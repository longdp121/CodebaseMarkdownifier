# learn.svelte.dev

A soup-to-nuts interactive tutorial on how to build apps with Svelte.

## Setup

This repo uses [pnpm](https://pnpm.io/).

## Developing the app

First, run `node scripts/create-common-bundle`. This packages up everything that's needed to run a SvelteKit app (Vite, esbuild, SvelteKit, Svelte compiler, etc.) which can subsequently be unpacked on a server to create and run an instance of a SvelteKit application (which powers the output window of the tutorial). Then, run `dev`:

```bash
node scripts/create-common-bundle
pnpm dev
```

To build for production and run locally:

```bash
pnpm build
pnpm preview
```

## Creating new tutorials

Tutorials live inside `content`. Each tutorial consists of a `README.md`, which is the text to the left, and `app-a` and `app-b` folders, which represent the initial and solved state. Files that stay the same can be omitted from `app-b`. Files are marked as deleted in `app-b` if they start with `__delete`. Folders that are marked as deleted in `app-b` if they contain a file named `__delete`.

## Bumping tutorial dependencies

Bump the dependency (for example Svelte) in both the root and the `content/common` `package.json`. In the root do `pnpm i` (to update `pnpm-lock.yaml`), in `content/common` do `npm i` (to update `package-lock.json`).


########## Project Structure ##########

```

.
├── content
│   └── tutorial
│       ├── 01-svelte
│       │   ├── 01-introduction
│       │   │   ├── 01-welcome-to-svelte
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-your-first-component
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-dynamic-attributes
│       │   │   │   ├── app-a
│       │   │   │   │   ├── src
│       │   │   │   │   │   └── lib
│       │   │   │   │   │       └── App.svelte
│       │   │   │   │   └── static
│       │   │   │   │       └── image.gif
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-styling
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 05-nested-components
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Nested.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 06-html-tags
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 02-reactivity
│       │   │   ├── 01-reactive-assignments
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-reactive-declarations
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-reactive-statements
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-updating-arrays-and-objects
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 03-props
│       │   │   ├── 01-declaring-props
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Nested.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── Nested.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-default-values
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Nested.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Nested.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-spread-props
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── PackageInfo.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 04-logic
│       │   │   ├── 01-if-blocks
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-else-blocks
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-else-if-blocks
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-each-blocks
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 05-keyed-each-blocks
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Thing.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 06-await-blocks
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       ├── lib
│       │   │   │   │       │   ├── App.svelte
│       │   │   │   │       │   └── utils.js
│       │   │   │   │       └── routes
│       │   │   │   │           └── random-number
│       │   │   │   │               └── +server.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 05-events
│       │   │   ├── 01-dom-events
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-inline-handlers
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-event-modifiers
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-component-events
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Inner.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Inner.svelte
│       │   │   │   └── README.md
│       │   │   ├── 05-event-forwarding
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── Inner.svelte
│       │   │   │   │           └── Outer.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── Outer.svelte
│       │   │   │   └── README.md
│       │   │   ├── 06-dom-event-forwarding
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── BigRedButton.svelte
│       │   │   │   │           └── horn.mp3
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── BigRedButton.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 06-bindings
│       │   │   ├── 01-text-inputs
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-numeric-inputs
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-checkbox-inputs
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-select-bindings
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 05-group-inputs
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 06-multiple-select-bindings
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 07-textarea-inputs
│       │   │   │   ├── app-a
│       │   │   │   │   ├── node_modules
│       │   │   │   │   │   └── marked
│       │   │   │   │   │       ├── bin
│       │   │   │   │   │       │   └── marked.js
│       │   │   │   │   │       ├── lib
│       │   │   │   │   │       │   ├── marked.cjs
│       │   │   │   │   │       │   ├── marked.esm.js
│       │   │   │   │   │       │   └── marked.umd.js
│       │   │   │   │   │       ├── LICENSE.md
│       │   │   │   │   │       ├── man
│       │   │   │   │   │       │   ├── marked.1
│       │   │   │   │   │       │   └── marked.1.txt
│       │   │   │   │   │       ├── marked.min.js
│       │   │   │   │   │       ├── package.json
│       │   │   │   │   │       ├── README.md
│       │   │   │   │   │       └── src
│       │   │   │   │   │           ├── defaults.js
│       │   │   │   │   │           ├── helpers.js
│       │   │   │   │   │           ├── Lexer.js
│       │   │   │   │   │           ├── marked.js
│       │   │   │   │   │           ├── Parser.js
│       │   │   │   │   │           ├── Renderer.js
│       │   │   │   │   │           ├── rules.js
│       │   │   │   │   │           ├── Slugger.js
│       │   │   │   │   │           ├── TextRenderer.js
│       │   │   │   │   │           └── Tokenizer.js
│       │   │   │   │   ├── package.json
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 07-lifecycle
│       │   │   ├── 01-onmount
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── gradient.js
│       │   │   │   │           └── svelte-logo-mask.svg
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-update
│       │   │   │   ├── app-a
│       │   │   │   │   ├── node_modules
│       │   │   │   │   │   └── elizabot
│       │   │   │   │   │       ├── elizabot.js
│       │   │   │   │   │       ├── elizadata.js
│       │   │   │   │   │       ├── package.json
│       │   │   │   │   │       └── README.md
│       │   │   │   │   ├── package.json
│       │   │   │   │   ├── package-lock.json
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-tick
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 08-stores
│       │   │   ├── 01-writable-stores
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── Decrementer.svelte
│       │   │   │   │           ├── Incrementer.svelte
│       │   │   │   │           ├── Resetter.svelte
│       │   │   │   │           └── stores.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── Decrementer.svelte
│       │   │   │   │           ├── Incrementer.svelte
│       │   │   │   │           └── Resetter.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-auto-subscriptions
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-readable-stores
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── stores.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── stores.js
│       │   │   │   └── README.md
│       │   │   ├── 04-derived-stores
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── stores.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── stores.js
│       │   │   │   └── README.md
│       │   │   ├── 05-custom-stores
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── stores.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── stores.js
│       │   │   │   └── README.md
│       │   │   ├── 06-store-bindings
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── stores.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── common
│       │   │   └── src
│       │   │       └── routes
│       │   │           ├── +error.svelte
│       │   │           ├── +layout.js
│       │   │           └── +page.svelte
│       │   └── meta.json
│       ├── 02-advanced-svelte
│       │   ├── 01-motion
│       │   │   ├── 01-tweens
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-springs
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 02-transitions
│       │   │   ├── 01-transition
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-adding-parameters-to-transitions
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-in-and-out
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-custom-css-transitions
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 05-custom-js-transitions
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 06-transition-events
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 07-global-transitions
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 08-key-blocks
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── loading-messages.js
│       │   │   │   │           └── transition.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 09-deferred-transitions
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── remove.svg
│       │   │   │   │           ├── TodoList.svelte
│       │   │   │   │           ├── todos.js
│       │   │   │   │           └── transition.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── TodoList.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 03-animations
│       │   │   ├── 01-animate
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── TodoList.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 04-actions
│       │   │   ├── 01-actions
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── actions.js
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Canvas.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── actions.js
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-adding-parameters-to-actions
│       │   │   │   ├── app-a
│       │   │   │   │   ├── node_modules
│       │   │   │   │   │   ├── @popperjs
│       │   │   │   │   │   │   └── core
│       │   │   │   │   │   │       ├── index.d.ts
│       │   │   │   │   │   │       ├── lib
│       │   │   │   │   │   │       │   ├── createPopper.js
│       │   │   │   │   │   │       │   ├── dom-utils
│       │   │   │   │   │   │       │   │   ├── contains.js
│       │   │   │   │   │   │       │   │   ├── getBoundingClientRect.js
│       │   │   │   │   │   │       │   │   ├── getClippingRect.js
│       │   │   │   │   │   │       │   │   ├── getCompositeRect.js
│       │   │   │   │   │   │       │   │   ├── getComputedStyle.js
│       │   │   │   │   │   │       │   │   ├── getDocumentElement.js
│       │   │   │   │   │   │       │   │   ├── getDocumentRect.js
│       │   │   │   │   │   │       │   │   ├── getHTMLElementScroll.js
│       │   │   │   │   │   │       │   │   ├── getLayoutRect.js
│       │   │   │   │   │   │       │   │   ├── getNodeName.js
│       │   │   │   │   │   │       │   │   ├── getNodeScroll.js
│       │   │   │   │   │   │       │   │   ├── getOffsetParent.js
│       │   │   │   │   │   │       │   │   ├── getParentNode.js
│       │   │   │   │   │   │       │   │   ├── getScrollParent.js
│       │   │   │   │   │   │       │   │   ├── getViewportRect.js
│       │   │   │   │   │   │       │   │   ├── getWindow.js
│       │   │   │   │   │   │       │   │   ├── getWindowScrollBarX.js
│       │   │   │   │   │   │       │   │   ├── getWindowScroll.js
│       │   │   │   │   │   │       │   │   ├── instanceOf.js
│       │   │   │   │   │   │       │   │   ├── isLayoutViewport.js
│       │   │   │   │   │   │       │   │   ├── isScrollParent.js
│       │   │   │   │   │   │       │   │   ├── isTableElement.js
│       │   │   │   │   │   │       │   │   └── listScrollParents.js
│       │   │   │   │   │   │       │   ├── enums.js
│       │   │   │   │   │   │       │   ├── index.js
│       │   │   │   │   │   │       │   ├── modifiers
│       │   │   │   │   │   │       │   │   ├── applyStyles.js
│       │   │   │   │   │   │       │   │   ├── arrow.js
│       │   │   │   │   │   │       │   │   ├── computeStyles.js
│       │   │   │   │   │   │       │   │   ├── eventListeners.js
│       │   │   │   │   │   │       │   │   ├── flip.js
│       │   │   │   │   │   │       │   │   ├── hide.js
│       │   │   │   │   │   │       │   │   ├── index.js
│       │   │   │   │   │   │       │   │   ├── offset.js
│       │   │   │   │   │   │       │   │   ├── popperOffsets.js
│       │   │   │   │   │   │       │   │   └── preventOverflow.js
│       │   │   │   │   │   │       │   ├── popper-base.js
│       │   │   │   │   │   │       │   ├── popper.js
│       │   │   │   │   │   │       │   ├── popper-lite.js
│       │   │   │   │   │   │       │   ├── types.js
│       │   │   │   │   │   │       │   └── utils
│       │   │   │   │   │   │       │       ├── computeAutoPlacement.js
│       │   │   │   │   │   │       │       ├── computeOffsets.js
│       │   │   │   │   │   │       │       ├── debounce.js
│       │   │   │   │   │   │       │       ├── detectOverflow.js
│       │   │   │   │   │   │       │       ├── expandToHashMap.js
│       │   │   │   │   │   │       │       ├── format.js
│       │   │   │   │   │   │       │       ├── getAltAxis.js
│       │   │   │   │   │   │       │       ├── getAltLen.js
│       │   │   │   │   │   │       │       ├── getBasePlacement.js
│       │   │   │   │   │   │       │       ├── getFreshSideObject.js
│       │   │   │   │   │   │       │       ├── getMainAxisFromPlacement.js
│       │   │   │   │   │   │       │       ├── getOppositePlacement.js
│       │   │   │   │   │   │       │       ├── getOppositeVariationPlacement.js
│       │   │   │   │   │   │       │       ├── getVariation.js
│       │   │   │   │   │   │       │       ├── math.js
│       │   │   │   │   │   │       │       ├── mergeByName.js
│       │   │   │   │   │   │       │       ├── mergePaddingObject.js
│       │   │   │   │   │   │       │       ├── orderModifiers.js
│       │   │   │   │   │   │       │       ├── rectToClientRect.js
│       │   │   │   │   │   │       │       ├── uniqueBy.js
│       │   │   │   │   │   │       │       ├── userAgent.js
│       │   │   │   │   │   │       │       ├── validateModifiers.js
│       │   │   │   │   │   │       │       └── within.js
│       │   │   │   │   │   │       ├── LICENSE.md
│       │   │   │   │   │   │       ├── package.json
│       │   │   │   │   │   │       └── README.md
│       │   │   │   │   │   └── tippy.js
│       │   │   │   │   │       ├── dist
│       │   │   │   │   │       │   ├── tippy.css
│       │   │   │   │   │       │   ├── tippy.esm.js
│       │   │   │   │   │       │   └── tippy.esm.js.map
│       │   │   │   │   │       ├── index.d.ts
│       │   │   │   │   │       ├── LICENSE
│       │   │   │   │   │       ├── package.json
│       │   │   │   │   │       ├── README.md
│       │   │   │   │   │       └── themes
│       │   │   │   │   │           ├── light-border.css
│       │   │   │   │   │           ├── light.css
│       │   │   │   │   │           ├── material.css
│       │   │   │   │   │           └── translucent.css
│       │   │   │   │   ├── package.json
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 05-bindings
│       │   │   ├── 01-contenteditable-bindings
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-each-block-bindings
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-media-elements
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── AudioPlayer.svelte
│       │   │   │   │           ├── pause.svg
│       │   │   │   │           ├── play.svg
│       │   │   │   │           ├── sound-off.svg
│       │   │   │   │           ├── sound-on.svg
│       │   │   │   │           └── tracks.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── AudioPlayer.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-dimensions
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 05-bind-this
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── gradient.js
│       │   │   │   │           └── svelte-logo-mask.svg
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 06-component-bindings
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Keypad.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 07-component-this
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── actions.js
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Canvas.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Canvas.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 06-classes-and-styles
│       │   │   ├── 01-classes
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── svelte-logo.svg
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-class-shorthand
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-styles
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-component-styles
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Box.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Box.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 07-composition
│       │   │   ├── 01-slots
│       │   │   │   ├── app-a
│       │   │   │   │   ├── src
│       │   │   │   │   │   └── lib
│       │   │   │   │   │       ├── App.svelte
│       │   │   │   │   │       ├── Card.svelte
│       │   │   │   │   │       ├── paper.svg
│       │   │   │   │   │       └── wood.svg
│       │   │   │   │   └── static
│       │   │   │   │       └── Garamond Classico SC Regular.woff2
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Card.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-named-slots
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── Card.svelte
│       │   │   │   │           ├── paper.svg
│       │   │   │   │           └── wood.svg
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── Card.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-slot-fallbacks
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── Card.svelte
│       │   │   │   │           ├── paper.svg
│       │   │   │   │           └── wood.svg
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── Card.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-slot-props
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── colors.js
│       │   │   │   │           └── FilterableList.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── FilterableList.svelte
│       │   │   │   └── README.md
│       │   │   ├── 05-optional-slots
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── FilterableList.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 08-context
│       │   │   ├── 01-context-api
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── Canvas.svelte
│       │   │   │   │           └── Square.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── Canvas.svelte
│       │   │   │   │           └── Square.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 09-special-elements
│       │   │   ├── 01-svelte-self
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── data.js
│       │   │   │   │           ├── File.svelte
│       │   │   │   │           └── Folder.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── Folder.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-svelte-component
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── BlueThing.svelte
│       │   │   │   │           ├── GreenThing.svelte
│       │   │   │   │           └── RedThing.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-svelte-element
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-svelte-window
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 05-svelte-window-bindings
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── deepsea.webp
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 06-svelte-body
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── kitten.png
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 07-svelte-document
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 08-svelte-head
│       │   │   │   ├── app-a
│       │   │   │   │   ├── src
│       │   │   │   │   │   └── lib
│       │   │   │   │   │       └── App.svelte
│       │   │   │   │   └── static
│       │   │   │   │       └── stylesheets
│       │   │   │   │           ├── fonts
│       │   │   │   │           │   ├── casablanca-antique.woff2
│       │   │   │   │           │   ├── edge-of-the-galaxy.woff2
│       │   │   │   │           │   ├── road-rage.woff2
│       │   │   │   │           │   └── shlop.woff2
│       │   │   │   │           ├── halloween.css
│       │   │   │   │           ├── halloween.webp
│       │   │   │   │           ├── margaritaville.css
│       │   │   │   │           ├── margaritaville.webp
│       │   │   │   │           ├── retrowave.css
│       │   │   │   │           ├── retrowave.webp
│       │   │   │   │           ├── spaaaaace.css
│       │   │   │   │           └── spaaaaace.webp
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   ├── 09-svelte-options
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── flash.js
│       │   │   │   │           └── Todo.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── Todo.svelte
│       │   │   │   └── README.md
│       │   │   ├── 10-svelte-fragment
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── Board.svelte
│       │   │   │   │           └── utils.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 10-module-context
│       │   │   ├── 01-sharing-code
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           ├── AudioPlayer.svelte
│       │   │   │   │           ├── pause.svg
│       │   │   │   │           ├── play.svg
│       │   │   │   │           ├── sound-off.svg
│       │   │   │   │           ├── sound-on.svg
│       │   │   │   │           └── tracks.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── AudioPlayer.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-module-exports
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           ├── App.svelte
│       │   │   │   │           └── AudioPlayer.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 11-misc
│       │   │   ├── 01-debug
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 12-next-steps
│       │   │   ├── 01-congratulations
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── lib
│       │   │   │   │           └── App.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── common
│       │   │   └── src
│       │   │       └── routes
│       │   │           ├── +error.svelte
│       │   │           ├── +layout.js
│       │   │           └── +page.svelte
│       │   └── meta.json
│       ├── 03-sveltekit
│       │   ├── 01-concepts
│       │   │   ├── 01-introducing-sveltekit
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 02-routing
│       │   │   ├── 01-pages
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── about
│       │   │   │   │               └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-layouts
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── about
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-params
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── blog
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── blog
│       │   │   │   │               └── [slug]
│       │   │   │   │                   └── +page.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 03-loading-data
│       │   │   ├── 01-page-data
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── blog
│       │   │   │   │           │   ├── data.js
│       │   │   │   │           │   ├── +page.svelte
│       │   │   │   │           │   └── [slug]
│       │   │   │   │           │       ├── +layout.svelte
│       │   │   │   │           │       └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── blog
│       │   │   │   │               ├── +page.server.js
│       │   │   │   │               ├── +page.svelte
│       │   │   │   │               └── [slug]
│       │   │   │   │                   ├── +page.server.js
│       │   │   │   │                   └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-layout-data
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── blog
│       │   │   │   │               ├── +layout.server.js
│       │   │   │   │               ├── +page.server.js
│       │   │   │   │               └── [slug]
│       │   │   │   │                   └── +layout.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 04-headers-and-cookies
│       │   │   ├── 01-headers
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.server.js
│       │   │   │   └── README.md
│       │   │   ├── 02-cookies
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.server.js
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 05-shared-modules
│       │   │   ├── 01-lib
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       ├── lib
│       │   │   │   │       │   └── message.js
│       │   │   │   │       └── routes
│       │   │   │   │           ├── a
│       │   │   │   │           │   └── deeply
│       │   │   │   │           │       └── nested
│       │   │   │   │           │           └── route
│       │   │   │   │           │               └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── a
│       │   │   │   │           │   └── deeply
│       │   │   │   │           │       └── nested
│       │   │   │   │           │           └── route
│       │   │   │   │           │               └── +page.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 06-forms
│       │   │   ├── 01-the-form-element
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       ├── lib
│       │   │   │   │       │   └── server
│       │   │   │   │       │       └── database.js
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           ├── +page.svelte
│       │   │   │   │           └── remove.svg
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-named-form-actions
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-form-validation
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       ├── lib
│       │   │   │   │       │   └── server
│       │   │   │   │       │       └── database.js
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-progressive-enhancement
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 05-customizing-use-enhance
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 07-api-routes
│       │   │   ├── 01-get-handlers
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── roll
│       │   │   │   │               └── +server.js
│       │   │   │   └── README.md
│       │   │   ├── 02-post-handlers
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       ├── lib
│       │   │   │   │       │   └── server
│       │   │   │   │       │       └── database.js
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           ├── +page.svelte
│       │   │   │   │           └── remove.svg
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.svelte
│       │   │   │   │           └── todo
│       │   │   │   │               └── +server.js
│       │   │   │   └── README.md
│       │   │   ├── 03-other-handlers
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.svelte
│       │   │   │   │           └── todo
│       │   │   │   │               └── [id]
│       │   │   │   │                   └── +server.js
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 08-stores
│       │   │   ├── 01-page-store
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── about
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +layout.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-navigating-store
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── about
│       │   │   │   │           │   ├── +page.server.js
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +layout.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-updated-store
│       │   │   │   ├── app-a
│       │   │   │   │   ├── src
│       │   │   │   │   │   └── routes
│       │   │   │   │   │       ├── about
│       │   │   │   │   │       │   ├── +page.server.js
│       │   │   │   │   │       │   └── +page.svelte
│       │   │   │   │   │       ├── +layout.svelte
│       │   │   │   │   │       ├── +page.server.js
│       │   │   │   │   │       └── +page.svelte
│       │   │   │   │   └── svelte.config.js
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +layout.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 09-errors-and-redirects
│       │   │   ├── 01-error-basics
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── emojis.js
│       │   │   │   │           ├── expected
│       │   │   │   │           │   ├── +page.server.js
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           ├── +page.svelte
│       │   │   │   │           └── unexpected
│       │   │   │   │               ├── +page.server.js
│       │   │   │   │               └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-error-pages
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +error.svelte
│       │   │   │   │           └── expected
│       │   │   │   │               └── +error.svelte
│       │   │   │   └── README.md
│       │   │   ├── 03-fallback-errors
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       ├── error.html
│       │   │   │   │       └── routes
│       │   │   │   │           └── +layout.server.js
│       │   │   │   └── README.md
│       │   │   ├── 04-redirects
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── a
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── b
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── a
│       │   │   │   │               └── +page.server.js
│       │   │   │   └── README.md
│       │   │   ├── meta.json
│       │   │   └── xx-custom-error-messages
│       │   │       ├── app-a
│       │   │       │   └── src
│       │   │       │       ├── hooks.client.js
│       │   │       │       ├── hooks.server.js
│       │   │       │       └── routes
│       │   │       │           ├── about
│       │   │       │           │   ├── +page.server.js
│       │   │       │           │   └── +page.svelte
│       │   │       │           ├── +error.svelte
│       │   │       │           ├── +layout.svelte
│       │   │       │           └── +page.svelte
│       │   │       ├── app-b
│       │   │       │   └── src
│       │   │       │       ├── hooks.client.js
│       │   │       │       ├── hooks.server.js
│       │   │       │       └── routes
│       │   │       │           └── +error.svelte
│       │   │       └── README.md
│       │   └── meta.json
│       ├── 04-advanced-sveltekit
│       │   ├── 01-hooks
│       │   │   ├── 01-handle
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       ├── hooks.server.js
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── hooks.server.js
│       │   │   │   └── README.md
│       │   │   ├── 02-event
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       ├── hooks.server.js
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       ├── hooks.server.js
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.server.js
│       │   │   │   └── README.md
│       │   │   ├── 03-handlefetch
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       ├── hooks.server.js
│       │   │   │   │       └── routes
│       │   │   │   │           ├── a
│       │   │   │   │           │   └── +server.js
│       │   │   │   │           ├── b
│       │   │   │   │           │   └── +server.js
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── hooks.server.js
│       │   │   │   └── README.md
│       │   │   ├── 04-handleerror
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       ├── hooks.server.js
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           ├── +page.svelte
│       │   │   │   │           ├── the-bad-place
│       │   │   │   │           │   ├── +page.server.js
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           └── the-good-place
│       │   │   │   │               └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       ├── hooks.server.js
│       │   │   │   │       └── routes
│       │   │   │   │           └── +error.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 02-page-options
│       │   │   ├── 01-page-options
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-ssr
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.server.js
│       │   │   │   └── README.md
│       │   │   ├── 03-csr
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.server.js
│       │   │   │   └── README.md
│       │   │   ├── 04-prerender
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.server.js
│       │   │   │   └── README.md
│       │   │   ├── 05-trailingslash
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── always
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── ignore
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           ├── never
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── always
│       │   │   │   │           │   └── +page.server.js
│       │   │   │   │           └── ignore
│       │   │   │   │               └── +page.server.js
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 03-link-options
│       │   │   ├── 01-preload
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           ├── +page.svelte
│       │   │   │   │           ├── slow-a
│       │   │   │   │           │   ├── +page.server.js
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           └── slow-b
│       │   │   │   │               ├── +page.server.js
│       │   │   │   │               └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +layout.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-reload
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── about
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +layout.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 04-advanced-routing
│       │   │   ├── 01-optional-params
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── [lang]
│       │   │   │   │           │   ├── +page.server.js
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── [[lang]]
│       │   │   │   │           │   ├── +page.server.js
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── [lang]
│       │   │   │   │           │   └── __delete
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 02-rest-params
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.svelte
│       │   │   │   │           └── [path]
│       │   │   │   │               └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── [...path]
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           └── [path]
│       │   │   │   │               └── __delete
│       │   │   │   └── README.md
│       │   │   ├── 03-param-matchers
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── colors
│       │   │   │   │           │   └── [color]
│       │   │   │   │           │       └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       ├── params
│       │   │   │   │       │   └── hex.js
│       │   │   │   │       └── routes
│       │   │   │   │           └── colors
│       │   │   │   │               ├── [color]
│       │   │   │   │               │   └── __delete
│       │   │   │   │               └── [color=hex]
│       │   │   │   │                   └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-route-groups
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── about
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── account
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── app
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           ├── login
│       │   │   │   │           │   ├── +page.server.js
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── logout
│       │   │   │   │           │   └── +page.server.js
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── account
│       │   │   │   │           │   └── __delete
│       │   │   │   │           ├── app
│       │   │   │   │           │   └── __delete
│       │   │   │   │           └── (authed)
│       │   │   │   │               ├── account
│       │   │   │   │               │   └── +page.svelte
│       │   │   │   │               ├── app
│       │   │   │   │               │   └── +page.svelte
│       │   │   │   │               ├── +layout.server.js
│       │   │   │   │               └── +layout.svelte
│       │   │   │   └── README.md
│       │   │   ├── 05-breaking-out-of-layouts
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── a
│       │   │   │   │           │   ├── b
│       │   │   │   │           │   │   ├── c
│       │   │   │   │           │   │   │   ├── +layout.svelte
│       │   │   │   │           │   │   │   └── +page.svelte
│       │   │   │   │           │   │   ├── +layout.svelte
│       │   │   │   │           │   │   └── +page.svelte
│       │   │   │   │           │   ├── +layout.svelte
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── a
│       │   │   │   │               └── b
│       │   │   │   │                   └── c
│       │   │   │   │                       ├── +page.svelte
│       │   │   │   │                       └── +page@.svelte
│       │   │   │   ├── meta.json
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 05-advanced-loading
│       │   │   ├── 01-universal-load-functions
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── blue
│       │   │   │   │           │   ├── blue.svelte
│       │   │   │   │           │   ├── +page.server.js
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── green
│       │   │   │   │           │   ├── green.svelte
│       │   │   │   │           │   ├── +page.server.js
│       │   │   │   │           │   └── +page.svelte
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           ├── +page.svelte
│       │   │   │   │           └── red
│       │   │   │   │               ├── +page.server.js
│       │   │   │   │               ├── +page.svelte
│       │   │   │   │               └── red.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── blue
│       │   │   │   │           │   ├── +page.js
│       │   │   │   │           │   └── +page.server.js
│       │   │   │   │           ├── green
│       │   │   │   │           │   ├── +page.js
│       │   │   │   │           │   └── +page.server.js
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── red
│       │   │   │   │               ├── +page.js
│       │   │   │   │               └── +page.server.js
│       │   │   │   └── README.md
│       │   │   ├── 02-using-both-load-functions
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── BoringComponent.svelte
│       │   │   │   │           ├── CoolComponent.svelte
│       │   │   │   │           ├── +page.js
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.js
│       │   │   │   └── README.md
│       │   │   ├── 03-await-parent
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +layout.server.js
│       │   │   │   │           ├── +page.svelte
│       │   │   │   │           └── sum
│       │   │   │   │               ├── +layout.js
│       │   │   │   │               ├── +page.js
│       │   │   │   │               └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +layout.server.js
│       │   │   │   │           └── sum
│       │   │   │   │               ├── +layout.js
│       │   │   │   │               └── +page.js
│       │   │   │   └── README.md
│       │   │   ├── 04-invalidation
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── api
│       │   │   │   │           │   └── now
│       │   │   │   │           │       └── +server.js
│       │   │   │   │           ├── +layout.js
│       │   │   │   │           ├── +layout.svelte
│       │   │   │   │           └── [...timezone]
│       │   │   │   │               ├── +page.js
│       │   │   │   │               └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── [...timezone]
│       │   │   │   │               └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 05-custom-dependencies
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +layout.js
│       │   │   │   │           └── [...timezone]
│       │   │   │   │               └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 06-invalidate-all
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +layout.js
│       │   │   │   │           └── [...timezone]
│       │   │   │   │               └── +page.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 06-environment-variables
│       │   │   ├── 01-env-static-private
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           ├── +page.server.js
│       │   │   │   │           ├── +page.svelte
│       │   │   │   │           └── welcome
│       │   │   │   │               ├── +page.server.js
│       │   │   │   │               └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.server.js
│       │   │   │   └── README.md
│       │   │   ├── 02-env-dynamic-private
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.server.js
│       │   │   │   └── README.md
│       │   │   ├── 03-env-static-public
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   ├── 04-env-dynamic-public
│       │   │   │   ├── app-b
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   ├── 07-conclusion
│       │   │   ├── 01-next-steps
│       │   │   │   ├── app-a
│       │   │   │   │   └── src
│       │   │   │   │       └── routes
│       │   │   │   │           └── +page.svelte
│       │   │   │   └── README.md
│       │   │   └── meta.json
│       │   └── meta.json
│       └── common
│           ├── package.json
│           ├── package-lock.json
│           ├── src
│           │   ├── app.html
│           │   ├── __client.js
│           │   └── routes
│           │       └── +page.svelte
│           ├── static
│           │   ├── favicon.png
│           │   ├── svelte-logo-mask.svg
│           │   └── tutorial
│           │       ├── dark-theme.css
│           │       └── icons
│           │           ├── folder-open.svg
│           │           ├── folder.svg
│           │           ├── gif.svg
│           │           ├── md.svg
│           │           └── xlsx.svg
│           ├── svelte.config.js
│           └── vite.config.js
├── jsconfig.json
├── LICENSE.md
├── middleware.js
├── package.json
├── playwright.config.ts
├── pnpm-lock.yaml
├── README.md
├── scripts
│   └── create-common-bundle
│       ├── index.js
│       └── unzip.js
├── script.sh
├── src
│   ├── app.css
│   ├── app.d.ts
│   ├── app.html
│   ├── hooks.server.js
│   ├── lib
│   │   ├── client
│   │   │   └── adapters
│   │   │       ├── common
│   │   │       │   └── index.js
│   │   │       └── webcontainer
│   │   │           └── index.js
│   │   ├── components
│   │   │   └── Modal.svelte
│   │   ├── icons
│   │   │   ├── chevron.svg
│   │   │   ├── delete.svg
│   │   │   ├── external.svg
│   │   │   ├── file-edit-inline-dark.svg
│   │   │   ├── file-edit.svg
│   │   │   ├── file-new.svg
│   │   │   ├── file.svg
│   │   │   ├── folder-new.svg
│   │   │   ├── folder-open.svg
│   │   │   ├── folder.svg
│   │   │   ├── refresh.svg
│   │   │   ├── rename.svg
│   │   │   └── terminal.svg
│   │   ├── server
│   │   │   ├── content.js
│   │   │   └── markdown.js
│   │   ├── types
│   │   │   └── index.d.ts
│   │   └── utils.js
│   └── routes
│       ├── assets
│       │   └── media
│       │       └── [...path]
│       │           └── +server.js
│       ├── content.json
│       │   └── +server.js
│       ├── +error.svelte
│       ├── +layout.server.js
│       ├── +layout.svelte
│       ├── nav.json
│       │   └── +server.js
│       ├── +page.server.js
│       └── tutorial
│           ├── +page.js
│           └── [slug]
│               ├── adapter.js
│               ├── autocompletionDataProvider.js
│               ├── autocompletion.js
│               ├── Chrome.svelte
│               ├── codemirror.css
│               ├── Editor.svelte
│               ├── filetree
│               │   ├── context.js
│               │   ├── ContextMenu.svelte
│               │   ├── File.svelte
│               │   ├── Filetree.svelte
│               │   ├── Folder.svelte
│               │   └── Item.svelte
│               ├── ImageViewer.svelte
│               ├── +layout.server.js
│               ├── Loading.svelte
│               ├── Menu.svelte
│               ├── Output.svelte
│               ├── +page.server.js
│               ├── +page.svelte
│               ├── ScreenToggle.svelte
│               ├── Sidebar.svelte
│               ├── state.js
│               └── ToggleButton.svelte
├── static
│   ├── favicon.png
│   ├── manifest.json
│   ├── robots.txt
│   ├── svelte-logo-square.png
│   ├── svelte-logo-square.svg
│   ├── svelte-logo.svg
│   └── tutorial
│       ├── dark-theme.css
│       └── icons
│           ├── email.svg
│           ├── gif.svg
│           ├── map-marker.svg
│           ├── md.svg
│           └── xlsx.svg
├── svelte.config.js
├── tests
│   ├── env_file.spec.ts
│   └── focus_management.spec.ts
├── vercel.json
└── vite.config.js

1067 directories, 890 files

```


########## File List ##########

| Index | File name |
|-------|-----------|
| 1 | content/tutorial/01-svelte/01-introduction/01-welcome-to-svelte/app-a/src/lib/App.svelte |
| 2 | content/tutorial/01-svelte/01-introduction/01-welcome-to-svelte/README.md |
| 3 | content/tutorial/01-svelte/01-introduction/02-your-first-component/app-a/src/lib/App.svelte |
| 4 | content/tutorial/01-svelte/01-introduction/02-your-first-component/app-b/src/lib/App.svelte |
| 5 | content/tutorial/01-svelte/01-introduction/02-your-first-component/README.md |
| 6 | content/tutorial/01-svelte/01-introduction/03-dynamic-attributes/app-a/src/lib/App.svelte |
| 7 | content/tutorial/01-svelte/01-introduction/03-dynamic-attributes/app-b/src/lib/App.svelte |
| 8 | content/tutorial/01-svelte/01-introduction/03-dynamic-attributes/README.md |
| 9 | content/tutorial/01-svelte/01-introduction/04-styling/app-a/src/lib/App.svelte |
| 10 | content/tutorial/01-svelte/01-introduction/04-styling/app-b/src/lib/App.svelte |
| 11 | content/tutorial/01-svelte/01-introduction/04-styling/README.md |
| 12 | content/tutorial/01-svelte/01-introduction/05-nested-components/app-a/src/lib/App.svelte |
| 13 | content/tutorial/01-svelte/01-introduction/05-nested-components/app-a/src/lib/Nested.svelte |
| 14 | content/tutorial/01-svelte/01-introduction/05-nested-components/app-b/src/lib/App.svelte |
| 15 | content/tutorial/01-svelte/01-introduction/05-nested-components/README.md |
| 16 | content/tutorial/01-svelte/01-introduction/06-html-tags/app-a/src/lib/App.svelte |
| 17 | content/tutorial/01-svelte/01-introduction/06-html-tags/app-b/src/lib/App.svelte |
| 18 | content/tutorial/01-svelte/01-introduction/06-html-tags/README.md |
| 19 | content/tutorial/01-svelte/01-introduction/meta.json |
| 20 | content/tutorial/01-svelte/02-reactivity/01-reactive-assignments/app-a/src/lib/App.svelte |
| 21 | content/tutorial/01-svelte/02-reactivity/01-reactive-assignments/app-b/src/lib/App.svelte |
| 22 | content/tutorial/01-svelte/02-reactivity/01-reactive-assignments/README.md |
| 23 | content/tutorial/01-svelte/02-reactivity/02-reactive-declarations/app-b/src/lib/App.svelte |
| 24 | content/tutorial/01-svelte/02-reactivity/02-reactive-declarations/README.md |
| 25 | content/tutorial/01-svelte/02-reactivity/03-reactive-statements/app-a/src/lib/App.svelte |
| 26 | content/tutorial/01-svelte/02-reactivity/03-reactive-statements/app-b/src/lib/App.svelte |
| 27 | content/tutorial/01-svelte/02-reactivity/03-reactive-statements/README.md |
| 28 | content/tutorial/01-svelte/02-reactivity/04-updating-arrays-and-objects/app-a/src/lib/App.svelte |
| 29 | content/tutorial/01-svelte/02-reactivity/04-updating-arrays-and-objects/app-b/src/lib/App.svelte |
| 30 | content/tutorial/01-svelte/02-reactivity/04-updating-arrays-and-objects/README.md |
| 31 | content/tutorial/01-svelte/02-reactivity/meta.json |
| 32 | content/tutorial/01-svelte/03-props/01-declaring-props/app-a/src/lib/App.svelte |
| 33 | content/tutorial/01-svelte/03-props/01-declaring-props/app-a/src/lib/Nested.svelte |
| 34 | content/tutorial/01-svelte/03-props/01-declaring-props/app-b/src/lib/Nested.svelte |
| 35 | content/tutorial/01-svelte/03-props/01-declaring-props/README.md |
| 36 | content/tutorial/01-svelte/03-props/02-default-values/app-a/src/lib/App.svelte |
| 37 | content/tutorial/01-svelte/03-props/02-default-values/app-a/src/lib/Nested.svelte |
| 38 | content/tutorial/01-svelte/03-props/02-default-values/app-b/src/lib/App.svelte |
| 39 | content/tutorial/01-svelte/03-props/02-default-values/app-b/src/lib/Nested.svelte |
| 40 | content/tutorial/01-svelte/03-props/02-default-values/README.md |
| 41 | content/tutorial/01-svelte/03-props/03-spread-props/app-a/src/lib/App.svelte |
| 42 | content/tutorial/01-svelte/03-props/03-spread-props/app-a/src/lib/PackageInfo.svelte |
| 43 | content/tutorial/01-svelte/03-props/03-spread-props/app-b/src/lib/App.svelte |
| 44 | content/tutorial/01-svelte/03-props/03-spread-props/README.md |
| 45 | content/tutorial/01-svelte/03-props/meta.json |
| 46 | content/tutorial/01-svelte/04-logic/01-if-blocks/app-a/src/lib/App.svelte |
| 47 | content/tutorial/01-svelte/04-logic/01-if-blocks/app-b/src/lib/App.svelte |
| 48 | content/tutorial/01-svelte/04-logic/01-if-blocks/README.md |
| 49 | content/tutorial/01-svelte/04-logic/02-else-blocks/app-b/src/lib/App.svelte |
| 50 | content/tutorial/01-svelte/04-logic/02-else-blocks/README.md |
| 51 | content/tutorial/01-svelte/04-logic/03-else-if-blocks/app-b/src/lib/App.svelte |
| 52 | content/tutorial/01-svelte/04-logic/03-else-if-blocks/README.md |
| 53 | content/tutorial/01-svelte/04-logic/04-each-blocks/app-a/src/lib/App.svelte |
| 54 | content/tutorial/01-svelte/04-logic/04-each-blocks/app-b/src/lib/App.svelte |
| 55 | content/tutorial/01-svelte/04-logic/04-each-blocks/README.md |
| 56 | content/tutorial/01-svelte/04-logic/05-keyed-each-blocks/app-a/src/lib/App.svelte |
| 57 | content/tutorial/01-svelte/04-logic/05-keyed-each-blocks/app-a/src/lib/Thing.svelte |
| 58 | content/tutorial/01-svelte/04-logic/05-keyed-each-blocks/app-b/src/lib/App.svelte |
| 59 | content/tutorial/01-svelte/04-logic/05-keyed-each-blocks/README.md |
| 60 | content/tutorial/01-svelte/04-logic/06-await-blocks/app-a/src/lib/App.svelte |
| 61 | content/tutorial/01-svelte/04-logic/06-await-blocks/app-a/src/lib/utils.js |
| 62 | content/tutorial/01-svelte/04-logic/06-await-blocks/app-a/src/routes/random-number/+server.js |
| 63 | content/tutorial/01-svelte/04-logic/06-await-blocks/app-b/src/lib/App.svelte |
| 64 | content/tutorial/01-svelte/04-logic/06-await-blocks/README.md |
| 65 | content/tutorial/01-svelte/04-logic/meta.json |
| 66 | content/tutorial/01-svelte/05-events/01-dom-events/app-a/src/lib/App.svelte |
| 67 | content/tutorial/01-svelte/05-events/01-dom-events/app-b/src/lib/App.svelte |
| 68 | content/tutorial/01-svelte/05-events/01-dom-events/README.md |
| 69 | content/tutorial/01-svelte/05-events/02-inline-handlers/app-b/src/lib/App.svelte |
| 70 | content/tutorial/01-svelte/05-events/02-inline-handlers/README.md |
| 71 | content/tutorial/01-svelte/05-events/03-event-modifiers/app-a/src/lib/App.svelte |
| 72 | content/tutorial/01-svelte/05-events/03-event-modifiers/app-b/src/lib/App.svelte |
| 73 | content/tutorial/01-svelte/05-events/03-event-modifiers/README.md |
| 74 | content/tutorial/01-svelte/05-events/04-component-events/app-a/src/lib/App.svelte |
| 75 | content/tutorial/01-svelte/05-events/04-component-events/app-a/src/lib/Inner.svelte |
| 76 | content/tutorial/01-svelte/05-events/04-component-events/app-b/src/lib/App.svelte |
| 77 | content/tutorial/01-svelte/05-events/04-component-events/app-b/src/lib/Inner.svelte |
| 78 | content/tutorial/01-svelte/05-events/04-component-events/README.md |
| 79 | content/tutorial/01-svelte/05-events/05-event-forwarding/app-a/src/lib/App.svelte |
| 80 | content/tutorial/01-svelte/05-events/05-event-forwarding/app-a/src/lib/Inner.svelte |
| 81 | content/tutorial/01-svelte/05-events/05-event-forwarding/app-a/src/lib/Outer.svelte |
| 82 | content/tutorial/01-svelte/05-events/05-event-forwarding/app-b/src/lib/Outer.svelte |
| 83 | content/tutorial/01-svelte/05-events/05-event-forwarding/README.md |
| 84 | content/tutorial/01-svelte/05-events/06-dom-event-forwarding/app-a/src/lib/App.svelte |
| 85 | content/tutorial/01-svelte/05-events/06-dom-event-forwarding/app-a/src/lib/BigRedButton.svelte |
| 86 | content/tutorial/01-svelte/05-events/06-dom-event-forwarding/app-b/src/lib/BigRedButton.svelte |
| 87 | content/tutorial/01-svelte/05-events/06-dom-event-forwarding/README.md |
| 88 | content/tutorial/01-svelte/05-events/meta.json |
| 89 | content/tutorial/01-svelte/06-bindings/01-text-inputs/app-a/src/lib/App.svelte |
| 90 | content/tutorial/01-svelte/06-bindings/01-text-inputs/app-b/src/lib/App.svelte |
| 91 | content/tutorial/01-svelte/06-bindings/01-text-inputs/README.md |
| 92 | content/tutorial/01-svelte/06-bindings/02-numeric-inputs/app-a/src/lib/App.svelte |
| 93 | content/tutorial/01-svelte/06-bindings/02-numeric-inputs/app-b/src/lib/App.svelte |
| 94 | content/tutorial/01-svelte/06-bindings/02-numeric-inputs/README.md |
| 95 | content/tutorial/01-svelte/06-bindings/03-checkbox-inputs/app-a/src/lib/App.svelte |
| 96 | content/tutorial/01-svelte/06-bindings/03-checkbox-inputs/app-b/src/lib/App.svelte |
| 97 | content/tutorial/01-svelte/06-bindings/03-checkbox-inputs/README.md |
| 98 | content/tutorial/01-svelte/06-bindings/04-select-bindings/app-a/src/lib/App.svelte |
| 99 | content/tutorial/01-svelte/06-bindings/04-select-bindings/app-b/src/lib/App.svelte |
| 100 | content/tutorial/01-svelte/06-bindings/04-select-bindings/README.md |
| 101 | content/tutorial/01-svelte/06-bindings/05-group-inputs/app-a/src/lib/App.svelte |
| 102 | content/tutorial/01-svelte/06-bindings/05-group-inputs/app-b/src/lib/App.svelte |
| 103 | content/tutorial/01-svelte/06-bindings/05-group-inputs/README.md |
| 104 | content/tutorial/01-svelte/06-bindings/06-multiple-select-bindings/app-b/src/lib/App.svelte |
| 105 | content/tutorial/01-svelte/06-bindings/06-multiple-select-bindings/README.md |
| 106 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/bin/marked.js |
| 107 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/lib/marked.cjs |
| 108 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/lib/marked.esm.js |
| 109 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/lib/marked.umd.js |
| 110 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/LICENSE.md |
| 111 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/man/marked.1 |
| 112 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/man/marked.1.txt |
| 113 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/marked.min.js |
| 114 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/package.json |
| 115 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/README.md |
| 116 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/defaults.js |
| 117 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/helpers.js |
| 118 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/Lexer.js |
| 119 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/marked.js |
| 120 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/Parser.js |
| 121 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/Renderer.js |
| 122 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/rules.js |
| 123 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/Slugger.js |
| 124 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/TextRenderer.js |
| 125 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/Tokenizer.js |
| 126 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/package.json |
| 127 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/src/lib/App.svelte |
| 128 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-b/src/lib/App.svelte |
| 129 | content/tutorial/01-svelte/06-bindings/07-textarea-inputs/README.md |
| 130 | content/tutorial/01-svelte/06-bindings/meta.json |
| 131 | content/tutorial/01-svelte/07-lifecycle/01-onmount/app-a/src/lib/App.svelte |
| 132 | content/tutorial/01-svelte/07-lifecycle/01-onmount/app-a/src/lib/gradient.js |
| 133 | content/tutorial/01-svelte/07-lifecycle/01-onmount/app-b/src/lib/App.svelte |
| 134 | content/tutorial/01-svelte/07-lifecycle/01-onmount/README.md |
| 135 | content/tutorial/01-svelte/07-lifecycle/02-update/app-a/node_modules/elizabot/elizabot.js |
| 136 | content/tutorial/01-svelte/07-lifecycle/02-update/app-a/node_modules/elizabot/elizadata.js |
| 137 | content/tutorial/01-svelte/07-lifecycle/02-update/app-a/node_modules/elizabot/package.json |
| 138 | content/tutorial/01-svelte/07-lifecycle/02-update/app-a/node_modules/elizabot/README.md |
| 139 | content/tutorial/01-svelte/07-lifecycle/02-update/app-a/package.json |
| 140 | content/tutorial/01-svelte/07-lifecycle/02-update/app-a/package-lock.json |
| 141 | content/tutorial/01-svelte/07-lifecycle/02-update/app-a/src/lib/App.svelte |
| 142 | content/tutorial/01-svelte/07-lifecycle/02-update/app-b/src/lib/App.svelte |
| 143 | content/tutorial/01-svelte/07-lifecycle/02-update/README.md |
| 144 | content/tutorial/01-svelte/07-lifecycle/03-tick/app-a/src/lib/App.svelte |
| 145 | content/tutorial/01-svelte/07-lifecycle/03-tick/app-b/src/lib/App.svelte |
| 146 | content/tutorial/01-svelte/07-lifecycle/03-tick/README.md |
| 147 | content/tutorial/01-svelte/07-lifecycle/meta.json |
| 148 | content/tutorial/01-svelte/08-stores/01-writable-stores/app-a/src/lib/App.svelte |
| 149 | content/tutorial/01-svelte/08-stores/01-writable-stores/app-a/src/lib/Decrementer.svelte |
| 150 | content/tutorial/01-svelte/08-stores/01-writable-stores/app-a/src/lib/Incrementer.svelte |
| 151 | content/tutorial/01-svelte/08-stores/01-writable-stores/app-a/src/lib/Resetter.svelte |
| 152 | content/tutorial/01-svelte/08-stores/01-writable-stores/app-a/src/lib/stores.js |
| 153 | content/tutorial/01-svelte/08-stores/01-writable-stores/app-b/src/lib/Decrementer.svelte |
| 154 | content/tutorial/01-svelte/08-stores/01-writable-stores/app-b/src/lib/Incrementer.svelte |
| 155 | content/tutorial/01-svelte/08-stores/01-writable-stores/app-b/src/lib/Resetter.svelte |
| 156 | content/tutorial/01-svelte/08-stores/01-writable-stores/README.md |
| 157 | content/tutorial/01-svelte/08-stores/02-auto-subscriptions/app-b/src/lib/App.svelte |
| 158 | content/tutorial/01-svelte/08-stores/02-auto-subscriptions/README.md |
| 159 | content/tutorial/01-svelte/08-stores/03-readable-stores/app-a/src/lib/App.svelte |
| 160 | content/tutorial/01-svelte/08-stores/03-readable-stores/app-a/src/lib/stores.js |
| 161 | content/tutorial/01-svelte/08-stores/03-readable-stores/app-b/src/lib/stores.js |
| 162 | content/tutorial/01-svelte/08-stores/03-readable-stores/README.md |
| 163 | content/tutorial/01-svelte/08-stores/04-derived-stores/app-a/src/lib/App.svelte |
| 164 | content/tutorial/01-svelte/08-stores/04-derived-stores/app-a/src/lib/stores.js |
| 165 | content/tutorial/01-svelte/08-stores/04-derived-stores/app-b/src/lib/stores.js |
| 166 | content/tutorial/01-svelte/08-stores/04-derived-stores/README.md |
| 167 | content/tutorial/01-svelte/08-stores/05-custom-stores/app-a/src/lib/App.svelte |
| 168 | content/tutorial/01-svelte/08-stores/05-custom-stores/app-a/src/lib/stores.js |
| 169 | content/tutorial/01-svelte/08-stores/05-custom-stores/app-b/src/lib/stores.js |
| 170 | content/tutorial/01-svelte/08-stores/05-custom-stores/README.md |
| 171 | content/tutorial/01-svelte/08-stores/06-store-bindings/app-a/src/lib/App.svelte |
| 172 | content/tutorial/01-svelte/08-stores/06-store-bindings/app-a/src/lib/stores.js |
| 173 | content/tutorial/01-svelte/08-stores/06-store-bindings/app-b/src/lib/App.svelte |
| 174 | content/tutorial/01-svelte/08-stores/06-store-bindings/README.md |
| 175 | content/tutorial/01-svelte/08-stores/meta.json |
| 176 | content/tutorial/01-svelte/common/src/routes/+error.svelte |
| 177 | content/tutorial/01-svelte/common/src/routes/+layout.js |
| 178 | content/tutorial/01-svelte/common/src/routes/+page.svelte |
| 179 | content/tutorial/01-svelte/meta.json |
| 180 | content/tutorial/02-advanced-svelte/01-motion/01-tweens/app-a/src/lib/App.svelte |
| 181 | content/tutorial/02-advanced-svelte/01-motion/01-tweens/app-b/src/lib/App.svelte |
| 182 | content/tutorial/02-advanced-svelte/01-motion/01-tweens/README.md |
| 183 | content/tutorial/02-advanced-svelte/01-motion/02-springs/app-a/src/lib/App.svelte |
| 184 | content/tutorial/02-advanced-svelte/01-motion/02-springs/app-b/src/lib/App.svelte |
| 185 | content/tutorial/02-advanced-svelte/01-motion/02-springs/README.md |
| 186 | content/tutorial/02-advanced-svelte/01-motion/meta.json |
| 187 | content/tutorial/02-advanced-svelte/02-transitions/01-transition/app-a/src/lib/App.svelte |
| 188 | content/tutorial/02-advanced-svelte/02-transitions/01-transition/app-b/src/lib/App.svelte |
| 189 | content/tutorial/02-advanced-svelte/02-transitions/01-transition/README.md |
| 190 | content/tutorial/02-advanced-svelte/02-transitions/02-adding-parameters-to-transitions/app-b/src/lib/App.svelte |
| 191 | content/tutorial/02-advanced-svelte/02-transitions/02-adding-parameters-to-transitions/README.md |
| 192 | content/tutorial/02-advanced-svelte/02-transitions/03-in-and-out/app-b/src/lib/App.svelte |
| 193 | content/tutorial/02-advanced-svelte/02-transitions/03-in-and-out/README.md |
| 194 | content/tutorial/02-advanced-svelte/02-transitions/04-custom-css-transitions/app-a/src/lib/App.svelte |
| 195 | content/tutorial/02-advanced-svelte/02-transitions/04-custom-css-transitions/app-b/src/lib/App.svelte |
| 196 | content/tutorial/02-advanced-svelte/02-transitions/04-custom-css-transitions/README.md |
| 197 | content/tutorial/02-advanced-svelte/02-transitions/05-custom-js-transitions/app-a/src/lib/App.svelte |
| 198 | content/tutorial/02-advanced-svelte/02-transitions/05-custom-js-transitions/app-b/src/lib/App.svelte |
| 199 | content/tutorial/02-advanced-svelte/02-transitions/05-custom-js-transitions/README.md |
| 200 | content/tutorial/02-advanced-svelte/02-transitions/06-transition-events/app-a/src/lib/App.svelte |
| 201 | content/tutorial/02-advanced-svelte/02-transitions/06-transition-events/app-b/src/lib/App.svelte |
| 202 | content/tutorial/02-advanced-svelte/02-transitions/06-transition-events/README.md |
| 203 | content/tutorial/02-advanced-svelte/02-transitions/07-global-transitions/app-a/src/lib/App.svelte |
| 204 | content/tutorial/02-advanced-svelte/02-transitions/07-global-transitions/app-b/src/lib/App.svelte |
| 205 | content/tutorial/02-advanced-svelte/02-transitions/07-global-transitions/README.md |
| 206 | content/tutorial/02-advanced-svelte/02-transitions/08-key-blocks/app-a/src/lib/App.svelte |
| 207 | content/tutorial/02-advanced-svelte/02-transitions/08-key-blocks/app-a/src/lib/loading-messages.js |
| 208 | content/tutorial/02-advanced-svelte/02-transitions/08-key-blocks/app-a/src/lib/transition.js |
| 209 | content/tutorial/02-advanced-svelte/02-transitions/08-key-blocks/app-b/src/lib/App.svelte |
| 210 | content/tutorial/02-advanced-svelte/02-transitions/08-key-blocks/README.md |
| 211 | content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/app-a/src/lib/App.svelte |
| 212 | content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/app-a/src/lib/TodoList.svelte |
| 213 | content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/app-a/src/lib/todos.js |
| 214 | content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/app-a/src/lib/transition.js |
| 215 | content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/app-b/src/lib/TodoList.svelte |
| 216 | content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/README.md |
| 217 | content/tutorial/02-advanced-svelte/02-transitions/meta.json |
| 218 | content/tutorial/02-advanced-svelte/03-animations/01-animate/app-b/src/lib/TodoList.svelte |
| 219 | content/tutorial/02-advanced-svelte/03-animations/01-animate/README.md |
| 220 | content/tutorial/02-advanced-svelte/03-animations/meta.json |
| 221 | content/tutorial/02-advanced-svelte/04-actions/01-actions/app-a/src/lib/actions.js |
| 222 | content/tutorial/02-advanced-svelte/04-actions/01-actions/app-a/src/lib/App.svelte |
| 223 | content/tutorial/02-advanced-svelte/04-actions/01-actions/app-a/src/lib/Canvas.svelte |
| 224 | content/tutorial/02-advanced-svelte/04-actions/01-actions/app-b/src/lib/actions.js |
| 225 | content/tutorial/02-advanced-svelte/04-actions/01-actions/app-b/src/lib/App.svelte |
| 226 | content/tutorial/02-advanced-svelte/04-actions/01-actions/README.md |
| 227 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/index.d.ts |
| 228 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/createPopper.js |
| 229 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/contains.js |
| 230 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js |
| 231 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js |
| 232 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js |
| 233 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js |
| 234 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js |
| 235 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js |
| 236 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js |
| 237 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js |
| 238 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getNodeName.js |
| 239 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js |
| 240 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js |
| 241 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getParentNode.js |
| 242 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js |
| 243 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js |
| 244 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getWindow.js |
| 245 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js |
| 246 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js |
| 247 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/instanceOf.js |
| 248 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/isLayoutViewport.js |
| 249 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js |
| 250 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/isTableElement.js |
| 251 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js |
| 252 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/enums.js |
| 253 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/index.js |
| 254 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/applyStyles.js |
| 255 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/arrow.js |
| 256 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/computeStyles.js |
| 257 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/eventListeners.js |
| 258 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/flip.js |
| 259 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/hide.js |
| 260 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/index.js |
| 261 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/offset.js |
| 262 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/popperOffsets.js |
| 263 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/preventOverflow.js |
| 264 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/popper-base.js |
| 265 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/popper.js |
| 266 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/popper-lite.js |
| 267 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/types.js |
| 268 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js |
| 269 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/computeOffsets.js |
| 270 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/debounce.js |
| 271 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/detectOverflow.js |
| 272 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/expandToHashMap.js |
| 273 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/format.js |
| 274 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getAltAxis.js |
| 275 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getAltLen.js |
| 276 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getBasePlacement.js |
| 277 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getFreshSideObject.js |
| 278 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js |
| 279 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getOppositePlacement.js |
| 280 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js |
| 281 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getVariation.js |
| 282 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/math.js |
| 283 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/mergeByName.js |
| 284 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/mergePaddingObject.js |
| 285 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/orderModifiers.js |
| 286 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/rectToClientRect.js |
| 287 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/uniqueBy.js |
| 288 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/userAgent.js |
| 289 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/validateModifiers.js |
| 290 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/within.js |
| 291 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/LICENSE.md |
| 292 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/package.json |
| 293 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/README.md |
| 294 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/dist/tippy.css |
| 295 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/dist/tippy.esm.js |
| 296 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/dist/tippy.esm.js.map |
| 297 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/index.d.ts |
| 298 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/LICENSE |
| 299 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/package.json |
| 300 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/README.md |
| 301 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/themes/light-border.css |
| 302 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/themes/light.css |
| 303 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/themes/material.css |
| 304 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/themes/translucent.css |
| 305 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/package.json |
| 306 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/src/lib/App.svelte |
| 307 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-b/src/lib/App.svelte |
| 308 | content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/README.md |
| 309 | content/tutorial/02-advanced-svelte/04-actions/meta.json |
| 310 | content/tutorial/02-advanced-svelte/05-bindings/01-contenteditable-bindings/app-a/src/lib/App.svelte |
| 311 | content/tutorial/02-advanced-svelte/05-bindings/01-contenteditable-bindings/app-b/src/lib/App.svelte |
| 312 | content/tutorial/02-advanced-svelte/05-bindings/01-contenteditable-bindings/README.md |
| 313 | content/tutorial/02-advanced-svelte/05-bindings/02-each-block-bindings/app-a/src/lib/App.svelte |
| 314 | content/tutorial/02-advanced-svelte/05-bindings/02-each-block-bindings/app-b/src/lib/App.svelte |
| 315 | content/tutorial/02-advanced-svelte/05-bindings/02-each-block-bindings/README.md |
| 316 | content/tutorial/02-advanced-svelte/05-bindings/03-media-elements/app-a/src/lib/App.svelte |
| 317 | content/tutorial/02-advanced-svelte/05-bindings/03-media-elements/app-a/src/lib/AudioPlayer.svelte |
| 318 | content/tutorial/02-advanced-svelte/05-bindings/03-media-elements/app-a/src/lib/tracks.js |
| 319 | content/tutorial/02-advanced-svelte/05-bindings/03-media-elements/app-b/src/lib/AudioPlayer.svelte |
| 320 | content/tutorial/02-advanced-svelte/05-bindings/03-media-elements/README.md |
| 321 | content/tutorial/02-advanced-svelte/05-bindings/04-dimensions/app-a/src/lib/App.svelte |
| 322 | content/tutorial/02-advanced-svelte/05-bindings/04-dimensions/app-b/src/lib/App.svelte |
| 323 | content/tutorial/02-advanced-svelte/05-bindings/04-dimensions/README.md |
| 324 | content/tutorial/02-advanced-svelte/05-bindings/05-bind-this/app-a/src/lib/App.svelte |
| 325 | content/tutorial/02-advanced-svelte/05-bindings/05-bind-this/app-a/src/lib/gradient.js |
| 326 | content/tutorial/02-advanced-svelte/05-bindings/05-bind-this/app-b/src/lib/App.svelte |
| 327 | content/tutorial/02-advanced-svelte/05-bindings/05-bind-this/README.md |
| 328 | content/tutorial/02-advanced-svelte/05-bindings/06-component-bindings/app-a/src/lib/App.svelte |
| 329 | content/tutorial/02-advanced-svelte/05-bindings/06-component-bindings/app-a/src/lib/Keypad.svelte |
| 330 | content/tutorial/02-advanced-svelte/05-bindings/06-component-bindings/app-b/src/lib/App.svelte |
| 331 | content/tutorial/02-advanced-svelte/05-bindings/06-component-bindings/README.md |
| 332 | content/tutorial/02-advanced-svelte/05-bindings/07-component-this/app-a/src/lib/actions.js |
| 333 | content/tutorial/02-advanced-svelte/05-bindings/07-component-this/app-a/src/lib/App.svelte |
| 334 | content/tutorial/02-advanced-svelte/05-bindings/07-component-this/app-a/src/lib/Canvas.svelte |
| 335 | content/tutorial/02-advanced-svelte/05-bindings/07-component-this/app-b/src/lib/App.svelte |
| 336 | content/tutorial/02-advanced-svelte/05-bindings/07-component-this/app-b/src/lib/Canvas.svelte |
| 337 | content/tutorial/02-advanced-svelte/05-bindings/07-component-this/README.md |
| 338 | content/tutorial/02-advanced-svelte/05-bindings/meta.json |
| 339 | content/tutorial/02-advanced-svelte/06-classes-and-styles/01-classes/app-a/src/lib/App.svelte |
| 340 | content/tutorial/02-advanced-svelte/06-classes-and-styles/01-classes/app-b/src/lib/App.svelte |
| 341 | content/tutorial/02-advanced-svelte/06-classes-and-styles/01-classes/README.md |
| 342 | content/tutorial/02-advanced-svelte/06-classes-and-styles/02-class-shorthand/app-b/src/lib/App.svelte |
| 343 | content/tutorial/02-advanced-svelte/06-classes-and-styles/02-class-shorthand/README.md |
| 344 | content/tutorial/02-advanced-svelte/06-classes-and-styles/03-styles/app-b/src/lib/App.svelte |
| 345 | content/tutorial/02-advanced-svelte/06-classes-and-styles/03-styles/README.md |
| 346 | content/tutorial/02-advanced-svelte/06-classes-and-styles/04-component-styles/app-a/src/lib/App.svelte |
| 347 | content/tutorial/02-advanced-svelte/06-classes-and-styles/04-component-styles/app-a/src/lib/Box.svelte |
| 348 | content/tutorial/02-advanced-svelte/06-classes-and-styles/04-component-styles/app-b/src/lib/App.svelte |
| 349 | content/tutorial/02-advanced-svelte/06-classes-and-styles/04-component-styles/app-b/src/lib/Box.svelte |
| 350 | content/tutorial/02-advanced-svelte/06-classes-and-styles/04-component-styles/README.md |
| 351 | content/tutorial/02-advanced-svelte/06-classes-and-styles/meta.json |
| 352 | content/tutorial/02-advanced-svelte/07-composition/01-slots/app-a/src/lib/App.svelte |
| 353 | content/tutorial/02-advanced-svelte/07-composition/01-slots/app-a/src/lib/Card.svelte |
| 354 | content/tutorial/02-advanced-svelte/07-composition/01-slots/app-b/src/lib/App.svelte |
| 355 | content/tutorial/02-advanced-svelte/07-composition/01-slots/app-b/src/lib/Card.svelte |
| 356 | content/tutorial/02-advanced-svelte/07-composition/01-slots/README.md |
| 357 | content/tutorial/02-advanced-svelte/07-composition/02-named-slots/app-a/src/lib/App.svelte |
| 358 | content/tutorial/02-advanced-svelte/07-composition/02-named-slots/app-a/src/lib/Card.svelte |
| 359 | content/tutorial/02-advanced-svelte/07-composition/02-named-slots/app-b/src/lib/App.svelte |
| 360 | content/tutorial/02-advanced-svelte/07-composition/02-named-slots/app-b/src/lib/Card.svelte |
| 361 | content/tutorial/02-advanced-svelte/07-composition/02-named-slots/README.md |
| 362 | content/tutorial/02-advanced-svelte/07-composition/03-slot-fallbacks/app-a/src/lib/App.svelte |
| 363 | content/tutorial/02-advanced-svelte/07-composition/03-slot-fallbacks/app-a/src/lib/Card.svelte |
| 364 | content/tutorial/02-advanced-svelte/07-composition/03-slot-fallbacks/app-b/src/lib/Card.svelte |
| 365 | content/tutorial/02-advanced-svelte/07-composition/03-slot-fallbacks/README.md |
| 366 | content/tutorial/02-advanced-svelte/07-composition/04-slot-props/app-a/src/lib/App.svelte |
| 367 | content/tutorial/02-advanced-svelte/07-composition/04-slot-props/app-a/src/lib/colors.js |
| 368 | content/tutorial/02-advanced-svelte/07-composition/04-slot-props/app-a/src/lib/FilterableList.svelte |
| 369 | content/tutorial/02-advanced-svelte/07-composition/04-slot-props/app-b/src/lib/App.svelte |
| 370 | content/tutorial/02-advanced-svelte/07-composition/04-slot-props/app-b/src/lib/FilterableList.svelte |
| 371 | content/tutorial/02-advanced-svelte/07-composition/04-slot-props/README.md |
| 372 | content/tutorial/02-advanced-svelte/07-composition/05-optional-slots/app-b/src/lib/App.svelte |
| 373 | content/tutorial/02-advanced-svelte/07-composition/05-optional-slots/app-b/src/lib/FilterableList.svelte |
| 374 | content/tutorial/02-advanced-svelte/07-composition/05-optional-slots/README.md |
| 375 | content/tutorial/02-advanced-svelte/07-composition/meta.json |
| 376 | content/tutorial/02-advanced-svelte/08-context/01-context-api/app-a/src/lib/App.svelte |
| 377 | content/tutorial/02-advanced-svelte/08-context/01-context-api/app-a/src/lib/Canvas.svelte |
| 378 | content/tutorial/02-advanced-svelte/08-context/01-context-api/app-a/src/lib/Square.svelte |
| 379 | content/tutorial/02-advanced-svelte/08-context/01-context-api/app-b/src/lib/App.svelte |
| 380 | content/tutorial/02-advanced-svelte/08-context/01-context-api/app-b/src/lib/Canvas.svelte |
| 381 | content/tutorial/02-advanced-svelte/08-context/01-context-api/app-b/src/lib/Square.svelte |
| 382 | content/tutorial/02-advanced-svelte/08-context/01-context-api/README.md |
| 383 | content/tutorial/02-advanced-svelte/08-context/meta.json |
| 384 | content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/app-a/src/lib/App.svelte |
| 385 | content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/app-a/src/lib/data.js |
| 386 | content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/app-a/src/lib/File.svelte |
| 387 | content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/app-a/src/lib/Folder.svelte |
| 388 | content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/app-b/src/lib/Folder.svelte |
| 389 | content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/README.md |
| 390 | content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/app-a/src/lib/App.svelte |
| 391 | content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/app-a/src/lib/BlueThing.svelte |
| 392 | content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/app-a/src/lib/GreenThing.svelte |
| 393 | content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/app-a/src/lib/RedThing.svelte |
| 394 | content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/app-b/src/lib/App.svelte |
| 395 | content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/README.md |
| 396 | content/tutorial/02-advanced-svelte/09-special-elements/03-svelte-element/app-a/src/lib/App.svelte |
| 397 | content/tutorial/02-advanced-svelte/09-special-elements/03-svelte-element/app-b/src/lib/App.svelte |
| 398 | content/tutorial/02-advanced-svelte/09-special-elements/03-svelte-element/README.md |
| 399 | content/tutorial/02-advanced-svelte/09-special-elements/04-svelte-window/app-a/src/lib/App.svelte |
| 400 | content/tutorial/02-advanced-svelte/09-special-elements/04-svelte-window/app-b/src/lib/App.svelte |
| 401 | content/tutorial/02-advanced-svelte/09-special-elements/04-svelte-window/README.md |
| 402 | content/tutorial/02-advanced-svelte/09-special-elements/05-svelte-window-bindings/app-a/src/lib/App.svelte |
| 403 | content/tutorial/02-advanced-svelte/09-special-elements/05-svelte-window-bindings/app-b/src/lib/App.svelte |
| 404 | content/tutorial/02-advanced-svelte/09-special-elements/05-svelte-window-bindings/README.md |
| 405 | content/tutorial/02-advanced-svelte/09-special-elements/06-svelte-body/app-a/src/lib/App.svelte |
| 406 | content/tutorial/02-advanced-svelte/09-special-elements/06-svelte-body/app-b/src/lib/App.svelte |
| 407 | content/tutorial/02-advanced-svelte/09-special-elements/06-svelte-body/README.md |
| 408 | content/tutorial/02-advanced-svelte/09-special-elements/07-svelte-document/app-a/src/lib/App.svelte |
| 409 | content/tutorial/02-advanced-svelte/09-special-elements/07-svelte-document/app-b/src/lib/App.svelte |
| 410 | content/tutorial/02-advanced-svelte/09-special-elements/07-svelte-document/README.md |
| 411 | content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-a/src/lib/App.svelte |
| 412 | content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-a/static/stylesheets/halloween.css |
| 413 | content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-a/static/stylesheets/margaritaville.css |
| 414 | content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-a/static/stylesheets/retrowave.css |
| 415 | content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-a/static/stylesheets/spaaaaace.css |
| 416 | content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-b/src/lib/App.svelte |
| 417 | content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/README.md |
| 418 | content/tutorial/02-advanced-svelte/09-special-elements/09-svelte-options/app-a/src/lib/App.svelte |
| 419 | content/tutorial/02-advanced-svelte/09-special-elements/09-svelte-options/app-a/src/lib/flash.js |
| 420 | content/tutorial/02-advanced-svelte/09-special-elements/09-svelte-options/app-a/src/lib/Todo.svelte |
| 421 | content/tutorial/02-advanced-svelte/09-special-elements/09-svelte-options/app-b/src/lib/Todo.svelte |
| 422 | content/tutorial/02-advanced-svelte/09-special-elements/09-svelte-options/README.md |
| 423 | content/tutorial/02-advanced-svelte/09-special-elements/10-svelte-fragment/app-a/src/lib/App.svelte |
| 424 | content/tutorial/02-advanced-svelte/09-special-elements/10-svelte-fragment/app-a/src/lib/Board.svelte |
| 425 | content/tutorial/02-advanced-svelte/09-special-elements/10-svelte-fragment/app-a/src/lib/utils.js |
| 426 | content/tutorial/02-advanced-svelte/09-special-elements/10-svelte-fragment/app-b/src/lib/App.svelte |
| 427 | content/tutorial/02-advanced-svelte/09-special-elements/10-svelte-fragment/README.md |
| 428 | content/tutorial/02-advanced-svelte/09-special-elements/meta.json |
| 429 | content/tutorial/02-advanced-svelte/10-module-context/01-sharing-code/app-a/src/lib/App.svelte |
| 430 | content/tutorial/02-advanced-svelte/10-module-context/01-sharing-code/app-a/src/lib/AudioPlayer.svelte |
| 431 | content/tutorial/02-advanced-svelte/10-module-context/01-sharing-code/app-a/src/lib/tracks.js |
| 432 | content/tutorial/02-advanced-svelte/10-module-context/01-sharing-code/app-b/src/lib/AudioPlayer.svelte |
| 433 | content/tutorial/02-advanced-svelte/10-module-context/01-sharing-code/README.md |
| 434 | content/tutorial/02-advanced-svelte/10-module-context/02-module-exports/app-b/src/lib/App.svelte |
| 435 | content/tutorial/02-advanced-svelte/10-module-context/02-module-exports/app-b/src/lib/AudioPlayer.svelte |
| 436 | content/tutorial/02-advanced-svelte/10-module-context/02-module-exports/README.md |
| 437 | content/tutorial/02-advanced-svelte/10-module-context/meta.json |
| 438 | content/tutorial/02-advanced-svelte/11-misc/01-debug/app-a/src/lib/App.svelte |
| 439 | content/tutorial/02-advanced-svelte/11-misc/01-debug/app-b/src/lib/App.svelte |
| 440 | content/tutorial/02-advanced-svelte/11-misc/01-debug/README.md |
| 441 | content/tutorial/02-advanced-svelte/11-misc/meta.json |
| 442 | content/tutorial/02-advanced-svelte/12-next-steps/01-congratulations/app-a/src/lib/App.svelte |
| 443 | content/tutorial/02-advanced-svelte/12-next-steps/01-congratulations/README.md |
| 444 | content/tutorial/02-advanced-svelte/12-next-steps/meta.json |
| 445 | content/tutorial/02-advanced-svelte/common/src/routes/+error.svelte |
| 446 | content/tutorial/02-advanced-svelte/common/src/routes/+layout.js |
| 447 | content/tutorial/02-advanced-svelte/common/src/routes/+page.svelte |
| 448 | content/tutorial/02-advanced-svelte/meta.json |
| 449 | content/tutorial/03-sveltekit/01-concepts/01-introducing-sveltekit/app-a/src/routes/+page.svelte |
| 450 | content/tutorial/03-sveltekit/01-concepts/01-introducing-sveltekit/README.md |
| 451 | content/tutorial/03-sveltekit/01-concepts/meta.json |
| 452 | content/tutorial/03-sveltekit/02-routing/01-pages/app-a/src/routes/+page.svelte |
| 453 | content/tutorial/03-sveltekit/02-routing/01-pages/app-b/src/routes/about/+page.svelte |
| 454 | content/tutorial/03-sveltekit/02-routing/01-pages/README.md |
| 455 | content/tutorial/03-sveltekit/02-routing/02-layouts/app-b/src/routes/about/+page.svelte |
| 456 | content/tutorial/03-sveltekit/02-routing/02-layouts/app-b/src/routes/+layout.svelte |
| 457 | content/tutorial/03-sveltekit/02-routing/02-layouts/app-b/src/routes/+page.svelte |
| 458 | content/tutorial/03-sveltekit/02-routing/02-layouts/README.md |
| 459 | content/tutorial/03-sveltekit/02-routing/03-params/app-a/src/routes/blog/+page.svelte |
| 460 | content/tutorial/03-sveltekit/02-routing/03-params/app-a/src/routes/+layout.svelte |
| 461 | content/tutorial/03-sveltekit/02-routing/03-params/app-a/src/routes/+page.svelte |
| 462 | content/tutorial/03-sveltekit/02-routing/03-params/app-b/src/routes/blog/[slug]/+page.svelte |
| 463 | content/tutorial/03-sveltekit/02-routing/03-params/README.md |
| 464 | content/tutorial/03-sveltekit/02-routing/meta.json |
| 465 | content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/blog/data.js |
| 466 | content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/blog/+page.svelte |
| 467 | content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/blog/[slug]/+layout.svelte |
| 468 | content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/blog/[slug]/+page.svelte |
| 469 | content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/+layout.svelte |
| 470 | content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/+page.svelte |
| 471 | content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-b/src/routes/blog/+page.server.js |
| 472 | content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-b/src/routes/blog/+page.svelte |
| 473 | content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-b/src/routes/blog/[slug]/+page.server.js |
| 474 | content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-b/src/routes/blog/[slug]/+page.svelte |
| 475 | content/tutorial/03-sveltekit/03-loading-data/01-page-data/README.md |
| 476 | content/tutorial/03-sveltekit/03-loading-data/02-layout-data/app-b/src/routes/blog/+layout.server.js |
| 477 | content/tutorial/03-sveltekit/03-loading-data/02-layout-data/app-b/src/routes/blog/+page.server.js |
| 478 | content/tutorial/03-sveltekit/03-loading-data/02-layout-data/app-b/src/routes/blog/[slug]/+layout.svelte |
| 479 | content/tutorial/03-sveltekit/03-loading-data/02-layout-data/README.md |
| 480 | content/tutorial/03-sveltekit/03-loading-data/meta.json |
| 481 | content/tutorial/03-sveltekit/04-headers-and-cookies/01-headers/app-a/src/routes/+page.server.js |
| 482 | content/tutorial/03-sveltekit/04-headers-and-cookies/01-headers/app-a/src/routes/+page.svelte |
| 483 | content/tutorial/03-sveltekit/04-headers-and-cookies/01-headers/app-b/src/routes/+page.server.js |
| 484 | content/tutorial/03-sveltekit/04-headers-and-cookies/01-headers/README.md |
| 485 | content/tutorial/03-sveltekit/04-headers-and-cookies/02-cookies/app-a/src/routes/+page.server.js |
| 486 | content/tutorial/03-sveltekit/04-headers-and-cookies/02-cookies/app-a/src/routes/+page.svelte |
| 487 | content/tutorial/03-sveltekit/04-headers-and-cookies/02-cookies/app-b/src/routes/+page.server.js |
| 488 | content/tutorial/03-sveltekit/04-headers-and-cookies/02-cookies/README.md |
| 489 | content/tutorial/03-sveltekit/04-headers-and-cookies/meta.json |
| 490 | content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-a/src/lib/message.js |
| 491 | content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-a/src/routes/a/deeply/nested/route/+page.svelte |
| 492 | content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-a/src/routes/+layout.svelte |
| 493 | content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-a/src/routes/+page.svelte |
| 494 | content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-b/src/routes/a/deeply/nested/route/+page.svelte |
| 495 | content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-b/src/routes/+page.svelte |
| 496 | content/tutorial/03-sveltekit/05-shared-modules/01-lib/README.md |
| 497 | content/tutorial/03-sveltekit/05-shared-modules/meta.json |
| 498 | content/tutorial/03-sveltekit/06-forms/01-the-form-element/app-a/src/lib/server/database.js |
| 499 | content/tutorial/03-sveltekit/06-forms/01-the-form-element/app-a/src/routes/+page.server.js |
| 500 | content/tutorial/03-sveltekit/06-forms/01-the-form-element/app-a/src/routes/+page.svelte |
| 501 | content/tutorial/03-sveltekit/06-forms/01-the-form-element/app-b/src/routes/+page.server.js |
| 502 | content/tutorial/03-sveltekit/06-forms/01-the-form-element/app-b/src/routes/+page.svelte |
| 503 | content/tutorial/03-sveltekit/06-forms/01-the-form-element/README.md |
| 504 | content/tutorial/03-sveltekit/06-forms/02-named-form-actions/app-b/src/routes/+page.server.js |
| 505 | content/tutorial/03-sveltekit/06-forms/02-named-form-actions/app-b/src/routes/+page.svelte |
| 506 | content/tutorial/03-sveltekit/06-forms/02-named-form-actions/README.md |
| 507 | content/tutorial/03-sveltekit/06-forms/03-form-validation/app-b/src/lib/server/database.js |
| 508 | content/tutorial/03-sveltekit/06-forms/03-form-validation/app-b/src/routes/+page.server.js |
| 509 | content/tutorial/03-sveltekit/06-forms/03-form-validation/app-b/src/routes/+page.svelte |
| 510 | content/tutorial/03-sveltekit/06-forms/03-form-validation/README.md |
| 511 | content/tutorial/03-sveltekit/06-forms/04-progressive-enhancement/app-b/src/routes/+page.svelte |
| 512 | content/tutorial/03-sveltekit/06-forms/04-progressive-enhancement/README.md |
| 513 | content/tutorial/03-sveltekit/06-forms/05-customizing-use-enhance/app-b/src/routes/+page.server.js |
| 514 | content/tutorial/03-sveltekit/06-forms/05-customizing-use-enhance/app-b/src/routes/+page.svelte |
| 515 | content/tutorial/03-sveltekit/06-forms/05-customizing-use-enhance/README.md |
| 516 | content/tutorial/03-sveltekit/06-forms/meta.json |
| 517 | content/tutorial/03-sveltekit/07-api-routes/01-get-handlers/app-a/src/routes/+page.svelte |
| 518 | content/tutorial/03-sveltekit/07-api-routes/01-get-handlers/app-b/src/routes/roll/+server.js |
| 519 | content/tutorial/03-sveltekit/07-api-routes/01-get-handlers/README.md |
| 520 | content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/app-a/src/lib/server/database.js |
| 521 | content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/app-a/src/routes/+page.server.js |
| 522 | content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/app-a/src/routes/+page.svelte |
| 523 | content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/app-b/src/routes/+page.svelte |
| 524 | content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/app-b/src/routes/todo/+server.js |
| 525 | content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/README.md |
| 526 | content/tutorial/03-sveltekit/07-api-routes/03-other-handlers/app-b/src/routes/+page.svelte |
| 527 | content/tutorial/03-sveltekit/07-api-routes/03-other-handlers/app-b/src/routes/todo/[id]/+server.js |
| 528 | content/tutorial/03-sveltekit/07-api-routes/03-other-handlers/README.md |
| 529 | content/tutorial/03-sveltekit/07-api-routes/meta.json |
| 530 | content/tutorial/03-sveltekit/08-stores/01-page-store/app-a/src/routes/about/+page.svelte |
| 531 | content/tutorial/03-sveltekit/08-stores/01-page-store/app-a/src/routes/+layout.svelte |
| 532 | content/tutorial/03-sveltekit/08-stores/01-page-store/app-a/src/routes/+page.svelte |
| 533 | content/tutorial/03-sveltekit/08-stores/01-page-store/app-b/src/routes/+layout.svelte |
| 534 | content/tutorial/03-sveltekit/08-stores/01-page-store/README.md |
| 535 | content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-a/src/routes/about/+page.server.js |
| 536 | content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-a/src/routes/about/+page.svelte |
| 537 | content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-a/src/routes/+layout.svelte |
| 538 | content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-a/src/routes/+page.server.js |
| 539 | content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-a/src/routes/+page.svelte |
| 540 | content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-b/src/routes/+layout.svelte |
| 541 | content/tutorial/03-sveltekit/08-stores/02-navigating-store/README.md |
| 542 | content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/src/routes/about/+page.server.js |
| 543 | content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/src/routes/about/+page.svelte |
| 544 | content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/src/routes/+layout.svelte |
| 545 | content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/src/routes/+page.server.js |
| 546 | content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/src/routes/+page.svelte |
| 547 | content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/svelte.config.js |
| 548 | content/tutorial/03-sveltekit/08-stores/03-updated-store/app-b/src/routes/+layout.svelte |
| 549 | content/tutorial/03-sveltekit/08-stores/03-updated-store/README.md |
| 550 | content/tutorial/03-sveltekit/08-stores/meta.json |
| 551 | content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/emojis.js |
| 552 | content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/expected/+page.server.js |
| 553 | content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/expected/+page.svelte |
| 554 | content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/+layout.svelte |
| 555 | content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/+page.svelte |
| 556 | content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/unexpected/+page.server.js |
| 557 | content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/unexpected/+page.svelte |
| 558 | content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/README.md |
| 559 | content/tutorial/03-sveltekit/09-errors-and-redirects/02-error-pages/app-b/src/routes/+error.svelte |
| 560 | content/tutorial/03-sveltekit/09-errors-and-redirects/02-error-pages/app-b/src/routes/expected/+error.svelte |
| 561 | content/tutorial/03-sveltekit/09-errors-and-redirects/02-error-pages/README.md |
| 562 | content/tutorial/03-sveltekit/09-errors-and-redirects/03-fallback-errors/app-b/src/error.html |
| 563 | content/tutorial/03-sveltekit/09-errors-and-redirects/03-fallback-errors/app-b/src/routes/+layout.server.js |
| 564 | content/tutorial/03-sveltekit/09-errors-and-redirects/03-fallback-errors/README.md |
| 565 | content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/app-a/src/routes/a/+page.svelte |
| 566 | content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/app-a/src/routes/b/+page.svelte |
| 567 | content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/app-a/src/routes/+layout.svelte |
| 568 | content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/app-a/src/routes/+page.svelte |
| 569 | content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/app-b/src/routes/a/+page.server.js |
| 570 | content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/README.md |
| 571 | content/tutorial/03-sveltekit/09-errors-and-redirects/meta.json |
| 572 | content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/hooks.client.js |
| 573 | content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/hooks.server.js |
| 574 | content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/routes/about/+page.server.js |
| 575 | content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/routes/about/+page.svelte |
| 576 | content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/routes/+error.svelte |
| 577 | content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/routes/+layout.svelte |
| 578 | content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/routes/+page.svelte |
| 579 | content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-b/src/hooks.client.js |
| 580 | content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-b/src/hooks.server.js |
| 581 | content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-b/src/routes/+error.svelte |
| 582 | content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/README.md |
| 583 | content/tutorial/03-sveltekit/meta.json |
| 584 | content/tutorial/04-advanced-sveltekit/01-hooks/01-handle/app-a/src/hooks.server.js |
| 585 | content/tutorial/04-advanced-sveltekit/01-hooks/01-handle/app-a/src/routes/+page.svelte |
| 586 | content/tutorial/04-advanced-sveltekit/01-hooks/01-handle/app-b/src/hooks.server.js |
| 587 | content/tutorial/04-advanced-sveltekit/01-hooks/01-handle/README.md |
| 588 | content/tutorial/04-advanced-sveltekit/01-hooks/02-event/app-a/src/hooks.server.js |
| 589 | content/tutorial/04-advanced-sveltekit/01-hooks/02-event/app-a/src/routes/+page.server.js |
| 590 | content/tutorial/04-advanced-sveltekit/01-hooks/02-event/app-a/src/routes/+page.svelte |
| 591 | content/tutorial/04-advanced-sveltekit/01-hooks/02-event/app-b/src/hooks.server.js |
| 592 | content/tutorial/04-advanced-sveltekit/01-hooks/02-event/app-b/src/routes/+page.server.js |
| 593 | content/tutorial/04-advanced-sveltekit/01-hooks/02-event/README.md |
| 594 | content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-a/src/hooks.server.js |
| 595 | content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-a/src/routes/a/+server.js |
| 596 | content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-a/src/routes/b/+server.js |
| 597 | content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-a/src/routes/+page.server.js |
| 598 | content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-a/src/routes/+page.svelte |
| 599 | content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-b/src/hooks.server.js |
| 600 | content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/README.md |
| 601 | content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/hooks.server.js |
| 602 | content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/routes/+layout.svelte |
| 603 | content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/routes/+page.svelte |
| 604 | content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/routes/the-bad-place/+page.server.js |
| 605 | content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/routes/the-bad-place/+page.svelte |
| 606 | content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/routes/the-good-place/+page.svelte |
| 607 | content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-b/src/hooks.server.js |
| 608 | content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-b/src/routes/+error.svelte |
| 609 | content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/README.md |
| 610 | content/tutorial/04-advanced-sveltekit/01-hooks/meta.json |
| 611 | content/tutorial/04-advanced-sveltekit/02-page-options/01-page-options/app-a/src/routes/+page.svelte |
| 612 | content/tutorial/04-advanced-sveltekit/02-page-options/01-page-options/README.md |
| 613 | content/tutorial/04-advanced-sveltekit/02-page-options/02-ssr/app-a/src/routes/+page.svelte |
| 614 | content/tutorial/04-advanced-sveltekit/02-page-options/02-ssr/app-b/src/routes/+page.server.js |
| 615 | content/tutorial/04-advanced-sveltekit/02-page-options/02-ssr/README.md |
| 616 | content/tutorial/04-advanced-sveltekit/02-page-options/03-csr/app-a/src/routes/+page.svelte |
| 617 | content/tutorial/04-advanced-sveltekit/02-page-options/03-csr/app-b/src/routes/+page.server.js |
| 618 | content/tutorial/04-advanced-sveltekit/02-page-options/03-csr/README.md |
| 619 | content/tutorial/04-advanced-sveltekit/02-page-options/04-prerender/app-a/src/routes/+page.svelte |
| 620 | content/tutorial/04-advanced-sveltekit/02-page-options/04-prerender/app-b/src/routes/+page.server.js |
| 621 | content/tutorial/04-advanced-sveltekit/02-page-options/04-prerender/README.md |
| 622 | content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-a/src/routes/always/+page.svelte |
| 623 | content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-a/src/routes/ignore/+page.svelte |
| 624 | content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-a/src/routes/+layout.svelte |
| 625 | content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-a/src/routes/never/+page.svelte |
| 626 | content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-a/src/routes/+page.svelte |
| 627 | content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-b/src/routes/always/+page.server.js |
| 628 | content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-b/src/routes/ignore/+page.server.js |
| 629 | content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/README.md |
| 630 | content/tutorial/04-advanced-sveltekit/02-page-options/meta.json |
| 631 | content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/+layout.svelte |
| 632 | content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/+page.svelte |
| 633 | content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/slow-a/+page.server.js |
| 634 | content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/slow-a/+page.svelte |
| 635 | content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/slow-b/+page.server.js |
| 636 | content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/slow-b/+page.svelte |
| 637 | content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-b/src/routes/+layout.svelte |
| 638 | content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/README.md |
| 639 | content/tutorial/04-advanced-sveltekit/03-link-options/02-reload/app-a/src/routes/about/+page.svelte |
| 640 | content/tutorial/04-advanced-sveltekit/03-link-options/02-reload/app-a/src/routes/+layout.svelte |
| 641 | content/tutorial/04-advanced-sveltekit/03-link-options/02-reload/app-a/src/routes/+page.svelte |
| 642 | content/tutorial/04-advanced-sveltekit/03-link-options/02-reload/app-b/src/routes/+layout.svelte |
| 643 | content/tutorial/04-advanced-sveltekit/03-link-options/02-reload/README.md |
| 644 | content/tutorial/04-advanced-sveltekit/03-link-options/meta.json |
| 645 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-a/src/routes/[lang]/+page.server.js |
| 646 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-a/src/routes/[lang]/+page.svelte |
| 647 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-a/src/routes/+layout.svelte |
| 648 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-a/src/routes/+page.svelte |
| 649 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-b/src/routes/[lang]/__delete |
| 650 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-b/src/routes/[[lang]]/+page.server.js |
| 651 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-b/src/routes/[[lang]]/+page.svelte |
| 652 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-b/src/routes/+page.svelte |
| 653 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/README.md |
| 654 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/02-rest-params/app-a/src/routes/+page.svelte |
| 655 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/02-rest-params/app-a/src/routes/[path]/+page.svelte |
| 656 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/02-rest-params/app-b/src/routes/[path]/__delete |
| 657 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/02-rest-params/app-b/src/routes/[...path]/+page.svelte |
| 658 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/02-rest-params/README.md |
| 659 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-a/src/routes/colors/[color]/+page.svelte |
| 660 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-a/src/routes/+layout.svelte |
| 661 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-a/src/routes/+page.svelte |
| 662 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-b/src/params/hex.js |
| 663 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-b/src/routes/colors/[color]/__delete |
| 664 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-b/src/routes/colors/[color=hex]/+page.svelte |
| 665 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/README.md |
| 666 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/about/+page.svelte |
| 667 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/account/+page.svelte |
| 668 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/app/+page.svelte |
| 669 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/+layout.svelte |
| 670 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/login/+page.server.js |
| 671 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/login/+page.svelte |
| 672 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/logout/+page.server.js |
| 673 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/+page.svelte |
| 674 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/account/__delete |
| 675 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/app/__delete |
| 676 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/(authed)/account/+page.svelte |
| 677 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/(authed)/app/+page.svelte |
| 678 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/(authed)/+layout.server.js |
| 679 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/(authed)/+layout.svelte |
| 680 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/README.md |
| 681 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/b/c/+layout.svelte |
| 682 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/b/c/+page.svelte |
| 683 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/b/+layout.svelte |
| 684 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/b/+page.svelte |
| 685 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/+layout.svelte |
| 686 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/+page.svelte |
| 687 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/+layout.svelte |
| 688 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/+page.svelte |
| 689 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-b/src/routes/a/b/c/+page.svelte |
| 690 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-b/src/routes/a/b/c/+page@.svelte |
| 691 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/meta.json |
| 692 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/README.md |
| 693 | content/tutorial/04-advanced-sveltekit/04-advanced-routing/meta.json |
| 694 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/blue/blue.svelte |
| 695 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/blue/+page.server.js |
| 696 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/blue/+page.svelte |
| 697 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/green/green.svelte |
| 698 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/green/+page.server.js |
| 699 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/green/+page.svelte |
| 700 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/+layout.svelte |
| 701 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/+page.svelte |
| 702 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/red/+page.server.js |
| 703 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/red/+page.svelte |
| 704 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/red/red.svelte |
| 705 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/blue/+page.js |
| 706 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/blue/+page.server.js |
| 707 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/green/+page.js |
| 708 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/green/+page.server.js |
| 709 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/+layout.svelte |
| 710 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/red/+page.js |
| 711 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/red/+page.server.js |
| 712 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/README.md |
| 713 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-a/src/routes/BoringComponent.svelte |
| 714 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-a/src/routes/CoolComponent.svelte |
| 715 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-a/src/routes/+page.js |
| 716 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-a/src/routes/+page.server.js |
| 717 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-a/src/routes/+page.svelte |
| 718 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-b/src/routes/+page.js |
| 719 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/README.md |
| 720 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-a/src/routes/+layout.server.js |
| 721 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-a/src/routes/+page.svelte |
| 722 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-a/src/routes/sum/+layout.js |
| 723 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-a/src/routes/sum/+page.js |
| 724 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-a/src/routes/sum/+page.svelte |
| 725 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-b/src/routes/+layout.server.js |
| 726 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-b/src/routes/sum/+layout.js |
| 727 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-b/src/routes/sum/+page.js |
| 728 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/README.md |
| 729 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-a/src/routes/api/now/+server.js |
| 730 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-a/src/routes/+layout.js |
| 731 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-a/src/routes/+layout.svelte |
| 732 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-a/src/routes/[...timezone]/+page.js |
| 733 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-a/src/routes/[...timezone]/+page.svelte |
| 734 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-b/src/routes/[...timezone]/+page.svelte |
| 735 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/README.md |
| 736 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/05-custom-dependencies/app-b/src/routes/+layout.js |
| 737 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/05-custom-dependencies/app-b/src/routes/[...timezone]/+page.svelte |
| 738 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/05-custom-dependencies/README.md |
| 739 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/06-invalidate-all/app-b/src/routes/+layout.js |
| 740 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/06-invalidate-all/app-b/src/routes/[...timezone]/+page.svelte |
| 741 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/06-invalidate-all/README.md |
| 742 | content/tutorial/04-advanced-sveltekit/05-advanced-loading/meta.json |
| 743 | content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/app-a/src/routes/+page.server.js |
| 744 | content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/app-a/src/routes/+page.svelte |
| 745 | content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/app-a/src/routes/welcome/+page.server.js |
| 746 | content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/app-a/src/routes/welcome/+page.svelte |
| 747 | content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/app-b/src/routes/+page.server.js |
| 748 | content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/README.md |
| 749 | content/tutorial/04-advanced-sveltekit/06-environment-variables/02-env-dynamic-private/app-b/src/routes/+page.server.js |
| 750 | content/tutorial/04-advanced-sveltekit/06-environment-variables/02-env-dynamic-private/README.md |
| 751 | content/tutorial/04-advanced-sveltekit/06-environment-variables/03-env-static-public/app-a/src/routes/+page.svelte |
| 752 | content/tutorial/04-advanced-sveltekit/06-environment-variables/03-env-static-public/app-b/src/routes/+page.svelte |
| 753 | content/tutorial/04-advanced-sveltekit/06-environment-variables/03-env-static-public/README.md |
| 754 | content/tutorial/04-advanced-sveltekit/06-environment-variables/04-env-dynamic-public/app-b/src/routes/+page.svelte |
| 755 | content/tutorial/04-advanced-sveltekit/06-environment-variables/04-env-dynamic-public/README.md |
| 756 | content/tutorial/04-advanced-sveltekit/06-environment-variables/meta.json |
| 757 | content/tutorial/04-advanced-sveltekit/07-conclusion/01-next-steps/app-a/src/routes/+page.svelte |
| 758 | content/tutorial/04-advanced-sveltekit/07-conclusion/01-next-steps/README.md |
| 759 | content/tutorial/04-advanced-sveltekit/07-conclusion/meta.json |
| 760 | content/tutorial/04-advanced-sveltekit/meta.json |
| 761 | content/tutorial/common/package.json |
| 762 | content/tutorial/common/package-lock.json |
| 763 | content/tutorial/common/src/app.html |
| 764 | content/tutorial/common/src/__client.js |
| 765 | content/tutorial/common/src/routes/+page.svelte |
| 766 | content/tutorial/common/static/tutorial/dark-theme.css |
| 767 | content/tutorial/common/svelte.config.js |
| 768 | content/tutorial/common/vite.config.js |
| 769 | jsconfig.json |
| 770 | LICENSE.md |
| 771 | middleware.js |
| 772 | package.json |
| 773 | playwright.config.ts |
| 774 | pnpm-lock.yaml |
| 775 | README.md |
| 776 | scripts/create-common-bundle/index.js |
| 777 | scripts/create-common-bundle/unzip.js |
| 778 | script.sh |
| 779 | src/app.css |
| 780 | src/app.d.ts |
| 781 | src/app.html |
| 782 | src/hooks.server.js |
| 783 | src/lib/client/adapters/common/index.js |
| 784 | src/lib/client/adapters/webcontainer/index.js |
| 785 | src/lib/components/Modal.svelte |
| 786 | src/lib/server/content.js |
| 787 | src/lib/server/markdown.js |
| 788 | src/lib/types/index.d.ts |
| 789 | src/lib/utils.js |
| 790 | src/routes/assets/media/[...path]/+server.js |
| 791 | src/routes/content.json/+server.js |
| 792 | src/routes/+error.svelte |
| 793 | src/routes/+layout.server.js |
| 794 | src/routes/+layout.svelte |
| 795 | src/routes/nav.json/+server.js |
| 796 | src/routes/+page.server.js |
| 797 | src/routes/tutorial/+page.js |
| 798 | src/routes/tutorial/[slug]/adapter.js |
| 799 | src/routes/tutorial/[slug]/autocompletionDataProvider.js |
| 800 | src/routes/tutorial/[slug]/autocompletion.js |
| 801 | src/routes/tutorial/[slug]/Chrome.svelte |
| 802 | src/routes/tutorial/[slug]/codemirror.css |
| 803 | src/routes/tutorial/[slug]/Editor.svelte |
| 804 | src/routes/tutorial/[slug]/filetree/context.js |
| 805 | src/routes/tutorial/[slug]/filetree/ContextMenu.svelte |
| 806 | src/routes/tutorial/[slug]/filetree/File.svelte |
| 807 | src/routes/tutorial/[slug]/filetree/Filetree.svelte |
| 808 | src/routes/tutorial/[slug]/filetree/Folder.svelte |
| 809 | src/routes/tutorial/[slug]/filetree/Item.svelte |
| 810 | src/routes/tutorial/[slug]/ImageViewer.svelte |
| 811 | src/routes/tutorial/[slug]/+layout.server.js |
| 812 | src/routes/tutorial/[slug]/Loading.svelte |
| 813 | src/routes/tutorial/[slug]/Menu.svelte |
| 814 | src/routes/tutorial/[slug]/Output.svelte |
| 815 | src/routes/tutorial/[slug]/+page.server.js |
| 816 | src/routes/tutorial/[slug]/+page.svelte |
| 817 | src/routes/tutorial/[slug]/ScreenToggle.svelte |
| 818 | src/routes/tutorial/[slug]/Sidebar.svelte |
| 819 | src/routes/tutorial/[slug]/state.js |
| 820 | src/routes/tutorial/[slug]/ToggleButton.svelte |
| 821 | static/manifest.json |
| 822 | static/robots.txt |
| 823 | static/tutorial/dark-theme.css |
| 824 | svelte.config.js |
| 825 | tests/env_file.spec.ts |
| 826 | tests/focus_management.spec.ts |
| 827 | vercel.json |
| 828 | vite.config.js |

####### content/tutorial/01-svelte/01-introduction/01-welcome-to-svelte/app-a/src/lib/App.svelte #######

```

<h1>Welcome!</h1>

```


####### content/tutorial/01-svelte/01-introduction/01-welcome-to-svelte/README.md #######

---
title: Welcome to Svelte
---

Welcome to the Svelte tutorial! This will teach you everything you need to know to easily build web applications of all sizes, with high performance and a small footprint.

You can also consult the [API docs](https://svelte.dev/docs) and the [examples](https://svelte.dev/examples), or — if you're impatient to start hacking on your machine locally — create a project with `npm init svelte`.

## What is Svelte?

Svelte is a tool for building web applications. Like other user interface frameworks, it allows you to build your app _declaratively_ out of components that combine markup, styles and behaviours.

These components are _compiled_ into small, efficient JavaScript modules that eliminate overhead traditionally associated with UI frameworks.

You can build your entire app with Svelte (for example, using an application framework like [SvelteKit](https://kit.svelte.dev), which this tutorial will cover), or you can add it incrementally to an existing codebase. You can also ship components as standalone packages that work anywhere.

## How to use this tutorial

> You'll need to have basic familiarity with HTML, CSS and JavaScript to understand Svelte.

This tutorial is split into four main parts:

- [Basic Svelte](/tutorial/welcome-to-svelte) (you are here)
- [Advanced Svelte](/tutorial/tweens)
- [Basic SvelteKit](/tutorial/introducing-sveltekit)
- [Advanced SvelteKit](/tutorial/optional-params)

Each section will present an exercise designed to illustrate a feature. Later exercises build on the knowledge gained in earlier ones, so it's recommended that you go from start to finish. If necessary, you can navigate via the menu above.

If you get stuck, you can click the `solve` button <span class="desktop">to the left of the editor</span><span class="mobile">in the top right of the editor view</span>. (<span class="mobile">Use the toggle below to switch between tutorial and editor views. </span>The `solve` button is disabled on sections like this one that don't include an exercise.) Try not to rely on it too much; you will learn faster by figuring out where to put each suggested code block and manually typing it in to the editor.

####### content/tutorial/01-svelte/01-introduction/02-your-first-component/app-a/src/lib/App.svelte #######

```

<h1>Hello world!</h1>

```


####### content/tutorial/01-svelte/01-introduction/02-your-first-component/app-b/src/lib/App.svelte #######

```

<script>
	let name = 'Svelte';
</script>

<h1>Hello {name.toUpperCase()}!</h1>

```


####### content/tutorial/01-svelte/01-introduction/02-your-first-component/README.md #######

---
title: Your first component
---

In Svelte, an application is composed from one or more _components_. A component is a reusable self-contained block of code that encapsulates HTML, CSS and JavaScript that belong together, written into a `.svelte` file. The `App.svelte` file, open in the code editor to the right, is a simple component.

## Adding data

A component that just renders some static markup isn't very interesting. Let's add some data.

First, add a script tag to your component and declare a `name` variable:

```svelte
/// file: App.svelte
+++<script>
	let name = 'Svelte';
</script>+++

<h1>Hello world!</h1>
```

Then, we can refer to `name` in the markup:

```svelte
/// file: App.svelte
<h1>Hello +++{name}+++!</h1>
```

Inside the curly braces, we can put any JavaScript we want. Try changing `name` to `name.toUpperCase()` for a shoutier greeting.

```svelte
/// file: App.svelte
<h1>Hello {name+++.toUpperCase()+++}!</h1>
```

####### content/tutorial/01-svelte/01-introduction/03-dynamic-attributes/app-a/src/lib/App.svelte #######

```

<script>
	let src = '/image.gif';
</script>

<img />

```


####### content/tutorial/01-svelte/01-introduction/03-dynamic-attributes/app-b/src/lib/App.svelte #######

```

<script>
	let src = '/image.gif';
	let name = 'Rick Astley';
</script>

<img {src} alt="{name} dances." />

```


####### content/tutorial/01-svelte/01-introduction/03-dynamic-attributes/README.md #######

---
title: Dynamic attributes
---

Just like you can use curly braces to control text, you can use them to control element attributes.

Our image is missing a `src` — let's add one:

```svelte
/// file: App.svelte
<img +++src={src}+++ />
```

That's better. But if you hover over the `<img>` in the editor, Svelte is giving us a warning:

> A11y: &lt;img&gt; element should have an alt attribute

When building web apps, it's important to make sure that they're _accessible_ to the broadest possible userbase, including people with (for example) impaired vision or motion, or people without powerful hardware or good internet connections. Accessibility (shortened to a11y) isn't always easy to get right, but Svelte will help by warning you if you write inaccessible markup.

In this case, we're missing the `alt` attribute that describes the image for people using screenreaders, or people with slow or flaky internet connections that can't download the image. Let's add one:

```svelte
/// file: App.svelte
<img src={src} +++alt="A man dances."+++ />
```

We can use curly braces _inside_ attributes. Try changing it to `"{name} dances."` — remember to declare a `name` variable in the `<script>` block.

## Shorthand attributes

It's not uncommon to have an attribute where the name and value are the same, like `src={src}`. Svelte gives us a convenient shorthand for these cases:

```svelte
/// file: App.svelte
<img +++{src}+++ alt="{name} dances." />
```

####### content/tutorial/01-svelte/01-introduction/04-styling/app-a/src/lib/App.svelte #######

```

<p>This is a paragraph.</p>

<style>
	/* Write your CSS here */
</style>

```


####### content/tutorial/01-svelte/01-introduction/04-styling/app-b/src/lib/App.svelte #######

```

<p>This is a paragraph.</p>

<style>
	p {
		color: goldenrod;
		font-family: 'Comic Sans MS', cursive;
		font-size: 2em;
	}
</style>

```


####### content/tutorial/01-svelte/01-introduction/04-styling/README.md #######

---
title: Styling
---

Just like in HTML, you can add a `<style>` tag to your component. Let's add some styles to the `<p>` element:

```svelte
/// file: App.svelte
<p>This is a paragraph.</p>

<style>
+++	p {
		color: goldenrod;
		font-family: 'Comic Sans MS', cursive;
		font-size: 2em;
	}+++
</style>
```

Importantly, these rules are _scoped to the component_. You won't accidentally change the style of `<p>` elements elsewhere in your app, as we'll see in the next step.

####### content/tutorial/01-svelte/01-introduction/05-nested-components/app-a/src/lib/App.svelte #######

```

<p>This is a paragraph.</p>

<style>
	p {
		color: goldenrod;
		font-family: 'Comic Sans MS', cursive;
		font-size: 2em;
	}
</style>

```


####### content/tutorial/01-svelte/01-introduction/05-nested-components/app-a/src/lib/Nested.svelte #######

```

<p>This is another paragraph.</p>

```


####### content/tutorial/01-svelte/01-introduction/05-nested-components/app-b/src/lib/App.svelte #######

```

<script>
	import Nested from './Nested.svelte';
</script>

<p>This is a paragraph.</p>
<Nested />

<style>
	p {
		color: goldenrod;
		font-family: 'Comic Sans MS', cursive;
		font-size: 2em;
	}
</style>

```


####### content/tutorial/01-svelte/01-introduction/05-nested-components/README.md #######

---
title: Nested components
---

It would be impractical to put your entire app in a single component. Instead, we can import components from other files and include them in our markup.

Add a `<script>` tag to the top of `App.svelte` that imports `Nested.svelte`...

```svelte
/// file: App.svelte
+++<script>
	import Nested from './Nested.svelte';
</script>+++
```

...and include a `<Nested />` component:

```svelte
/// file: App.svelte
<p>This is a paragraph.</p>
+++<Nested />+++
```

Notice that even though `Nested.svelte` has a `<p>` element, the styles from `App.svelte` don't leak in.

> Component names are always capitalised, to distinguish them from HTML elements.

####### content/tutorial/01-svelte/01-introduction/06-html-tags/app-a/src/lib/App.svelte #######

```

<script>
	let string = `this string contains some <strong>HTML!!!</strong>`;
</script>

<p>{string}</p>

```


####### content/tutorial/01-svelte/01-introduction/06-html-tags/app-b/src/lib/App.svelte #######

```

<script>
	let string = `this string contains some <strong>HTML!!!</strong>`;
</script>

<p>{@html string}</p>

```


####### content/tutorial/01-svelte/01-introduction/06-html-tags/README.md #######

---
title: HTML tags
---

Ordinarily, strings are inserted as plain text, meaning that characters like `<` and `>` have no special meaning.

But sometimes you need to render HTML directly into a component. For example, the words you're reading right now exist in a markdown file that gets included on this page as a blob of HTML.

In Svelte, you do this with the special `{@html ...}` tag:

```svelte
/// file: App.svelte
<p>{+++@html+++ string}</p>
```

> **Warning!** Svelte doesn't perform any sanitization of the expression inside `{@html ...}` before it gets inserted into the DOM. This isn't an issue if the content is something you trust like an article you wrote yourself. However if it's some untrusted user content, e.g. a comment on an article, then it's critical that you manually escape it, otherwise you risk exposing your users to <a href="https://owasp.org/www-community/attacks/xss/" target="_blank">Cross-Site Scripting</a> (XSS) attacks.

####### content/tutorial/01-svelte/01-introduction/meta.json #######

```

{
	"title": "Introduction",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/01-svelte/02-reactivity/01-reactive-assignments/app-a/src/lib/App.svelte #######

```

<script>
	let count = 0;

	function increment() {
		// event handler code goes here
	}
</script>

<button>
	Clicked {count}
	{count === 1 ? 'time' : 'times'}
</button>

```


####### content/tutorial/01-svelte/02-reactivity/01-reactive-assignments/app-b/src/lib/App.svelte #######

```

<script>
	let count = 0;

	function increment() {
		count += 1;
	}
</script>

<button on:click={increment}>
	Clicked {count}
	{count === 1 ? 'time' : 'times'}
</button>

```


####### content/tutorial/01-svelte/02-reactivity/01-reactive-assignments/README.md #######

---
title: Assignments
---

At the heart of Svelte is a powerful system of _reactivity_ for keeping the DOM in sync with your application state — for example, in response to an event.

To demonstrate it, we first need to wire up an event handler (we'll learn more about these [later](/tutorial/dom-events)):

```svelte
/// file: App.svelte
<button +++on:click={increment}+++>
	Clicked {count}
	{count === 1 ? 'time' : 'times'}
</button>
```

Inside the `increment` function, all we need to do is change the value of `count`:

```js
/// file: App.svelte
function increment() {
	+++count += 1;+++
}
```

Svelte 'instruments' this assignment with some code that tells it the DOM will need to be updated.

####### content/tutorial/01-svelte/02-reactivity/02-reactive-declarations/app-b/src/lib/App.svelte #######

```

<script>
	let count = 0;
	$: doubled = count * 2;

	function increment() {
		count += 1;
	}
</script>

<button on:click={increment}>
	Clicked {count}
	{count === 1 ? 'time' : 'times'}
</button>

<p>{count} doubled is {doubled}</p>

```


####### content/tutorial/01-svelte/02-reactivity/02-reactive-declarations/README.md #######

---
title: Declarations
---

Svelte automatically updates the DOM when your component's state changes. Often, some parts of a component's state need to be computed from _other_ parts (such as a `fullname` derived from a `firstname` and a `lastname`), and recomputed whenever they change.

For these, we have _reactive declarations_. They look like this:

```js
/// file: App.svelte
let count = 0;
+++$: doubled = count * 2;+++
```

If a reactive statement consists entirely of an assignment to an undeclared variable, Svelte will inject a `let` declaration on your behalf.

> Don't worry if this looks a little alien. It's [valid](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/label) (if unconventional) JavaScript, which Svelte interprets to mean 're-run this code whenever any of the referenced values change'. Once you get used to it, there's no going back.

Let's use `doubled` in our markup:

```svelte
/// file: App.svelte
<button>...</button>

+++<p>{count} doubled is {doubled}</p>+++
```

Of course, you could just write `{count * 2}` in the markup instead — you don't have to use reactive values. Reactive values become particularly valuable (no pun intended) when you need to reference them multiple times, or you have values that depend on _other_ reactive values.

> Note that reactive declarations and statements will run after other script code and before component markup is rendered.

####### content/tutorial/01-svelte/02-reactivity/03-reactive-statements/app-a/src/lib/App.svelte #######

```

<script>
	let count = 0;

	function handleClick() {
		count += 1;
	}
</script>

<button on:click={handleClick}>
	Clicked {count}
	{count === 1 ? 'time' : 'times'}
</button>

```


####### content/tutorial/01-svelte/02-reactivity/03-reactive-statements/app-b/src/lib/App.svelte #######

```

<script>
	let count = 0;

	$: if (count >= 10) {
		alert('count is dangerously high!');
		count = 0;
	}

	function handleClick() {
		count += 1;
	}
</script>

<button on:click={handleClick}>
	Clicked {count}
	{count === 1 ? 'time' : 'times'}
</button>

```


####### content/tutorial/01-svelte/02-reactivity/03-reactive-statements/README.md #######

---
title: Statements
---

We're not limited to declaring reactive _values_ — we can also run arbitrary _statements_ reactively. For example, we can log the value of `count` whenever it changes:

```js
/// file: App.svelte
let count = 0;

+++$: console.log(`the count is ${count}`);+++
```

You can easily group statements together with a block:

```js
/// file: App.svelte
$: +++{+++
	console.log(`the count is ${count}`);
	console.log(`this will also be logged whenever count changes`);
+++}+++
```

You can even put the `$:` in front of things like `if` blocks:

```js
/// file: App.svelte
$: +++if (count >= 10)+++ {
	alert('count is dangerously high!');
	count = 0;
}
```

####### content/tutorial/01-svelte/02-reactivity/04-updating-arrays-and-objects/app-a/src/lib/App.svelte #######

```

<script>
	let numbers = [1, 2, 3, 4];

	function addNumber() {
		numbers.push(numbers.length + 1);
	}

	$: sum = numbers.reduce((total, currentNumber) => total + currentNumber, 0);
</script>

<p>{numbers.join(' + ')} = {sum}</p>

<button on:click={addNumber}>
	Add a number
</button>

```


####### content/tutorial/01-svelte/02-reactivity/04-updating-arrays-and-objects/app-b/src/lib/App.svelte #######

```

<script>
	let numbers = [1, 2, 3, 4];

	function addNumber() {
		numbers = [...numbers, numbers.length + 1];
	}

	$: sum = numbers.reduce((total, currentNumber) => total + currentNumber, 0);
</script>

<p>{numbers.join(' + ')} = {sum}</p>

<button on:click={addNumber}>
	Add a number
</button>

```


####### content/tutorial/01-svelte/02-reactivity/04-updating-arrays-and-objects/README.md #######

---
title: Updating arrays and objects
---

Because Svelte's reactivity is triggered by assignments, using array methods like `push` and `splice` won't automatically cause updates. For example, clicking the 'Add a number' button doesn't currently do anything, even though we're calling `numbers.push(...)` inside `addNumber`.

One way to fix that is to add an assignment that would otherwise be redundant:

```js
/// file: App.svelte
function addNumber() {
	numbers.push(numbers.length + 1);
	+++numbers = numbers;+++
}
```

But there's a more idiomatic solution:

```js
/// file: App.svelte
function addNumber() {
	numbers = +++[...numbers, numbers.length + 1];+++
}
```

You can use similar patterns to replace `pop`, `shift`, `unshift` and `splice`.

Assignments to _properties_ of arrays and objects — e.g. `obj.foo += 1` or `array[i] = x` — work the same way as assignments to the values themselves.

```js
/// file: App.svelte
function addNumber() {
	numbers[numbers.length] = numbers.length + 1;
}
```

A simple rule of thumb: the name of the updated variable must appear on the left hand side of the assignment. For example this...

```js
/// no-file
const obj = { foo: { bar: 1 } };
const foo = obj.foo;
foo.bar = 2;
```

...won't trigger reactivity on `obj.foo.bar`, unless you follow it up with `obj = obj`.

####### content/tutorial/01-svelte/02-reactivity/meta.json #######

```

{
	"title": "Reactivity",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/01-svelte/03-props/01-declaring-props/app-a/src/lib/App.svelte #######

```

<script>
	import Nested from './Nested.svelte';
</script>

<Nested answer={42} />

```


####### content/tutorial/01-svelte/03-props/01-declaring-props/app-a/src/lib/Nested.svelte #######

```

<script>
	let answer;
</script>

<p>The answer is {answer}</p>

```


####### content/tutorial/01-svelte/03-props/01-declaring-props/app-b/src/lib/Nested.svelte #######

```

<script>
	export let answer;
</script>

<p>The answer is {answer}</p>

```


####### content/tutorial/01-svelte/03-props/01-declaring-props/README.md #######

---
title: Declaring props
---

So far, we've dealt exclusively with internal state — that is to say, the values are only accessible within a given component.

In any real application, you'll need to pass data from one component down to its children. To do that, we need to declare _properties_, generally shortened to 'props'. In Svelte, we do that with the `export` keyword. Edit the `Nested.svelte` component:

```svelte
/// file: Nested.svelte
<script>
	+++export+++ let answer;
</script>
```

> Just like `$:`, this may feel a little weird at first. That's not how `export` normally works in JavaScript modules! Just roll with it for now — it'll soon become second nature.

####### content/tutorial/01-svelte/03-props/02-default-values/app-a/src/lib/App.svelte #######

```

<script>
	import Nested from './Nested.svelte';
</script>

<Nested answer={42} />

```


####### content/tutorial/01-svelte/03-props/02-default-values/app-a/src/lib/Nested.svelte #######

```

<script>
	export let answer;
</script>

<p>The answer is {answer}</p>

```


####### content/tutorial/01-svelte/03-props/02-default-values/app-b/src/lib/App.svelte #######

```

<script>
	import Nested from './Nested.svelte';
</script>

<Nested answer={42} />
<Nested />

```


####### content/tutorial/01-svelte/03-props/02-default-values/app-b/src/lib/Nested.svelte #######

```

<script>
	export let answer = 'a mystery';
</script>

<p>The answer is {answer}</p>

```


####### content/tutorial/01-svelte/03-props/02-default-values/README.md #######

---
title: Default values
---

We can easily specify default values for props in `Nested.svelte`:

```svelte
/// file: Nested.svelte
<script>
	export let answer +++= 'a mystery'+++;
</script>
```

If we now add a second component _without_ an `answer` prop, it will fall back to the default:

```svelte
/// file: App.svelte
<Nested answer={42}/>
+++<Nested />+++
```

####### content/tutorial/01-svelte/03-props/03-spread-props/app-a/src/lib/App.svelte #######

```

<script>
	import PackageInfo from './PackageInfo.svelte';

	const pkg = {
		name: 'svelte',
		speed: 'blazing',
		version: 4,
		website: 'https://svelte.dev'
	};
</script>

<PackageInfo
	name={pkg.name}
	speed={pkg.speed}
	website={pkg.website}
/>

```


####### content/tutorial/01-svelte/03-props/03-spread-props/app-a/src/lib/PackageInfo.svelte #######

```

<script>
	export let name;
	export let version;
	export let speed;
	export let website;

	$: href = `https://www.npmjs.com/package/${name}`;
</script>

<p>
	The <code>{name}</code> package is {speed} fast. Download version {version} from
	<a {href}>npm</a> and <a href={website}>learn more here</a>
</p>

```


####### content/tutorial/01-svelte/03-props/03-spread-props/app-b/src/lib/App.svelte #######

```

<script>
	import PackageInfo from './PackageInfo.svelte';

	const pkg = {
		name: 'svelte',
		speed: 'blazing',
		version: 4,
		website: 'https://svelte.dev'
	};
</script>

<PackageInfo {...pkg} />

```


####### content/tutorial/01-svelte/03-props/03-spread-props/README.md #######

---
title: Spread props
---

In this exercise, we've forgotten to specify the `version` prop expected by `PackageInfo.svelte`, meaning it shows 'version undefined'.

We _could_ fix it by adding the `version` prop...

```svelte
/// file: App.svelte
<PackageInfo
    name={pkg.name}
	speed={pkg.speed}
    +++version={pkg.version}+++
	website={pkg.website}
/>
```

...but since the properties of `pkg` correspond to the component's expected props, we can 'spread' them onto the component instead:

```svelte
/// file: App.svelte
<PackageInfo +++{...pkg}+++ />
```

> Conversely, if you need to reference all the props that were passed into a component, including ones that weren't declared with `export`, you can do so by accessing `$$props` directly. It's not generally recommended, as it's difficult for Svelte to optimise, but it's useful in rare cases.

####### content/tutorial/01-svelte/03-props/meta.json #######

```

{
	"title": "Props",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/01-svelte/04-logic/01-if-blocks/app-a/src/lib/App.svelte #######

```

<script>
	let count = 0;

	function increment() {
		count += 1;
	}
</script>

<button on:click={increment}>
	Clicked {count}
	{count === 1 ? 'time' : 'times'}
</button>

```


####### content/tutorial/01-svelte/04-logic/01-if-blocks/app-b/src/lib/App.svelte #######

```

<script>
	let count = 0;

	function increment() {
		count += 1;
	}
</script>

<button on:click={increment}>
	Clicked {count}
	{count === 1 ? 'time' : 'times'}
</button>

{#if count > 10}
	<p>{count} is greater than 10</p>
{/if}
```


####### content/tutorial/01-svelte/04-logic/01-if-blocks/README.md #######

---
title: If blocks
---

HTML doesn't have a way of expressing _logic_, like conditionals and loops. Svelte does.

To conditionally render some markup, we wrap it in an `if` block. Let's add some text that appears when `count` is greater than `10`:

```svelte
/// file: App.svelte
<button on:click={increment}>
	Clicked {count}
	{count === 1 ? 'time' : 'times'}
</button>

+++{#if count > 10}
	<p>{count} is greater than 10</p>
{/if}+++
```

Try it — update the component, and click on the button.

####### content/tutorial/01-svelte/04-logic/02-else-blocks/app-b/src/lib/App.svelte #######

```

<script>
	let count = 0;

	function increment() {
		count += 1;
	}
</script>

<button on:click={increment}>
	Clicked {count}
	{count === 1 ? 'time' : 'times'}
</button>

{#if count > 10}
	<p>{count} is greater than 10</p>
{:else}
	<p>{count} is between 0 and 10</p>
{/if}
```


####### content/tutorial/01-svelte/04-logic/02-else-blocks/README.md #######

---
title: Else blocks
---

Just like in JavaScript, an `if` block can have an `else` block:

```svelte
/// file: App.svelte
{#if count > 10}
	<p>{count} is greater than 10</p>
+++{:else}
	<p>{count} is between 0 and 10</p>+++
{/if}
```

> A `#` character always indicates a _block opening_ tag. A `/` character always indicates a _block closing_ tag. A `:` character, as in `{:else}`, indicates a _block continuation_ tag. Don't worry — you've already learned almost all the syntax Svelte adds to HTML.

####### content/tutorial/01-svelte/04-logic/03-else-if-blocks/app-b/src/lib/App.svelte #######

```

<script>
	let count = 0;

	function increment() {
		count += 1;
	}
</script>

<button on:click={increment}>
	Clicked {count}
	{count === 1 ? 'time' : 'times'}
</button>

{#if count > 10}
	<p>{count} is greater than 10</p>
{:else if count < 5}
	<p>{count} is less than 5</p>
{:else}
	<p>{count} is between 5 and 10</p>
{/if}
```


####### content/tutorial/01-svelte/04-logic/03-else-if-blocks/README.md #######

---
title: Else-if blocks
---

Multiple conditions can be 'chained' together with `else if`:

```svelte
/// file: App.svelte
{#if count > 10}
	<p>{count} is greater than 10</p>
+++{:else if count < 5}
	<p>{count} is less than 5</p>+++
{:else}
	<p>{count} is between +++5+++ and 10</p>
{/if}
```

####### content/tutorial/01-svelte/04-logic/04-each-blocks/app-a/src/lib/App.svelte #######

```

<script>
	const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet'];
	let selected = colors[0];
</script>

<h1 style="color: {selected}">Pick a colour</h1>

<div>
	<button
		aria-current={selected === 'red'}
		aria-label="red"
		style="background: red"
		on:click={() => selected = 'red'}
	></button>

	<button
		aria-current={selected === 'orange'}
		aria-label="orange"
		style="background: orange"
		on:click={() => selected = 'orange'}
	></button>

	<button
		aria-current={selected === 'yellow'}
		aria-label="yellow"
		style="background: yellow"
		on:click={() => selected = 'yellow'}
	></button>

	<!-- TODO add the rest of the colours -->
	<button></button>
	<button></button>
	<button></button>
	<button></button>
</div>

<style>
	h1 {
		transition: color 0.2s;
	}

	div {
		display: grid;
		grid-template-columns: repeat(7, 1fr);
		grid-gap: 5px;
		max-width: 400px;
	}

	button {
		aspect-ratio: 1;
		border-radius: 50%;
		background: var(--color, #fff);
		transform: translate(-2px,-2px);
		filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.2));
		transition: all 0.1s;
	}

	button[aria-current="true"] {
		transform: none;
		filter: none;
		box-shadow: inset 3px 3px 4px rgba(0,0,0,0.2);
	}
</style>
```


####### content/tutorial/01-svelte/04-logic/04-each-blocks/app-b/src/lib/App.svelte #######

```

<script>
	const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet'];
	let selected = colors[0];
</script>

<h1 style="color: {selected}">Pick a colour</h1>

<div>
	{#each colors as color, i}
		<button
			aria-current={selected === color}
			aria-label={color}
			style="background: {color}"
			on:click={() => selected = color}
		>{i + 1}</button>
	{/each}
</div>

<style>
	h1 {
		transition: color 0.2s;
	}

	div {
		display: grid;
		grid-template-columns: repeat(7, 1fr);
		grid-gap: 5px;
		max-width: 400px;
	}

	button {
		aspect-ratio: 1;
		border-radius: 50%;
		background: var(--color, #fff);
		transform: translate(-2px,-2px);
		filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.2));
		transition: all 0.1s;
	}

	button[aria-current="true"] {
		transform: none;
		filter: none;
		box-shadow: inset 3px 3px 4px rgba(0,0,0,0.2);
	}
</style>
```


####### content/tutorial/01-svelte/04-logic/04-each-blocks/README.md #######

---
title: Each blocks
---

When building user interfaces you'll often find yourself working with lists of data. In this exercise, we've repeated the `<button>` markup multiple times — changing the colour each time — but there's still more to add.

Instead of laboriously copying, pasting and editing, we can get rid of all but the first button, then use an `each` block:

```svelte
/// file: App.svelte
<div>
	+++{#each colors as color}+++
		<button
			aria-current={selected === 'red'}
			aria-label="red"
			style="background: red"
			on:click={() => selected = 'red'}
		></button>
	+++{/each}+++
</div>
```

> The expression (`colors`, in this case) can be any array or array-like object (i.e. it has a `length` property). You can loop over generic iterables with `each [...iterable]`.

Now we need to use the `color` variable in place of `"red"`:

```svelte
/// file: App.svelte
<div>
	{#each colors as color}
		<button
			aria-current={selected === +++color+++}
			aria-label=+++{color}+++
			style="background: +++{color}+++"
			on:click={() => selected = +++color+++}
		></button>
	{/each}
</div>
```

You can get the current _index_ as a second argument, like so:

```svelte
/// file: App.svelte
<div>
	{#each colors as color, +++i}+++
		<button
			aria-current={selected === color}
			aria-label={color}
			style="background: {color}"
			on:click={() => selected = color}
		>+++{i + 1}+++</button>
	{/each}
</div>
```

####### content/tutorial/01-svelte/04-logic/05-keyed-each-blocks/app-a/src/lib/App.svelte #######

```

<script>
	import Thing from './Thing.svelte';

	let things = [
		{ id: 1, name: 'apple' },
		{ id: 2, name: 'banana' },
		{ id: 3, name: 'carrot' },
		{ id: 4, name: 'doughnut' },
		{ id: 5, name: 'egg' }
	];

	function handleClick() {
		things = things.slice(1);
	}
</script>

<button on:click={handleClick}>
	Remove first thing
</button>

{#each things as thing}
	<Thing name={thing.name} />
{/each}

```


####### content/tutorial/01-svelte/04-logic/05-keyed-each-blocks/app-a/src/lib/Thing.svelte #######

```

<script>
	const emojis = {
		apple: '🍎',
		banana: '🍌',
		carrot: '🥕',
		doughnut: '🍩',
		egg: '🥚'
	};

	// the name is updated whenever the prop value changes...
	export let name;

	// ...but the "emoji" variable is fixed upon initialisation
	// of the component because it uses `const` instead of `$:`
	const emoji = emojis[name];
</script>

<p>{emoji} = {name}</p>
```


####### content/tutorial/01-svelte/04-logic/05-keyed-each-blocks/app-b/src/lib/App.svelte #######

```

<script>
	import Thing from './Thing.svelte';

	let things = [
		{ id: 1, name: 'apple' },
		{ id: 2, name: 'banana' },
		{ id: 3, name: 'carrot' },
		{ id: 4, name: 'doughnut' },
		{ id: 5, name: 'egg' }
	];

	function handleClick() {
		things = things.slice(1);
	}
</script>

<button on:click={handleClick}>
	Remove first thing
</button>

{#each things as thing (thing.id)}
	<Thing name={thing.name} />
{/each}

```


####### content/tutorial/01-svelte/04-logic/05-keyed-each-blocks/README.md #######

---
title: Keyed each blocks
---

By default, when you modify the value of an `each` block, it will add and remove DOM nodes at the _end_ of the block, and update any values that have changed. That might not be what you want.

It's easier to show why than to explain. The `<Thing>` component sets the emoji as a constant on initialization, but the name is passed in via a prop.

Click the 'Remove first thing' button a few times, and notice what happens:

1. It removes the last component.
2. It then updates the `name` value in the remaining DOM nodes, but not the emoji, which is fixed when each `<Thing>` is created.

Instead, we'd like to remove only the first `<Thing>` component and its DOM node, and leave the others unaffected.

To do that, we specify a unique identifier (or "key") for each iteration of the `each` block:

```svelte
/// file: App.svelte
{#each things as thing (+++thing.id+++)}
	<Thing name={thing.name}/>
{/each}
```

Here, `(thing.id)` is the _key_, which tells Svelte how to figure out what to update when the values (`name` in this example) change.

> You can use any object as the key, as Svelte uses a `Map` internally — in other words you could do `(thing)` instead of `(thing.id)`. Using a string or number is generally safer, however, since it means identity persists without referential equality, for example when updating with fresh data from an API server.

####### content/tutorial/01-svelte/04-logic/06-await-blocks/app-a/src/lib/App.svelte #######

```

<script>
	import { getRandomNumber } from './utils.js';

	let promise = getRandomNumber();

	function handleClick() {
		promise = getRandomNumber();
	}
</script>

<button on:click={handleClick}>
	generate random number
</button>

<p>...waiting</p>

```


####### content/tutorial/01-svelte/04-logic/06-await-blocks/app-a/src/lib/utils.js #######

```

export async function getRandomNumber() {
    // Fetch a random number between 0 and 100
    // (with a delay, so that we can see it)
    const res = await fetch('/random-number');

    if (res.ok) {
        return await res.text();
    } else {
        // Sometimes the API will fail!
        throw new Error('Request failed');
    }
}
```


####### content/tutorial/01-svelte/04-logic/06-await-blocks/app-a/src/routes/random-number/+server.js #######

```

export async function GET(req) {
	const query = req.url.searchParams;
	let min = query.get('min') || '0';
	let max = query.get('max') || '100';
	min = +min;
	max = +max;

	// simulate a long delay
	await new Promise((res) => setTimeout(res, 1000));

	// fail sometimes
	if (Math.random() < 0.333) {
		return new Response(`Failed to generate random number. Please try again`, {
			status: 400,
			headers: { 'Access-Control-Allow-Origin': '*' }
		});
	}

	const num = min + Math.round(Math.random() * (max - min));
	return new Response(String(num), {
		headers: { 'Access-Control-Allow-Origin': '*' }
	});
}
```


####### content/tutorial/01-svelte/04-logic/06-await-blocks/app-b/src/lib/App.svelte #######

```

<script>
	import { getRandomNumber } from './utils.js';

	let promise = getRandomNumber();

	function handleClick() {
		promise = getRandomNumber();
	}
</script>

<button on:click={handleClick}>
	generate random number
</button>

{#await promise}
	<p>...waiting</p>
{:then number}
	<p>The number is {number}</p>
{:catch error}
	<p style="color: red">{error.message}</p>
{/await}

```


####### content/tutorial/01-svelte/04-logic/06-await-blocks/README.md #######

---
title: Await blocks
---

Most web applications have to deal with asynchronous data at some point. Svelte makes it easy to _await_ the value of [promises](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises) directly in your markup:

```svelte
/// file: App.svelte
+++{#await promise}+++
	<p>...waiting</p>
+++{:then number}
	<p>The number is {number}</p>
{:catch error}
	<p style="color: red">{error.message}</p>
{/await}+++
```

> Only the most recent `promise` is considered, meaning you don't need to worry about race conditions.

If you know that your promise can't reject, you can omit the `catch` block. You can also omit the first block if you don't want to show anything until the promise resolves:

```svelte
/// no-file
{#await promise then number}
	<p>The number is {number}</p>
{/await}
```

####### content/tutorial/01-svelte/04-logic/meta.json #######

```

{
	"title": "Logic",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/01-svelte/05-events/01-dom-events/app-a/src/lib/App.svelte #######

```

<script>
	let m = { x: 0, y: 0 };

	function handleMove(event) {
		m.x = event.clientX;
		m.y = event.clientY;
	}
</script>

<div>
	The pointer is at {m.x} x {m.y}
</div>

<style>
	div {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		padding: 1rem;
	}
</style>

```


####### content/tutorial/01-svelte/05-events/01-dom-events/app-b/src/lib/App.svelte #######

```

<script>
	let m = { x: 0, y: 0 };

	function handleMove(event) {
		m.x = event.clientX;
		m.y = event.clientY;
	}
</script>

<div on:pointermove={handleMove}>
	The pointer is at {m.x} x {m.y}
</div>

<style>
	div {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		padding: 1rem;
	}
</style>

```


####### content/tutorial/01-svelte/05-events/01-dom-events/README.md #######

---
title: DOM events
---

As we've briefly seen already, you can listen to any DOM event on an element (such as click or [pointermove](https://developer.mozilla.org/en-US/docs/Web/API/Element/pointermove_event)) with the `on:` directive:

```svelte
/// file: App.svelte
<div +++on:pointermove={handleMove}+++>
	The pointer is at {m.x} x {m.y}
</div>
```

####### content/tutorial/01-svelte/05-events/02-inline-handlers/app-b/src/lib/App.svelte #######

```

<script>
	let m = { x: 0, y: 0 };
</script>

<div
	on:pointermove={(e) => {
		m = { x: e.clientX, y: e.clientY };
	}}
>
	The pointer is at {m.x} x {m.y}
</div>

<style>
	div {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		padding: 1rem;
	}
</style>

```


####### content/tutorial/01-svelte/05-events/02-inline-handlers/README.md #######

---
title: Inline handlers
---

You can also declare event handlers inline:

```svelte
/// file: App.svelte
<script>
	let m = { x: 0, y: 0 };

	---function handleMove(event) {
		m.x = event.clientX;
		m.y = event.clientY;
	}---
</script>

<div
	on:pointermove={+++(e) => {
		m = { x: e.clientX, y: e.clientY };
	}+++}
>
	The pointer is at {m.x} x {m.y}
</div>
```

> In some frameworks you may see recommendations to avoid inline event handlers for performance reasons, particularly inside loops. That advice doesn't apply to Svelte — the compiler will always do the right thing, whichever form you choose.

####### content/tutorial/01-svelte/05-events/03-event-modifiers/app-a/src/lib/App.svelte #######

```

<button on:click={() => alert('clicked')}>
	Click me
</button>

```


####### content/tutorial/01-svelte/05-events/03-event-modifiers/app-b/src/lib/App.svelte #######

```

<button on:click|once={() => alert('clicked')}>
	Click me
</button>

```


####### content/tutorial/01-svelte/05-events/03-event-modifiers/README.md #######

---
title: Event modifiers
---

DOM event handlers can have _modifiers_ that alter their behaviour. For example, a handler with a `once` modifier will only run a single time:

```svelte
/// file: App.svelte
<button on:click+++|once+++={() => alert('clicked')}>
	Click me
</button>
```

The full list of modifiers:

- `preventDefault` — calls `event.preventDefault()` before running the handler. Useful for client-side form handling, for example.
- `stopPropagation` — calls `event.stopPropagation()`, preventing the event reaching the next element
- `passive` — improves scrolling performance on touch/wheel events (Svelte will add it automatically where it's safe to do so)
- `nonpassive` — explicitly set `passive: false`
- `capture` — fires the handler during the [_capture_](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#event_capture) phase instead of the [_bubbling_](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#event_bubbling) phase
- `once` — remove the handler after the first time it runs
- `self` — only trigger handler if event.target is the element itself
- `trusted` — only trigger handler if `event.isTrusted` is `true`, meaning the event was triggered by a user action rather than because some JavaScript called `element.dispatchEvent(...)`

You can chain modifiers together, e.g. `on:click|once|capture={...}`.

####### content/tutorial/01-svelte/05-events/04-component-events/app-a/src/lib/App.svelte #######

```

<script>
	import Inner from './Inner.svelte';

	function handleMessage(event) {
		alert(event.detail.text);
	}
</script>

<Inner />

```


####### content/tutorial/01-svelte/05-events/04-component-events/app-a/src/lib/Inner.svelte #######

```

<script>
	function sayHello() {
		dispatch('message', {
			text: 'Hello!'
		});
	}
</script>

<button on:click={sayHello}>
	Click to say hello
</button>

```


####### content/tutorial/01-svelte/05-events/04-component-events/app-b/src/lib/App.svelte #######

```

<script>
	import Inner from './Inner.svelte';

	function handleMessage(event) {
		alert(event.detail.text);
	}
</script>

<Inner on:message={handleMessage} />

```


####### content/tutorial/01-svelte/05-events/04-component-events/app-b/src/lib/Inner.svelte #######

```

<script>
	import { createEventDispatcher } from 'svelte';

	const dispatch = createEventDispatcher();

	function sayHello() {
		dispatch('message', {
			text: 'Hello!'
		});
	}
</script>

<button on:click={sayHello}>
	Click to say hello
</button>

```


####### content/tutorial/01-svelte/05-events/04-component-events/README.md #######

---
title: Component events
---

Components can also dispatch events. To do so, they must create an event dispatcher. Update `Inner.svelte`:

```svelte
/// file: Inner.svelte
<script>
	+++import { createEventDispatcher } from 'svelte';+++

	+++const dispatch = createEventDispatcher();+++

	function sayHello() {
		dispatch('message', {
			text: 'Hello!'
		});
	}
</script>
```

> `createEventDispatcher` must be called when the component is first instantiated — you can't do it later inside e.g. a `setTimeout` callback. This links `dispatch` to the component instance.

Then, add an `on:message` handler in `App.svelte`:

```svelte
/// file: App.svelte
<Inner +++on:message={handleMessage}+++ />
```

> You can also try changing the event name to something else. For instance, change `dispatch('message', {...})` to `dispatch('greet', {...})` in `Inner.svelte` and change the attribute name from `on:message` to `on:greet` in `App.svelte`.

####### content/tutorial/01-svelte/05-events/05-event-forwarding/app-a/src/lib/App.svelte #######

```

<script>
	import Outer from './Outer.svelte';

	function handleMessage(event) {
		alert(event.detail.text);
	}
</script>

<Outer on:message={handleMessage} />

```


####### content/tutorial/01-svelte/05-events/05-event-forwarding/app-a/src/lib/Inner.svelte #######

```

<script>
	import { createEventDispatcher } from 'svelte';

	const dispatch = createEventDispatcher();

	function sayHello() {
		dispatch('message', {
			text: 'Hello!'
		});
	}
</script>

<button on:click={sayHello}>
	Click to say hello
</button>

```


####### content/tutorial/01-svelte/05-events/05-event-forwarding/app-a/src/lib/Outer.svelte #######

```

<script>
	import Inner from './Inner.svelte';
</script>

<Inner />

```


####### content/tutorial/01-svelte/05-events/05-event-forwarding/app-b/src/lib/Outer.svelte #######

```

<script>
	import Inner from './Inner.svelte';
</script>

<Inner on:message />

```


####### content/tutorial/01-svelte/05-events/05-event-forwarding/README.md #######

---
title: Event forwarding
---

Unlike DOM events, component events don't _bubble_. If you want to listen to an event on some deeply nested component, the intermediate components must _forward_ the event.

In this case, we have the same `App.svelte` and `Inner.svelte` as in the [previous chapter](/tutorial/component-events), but there's now an `Outer.svelte` component that contains `<Inner/>`.

One way we _could_ solve the problem is adding `createEventDispatcher` to `Outer.svelte`, listening for the `message` event, and creating a handler for it:

```svelte
/// file: Outer.svelte
<script>
	import Inner from './Inner.svelte';
	import { createEventDispatcher } from 'svelte';

	const dispatch = createEventDispatcher();

	function forward(event) {
		dispatch('message', event.detail);
	}
</script>

<Inner on:message={forward}/>
```

But that's a lot of code to write, so Svelte gives us an equivalent shorthand — an `on:message` event directive without a value means 'forward all `message` events'.

```svelte
/// file: Outer.svelte
<script>
	import Inner from './Inner.svelte';
</script>

<Inner +++on:message+++/>
```

####### content/tutorial/01-svelte/05-events/06-dom-event-forwarding/app-a/src/lib/App.svelte #######

```

<script>
	import BigRedButton from './BigRedButton.svelte';
	import horn from './horn.mp3';

	const audio = new Audio();
	audio.src = horn;

	function handleClick() {
		audio.load();
		audio.play();
	}
</script>

<BigRedButton on:click={handleClick} />

```


####### content/tutorial/01-svelte/05-events/06-dom-event-forwarding/app-a/src/lib/BigRedButton.svelte #######

```

<button>
	Push
</button>

<style>
	button {
		font-size: 1.4em;
		width: 6em;
		height: 6em;
		border-radius: 50%;
		background: radial-gradient(circle at 25% 25%, hsl(0, 100%, 50%) 0, hsl(0, 100%, 40%) 100%);
		box-shadow: 0 8px 0 hsl(0, 100%, 30%), 2px 12px 10px rgba(0,0,0,.35);
		color: hsl(0, 100%, 30%);
		text-shadow: -1px -1px 2px rgba(0,0,0,0.3), 1px 1px 2px rgba(255,255,255,0.4);
		text-transform: uppercase;
		letter-spacing: 0.05em;
		transform: translate(0, -8px);
		transition: all 0.2s;
	}

	button:active {
		transform: translate(0, -2px);
		box-shadow: 0 2px 0 hsl(0, 100%, 30%), 2px 6px 10px rgba(0,0,0,.35);
	}
</style>

```


####### content/tutorial/01-svelte/05-events/06-dom-event-forwarding/app-b/src/lib/BigRedButton.svelte #######

```

<button on:click>
	Push
</button>

<style>
	button {
		font-size: 1.4em;
		width: 6em;
		height: 6em;
		border-radius: 50%;
		background: radial-gradient(circle at 25% 25%, hsl(0, 100%, 50%) 0, hsl(0, 100%, 40%) 100%);
		box-shadow: 0 8px 0 hsl(0, 100%, 30%), 2px 12px 10px rgba(0,0,0,.35);
		color: hsl(0, 100%, 30%);
		text-shadow: -1px -1px 2px rgba(0,0,0,0.3), 1px 1px 2px rgba(255,255,255,0.4);
		text-transform: uppercase;
		letter-spacing: 0.05em;
		transform: translate(0, -8px);
		transition: all 0.2s;
	}

	button:active {
		transform: translate(0, -2px);
		box-shadow: 0 2px 0 hsl(0, 100%, 30%), 2px 6px 10px rgba(0,0,0,.35);
	}
</style>

```


####### content/tutorial/01-svelte/05-events/06-dom-event-forwarding/README.md #######

---
title: DOM event forwarding
---

Event forwarding works for DOM events too.

We want to get notified of clicks on our `<BigRedButton>` — to do that, we just need to forward `click` events on the `<button>` element in `BigRedButton.svelte`:

```svelte
/// file: BigRedButton.svelte
<button +++on:click+++>
	Push
</button>
```

####### content/tutorial/01-svelte/05-events/meta.json #######

```

{
	"title": "Events",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/01-svelte/06-bindings/01-text-inputs/app-a/src/lib/App.svelte #######

```

<script>
	let name = 'world';
</script>

<input value={name} />

<h1>Hello {name}!</h1>

```


####### content/tutorial/01-svelte/06-bindings/01-text-inputs/app-b/src/lib/App.svelte #######

```

<script>
	let name = 'world';
</script>

<input bind:value={name} />

<h1>Hello {name}!</h1>

```


####### content/tutorial/01-svelte/06-bindings/01-text-inputs/README.md #######

---
title: Text inputs
---

As a general rule, data flow in Svelte is _top down_ — a parent component can set props on a child component, and a component can set attributes on an element, but not the other way around.

Sometimes it's useful to break that rule. Take the case of the `<input>` element in this component — we _could_ add an `on:input` event handler that sets the value of `name` to `event.target.value`, but it's a bit... boilerplatey. It gets even worse with other form elements, as we'll see.

Instead, we can use the `bind:value` directive:

```svelte
/// file: App.svelte
<input +++bind:+++value={name}>
```

This means that not only will changes to the value of `name` update the input value, but changes to the input value will update `name`.

####### content/tutorial/01-svelte/06-bindings/02-numeric-inputs/app-a/src/lib/App.svelte #######

```

<script>
	let a = 1;
	let b = 2;
</script>

<label>
	<input type="number" value={a} min="0" max="10" />
	<input type="range" value={a} min="0" max="10" />
</label>

<label>
	<input type="number" value={b} min="0" max="10" />
	<input type="range" value={b} min="0" max="10" />
</label>

<p>{a} + {b} = {a + b}</p>

```


####### content/tutorial/01-svelte/06-bindings/02-numeric-inputs/app-b/src/lib/App.svelte #######

```

<script>
	let a = 1;
	let b = 2;
</script>

<label>
	<input type="number" bind:value={a} min="0" max="10" />
	<input type="range" bind:value={a} min="0" max="10" />
</label>

<label>
	<input type="number" bind:value={b} min="0" max="10" />
	<input type="range" bind:value={b} min="0" max="10" />
</label>

<p>{a} + {b} = {a + b}</p>

```


####### content/tutorial/01-svelte/06-bindings/02-numeric-inputs/README.md #######

---
title: Numeric inputs
---

In the DOM, everything is a string. That's unhelpful when you're dealing with numeric inputs — `type="number"` and `type="range"` — as it means you have to remember to coerce `input.value` before using it.

With `bind:value`, Svelte takes care of it for you:

```svelte
/// file: App.svelte
<label>
	<input type="number" +++bind:+++value={a} min="0" max="10" />
	<input type="range" +++bind:+++value={a} min="0" max="10" />
</label>

<label>
	<input type="number" +++bind:+++value={b} min="0" max="10" />
	<input type="range" +++bind:+++value={b} min="0" max="10" />
</label>
```

####### content/tutorial/01-svelte/06-bindings/03-checkbox-inputs/app-a/src/lib/App.svelte #######

```

<script>
	let yes = false;
</script>

<label>
	<input type="checkbox" checked={yes} />
	Yes! Send me regular email spam
</label>

{#if yes}
	<p>
		Thank you. We will bombard your inbox and sell
		your personal details.
	</p>
{:else}
	<p>
		You must opt in to continue. If you're not
		paying, you're the product.
	</p>
{/if}

<button disabled={!yes}>Subscribe</button>

```


####### content/tutorial/01-svelte/06-bindings/03-checkbox-inputs/app-b/src/lib/App.svelte #######

```

<script>
	let yes = false;
</script>

<label>
	<input type="checkbox" bind:checked={yes} />
	Yes! Send me regular email spam
</label>

{#if yes}
	<p>
		Thank you. We will bombard your inbox and sell
		your personal details.
	</p>
{:else}
	<p>
		You must opt in to continue. If you're not
		paying, you're the product.
	</p>
{/if}

<button disabled={!yes}>Subscribe</button>

```


####### content/tutorial/01-svelte/06-bindings/03-checkbox-inputs/README.md #######

---
title: Checkbox inputs
---

Checkboxes are used for toggling between states. Instead of binding to `input.value`, we bind to `input.checked`:

```svelte
/// file: App.svelte
<input type="checkbox" +++bind:+++checked={yes}>
```

####### content/tutorial/01-svelte/06-bindings/04-select-bindings/app-a/src/lib/App.svelte #######

```

<script>
	let questions = [
		{
			id: 1,
			text: `Where did you go to school?`
		},
		{
			id: 2,
			text: `What is your mother's name?`
		},
		{
			id: 3,
			text: `What is another personal fact that an attacker could easily find with Google?`
		}
	];

	let selected;

	let answer = '';

	function handleSubmit() {
		alert(
			`answered question ${selected.id} (${selected.text}) with "${answer}"`
		);
	}
</script>

<h2>Insecurity questions</h2>

<form on:submit|preventDefault={handleSubmit}>
	<select
		value={selected}
		on:change={() => (answer = '')}
	>
		{#each questions as question}
			<option value={question}>
				{question.text}
			</option>
		{/each}
	</select>

	<input bind:value={answer} />

	<button disabled={!answer} type="submit">
		Submit
	</button>
</form>

<p>
	selected question {selected
		? selected.id
		: '[waiting...]'}
</p>
```


####### content/tutorial/01-svelte/06-bindings/04-select-bindings/app-b/src/lib/App.svelte #######

```

<script>
	let questions = [
		{
			id: 1,
			text: `Where did you go to school?`
		},
		{
			id: 2,
			text: `What is your mother's name?`
		},
		{
			id: 3,
			text: `What is another personal fact that an attacker could easily find with Google?`
		}
	];

	let selected;

	let answer = '';

	function handleSubmit() {
		alert(
			`answered question ${selected.id} (${selected.text}) with "${answer}"`
		);
	}
</script>

<h2>Insecurity questions</h2>

<form on:submit|preventDefault={handleSubmit}>
	<select
		bind:value={selected}
		on:change={() => (answer = '')}
	>
		{#each questions as question}
			<option value={question}>
				{question.text}
			</option>
		{/each}
	</select>

	<input bind:value={answer} />

	<button disabled={!answer} type="submit">
		Submit
	</button>
</form>

<p>
	selected question {selected
		? selected.id
		: '[waiting...]'}
</p>

```


####### content/tutorial/01-svelte/06-bindings/04-select-bindings/README.md #######

---
title: Select bindings
---

We can also use `bind:value` with `<select>` elements:

```svelte
/// file: App.svelte
<select
    +++bind:+++value={selected}
    on:change={() => answer = ''}
>
```

Note that the `<option>` values are objects rather than strings. Svelte doesn't mind.

> Because we haven't set an initial value of `selected`, the binding will set it to the default value (the first in the list) automatically. Be careful though — until the binding is initialised, `selected` remains undefined, so we can't blindly reference e.g. `selected.id` in the template.

####### content/tutorial/01-svelte/06-bindings/05-group-inputs/app-a/src/lib/App.svelte #######

```

<script>
	let scoops = 1;
	let flavours = [];

	const formatter = new Intl.ListFormat('en', { style: 'long', type: 'conjunction' });
</script>

<h2>Size</h2>

{#each [1, 2, 3] as number}
	<label>
		<input
			type="radio"
			name="scoops"
			value={number}
		/>

		{number} {number === 1 ? 'scoop' : 'scoops'}
	</label>
{/each}

<h2>Flavours</h2>

{#each ['cookies and cream', 'mint choc chip', 'raspberry ripple'] as flavour}
	<label>
		<input
			type="checkbox"
			name="flavours"
			value={flavour}
		/>

		{flavour}
	</label>
{/each}

{#if flavours.length === 0}
	<p>Please select at least one flavour</p>
{:else if flavours.length > scoops}
	<p>Can't order more flavours than scoops!</p>
{:else}
	<p>
		You ordered {scoops} {scoops === 1 ? 'scoop' : 'scoops'}
		of {formatter.format(flavours)}
	</p>
{/if}
```


####### content/tutorial/01-svelte/06-bindings/05-group-inputs/app-b/src/lib/App.svelte #######

```

<script>
	let scoops = 1;
	let flavours = [];

	const formatter = new Intl.ListFormat('en', { style: 'long', type: 'conjunction' });
</script>

<h2>Size</h2>

{#each [1, 2, 3] as number}
	<label>
		<input
			type="radio"
			name="scoops"
			value={number}
			bind:group={scoops}
		/>

		{number} {number === 1 ? 'scoop' : 'scoops'}
	</label>
{/each}

<h2>Flavours</h2>

{#each ['cookies and cream', 'mint choc chip', 'raspberry ripple'] as flavour}
	<label>
		<input
			type="checkbox"
			name="flavours"
			value={flavour}
			bind:group={flavours}
		/>

		{flavour}
	</label>
{/each}

{#if flavours.length === 0}
	<p>Please select at least one flavour</p>
{:else if flavours.length > scoops}
	<p>Can't order more flavours than scoops!</p>
{:else}
	<p>
		You ordered {scoops} {scoops === 1 ? 'scoop' : 'scoops'}
		of {formatter.format(flavours)}
	</p>
{/if}
```


####### content/tutorial/01-svelte/06-bindings/05-group-inputs/README.md #######

---
title: Group inputs
---

If you have multiple `type="radio"` or `type="checkbox"` inputs relating to the same value, you can use `bind:group` along with the `value` attribute. Radio inputs in the same group are mutually exclusive; checkbox inputs in the same group form an array of selected values.

Add `bind:group={scoops}` to the radio inputs...

```svelte
/// file: App.svelte
<input
	type="radio"
	name="scoops"
	value={number}
	+++bind:group={scoops}+++
/>
```

...and `bind:group={flavours}` to the checkbox inputs:

```svelte
/// file: App.svelte
<input
	type="checkbox"
	name="flavours"
	value={flavour}
	+++bind:group={flavours}+++
/>
```

####### content/tutorial/01-svelte/06-bindings/06-multiple-select-bindings/app-b/src/lib/App.svelte #######

```

<script>
	let scoops = 1;
	let flavours = [];

	const formatter = new Intl.ListFormat('en', { style: 'long', type: 'conjunction' });
</script>

<h2>Size</h2>

{#each [1, 2, 3] as number}
	<label>
		<input
			type="radio"
			name="scoops"
			value={number}
			bind:group={scoops}
		/>

		{number} {number === 1 ? 'scoop' : 'scoops'}
	</label>
{/each}

<h2>Flavours</h2>

<select multiple bind:value={flavours}>
	{#each ['cookies and cream', 'mint choc chip', 'raspberry ripple'] as flavour}
		<option>{flavour}</option>
	{/each}
</select>

{#if flavours.length === 0}
	<p>Please select at least one flavour</p>
{:else if flavours.length > scoops}
	<p>Can't order more flavours than scoops!</p>
{:else}
	<p>
		You ordered {scoops} {scoops === 1 ? 'scoop' : 'scoops'}
		of {formatter.format(flavours)}
	</p>
{/if}
```


####### content/tutorial/01-svelte/06-bindings/06-multiple-select-bindings/README.md #######

---
title: Select multiple
---

A `<select>` element can have a `multiple` attribute, in which case it will populate an array rather than selecting a single value.

Replace the checkboxes with a `<select multiple>`:

```svelte
/// file: App.svelte
<h2>Flavours</h2>

+++<select multiple bind:value={flavours}>+++
	{#each ['cookies and cream', 'mint choc chip', 'raspberry ripple'] as flavour}
+++		<option>{flavour}</option>+++
	{/each}
+++</select>+++
```

Note that we're able to omit the `value` attribute on the `<option>`, since the value is identical to the element's contents.

> Press and hold the `control` key (or the `command` key on MacOS) to select multiple options.

####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/bin/marked.js #######

```

#!/usr/bin/env node

/**
 * Marked CLI
 * Copyright (c) 2011-2013, Christopher Jeffrey (MIT License)
 */

import { promises } from 'fs';
import { marked } from '../lib/marked.esm.js';

const { readFile, writeFile } = promises;

/**
 * Man Page
 */

async function help() {
  const { spawn } = await import('child_process');

  const options = {
    cwd: process.cwd(),
    env: process.env,
    setsid: false,
    stdio: 'inherit'
  };

  const { dirname, resolve } = await import('path');
  const { fileURLToPath } = await import('url');
  const __dirname = dirname(fileURLToPath(import.meta.url));
  const helpText = await readFile(resolve(__dirname, '../man/marked.1.txt'), 'utf8');

  // eslint-disable-next-line promise/param-names
  await new Promise(res => {
    spawn('man', [resolve(__dirname, '../man/marked.1')], options)
      .on('error', () => {
        console.log(helpText);
      })
      .on('close', res);
  });
}

async function version() {
  const { createRequire } = await import('module');
  const require = createRequire(import.meta.url);
  const pkg = require('../package.json');
  console.log(pkg.version);
}

/**
 * Main
 */

async function main(argv) {
  const files = [];
  const options = {};
  let input;
  let output;
  let string;
  let arg;
  let tokens;
  let opt;

  function getarg() {
    let arg = argv.shift();

    if (arg.indexOf('--') === 0) {
      // e.g. --opt
      arg = arg.split('=');
      if (arg.length > 1) {
        // e.g. --opt=val
        argv.unshift(arg.slice(1).join('='));
      }
      arg = arg[0];
    } else if (arg[0] === '-') {
      if (arg.length > 2) {
        // e.g. -abc
        argv = arg.substring(1).split('').map(function(ch) {
          return '-' + ch;
        }).concat(argv);
        arg = argv.shift();
      } else {
        // e.g. -a
      }
    } else {
      // e.g. foo
    }

    return arg;
  }

  while (argv.length) {
    arg = getarg();
    switch (arg) {
      case '-o':
      case '--output':
        output = argv.shift();
        break;
      case '-i':
      case '--input':
        input = argv.shift();
        break;
      case '-s':
      case '--string':
        string = argv.shift();
        break;
      case '-t':
      case '--tokens':
        tokens = true;
        break;
      case '-h':
      case '--help':
        return await help();
      case '-v':
      case '--version':
        return await version();
      default:
        if (arg.indexOf('--') === 0) {
          opt = camelize(arg.replace(/^--(no-)?/, ''));
          if (!marked.defaults.hasOwnProperty(opt)) {
            continue;
          }
          if (arg.indexOf('--no-') === 0) {
            options[opt] = typeof marked.defaults[opt] !== 'boolean'
              ? null
              : false;
          } else {
            options[opt] = typeof marked.defaults[opt] !== 'boolean'
              ? argv.shift()
              : true;
          }
        } else {
          files.push(arg);
        }
        break;
    }
  }

  async function getData() {
    if (!input) {
      if (files.length <= 2) {
        if (string) {
          return string;
        }
        return await getStdin();
      }
      input = files.pop();
    }
    return await readFile(input, 'utf8');
  }

  const data = await getData();

  const html = tokens
    ? JSON.stringify(marked.lexer(data, options), null, 2)
    : marked(data, options);

  if (output) {
    return await writeFile(output, html);
  }

  process.stdout.write(html + '\n');
}

/**
 * Helpers
 */

function getStdin() {
  return new Promise((resolve, reject) => {
    const stdin = process.stdin;
    let buff = '';

    stdin.setEncoding('utf8');

    stdin.on('data', function(data) {
      buff += data;
    });

    stdin.on('error', function(err) {
      reject(err);
    });

    stdin.on('end', function() {
      resolve(buff);
    });

    stdin.resume();
  });
}

/**
 * @param {string} text
 */
function camelize(text) {
  return text.replace(/(\w)-(\w)/g, function(_, a, b) {
    return a + b.toUpperCase();
  });
}

function handleError(err) {
  if (err.code === 'ENOENT') {
    console.error('marked: output to ' + err.path + ': No such directory');
    return process.exit(1);
  }
  throw err;
}

/**
 * Expose / Entry Point
 */

process.title = 'marked';
main(process.argv.slice()).then(code => {
  process.exit(code || 0);
}).catch(err => {
  handleError(err);
});

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/lib/marked.cjs #######

```

/**
 * marked - a markdown parser
 * Copyright (c) 2011-2022, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/markedjs/marked
 */

/**
 * DO NOT EDIT THIS FILE
 * The code in this file is generated from files in ./src/
 */

'use strict';

function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor) descriptor.writable = true;
    Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);
  }
}
function _createClass(Constructor, protoProps, staticProps) {
  if (protoProps) _defineProperties(Constructor.prototype, protoProps);
  if (staticProps) _defineProperties(Constructor, staticProps);
  Object.defineProperty(Constructor, "prototype", {
    writable: false
  });
  return Constructor;
}
function _unsupportedIterableToArray(o, minLen) {
  if (!o) return;
  if (typeof o === "string") return _arrayLikeToArray(o, minLen);
  var n = Object.prototype.toString.call(o).slice(8, -1);
  if (n === "Object" && o.constructor) n = o.constructor.name;
  if (n === "Map" || n === "Set") return Array.from(o);
  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
}
function _arrayLikeToArray(arr, len) {
  if (len == null || len > arr.length) len = arr.length;
  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];
  return arr2;
}
function _createForOfIteratorHelperLoose(o, allowArrayLike) {
  var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"];
  if (it) return (it = it.call(o)).next.bind(it);
  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {
    if (it) o = it;
    var i = 0;
    return function () {
      if (i >= o.length) return {
        done: true
      };
      return {
        done: false,
        value: o[i++]
      };
    };
  }
  throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}
function _toPrimitive(input, hint) {
  if (typeof input !== "object" || input === null) return input;
  var prim = input[Symbol.toPrimitive];
  if (prim !== undefined) {
    var res = prim.call(input, hint || "default");
    if (typeof res !== "object") return res;
    throw new TypeError("@@toPrimitive must return a primitive value.");
  }
  return (hint === "string" ? String : Number)(input);
}
function _toPropertyKey(arg) {
  var key = _toPrimitive(arg, "string");
  return typeof key === "symbol" ? key : String(key);
}

function getDefaults() {
  return {
    async: false,
    baseUrl: null,
    breaks: false,
    extensions: null,
    gfm: true,
    headerIds: true,
    headerPrefix: '',
    highlight: null,
    langPrefix: 'language-',
    mangle: true,
    pedantic: false,
    renderer: null,
    sanitize: false,
    sanitizer: null,
    silent: false,
    smartypants: false,
    tokenizer: null,
    walkTokens: null,
    xhtml: false
  };
}
exports.defaults = getDefaults();
function changeDefaults(newDefaults) {
  exports.defaults = newDefaults;
}

/**
 * Helpers
 */
var escapeTest = /[&<>"']/;
var escapeReplace = new RegExp(escapeTest.source, 'g');
var escapeTestNoEncode = /[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/;
var escapeReplaceNoEncode = new RegExp(escapeTestNoEncode.source, 'g');
var escapeReplacements = {
  '&': '&amp;',
  '<': '&lt;',
  '>': '&gt;',
  '"': '&quot;',
  "'": '&#39;'
};
var getEscapeReplacement = function getEscapeReplacement(ch) {
  return escapeReplacements[ch];
};
function escape(html, encode) {
  if (encode) {
    if (escapeTest.test(html)) {
      return html.replace(escapeReplace, getEscapeReplacement);
    }
  } else {
    if (escapeTestNoEncode.test(html)) {
      return html.replace(escapeReplaceNoEncode, getEscapeReplacement);
    }
  }
  return html;
}
var unescapeTest = /&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;

/**
 * @param {string} html
 */
function unescape(html) {
  // explicitly match decimal, hex, and named HTML entities
  return html.replace(unescapeTest, function (_, n) {
    n = n.toLowerCase();
    if (n === 'colon') return ':';
    if (n.charAt(0) === '#') {
      return n.charAt(1) === 'x' ? String.fromCharCode(parseInt(n.substring(2), 16)) : String.fromCharCode(+n.substring(1));
    }
    return '';
  });
}
var caret = /(^|[^\[])\^/g;

/**
 * @param {string | RegExp} regex
 * @param {string} opt
 */
function edit(regex, opt) {
  regex = typeof regex === 'string' ? regex : regex.source;
  opt = opt || '';
  var obj = {
    replace: function replace(name, val) {
      val = val.source || val;
      val = val.replace(caret, '$1');
      regex = regex.replace(name, val);
      return obj;
    },
    getRegex: function getRegex() {
      return new RegExp(regex, opt);
    }
  };
  return obj;
}
var nonWordAndColonTest = /[^\w:]/g;
var originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;

/**
 * @param {boolean} sanitize
 * @param {string} base
 * @param {string} href
 */
function cleanUrl(sanitize, base, href) {
  if (sanitize) {
    var prot;
    try {
      prot = decodeURIComponent(unescape(href)).replace(nonWordAndColonTest, '').toLowerCase();
    } catch (e) {
      return null;
    }
    if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0 || prot.indexOf('data:') === 0) {
      return null;
    }
  }
  if (base && !originIndependentUrl.test(href)) {
    href = resolveUrl(base, href);
  }
  try {
    href = encodeURI(href).replace(/%25/g, '%');
  } catch (e) {
    return null;
  }
  return href;
}
var baseUrls = {};
var justDomain = /^[^:]+:\/*[^/]*$/;
var protocol = /^([^:]+:)[\s\S]*$/;
var domain = /^([^:]+:\/*[^/]*)[\s\S]*$/;

/**
 * @param {string} base
 * @param {string} href
 */
function resolveUrl(base, href) {
  if (!baseUrls[' ' + base]) {
    // we can ignore everything in base after the last slash of its path component,
    // but we might need to add _that_
    // https://tools.ietf.org/html/rfc3986#section-3
    if (justDomain.test(base)) {
      baseUrls[' ' + base] = base + '/';
    } else {
      baseUrls[' ' + base] = rtrim(base, '/', true);
    }
  }
  base = baseUrls[' ' + base];
  var relativeBase = base.indexOf(':') === -1;
  if (href.substring(0, 2) === '//') {
    if (relativeBase) {
      return href;
    }
    return base.replace(protocol, '$1') + href;
  } else if (href.charAt(0) === '/') {
    if (relativeBase) {
      return href;
    }
    return base.replace(domain, '$1') + href;
  } else {
    return base + href;
  }
}
var noopTest = {
  exec: function noopTest() {}
};
function merge(obj) {
  var i = 1,
    target,
    key;
  for (; i < arguments.length; i++) {
    target = arguments[i];
    for (key in target) {
      if (Object.prototype.hasOwnProperty.call(target, key)) {
        obj[key] = target[key];
      }
    }
  }
  return obj;
}
function splitCells(tableRow, count) {
  // ensure that every cell-delimiting pipe has a space
  // before it to distinguish it from an escaped pipe
  var row = tableRow.replace(/\|/g, function (match, offset, str) {
      var escaped = false,
        curr = offset;
      while (--curr >= 0 && str[curr] === '\\') {
        escaped = !escaped;
      }
      if (escaped) {
        // odd number of slashes means | is escaped
        // so we leave it alone
        return '|';
      } else {
        // add space before unescaped |
        return ' |';
      }
    }),
    cells = row.split(/ \|/);
  var i = 0;

  // First/last cell in a row cannot be empty if it has no leading/trailing pipe
  if (!cells[0].trim()) {
    cells.shift();
  }
  if (cells.length > 0 && !cells[cells.length - 1].trim()) {
    cells.pop();
  }
  if (cells.length > count) {
    cells.splice(count);
  } else {
    while (cells.length < count) {
      cells.push('');
    }
  }
  for (; i < cells.length; i++) {
    // leading or trailing whitespace is ignored per the gfm spec
    cells[i] = cells[i].trim().replace(/\\\|/g, '|');
  }
  return cells;
}

/**
 * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').
 * /c*$/ is vulnerable to REDOS.
 *
 * @param {string} str
 * @param {string} c
 * @param {boolean} invert Remove suffix of non-c chars instead. Default falsey.
 */
function rtrim(str, c, invert) {
  var l = str.length;
  if (l === 0) {
    return '';
  }

  // Length of suffix matching the invert condition.
  var suffLen = 0;

  // Step left until we fail to match the invert condition.
  while (suffLen < l) {
    var currChar = str.charAt(l - suffLen - 1);
    if (currChar === c && !invert) {
      suffLen++;
    } else if (currChar !== c && invert) {
      suffLen++;
    } else {
      break;
    }
  }
  return str.slice(0, l - suffLen);
}
function findClosingBracket(str, b) {
  if (str.indexOf(b[1]) === -1) {
    return -1;
  }
  var l = str.length;
  var level = 0,
    i = 0;
  for (; i < l; i++) {
    if (str[i] === '\\') {
      i++;
    } else if (str[i] === b[0]) {
      level++;
    } else if (str[i] === b[1]) {
      level--;
      if (level < 0) {
        return i;
      }
    }
  }
  return -1;
}
function checkSanitizeDeprecation(opt) {
  if (opt && opt.sanitize && !opt.silent) {
    console.warn('marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options');
  }
}

// copied from https://stackoverflow.com/a/5450113/806777
/**
 * @param {string} pattern
 * @param {number} count
 */
function repeatString(pattern, count) {
  if (count < 1) {
    return '';
  }
  var result = '';
  while (count > 1) {
    if (count & 1) {
      result += pattern;
    }
    count >>= 1;
    pattern += pattern;
  }
  return result + pattern;
}

function outputLink(cap, link, raw, lexer) {
  var href = link.href;
  var title = link.title ? escape(link.title) : null;
  var text = cap[1].replace(/\\([\[\]])/g, '$1');
  if (cap[0].charAt(0) !== '!') {
    lexer.state.inLink = true;
    var token = {
      type: 'link',
      raw: raw,
      href: href,
      title: title,
      text: text,
      tokens: lexer.inlineTokens(text)
    };
    lexer.state.inLink = false;
    return token;
  }
  return {
    type: 'image',
    raw: raw,
    href: href,
    title: title,
    text: escape(text)
  };
}
function indentCodeCompensation(raw, text) {
  var matchIndentToCode = raw.match(/^(\s+)(?:```)/);
  if (matchIndentToCode === null) {
    return text;
  }
  var indentToCode = matchIndentToCode[1];
  return text.split('\n').map(function (node) {
    var matchIndentInNode = node.match(/^\s+/);
    if (matchIndentInNode === null) {
      return node;
    }
    var indentInNode = matchIndentInNode[0];
    if (indentInNode.length >= indentToCode.length) {
      return node.slice(indentToCode.length);
    }
    return node;
  }).join('\n');
}

/**
 * Tokenizer
 */
var Tokenizer = /*#__PURE__*/function () {
  function Tokenizer(options) {
    this.options = options || exports.defaults;
  }
  var _proto = Tokenizer.prototype;
  _proto.space = function space(src) {
    var cap = this.rules.block.newline.exec(src);
    if (cap && cap[0].length > 0) {
      return {
        type: 'space',
        raw: cap[0]
      };
    }
  };
  _proto.code = function code(src) {
    var cap = this.rules.block.code.exec(src);
    if (cap) {
      var text = cap[0].replace(/^ {1,4}/gm, '');
      return {
        type: 'code',
        raw: cap[0],
        codeBlockStyle: 'indented',
        text: !this.options.pedantic ? rtrim(text, '\n') : text
      };
    }
  };
  _proto.fences = function fences(src) {
    var cap = this.rules.block.fences.exec(src);
    if (cap) {
      var raw = cap[0];
      var text = indentCodeCompensation(raw, cap[3] || '');
      return {
        type: 'code',
        raw: raw,
        lang: cap[2] ? cap[2].trim().replace(this.rules.inline._escapes, '$1') : cap[2],
        text: text
      };
    }
  };
  _proto.heading = function heading(src) {
    var cap = this.rules.block.heading.exec(src);
    if (cap) {
      var text = cap[2].trim();

      // remove trailing #s
      if (/#$/.test(text)) {
        var trimmed = rtrim(text, '#');
        if (this.options.pedantic) {
          text = trimmed.trim();
        } else if (!trimmed || / $/.test(trimmed)) {
          // CommonMark requires space before trailing #s
          text = trimmed.trim();
        }
      }
      return {
        type: 'heading',
        raw: cap[0],
        depth: cap[1].length,
        text: text,
        tokens: this.lexer.inline(text)
      };
    }
  };
  _proto.hr = function hr(src) {
    var cap = this.rules.block.hr.exec(src);
    if (cap) {
      return {
        type: 'hr',
        raw: cap[0]
      };
    }
  };
  _proto.blockquote = function blockquote(src) {
    var cap = this.rules.block.blockquote.exec(src);
    if (cap) {
      var text = cap[0].replace(/^ *>[ \t]?/gm, '');
      var top = this.lexer.state.top;
      this.lexer.state.top = true;
      var tokens = this.lexer.blockTokens(text);
      this.lexer.state.top = top;
      return {
        type: 'blockquote',
        raw: cap[0],
        tokens: tokens,
        text: text
      };
    }
  };
  _proto.list = function list(src) {
    var cap = this.rules.block.list.exec(src);
    if (cap) {
      var raw, istask, ischecked, indent, i, blankLine, endsWithBlankLine, line, nextLine, rawLine, itemContents, endEarly;
      var bull = cap[1].trim();
      var isordered = bull.length > 1;
      var list = {
        type: 'list',
        raw: '',
        ordered: isordered,
        start: isordered ? +bull.slice(0, -1) : '',
        loose: false,
        items: []
      };
      bull = isordered ? "\\d{1,9}\\" + bull.slice(-1) : "\\" + bull;
      if (this.options.pedantic) {
        bull = isordered ? bull : '[*+-]';
      }

      // Get next list item
      var itemRegex = new RegExp("^( {0,3}" + bull + ")((?:[\t ][^\\n]*)?(?:\\n|$))");

      // Check if current bullet point can start a new List Item
      while (src) {
        endEarly = false;
        if (!(cap = itemRegex.exec(src))) {
          break;
        }
        if (this.rules.block.hr.test(src)) {
          // End list if bullet was actually HR (possibly move into itemRegex?)
          break;
        }
        raw = cap[0];
        src = src.substring(raw.length);
        line = cap[2].split('\n', 1)[0].replace(/^\t+/, function (t) {
          return ' '.repeat(3 * t.length);
        });
        nextLine = src.split('\n', 1)[0];
        if (this.options.pedantic) {
          indent = 2;
          itemContents = line.trimLeft();
        } else {
          indent = cap[2].search(/[^ ]/); // Find first non-space char
          indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent
          itemContents = line.slice(indent);
          indent += cap[1].length;
        }
        blankLine = false;
        if (!line && /^ *$/.test(nextLine)) {
          // Items begin with at most one blank line
          raw += nextLine + '\n';
          src = src.substring(nextLine.length + 1);
          endEarly = true;
        }
        if (!endEarly) {
          var nextBulletRegex = new RegExp("^ {0," + Math.min(3, indent - 1) + "}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))");
          var hrRegex = new RegExp("^ {0," + Math.min(3, indent - 1) + "}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)");
          var fencesBeginRegex = new RegExp("^ {0," + Math.min(3, indent - 1) + "}(?:```|~~~)");
          var headingBeginRegex = new RegExp("^ {0," + Math.min(3, indent - 1) + "}#");

          // Check if following lines should be included in List Item
          while (src) {
            rawLine = src.split('\n', 1)[0];
            nextLine = rawLine;

            // Re-align to follow commonmark nesting rules
            if (this.options.pedantic) {
              nextLine = nextLine.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');
            }

            // End list item if found code fences
            if (fencesBeginRegex.test(nextLine)) {
              break;
            }

            // End list item if found start of new heading
            if (headingBeginRegex.test(nextLine)) {
              break;
            }

            // End list item if found start of new bullet
            if (nextBulletRegex.test(nextLine)) {
              break;
            }

            // Horizontal rule found
            if (hrRegex.test(src)) {
              break;
            }
            if (nextLine.search(/[^ ]/) >= indent || !nextLine.trim()) {
              // Dedent if possible
              itemContents += '\n' + nextLine.slice(indent);
            } else {
              // not enough indentation
              if (blankLine) {
                break;
              }

              // paragraph continuation unless last line was a different block level element
              if (line.search(/[^ ]/) >= 4) {
                // indented code block
                break;
              }
              if (fencesBeginRegex.test(line)) {
                break;
              }
              if (headingBeginRegex.test(line)) {
                break;
              }
              if (hrRegex.test(line)) {
                break;
              }
              itemContents += '\n' + nextLine;
            }
            if (!blankLine && !nextLine.trim()) {
              // Check if current line is blank
              blankLine = true;
            }
            raw += rawLine + '\n';
            src = src.substring(rawLine.length + 1);
            line = nextLine.slice(indent);
          }
        }
        if (!list.loose) {
          // If the previous item ended with a blank line, the list is loose
          if (endsWithBlankLine) {
            list.loose = true;
          } else if (/\n *\n *$/.test(raw)) {
            endsWithBlankLine = true;
          }
        }

        // Check for task list items
        if (this.options.gfm) {
          istask = /^\[[ xX]\] /.exec(itemContents);
          if (istask) {
            ischecked = istask[0] !== '[ ] ';
            itemContents = itemContents.replace(/^\[[ xX]\] +/, '');
          }
        }
        list.items.push({
          type: 'list_item',
          raw: raw,
          task: !!istask,
          checked: ischecked,
          loose: false,
          text: itemContents
        });
        list.raw += raw;
      }

      // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic
      list.items[list.items.length - 1].raw = raw.trimRight();
      list.items[list.items.length - 1].text = itemContents.trimRight();
      list.raw = list.raw.trimRight();
      var l = list.items.length;

      // Item child tokens handled here at end because we needed to have the final item to trim it first
      for (i = 0; i < l; i++) {
        this.lexer.state.top = false;
        list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);
        if (!list.loose) {
          // Check if list should be loose
          var spacers = list.items[i].tokens.filter(function (t) {
            return t.type === 'space';
          });
          var hasMultipleLineBreaks = spacers.length > 0 && spacers.some(function (t) {
            return /\n.*\n/.test(t.raw);
          });
          list.loose = hasMultipleLineBreaks;
        }
      }

      // Set all items to loose if list is loose
      if (list.loose) {
        for (i = 0; i < l; i++) {
          list.items[i].loose = true;
        }
      }
      return list;
    }
  };
  _proto.html = function html(src) {
    var cap = this.rules.block.html.exec(src);
    if (cap) {
      var token = {
        type: 'html',
        raw: cap[0],
        pre: !this.options.sanitizer && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),
        text: cap[0]
      };
      if (this.options.sanitize) {
        var text = this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]);
        token.type = 'paragraph';
        token.text = text;
        token.tokens = this.lexer.inline(text);
      }
      return token;
    }
  };
  _proto.def = function def(src) {
    var cap = this.rules.block.def.exec(src);
    if (cap) {
      var tag = cap[1].toLowerCase().replace(/\s+/g, ' ');
      var href = cap[2] ? cap[2].replace(/^<(.*)>$/, '$1').replace(this.rules.inline._escapes, '$1') : '';
      var title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline._escapes, '$1') : cap[3];
      return {
        type: 'def',
        tag: tag,
        raw: cap[0],
        href: href,
        title: title
      };
    }
  };
  _proto.table = function table(src) {
    var cap = this.rules.block.table.exec(src);
    if (cap) {
      var item = {
        type: 'table',
        header: splitCells(cap[1]).map(function (c) {
          return {
            text: c
          };
        }),
        align: cap[2].replace(/^ *|\| *$/g, '').split(/ *\| */),
        rows: cap[3] && cap[3].trim() ? cap[3].replace(/\n[ \t]*$/, '').split('\n') : []
      };
      if (item.header.length === item.align.length) {
        item.raw = cap[0];
        var l = item.align.length;
        var i, j, k, row;
        for (i = 0; i < l; i++) {
          if (/^ *-+: *$/.test(item.align[i])) {
            item.align[i] = 'right';
          } else if (/^ *:-+: *$/.test(item.align[i])) {
            item.align[i] = 'center';
          } else if (/^ *:-+ *$/.test(item.align[i])) {
            item.align[i] = 'left';
          } else {
            item.align[i] = null;
          }
        }
        l = item.rows.length;
        for (i = 0; i < l; i++) {
          item.rows[i] = splitCells(item.rows[i], item.header.length).map(function (c) {
            return {
              text: c
            };
          });
        }

        // parse child tokens inside headers and cells

        // header child tokens
        l = item.header.length;
        for (j = 0; j < l; j++) {
          item.header[j].tokens = this.lexer.inline(item.header[j].text);
        }

        // cell child tokens
        l = item.rows.length;
        for (j = 0; j < l; j++) {
          row = item.rows[j];
          for (k = 0; k < row.length; k++) {
            row[k].tokens = this.lexer.inline(row[k].text);
          }
        }
        return item;
      }
    }
  };
  _proto.lheading = function lheading(src) {
    var cap = this.rules.block.lheading.exec(src);
    if (cap) {
      return {
        type: 'heading',
        raw: cap[0],
        depth: cap[2].charAt(0) === '=' ? 1 : 2,
        text: cap[1],
        tokens: this.lexer.inline(cap[1])
      };
    }
  };
  _proto.paragraph = function paragraph(src) {
    var cap = this.rules.block.paragraph.exec(src);
    if (cap) {
      var text = cap[1].charAt(cap[1].length - 1) === '\n' ? cap[1].slice(0, -1) : cap[1];
      return {
        type: 'paragraph',
        raw: cap[0],
        text: text,
        tokens: this.lexer.inline(text)
      };
    }
  };
  _proto.text = function text(src) {
    var cap = this.rules.block.text.exec(src);
    if (cap) {
      return {
        type: 'text',
        raw: cap[0],
        text: cap[0],
        tokens: this.lexer.inline(cap[0])
      };
    }
  };
  _proto.escape = function escape$1(src) {
    var cap = this.rules.inline.escape.exec(src);
    if (cap) {
      return {
        type: 'escape',
        raw: cap[0],
        text: escape(cap[1])
      };
    }
  };
  _proto.tag = function tag(src) {
    var cap = this.rules.inline.tag.exec(src);
    if (cap) {
      if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {
        this.lexer.state.inLink = true;
      } else if (this.lexer.state.inLink && /^<\/a>/i.test(cap[0])) {
        this.lexer.state.inLink = false;
      }
      if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\s|>)/i.test(cap[0])) {
        this.lexer.state.inRawBlock = true;
      } else if (this.lexer.state.inRawBlock && /^<\/(pre|code|kbd|script)(\s|>)/i.test(cap[0])) {
        this.lexer.state.inRawBlock = false;
      }
      return {
        type: this.options.sanitize ? 'text' : 'html',
        raw: cap[0],
        inLink: this.lexer.state.inLink,
        inRawBlock: this.lexer.state.inRawBlock,
        text: this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0]
      };
    }
  };
  _proto.link = function link(src) {
    var cap = this.rules.inline.link.exec(src);
    if (cap) {
      var trimmedUrl = cap[2].trim();
      if (!this.options.pedantic && /^</.test(trimmedUrl)) {
        // commonmark requires matching angle brackets
        if (!/>$/.test(trimmedUrl)) {
          return;
        }

        // ending angle bracket cannot be escaped
        var rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\');
        if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {
          return;
        }
      } else {
        // find closing parenthesis
        var lastParenIndex = findClosingBracket(cap[2], '()');
        if (lastParenIndex > -1) {
          var start = cap[0].indexOf('!') === 0 ? 5 : 4;
          var linkLen = start + cap[1].length + lastParenIndex;
          cap[2] = cap[2].substring(0, lastParenIndex);
          cap[0] = cap[0].substring(0, linkLen).trim();
          cap[3] = '';
        }
      }
      var href = cap[2];
      var title = '';
      if (this.options.pedantic) {
        // split pedantic href and title
        var link = /^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(href);
        if (link) {
          href = link[1];
          title = link[3];
        }
      } else {
        title = cap[3] ? cap[3].slice(1, -1) : '';
      }
      href = href.trim();
      if (/^</.test(href)) {
        if (this.options.pedantic && !/>$/.test(trimmedUrl)) {
          // pedantic allows starting angle bracket without ending angle bracket
          href = href.slice(1);
        } else {
          href = href.slice(1, -1);
        }
      }
      return outputLink(cap, {
        href: href ? href.replace(this.rules.inline._escapes, '$1') : href,
        title: title ? title.replace(this.rules.inline._escapes, '$1') : title
      }, cap[0], this.lexer);
    }
  };
  _proto.reflink = function reflink(src, links) {
    var cap;
    if ((cap = this.rules.inline.reflink.exec(src)) || (cap = this.rules.inline.nolink.exec(src))) {
      var link = (cap[2] || cap[1]).replace(/\s+/g, ' ');
      link = links[link.toLowerCase()];
      if (!link) {
        var text = cap[0].charAt(0);
        return {
          type: 'text',
          raw: text,
          text: text
        };
      }
      return outputLink(cap, link, cap[0], this.lexer);
    }
  };
  _proto.emStrong = function emStrong(src, maskedSrc, prevChar) {
    if (prevChar === void 0) {
      prevChar = '';
    }
    var match = this.rules.inline.emStrong.lDelim.exec(src);
    if (!match) return;

    // _ can't be between two alphanumerics. \p{L}\p{N} includes non-english alphabet/numbers as well
    if (match[3] && prevChar.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/)) return;
    var nextChar = match[1] || match[2] || '';
    if (!nextChar || nextChar && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar))) {
      var lLength = match[0].length - 1;
      var rDelim,
        rLength,
        delimTotal = lLength,
        midDelimTotal = 0;
      var endReg = match[0][0] === '*' ? this.rules.inline.emStrong.rDelimAst : this.rules.inline.emStrong.rDelimUnd;
      endReg.lastIndex = 0;

      // Clip maskedSrc to same section of string as src (move to lexer?)
      maskedSrc = maskedSrc.slice(-1 * src.length + lLength);
      while ((match = endReg.exec(maskedSrc)) != null) {
        rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];
        if (!rDelim) continue; // skip single * in __abc*abc__

        rLength = rDelim.length;
        if (match[3] || match[4]) {
          // found another Left Delim
          delimTotal += rLength;
          continue;
        } else if (match[5] || match[6]) {
          // either Left or Right Delim
          if (lLength % 3 && !((lLength + rLength) % 3)) {
            midDelimTotal += rLength;
            continue; // CommonMark Emphasis Rules 9-10
          }
        }

        delimTotal -= rLength;
        if (delimTotal > 0) continue; // Haven't found enough closing delimiters

        // Remove extra characters. *a*** -> *a*
        rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);
        var raw = src.slice(0, lLength + match.index + (match[0].length - rDelim.length) + rLength);

        // Create `em` if smallest delimiter has odd char count. *a***
        if (Math.min(lLength, rLength) % 2) {
          var _text = raw.slice(1, -1);
          return {
            type: 'em',
            raw: raw,
            text: _text,
            tokens: this.lexer.inlineTokens(_text)
          };
        }

        // Create 'strong' if smallest delimiter has even char count. **a***
        var text = raw.slice(2, -2);
        return {
          type: 'strong',
          raw: raw,
          text: text,
          tokens: this.lexer.inlineTokens(text)
        };
      }
    }
  };
  _proto.codespan = function codespan(src) {
    var cap = this.rules.inline.code.exec(src);
    if (cap) {
      var text = cap[2].replace(/\n/g, ' ');
      var hasNonSpaceChars = /[^ ]/.test(text);
      var hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);
      if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {
        text = text.substring(1, text.length - 1);
      }
      text = escape(text, true);
      return {
        type: 'codespan',
        raw: cap[0],
        text: text
      };
    }
  };
  _proto.br = function br(src) {
    var cap = this.rules.inline.br.exec(src);
    if (cap) {
      return {
        type: 'br',
        raw: cap[0]
      };
    }
  };
  _proto.del = function del(src) {
    var cap = this.rules.inline.del.exec(src);
    if (cap) {
      return {
        type: 'del',
        raw: cap[0],
        text: cap[2],
        tokens: this.lexer.inlineTokens(cap[2])
      };
    }
  };
  _proto.autolink = function autolink(src, mangle) {
    var cap = this.rules.inline.autolink.exec(src);
    if (cap) {
      var text, href;
      if (cap[2] === '@') {
        text = escape(this.options.mangle ? mangle(cap[1]) : cap[1]);
        href = 'mailto:' + text;
      } else {
        text = escape(cap[1]);
        href = text;
      }
      return {
        type: 'link',
        raw: cap[0],
        text: text,
        href: href,
        tokens: [{
          type: 'text',
          raw: text,
          text: text
        }]
      };
    }
  };
  _proto.url = function url(src, mangle) {
    var cap;
    if (cap = this.rules.inline.url.exec(src)) {
      var text, href;
      if (cap[2] === '@') {
        text = escape(this.options.mangle ? mangle(cap[0]) : cap[0]);
        href = 'mailto:' + text;
      } else {
        // do extended autolink path validation
        var prevCapZero;
        do {
          prevCapZero = cap[0];
          cap[0] = this.rules.inline._backpedal.exec(cap[0])[0];
        } while (prevCapZero !== cap[0]);
        text = escape(cap[0]);
        if (cap[1] === 'www.') {
          href = 'http://' + cap[0];
        } else {
          href = cap[0];
        }
      }
      return {
        type: 'link',
        raw: cap[0],
        text: text,
        href: href,
        tokens: [{
          type: 'text',
          raw: text,
          text: text
        }]
      };
    }
  };
  _proto.inlineText = function inlineText(src, smartypants) {
    var cap = this.rules.inline.text.exec(src);
    if (cap) {
      var text;
      if (this.lexer.state.inRawBlock) {
        text = this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0];
      } else {
        text = escape(this.options.smartypants ? smartypants(cap[0]) : cap[0]);
      }
      return {
        type: 'text',
        raw: cap[0],
        text: text
      };
    }
  };
  return Tokenizer;
}();

/**
 * Block-Level Grammar
 */
var block = {
  newline: /^(?: *(?:\n|$))+/,
  code: /^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,
  fences: /^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,
  hr: /^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,
  heading: /^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,
  blockquote: /^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,
  list: /^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,
  html: '^ {0,3}(?:' // optional indentation
  + '<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)' // (1)
  + '|comment[^\\n]*(\\n+|$)' // (2)
  + '|<\\?[\\s\\S]*?(?:\\?>\\n*|$)' // (3)
  + '|<![A-Z][\\s\\S]*?(?:>\\n*|$)' // (4)
  + '|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)' // (5)
  + '|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (6)
  + '|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (7) open tag
  + '|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (7) closing tag
  + ')',
  def: /^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,
  table: noopTest,
  lheading: /^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,
  // regex template, placeholders will be replaced according to different paragraph
  // interruption rules of commonmark and the original markdown spec:
  _paragraph: /^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,
  text: /^[^\n]+/
};
block._label = /(?!\s*\])(?:\\.|[^\[\]\\])+/;
block._title = /(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;
block.def = edit(block.def).replace('label', block._label).replace('title', block._title).getRegex();
block.bullet = /(?:[*+-]|\d{1,9}[.)])/;
block.listItemStart = edit(/^( *)(bull) */).replace('bull', block.bullet).getRegex();
block.list = edit(block.list).replace(/bull/g, block.bullet).replace('hr', '\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))').replace('def', '\\n+(?=' + block.def.source + ')').getRegex();
block._tag = 'address|article|aside|base|basefont|blockquote|body|caption' + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption' + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe' + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option' + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr' + '|track|ul';
block._comment = /<!--(?!-?>)[\s\S]*?(?:-->|$)/;
block.html = edit(block.html, 'i').replace('comment', block._comment).replace('tag', block._tag).replace('attribute', / +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();
block.paragraph = edit(block._paragraph).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs
.replace('|table', '').replace('blockquote', ' {0,3}>').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
.replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // pars can be interrupted by type (6) html blocks
.getRegex();
block.blockquote = edit(block.blockquote).replace('paragraph', block.paragraph).getRegex();

/**
 * Normal Block Grammar
 */

block.normal = merge({}, block);

/**
 * GFM Block Grammar
 */

block.gfm = merge({}, block.normal, {
  table: '^ *([^\\n ].*\\|.*)\\n' // Header
  + ' {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?' // Align
  + '(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)' // Cells
});

block.gfm.table = edit(block.gfm.table).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('blockquote', ' {0,3}>').replace('code', ' {4}[^\\n]').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
.replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // tables can be interrupted by type (6) html blocks
.getRegex();
block.gfm.paragraph = edit(block._paragraph).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs
.replace('table', block.gfm.table) // interrupt paragraphs with table
.replace('blockquote', ' {0,3}>').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
.replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // pars can be interrupted by type (6) html blocks
.getRegex();
/**
 * Pedantic grammar (original John Gruber's loose markdown specification)
 */

block.pedantic = merge({}, block.normal, {
  html: edit('^ *(?:comment *(?:\\n|\\s*$)' + '|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)' // closed tag
  + '|<tag(?:"[^"]*"|\'[^\']*\'|\\s[^\'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))').replace('comment', block._comment).replace(/tag/g, '(?!(?:' + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub' + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)' + '\\b)\\w+(?!:|[^\\w\\s@]*@)\\b').getRegex(),
  def: /^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,
  heading: /^(#{1,6})(.*)(?:\n+|$)/,
  fences: noopTest,
  // fences not supported
  lheading: /^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,
  paragraph: edit(block.normal._paragraph).replace('hr', block.hr).replace('heading', ' *#{1,6} *[^\n]').replace('lheading', block.lheading).replace('blockquote', ' {0,3}>').replace('|fences', '').replace('|list', '').replace('|html', '').getRegex()
});

/**
 * Inline-Level Grammar
 */
var inline = {
  escape: /^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,
  autolink: /^<(scheme:[^\s\x00-\x1f<>]*|email)>/,
  url: noopTest,
  tag: '^comment' + '|^</[a-zA-Z][\\w:-]*\\s*>' // self-closing tag
  + '|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>' // open tag
  + '|^<\\?[\\s\\S]*?\\?>' // processing instruction, e.g. <?php ?>
  + '|^<![a-zA-Z]+\\s[\\s\\S]*?>' // declaration, e.g. <!DOCTYPE html>
  + '|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>',
  // CDATA section
  link: /^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,
  reflink: /^!?\[(label)\]\[(ref)\]/,
  nolink: /^!?\[(ref)\](?:\[\])?/,
  reflinkSearch: 'reflink|nolink(?!\\()',
  emStrong: {
    lDelim: /^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,
    //        (1) and (2) can only be a Right Delimiter. (3) and (4) can only be Left.  (5) and (6) can be either Left or Right.
    //          () Skip orphan inside strong                                      () Consume to delim     (1) #***                (2) a***#, a***                             (3) #***a, ***a                 (4) ***#              (5) #***#                 (6) a***a
    rDelimAst: /^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,
    rDelimUnd: /^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/ // ^- Not allowed for _
  },

  code: /^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,
  br: /^( {2,}|\\)\n(?!\s*$)/,
  del: noopTest,
  text: /^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,
  punctuation: /^([\spunctuation])/
};

// list of punctuation marks from CommonMark spec
// without * and _ to handle the different emphasis markers * and _
inline._punctuation = '!"#$%&\'()+\\-.,/:;<=>?@\\[\\]`^{|}~';
inline.punctuation = edit(inline.punctuation).replace(/punctuation/g, inline._punctuation).getRegex();

// sequences em should skip over [title](link), `code`, <html>
inline.blockSkip = /\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;
// lookbehind is not available on Safari as of version 16
// inline.escapedEmSt = /(?<=(?:^|[^\\)(?:\\[^])*)\\[*_]/g;
inline.escapedEmSt = /(?:^|[^\\])(?:\\\\)*\\[*_]/g;
inline._comment = edit(block._comment).replace('(?:-->|$)', '-->').getRegex();
inline.emStrong.lDelim = edit(inline.emStrong.lDelim).replace(/punct/g, inline._punctuation).getRegex();
inline.emStrong.rDelimAst = edit(inline.emStrong.rDelimAst, 'g').replace(/punct/g, inline._punctuation).getRegex();
inline.emStrong.rDelimUnd = edit(inline.emStrong.rDelimUnd, 'g').replace(/punct/g, inline._punctuation).getRegex();
inline._escapes = /\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;
inline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;
inline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;
inline.autolink = edit(inline.autolink).replace('scheme', inline._scheme).replace('email', inline._email).getRegex();
inline._attribute = /\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;
inline.tag = edit(inline.tag).replace('comment', inline._comment).replace('attribute', inline._attribute).getRegex();
inline._label = /(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;
inline._href = /<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;
inline._title = /"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;
inline.link = edit(inline.link).replace('label', inline._label).replace('href', inline._href).replace('title', inline._title).getRegex();
inline.reflink = edit(inline.reflink).replace('label', inline._label).replace('ref', block._label).getRegex();
inline.nolink = edit(inline.nolink).replace('ref', block._label).getRegex();
inline.reflinkSearch = edit(inline.reflinkSearch, 'g').replace('reflink', inline.reflink).replace('nolink', inline.nolink).getRegex();

/**
 * Normal Inline Grammar
 */

inline.normal = merge({}, inline);

/**
 * Pedantic Inline Grammar
 */

inline.pedantic = merge({}, inline.normal, {
  strong: {
    start: /^__|\*\*/,
    middle: /^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,
    endAst: /\*\*(?!\*)/g,
    endUnd: /__(?!_)/g
  },
  em: {
    start: /^_|\*/,
    middle: /^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,
    endAst: /\*(?!\*)/g,
    endUnd: /_(?!_)/g
  },
  link: edit(/^!?\[(label)\]\((.*?)\)/).replace('label', inline._label).getRegex(),
  reflink: edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace('label', inline._label).getRegex()
});

/**
 * GFM Inline Grammar
 */

inline.gfm = merge({}, inline.normal, {
  escape: edit(inline.escape).replace('])', '~|])').getRegex(),
  _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,
  url: /^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,
  _backpedal: /(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,
  del: /^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,
  text: /^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/
});
inline.gfm.url = edit(inline.gfm.url, 'i').replace('email', inline.gfm._extended_email).getRegex();
/**
 * GFM + Line Breaks Inline Grammar
 */

inline.breaks = merge({}, inline.gfm, {
  br: edit(inline.br).replace('{2,}', '*').getRegex(),
  text: edit(inline.gfm.text).replace('\\b_', '\\b_| {2,}\\n').replace(/\{2,\}/g, '*').getRegex()
});

/**
 * smartypants text replacement
 * @param {string} text
 */
function smartypants(text) {
  return text
  // em-dashes
  .replace(/---/g, "\u2014")
  // en-dashes
  .replace(/--/g, "\u2013")
  // opening singles
  .replace(/(^|[-\u2014/(\[{"\s])'/g, "$1\u2018")
  // closing singles & apostrophes
  .replace(/'/g, "\u2019")
  // opening doubles
  .replace(/(^|[-\u2014/(\[{\u2018\s])"/g, "$1\u201C")
  // closing doubles
  .replace(/"/g, "\u201D")
  // ellipses
  .replace(/\.{3}/g, "\u2026");
}

/**
 * mangle email addresses
 * @param {string} text
 */
function mangle(text) {
  var out = '',
    i,
    ch;
  var l = text.length;
  for (i = 0; i < l; i++) {
    ch = text.charCodeAt(i);
    if (Math.random() > 0.5) {
      ch = 'x' + ch.toString(16);
    }
    out += '&#' + ch + ';';
  }
  return out;
}

/**
 * Block Lexer
 */
var Lexer = /*#__PURE__*/function () {
  function Lexer(options) {
    this.tokens = [];
    this.tokens.links = Object.create(null);
    this.options = options || exports.defaults;
    this.options.tokenizer = this.options.tokenizer || new Tokenizer();
    this.tokenizer = this.options.tokenizer;
    this.tokenizer.options = this.options;
    this.tokenizer.lexer = this;
    this.inlineQueue = [];
    this.state = {
      inLink: false,
      inRawBlock: false,
      top: true
    };
    var rules = {
      block: block.normal,
      inline: inline.normal
    };
    if (this.options.pedantic) {
      rules.block = block.pedantic;
      rules.inline = inline.pedantic;
    } else if (this.options.gfm) {
      rules.block = block.gfm;
      if (this.options.breaks) {
        rules.inline = inline.breaks;
      } else {
        rules.inline = inline.gfm;
      }
    }
    this.tokenizer.rules = rules;
  }

  /**
   * Expose Rules
   */
  /**
   * Static Lex Method
   */
  Lexer.lex = function lex(src, options) {
    var lexer = new Lexer(options);
    return lexer.lex(src);
  }

  /**
   * Static Lex Inline Method
   */;
  Lexer.lexInline = function lexInline(src, options) {
    var lexer = new Lexer(options);
    return lexer.inlineTokens(src);
  }

  /**
   * Preprocessing
   */;
  var _proto = Lexer.prototype;
  _proto.lex = function lex(src) {
    src = src.replace(/\r\n|\r/g, '\n');
    this.blockTokens(src, this.tokens);
    var next;
    while (next = this.inlineQueue.shift()) {
      this.inlineTokens(next.src, next.tokens);
    }
    return this.tokens;
  }

  /**
   * Lexing
   */;
  _proto.blockTokens = function blockTokens(src, tokens) {
    var _this = this;
    if (tokens === void 0) {
      tokens = [];
    }
    if (this.options.pedantic) {
      src = src.replace(/\t/g, '    ').replace(/^ +$/gm, '');
    } else {
      src = src.replace(/^( *)(\t+)/gm, function (_, leading, tabs) {
        return leading + '    '.repeat(tabs.length);
      });
    }
    var token, lastToken, cutSrc, lastParagraphClipped;
    while (src) {
      if (this.options.extensions && this.options.extensions.block && this.options.extensions.block.some(function (extTokenizer) {
        if (token = extTokenizer.call({
          lexer: _this
        }, src, tokens)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          return true;
        }
        return false;
      })) {
        continue;
      }

      // newline
      if (token = this.tokenizer.space(src)) {
        src = src.substring(token.raw.length);
        if (token.raw.length === 1 && tokens.length > 0) {
          // if there's a single \n as a spacer, it's terminating the last line,
          // so move it there so that we don't get unecessary paragraph tags
          tokens[tokens.length - 1].raw += '\n';
        } else {
          tokens.push(token);
        }
        continue;
      }

      // code
      if (token = this.tokenizer.code(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        // An indented code block cannot interrupt a paragraph.
        if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.text;
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      // fences
      if (token = this.tokenizer.fences(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // heading
      if (token = this.tokenizer.heading(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // hr
      if (token = this.tokenizer.hr(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // blockquote
      if (token = this.tokenizer.blockquote(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // list
      if (token = this.tokenizer.list(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // html
      if (token = this.tokenizer.html(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // def
      if (token = this.tokenizer.def(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.raw;
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else if (!this.tokens.links[token.tag]) {
          this.tokens.links[token.tag] = {
            href: token.href,
            title: token.title
          };
        }
        continue;
      }

      // table (gfm)
      if (token = this.tokenizer.table(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // lheading
      if (token = this.tokenizer.lheading(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // top-level paragraph
      // prevent paragraph consuming extensions by clipping 'src' to extension start
      cutSrc = src;
      if (this.options.extensions && this.options.extensions.startBlock) {
        (function () {
          var startIndex = Infinity;
          var tempSrc = src.slice(1);
          var tempStart = void 0;
          _this.options.extensions.startBlock.forEach(function (getStartIndex) {
            tempStart = getStartIndex.call({
              lexer: this
            }, tempSrc);
            if (typeof tempStart === 'number' && tempStart >= 0) {
              startIndex = Math.min(startIndex, tempStart);
            }
          });
          if (startIndex < Infinity && startIndex >= 0) {
            cutSrc = src.substring(0, startIndex + 1);
          }
        })();
      }
      if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {
        lastToken = tokens[tokens.length - 1];
        if (lastParagraphClipped && lastToken.type === 'paragraph') {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.text;
          this.inlineQueue.pop();
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else {
          tokens.push(token);
        }
        lastParagraphClipped = cutSrc.length !== src.length;
        src = src.substring(token.raw.length);
        continue;
      }

      // text
      if (token = this.tokenizer.text(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && lastToken.type === 'text') {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.text;
          this.inlineQueue.pop();
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else {
          tokens.push(token);
        }
        continue;
      }
      if (src) {
        var errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);
        if (this.options.silent) {
          console.error(errMsg);
          break;
        } else {
          throw new Error(errMsg);
        }
      }
    }
    this.state.top = true;
    return tokens;
  };
  _proto.inline = function inline(src, tokens) {
    if (tokens === void 0) {
      tokens = [];
    }
    this.inlineQueue.push({
      src: src,
      tokens: tokens
    });
    return tokens;
  }

  /**
   * Lexing/Compiling
   */;
  _proto.inlineTokens = function inlineTokens(src, tokens) {
    var _this2 = this;
    if (tokens === void 0) {
      tokens = [];
    }
    var token, lastToken, cutSrc;

    // String with links masked to avoid interference with em and strong
    var maskedSrc = src;
    var match;
    var keepPrevChar, prevChar;

    // Mask out reflinks
    if (this.tokens.links) {
      var links = Object.keys(this.tokens.links);
      if (links.length > 0) {
        while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {
          if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {
            maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);
          }
        }
      }
    }
    // Mask out other blocks
    while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {
      maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);
    }

    // Mask out escaped em & strong delimiters
    while ((match = this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc)) != null) {
      maskedSrc = maskedSrc.slice(0, match.index + match[0].length - 2) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);
      this.tokenizer.rules.inline.escapedEmSt.lastIndex--;
    }
    while (src) {
      if (!keepPrevChar) {
        prevChar = '';
      }
      keepPrevChar = false;

      // extensions
      if (this.options.extensions && this.options.extensions.inline && this.options.extensions.inline.some(function (extTokenizer) {
        if (token = extTokenizer.call({
          lexer: _this2
        }, src, tokens)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          return true;
        }
        return false;
      })) {
        continue;
      }

      // escape
      if (token = this.tokenizer.escape(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // tag
      if (token = this.tokenizer.tag(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && token.type === 'text' && lastToken.type === 'text') {
          lastToken.raw += token.raw;
          lastToken.text += token.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      // link
      if (token = this.tokenizer.link(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // reflink, nolink
      if (token = this.tokenizer.reflink(src, this.tokens.links)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && token.type === 'text' && lastToken.type === 'text') {
          lastToken.raw += token.raw;
          lastToken.text += token.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      // em & strong
      if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // code
      if (token = this.tokenizer.codespan(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // br
      if (token = this.tokenizer.br(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // del (gfm)
      if (token = this.tokenizer.del(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // autolink
      if (token = this.tokenizer.autolink(src, mangle)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // url (gfm)
      if (!this.state.inLink && (token = this.tokenizer.url(src, mangle))) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // text
      // prevent inlineText consuming extensions by clipping 'src' to extension start
      cutSrc = src;
      if (this.options.extensions && this.options.extensions.startInline) {
        (function () {
          var startIndex = Infinity;
          var tempSrc = src.slice(1);
          var tempStart = void 0;
          _this2.options.extensions.startInline.forEach(function (getStartIndex) {
            tempStart = getStartIndex.call({
              lexer: this
            }, tempSrc);
            if (typeof tempStart === 'number' && tempStart >= 0) {
              startIndex = Math.min(startIndex, tempStart);
            }
          });
          if (startIndex < Infinity && startIndex >= 0) {
            cutSrc = src.substring(0, startIndex + 1);
          }
        })();
      }
      if (token = this.tokenizer.inlineText(cutSrc, smartypants)) {
        src = src.substring(token.raw.length);
        if (token.raw.slice(-1) !== '_') {
          // Track prevChar before string of ____ started
          prevChar = token.raw.slice(-1);
        }
        keepPrevChar = true;
        lastToken = tokens[tokens.length - 1];
        if (lastToken && lastToken.type === 'text') {
          lastToken.raw += token.raw;
          lastToken.text += token.text;
        } else {
          tokens.push(token);
        }
        continue;
      }
      if (src) {
        var errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);
        if (this.options.silent) {
          console.error(errMsg);
          break;
        } else {
          throw new Error(errMsg);
        }
      }
    }
    return tokens;
  };
  _createClass(Lexer, null, [{
    key: "rules",
    get: function get() {
      return {
        block: block,
        inline: inline
      };
    }
  }]);
  return Lexer;
}();

/**
 * Renderer
 */
var Renderer = /*#__PURE__*/function () {
  function Renderer(options) {
    this.options = options || exports.defaults;
  }
  var _proto = Renderer.prototype;
  _proto.code = function code(_code, infostring, escaped) {
    var lang = (infostring || '').match(/\S*/)[0];
    if (this.options.highlight) {
      var out = this.options.highlight(_code, lang);
      if (out != null && out !== _code) {
        escaped = true;
        _code = out;
      }
    }
    _code = _code.replace(/\n$/, '') + '\n';
    if (!lang) {
      return '<pre><code>' + (escaped ? _code : escape(_code, true)) + '</code></pre>\n';
    }
    return '<pre><code class="' + this.options.langPrefix + escape(lang) + '">' + (escaped ? _code : escape(_code, true)) + '</code></pre>\n';
  }

  /**
   * @param {string} quote
   */;
  _proto.blockquote = function blockquote(quote) {
    return "<blockquote>\n" + quote + "</blockquote>\n";
  };
  _proto.html = function html(_html) {
    return _html;
  }

  /**
   * @param {string} text
   * @param {string} level
   * @param {string} raw
   * @param {any} slugger
   */;
  _proto.heading = function heading(text, level, raw, slugger) {
    if (this.options.headerIds) {
      var id = this.options.headerPrefix + slugger.slug(raw);
      return "<h" + level + " id=\"" + id + "\">" + text + "</h" + level + ">\n";
    }

    // ignore IDs
    return "<h" + level + ">" + text + "</h" + level + ">\n";
  };
  _proto.hr = function hr() {
    return this.options.xhtml ? '<hr/>\n' : '<hr>\n';
  };
  _proto.list = function list(body, ordered, start) {
    var type = ordered ? 'ol' : 'ul',
      startatt = ordered && start !== 1 ? ' start="' + start + '"' : '';
    return '<' + type + startatt + '>\n' + body + '</' + type + '>\n';
  }

  /**
   * @param {string} text
   */;
  _proto.listitem = function listitem(text) {
    return "<li>" + text + "</li>\n";
  };
  _proto.checkbox = function checkbox(checked) {
    return '<input ' + (checked ? 'checked="" ' : '') + 'disabled="" type="checkbox"' + (this.options.xhtml ? ' /' : '') + '> ';
  }

  /**
   * @param {string} text
   */;
  _proto.paragraph = function paragraph(text) {
    return "<p>" + text + "</p>\n";
  }

  /**
   * @param {string} header
   * @param {string} body
   */;
  _proto.table = function table(header, body) {
    if (body) body = "<tbody>" + body + "</tbody>";
    return '<table>\n' + '<thead>\n' + header + '</thead>\n' + body + '</table>\n';
  }

  /**
   * @param {string} content
   */;
  _proto.tablerow = function tablerow(content) {
    return "<tr>\n" + content + "</tr>\n";
  };
  _proto.tablecell = function tablecell(content, flags) {
    var type = flags.header ? 'th' : 'td';
    var tag = flags.align ? "<" + type + " align=\"" + flags.align + "\">" : "<" + type + ">";
    return tag + content + ("</" + type + ">\n");
  }

  /**
   * span level renderer
   * @param {string} text
   */;
  _proto.strong = function strong(text) {
    return "<strong>" + text + "</strong>";
  }

  /**
   * @param {string} text
   */;
  _proto.em = function em(text) {
    return "<em>" + text + "</em>";
  }

  /**
   * @param {string} text
   */;
  _proto.codespan = function codespan(text) {
    return "<code>" + text + "</code>";
  };
  _proto.br = function br() {
    return this.options.xhtml ? '<br/>' : '<br>';
  }

  /**
   * @param {string} text
   */;
  _proto.del = function del(text) {
    return "<del>" + text + "</del>";
  }

  /**
   * @param {string} href
   * @param {string} title
   * @param {string} text
   */;
  _proto.link = function link(href, title, text) {
    href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);
    if (href === null) {
      return text;
    }
    var out = '<a href="' + href + '"';
    if (title) {
      out += ' title="' + title + '"';
    }
    out += '>' + text + '</a>';
    return out;
  }

  /**
   * @param {string} href
   * @param {string} title
   * @param {string} text
   */;
  _proto.image = function image(href, title, text) {
    href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);
    if (href === null) {
      return text;
    }
    var out = "<img src=\"" + href + "\" alt=\"" + text + "\"";
    if (title) {
      out += " title=\"" + title + "\"";
    }
    out += this.options.xhtml ? '/>' : '>';
    return out;
  };
  _proto.text = function text(_text) {
    return _text;
  };
  return Renderer;
}();

/**
 * TextRenderer
 * returns only the textual part of the token
 */
var TextRenderer = /*#__PURE__*/function () {
  function TextRenderer() {}
  var _proto = TextRenderer.prototype;
  // no need for block level renderers
  _proto.strong = function strong(text) {
    return text;
  };
  _proto.em = function em(text) {
    return text;
  };
  _proto.codespan = function codespan(text) {
    return text;
  };
  _proto.del = function del(text) {
    return text;
  };
  _proto.html = function html(text) {
    return text;
  };
  _proto.text = function text(_text) {
    return _text;
  };
  _proto.link = function link(href, title, text) {
    return '' + text;
  };
  _proto.image = function image(href, title, text) {
    return '' + text;
  };
  _proto.br = function br() {
    return '';
  };
  return TextRenderer;
}();

/**
 * Slugger generates header id
 */
var Slugger = /*#__PURE__*/function () {
  function Slugger() {
    this.seen = {};
  }

  /**
   * @param {string} value
   */
  var _proto = Slugger.prototype;
  _proto.serialize = function serialize(value) {
    return value.toLowerCase().trim()
    // remove html tags
    .replace(/<[!\/a-z].*?>/ig, '')
    // remove unwanted chars
    .replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g, '').replace(/\s/g, '-');
  }

  /**
   * Finds the next safe (unique) slug to use
   * @param {string} originalSlug
   * @param {boolean} isDryRun
   */;
  _proto.getNextSafeSlug = function getNextSafeSlug(originalSlug, isDryRun) {
    var slug = originalSlug;
    var occurenceAccumulator = 0;
    if (this.seen.hasOwnProperty(slug)) {
      occurenceAccumulator = this.seen[originalSlug];
      do {
        occurenceAccumulator++;
        slug = originalSlug + '-' + occurenceAccumulator;
      } while (this.seen.hasOwnProperty(slug));
    }
    if (!isDryRun) {
      this.seen[originalSlug] = occurenceAccumulator;
      this.seen[slug] = 0;
    }
    return slug;
  }

  /**
   * Convert string to unique id
   * @param {object} [options]
   * @param {boolean} [options.dryrun] Generates the next unique slug without
   * updating the internal accumulator.
   */;
  _proto.slug = function slug(value, options) {
    if (options === void 0) {
      options = {};
    }
    var slug = this.serialize(value);
    return this.getNextSafeSlug(slug, options.dryrun);
  };
  return Slugger;
}();

/**
 * Parsing & Compiling
 */
var Parser = /*#__PURE__*/function () {
  function Parser(options) {
    this.options = options || exports.defaults;
    this.options.renderer = this.options.renderer || new Renderer();
    this.renderer = this.options.renderer;
    this.renderer.options = this.options;
    this.textRenderer = new TextRenderer();
    this.slugger = new Slugger();
  }

  /**
   * Static Parse Method
   */
  Parser.parse = function parse(tokens, options) {
    var parser = new Parser(options);
    return parser.parse(tokens);
  }

  /**
   * Static Parse Inline Method
   */;
  Parser.parseInline = function parseInline(tokens, options) {
    var parser = new Parser(options);
    return parser.parseInline(tokens);
  }

  /**
   * Parse Loop
   */;
  var _proto = Parser.prototype;
  _proto.parse = function parse(tokens, top) {
    if (top === void 0) {
      top = true;
    }
    var out = '',
      i,
      j,
      k,
      l2,
      l3,
      row,
      cell,
      header,
      body,
      token,
      ordered,
      start,
      loose,
      itemBody,
      item,
      checked,
      task,
      checkbox,
      ret;
    var l = tokens.length;
    for (i = 0; i < l; i++) {
      token = tokens[i];

      // Run any renderer extensions
      if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {
        ret = this.options.extensions.renderers[token.type].call({
          parser: this
        }, token);
        if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(token.type)) {
          out += ret || '';
          continue;
        }
      }
      switch (token.type) {
        case 'space':
          {
            continue;
          }
        case 'hr':
          {
            out += this.renderer.hr();
            continue;
          }
        case 'heading':
          {
            out += this.renderer.heading(this.parseInline(token.tokens), token.depth, unescape(this.parseInline(token.tokens, this.textRenderer)), this.slugger);
            continue;
          }
        case 'code':
          {
            out += this.renderer.code(token.text, token.lang, token.escaped);
            continue;
          }
        case 'table':
          {
            header = '';

            // header
            cell = '';
            l2 = token.header.length;
            for (j = 0; j < l2; j++) {
              cell += this.renderer.tablecell(this.parseInline(token.header[j].tokens), {
                header: true,
                align: token.align[j]
              });
            }
            header += this.renderer.tablerow(cell);
            body = '';
            l2 = token.rows.length;
            for (j = 0; j < l2; j++) {
              row = token.rows[j];
              cell = '';
              l3 = row.length;
              for (k = 0; k < l3; k++) {
                cell += this.renderer.tablecell(this.parseInline(row[k].tokens), {
                  header: false,
                  align: token.align[k]
                });
              }
              body += this.renderer.tablerow(cell);
            }
            out += this.renderer.table(header, body);
            continue;
          }
        case 'blockquote':
          {
            body = this.parse(token.tokens);
            out += this.renderer.blockquote(body);
            continue;
          }
        case 'list':
          {
            ordered = token.ordered;
            start = token.start;
            loose = token.loose;
            l2 = token.items.length;
            body = '';
            for (j = 0; j < l2; j++) {
              item = token.items[j];
              checked = item.checked;
              task = item.task;
              itemBody = '';
              if (item.task) {
                checkbox = this.renderer.checkbox(checked);
                if (loose) {
                  if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {
                    item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;
                    if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {
                      item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;
                    }
                  } else {
                    item.tokens.unshift({
                      type: 'text',
                      text: checkbox
                    });
                  }
                } else {
                  itemBody += checkbox;
                }
              }
              itemBody += this.parse(item.tokens, loose);
              body += this.renderer.listitem(itemBody, task, checked);
            }
            out += this.renderer.list(body, ordered, start);
            continue;
          }
        case 'html':
          {
            // TODO parse inline content if parameter markdown=1
            out += this.renderer.html(token.text);
            continue;
          }
        case 'paragraph':
          {
            out += this.renderer.paragraph(this.parseInline(token.tokens));
            continue;
          }
        case 'text':
          {
            body = token.tokens ? this.parseInline(token.tokens) : token.text;
            while (i + 1 < l && tokens[i + 1].type === 'text') {
              token = tokens[++i];
              body += '\n' + (token.tokens ? this.parseInline(token.tokens) : token.text);
            }
            out += top ? this.renderer.paragraph(body) : body;
            continue;
          }
        default:
          {
            var errMsg = 'Token with "' + token.type + '" type was not found.';
            if (this.options.silent) {
              console.error(errMsg);
              return;
            } else {
              throw new Error(errMsg);
            }
          }
      }
    }
    return out;
  }

  /**
   * Parse Inline Tokens
   */;
  _proto.parseInline = function parseInline(tokens, renderer) {
    renderer = renderer || this.renderer;
    var out = '',
      i,
      token,
      ret;
    var l = tokens.length;
    for (i = 0; i < l; i++) {
      token = tokens[i];

      // Run any renderer extensions
      if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {
        ret = this.options.extensions.renderers[token.type].call({
          parser: this
        }, token);
        if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(token.type)) {
          out += ret || '';
          continue;
        }
      }
      switch (token.type) {
        case 'escape':
          {
            out += renderer.text(token.text);
            break;
          }
        case 'html':
          {
            out += renderer.html(token.text);
            break;
          }
        case 'link':
          {
            out += renderer.link(token.href, token.title, this.parseInline(token.tokens, renderer));
            break;
          }
        case 'image':
          {
            out += renderer.image(token.href, token.title, token.text);
            break;
          }
        case 'strong':
          {
            out += renderer.strong(this.parseInline(token.tokens, renderer));
            break;
          }
        case 'em':
          {
            out += renderer.em(this.parseInline(token.tokens, renderer));
            break;
          }
        case 'codespan':
          {
            out += renderer.codespan(token.text);
            break;
          }
        case 'br':
          {
            out += renderer.br();
            break;
          }
        case 'del':
          {
            out += renderer.del(this.parseInline(token.tokens, renderer));
            break;
          }
        case 'text':
          {
            out += renderer.text(token.text);
            break;
          }
        default:
          {
            var errMsg = 'Token with "' + token.type + '" type was not found.';
            if (this.options.silent) {
              console.error(errMsg);
              return;
            } else {
              throw new Error(errMsg);
            }
          }
      }
    }
    return out;
  };
  return Parser;
}();

/**
 * Marked
 */
function marked(src, opt, callback) {
  // throw error in case of non string input
  if (typeof src === 'undefined' || src === null) {
    throw new Error('marked(): input parameter is undefined or null');
  }
  if (typeof src !== 'string') {
    throw new Error('marked(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');
  }
  if (typeof opt === 'function') {
    callback = opt;
    opt = null;
  }
  opt = merge({}, marked.defaults, opt || {});
  checkSanitizeDeprecation(opt);
  if (callback) {
    var highlight = opt.highlight;
    var tokens;
    try {
      tokens = Lexer.lex(src, opt);
    } catch (e) {
      return callback(e);
    }
    var done = function done(err) {
      var out;
      if (!err) {
        try {
          if (opt.walkTokens) {
            marked.walkTokens(tokens, opt.walkTokens);
          }
          out = Parser.parse(tokens, opt);
        } catch (e) {
          err = e;
        }
      }
      opt.highlight = highlight;
      return err ? callback(err) : callback(null, out);
    };
    if (!highlight || highlight.length < 3) {
      return done();
    }
    delete opt.highlight;
    if (!tokens.length) return done();
    var pending = 0;
    marked.walkTokens(tokens, function (token) {
      if (token.type === 'code') {
        pending++;
        setTimeout(function () {
          highlight(token.text, token.lang, function (err, code) {
            if (err) {
              return done(err);
            }
            if (code != null && code !== token.text) {
              token.text = code;
              token.escaped = true;
            }
            pending--;
            if (pending === 0) {
              done();
            }
          });
        }, 0);
      }
    });
    if (pending === 0) {
      done();
    }
    return;
  }
  function onError(e) {
    e.message += '\nPlease report this to https://github.com/markedjs/marked.';
    if (opt.silent) {
      return '<p>An error occurred:</p><pre>' + escape(e.message + '', true) + '</pre>';
    }
    throw e;
  }
  try {
    var _tokens = Lexer.lex(src, opt);
    if (opt.walkTokens) {
      if (opt.async) {
        return Promise.all(marked.walkTokens(_tokens, opt.walkTokens)).then(function () {
          return Parser.parse(_tokens, opt);
        })["catch"](onError);
      }
      marked.walkTokens(_tokens, opt.walkTokens);
    }
    return Parser.parse(_tokens, opt);
  } catch (e) {
    onError(e);
  }
}

/**
 * Options
 */

marked.options = marked.setOptions = function (opt) {
  merge(marked.defaults, opt);
  changeDefaults(marked.defaults);
  return marked;
};
marked.getDefaults = getDefaults;
marked.defaults = exports.defaults;

/**
 * Use Extension
 */

marked.use = function () {
  var extensions = marked.defaults.extensions || {
    renderers: {},
    childTokens: {}
  };
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }
  args.forEach(function (pack) {
    // copy options to new object
    var opts = merge({}, pack);

    // set async to true if it was set to true before
    opts.async = marked.defaults.async || opts.async;

    // ==-- Parse "addon" extensions --== //
    if (pack.extensions) {
      pack.extensions.forEach(function (ext) {
        if (!ext.name) {
          throw new Error('extension name required');
        }
        if (ext.renderer) {
          // Renderer extensions
          var prevRenderer = extensions.renderers[ext.name];
          if (prevRenderer) {
            // Replace extension with func to run new extension but fall back if false
            extensions.renderers[ext.name] = function () {
              for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
                args[_key2] = arguments[_key2];
              }
              var ret = ext.renderer.apply(this, args);
              if (ret === false) {
                ret = prevRenderer.apply(this, args);
              }
              return ret;
            };
          } else {
            extensions.renderers[ext.name] = ext.renderer;
          }
        }
        if (ext.tokenizer) {
          // Tokenizer Extensions
          if (!ext.level || ext.level !== 'block' && ext.level !== 'inline') {
            throw new Error("extension level must be 'block' or 'inline'");
          }
          if (extensions[ext.level]) {
            extensions[ext.level].unshift(ext.tokenizer);
          } else {
            extensions[ext.level] = [ext.tokenizer];
          }
          if (ext.start) {
            // Function to check for start of token
            if (ext.level === 'block') {
              if (extensions.startBlock) {
                extensions.startBlock.push(ext.start);
              } else {
                extensions.startBlock = [ext.start];
              }
            } else if (ext.level === 'inline') {
              if (extensions.startInline) {
                extensions.startInline.push(ext.start);
              } else {
                extensions.startInline = [ext.start];
              }
            }
          }
        }
        if (ext.childTokens) {
          // Child tokens to be visited by walkTokens
          extensions.childTokens[ext.name] = ext.childTokens;
        }
      });
      opts.extensions = extensions;
    }

    // ==-- Parse "overwrite" extensions --== //
    if (pack.renderer) {
      (function () {
        var renderer = marked.defaults.renderer || new Renderer();
        var _loop = function _loop(prop) {
          var prevRenderer = renderer[prop];
          // Replace renderer with func to run extension, but fall back if false
          renderer[prop] = function () {
            for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
              args[_key3] = arguments[_key3];
            }
            var ret = pack.renderer[prop].apply(renderer, args);
            if (ret === false) {
              ret = prevRenderer.apply(renderer, args);
            }
            return ret;
          };
        };
        for (var prop in pack.renderer) {
          _loop(prop);
        }
        opts.renderer = renderer;
      })();
    }
    if (pack.tokenizer) {
      (function () {
        var tokenizer = marked.defaults.tokenizer || new Tokenizer();
        var _loop2 = function _loop2(prop) {
          var prevTokenizer = tokenizer[prop];
          // Replace tokenizer with func to run extension, but fall back if false
          tokenizer[prop] = function () {
            for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
              args[_key4] = arguments[_key4];
            }
            var ret = pack.tokenizer[prop].apply(tokenizer, args);
            if (ret === false) {
              ret = prevTokenizer.apply(tokenizer, args);
            }
            return ret;
          };
        };
        for (var prop in pack.tokenizer) {
          _loop2(prop);
        }
        opts.tokenizer = tokenizer;
      })();
    }

    // ==-- Parse WalkTokens extensions --== //
    if (pack.walkTokens) {
      var _walkTokens = marked.defaults.walkTokens;
      opts.walkTokens = function (token) {
        var values = [];
        values.push(pack.walkTokens.call(this, token));
        if (_walkTokens) {
          values = values.concat(_walkTokens.call(this, token));
        }
        return values;
      };
    }
    marked.setOptions(opts);
  });
};

/**
 * Run callback for every token
 */

marked.walkTokens = function (tokens, callback) {
  var values = [];
  var _loop3 = function _loop3() {
    var token = _step.value;
    values = values.concat(callback.call(marked, token));
    switch (token.type) {
      case 'table':
        {
          for (var _iterator2 = _createForOfIteratorHelperLoose(token.header), _step2; !(_step2 = _iterator2()).done;) {
            var cell = _step2.value;
            values = values.concat(marked.walkTokens(cell.tokens, callback));
          }
          for (var _iterator3 = _createForOfIteratorHelperLoose(token.rows), _step3; !(_step3 = _iterator3()).done;) {
            var row = _step3.value;
            for (var _iterator4 = _createForOfIteratorHelperLoose(row), _step4; !(_step4 = _iterator4()).done;) {
              var _cell = _step4.value;
              values = values.concat(marked.walkTokens(_cell.tokens, callback));
            }
          }
          break;
        }
      case 'list':
        {
          values = values.concat(marked.walkTokens(token.items, callback));
          break;
        }
      default:
        {
          if (marked.defaults.extensions && marked.defaults.extensions.childTokens && marked.defaults.extensions.childTokens[token.type]) {
            // Walk any extensions
            marked.defaults.extensions.childTokens[token.type].forEach(function (childTokens) {
              values = values.concat(marked.walkTokens(token[childTokens], callback));
            });
          } else if (token.tokens) {
            values = values.concat(marked.walkTokens(token.tokens, callback));
          }
        }
    }
  };
  for (var _iterator = _createForOfIteratorHelperLoose(tokens), _step; !(_step = _iterator()).done;) {
    _loop3();
  }
  return values;
};

/**
 * Parse Inline
 * @param {string} src
 */
marked.parseInline = function (src, opt) {
  // throw error in case of non string input
  if (typeof src === 'undefined' || src === null) {
    throw new Error('marked.parseInline(): input parameter is undefined or null');
  }
  if (typeof src !== 'string') {
    throw new Error('marked.parseInline(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');
  }
  opt = merge({}, marked.defaults, opt || {});
  checkSanitizeDeprecation(opt);
  try {
    var tokens = Lexer.lexInline(src, opt);
    if (opt.walkTokens) {
      marked.walkTokens(tokens, opt.walkTokens);
    }
    return Parser.parseInline(tokens, opt);
  } catch (e) {
    e.message += '\nPlease report this to https://github.com/markedjs/marked.';
    if (opt.silent) {
      return '<p>An error occurred:</p><pre>' + escape(e.message + '', true) + '</pre>';
    }
    throw e;
  }
};

/**
 * Expose
 */
marked.Parser = Parser;
marked.parser = Parser.parse;
marked.Renderer = Renderer;
marked.TextRenderer = TextRenderer;
marked.Lexer = Lexer;
marked.lexer = Lexer.lex;
marked.Tokenizer = Tokenizer;
marked.Slugger = Slugger;
marked.parse = marked;
var options = marked.options;
var setOptions = marked.setOptions;
var use = marked.use;
var walkTokens = marked.walkTokens;
var parseInline = marked.parseInline;
var parse = marked;
var parser = Parser.parse;
var lexer = Lexer.lex;

exports.Lexer = Lexer;
exports.Parser = Parser;
exports.Renderer = Renderer;
exports.Slugger = Slugger;
exports.TextRenderer = TextRenderer;
exports.Tokenizer = Tokenizer;
exports.getDefaults = getDefaults;
exports.lexer = lexer;
exports.marked = marked;
exports.options = options;
exports.parse = parse;
exports.parseInline = parseInline;
exports.parser = parser;
exports.setOptions = setOptions;
exports.use = use;
exports.walkTokens = walkTokens;

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/lib/marked.esm.js #######

```

/**
 * marked - a markdown parser
 * Copyright (c) 2011-2022, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/markedjs/marked
 */

/**
 * DO NOT EDIT THIS FILE
 * The code in this file is generated from files in ./src/
 */

function getDefaults() {
  return {
    async: false,
    baseUrl: null,
    breaks: false,
    extensions: null,
    gfm: true,
    headerIds: true,
    headerPrefix: '',
    highlight: null,
    langPrefix: 'language-',
    mangle: true,
    pedantic: false,
    renderer: null,
    sanitize: false,
    sanitizer: null,
    silent: false,
    smartypants: false,
    tokenizer: null,
    walkTokens: null,
    xhtml: false
  };
}

let defaults = getDefaults();

function changeDefaults(newDefaults) {
  defaults = newDefaults;
}

/**
 * Helpers
 */
const escapeTest = /[&<>"']/;
const escapeReplace = new RegExp(escapeTest.source, 'g');
const escapeTestNoEncode = /[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/;
const escapeReplaceNoEncode = new RegExp(escapeTestNoEncode.source, 'g');
const escapeReplacements = {
  '&': '&amp;',
  '<': '&lt;',
  '>': '&gt;',
  '"': '&quot;',
  "'": '&#39;'
};
const getEscapeReplacement = (ch) => escapeReplacements[ch];
function escape(html, encode) {
  if (encode) {
    if (escapeTest.test(html)) {
      return html.replace(escapeReplace, getEscapeReplacement);
    }
  } else {
    if (escapeTestNoEncode.test(html)) {
      return html.replace(escapeReplaceNoEncode, getEscapeReplacement);
    }
  }

  return html;
}

const unescapeTest = /&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;

/**
 * @param {string} html
 */
function unescape(html) {
  // explicitly match decimal, hex, and named HTML entities
  return html.replace(unescapeTest, (_, n) => {
    n = n.toLowerCase();
    if (n === 'colon') return ':';
    if (n.charAt(0) === '#') {
      return n.charAt(1) === 'x'
        ? String.fromCharCode(parseInt(n.substring(2), 16))
        : String.fromCharCode(+n.substring(1));
    }
    return '';
  });
}

const caret = /(^|[^\[])\^/g;

/**
 * @param {string | RegExp} regex
 * @param {string} opt
 */
function edit(regex, opt) {
  regex = typeof regex === 'string' ? regex : regex.source;
  opt = opt || '';
  const obj = {
    replace: (name, val) => {
      val = val.source || val;
      val = val.replace(caret, '$1');
      regex = regex.replace(name, val);
      return obj;
    },
    getRegex: () => {
      return new RegExp(regex, opt);
    }
  };
  return obj;
}

const nonWordAndColonTest = /[^\w:]/g;
const originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;

/**
 * @param {boolean} sanitize
 * @param {string} base
 * @param {string} href
 */
function cleanUrl(sanitize, base, href) {
  if (sanitize) {
    let prot;
    try {
      prot = decodeURIComponent(unescape(href))
        .replace(nonWordAndColonTest, '')
        .toLowerCase();
    } catch (e) {
      return null;
    }
    if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0 || prot.indexOf('data:') === 0) {
      return null;
    }
  }
  if (base && !originIndependentUrl.test(href)) {
    href = resolveUrl(base, href);
  }
  try {
    href = encodeURI(href).replace(/%25/g, '%');
  } catch (e) {
    return null;
  }
  return href;
}

const baseUrls = {};
const justDomain = /^[^:]+:\/*[^/]*$/;
const protocol = /^([^:]+:)[\s\S]*$/;
const domain = /^([^:]+:\/*[^/]*)[\s\S]*$/;

/**
 * @param {string} base
 * @param {string} href
 */
function resolveUrl(base, href) {
  if (!baseUrls[' ' + base]) {
    // we can ignore everything in base after the last slash of its path component,
    // but we might need to add _that_
    // https://tools.ietf.org/html/rfc3986#section-3
    if (justDomain.test(base)) {
      baseUrls[' ' + base] = base + '/';
    } else {
      baseUrls[' ' + base] = rtrim(base, '/', true);
    }
  }
  base = baseUrls[' ' + base];
  const relativeBase = base.indexOf(':') === -1;

  if (href.substring(0, 2) === '//') {
    if (relativeBase) {
      return href;
    }
    return base.replace(protocol, '$1') + href;
  } else if (href.charAt(0) === '/') {
    if (relativeBase) {
      return href;
    }
    return base.replace(domain, '$1') + href;
  } else {
    return base + href;
  }
}

const noopTest = { exec: function noopTest() {} };

function merge(obj) {
  let i = 1,
    target,
    key;

  for (; i < arguments.length; i++) {
    target = arguments[i];
    for (key in target) {
      if (Object.prototype.hasOwnProperty.call(target, key)) {
        obj[key] = target[key];
      }
    }
  }

  return obj;
}

function splitCells(tableRow, count) {
  // ensure that every cell-delimiting pipe has a space
  // before it to distinguish it from an escaped pipe
  const row = tableRow.replace(/\|/g, (match, offset, str) => {
      let escaped = false,
        curr = offset;
      while (--curr >= 0 && str[curr] === '\\') escaped = !escaped;
      if (escaped) {
        // odd number of slashes means | is escaped
        // so we leave it alone
        return '|';
      } else {
        // add space before unescaped |
        return ' |';
      }
    }),
    cells = row.split(/ \|/);
  let i = 0;

  // First/last cell in a row cannot be empty if it has no leading/trailing pipe
  if (!cells[0].trim()) { cells.shift(); }
  if (cells.length > 0 && !cells[cells.length - 1].trim()) { cells.pop(); }

  if (cells.length > count) {
    cells.splice(count);
  } else {
    while (cells.length < count) cells.push('');
  }

  for (; i < cells.length; i++) {
    // leading or trailing whitespace is ignored per the gfm spec
    cells[i] = cells[i].trim().replace(/\\\|/g, '|');
  }
  return cells;
}

/**
 * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').
 * /c*$/ is vulnerable to REDOS.
 *
 * @param {string} str
 * @param {string} c
 * @param {boolean} invert Remove suffix of non-c chars instead. Default falsey.
 */
function rtrim(str, c, invert) {
  const l = str.length;
  if (l === 0) {
    return '';
  }

  // Length of suffix matching the invert condition.
  let suffLen = 0;

  // Step left until we fail to match the invert condition.
  while (suffLen < l) {
    const currChar = str.charAt(l - suffLen - 1);
    if (currChar === c && !invert) {
      suffLen++;
    } else if (currChar !== c && invert) {
      suffLen++;
    } else {
      break;
    }
  }

  return str.slice(0, l - suffLen);
}

function findClosingBracket(str, b) {
  if (str.indexOf(b[1]) === -1) {
    return -1;
  }
  const l = str.length;
  let level = 0,
    i = 0;
  for (; i < l; i++) {
    if (str[i] === '\\') {
      i++;
    } else if (str[i] === b[0]) {
      level++;
    } else if (str[i] === b[1]) {
      level--;
      if (level < 0) {
        return i;
      }
    }
  }
  return -1;
}

function checkSanitizeDeprecation(opt) {
  if (opt && opt.sanitize && !opt.silent) {
    console.warn('marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options');
  }
}

// copied from https://stackoverflow.com/a/5450113/806777
/**
 * @param {string} pattern
 * @param {number} count
 */
function repeatString(pattern, count) {
  if (count < 1) {
    return '';
  }
  let result = '';
  while (count > 1) {
    if (count & 1) {
      result += pattern;
    }
    count >>= 1;
    pattern += pattern;
  }
  return result + pattern;
}

function outputLink(cap, link, raw, lexer) {
  const href = link.href;
  const title = link.title ? escape(link.title) : null;
  const text = cap[1].replace(/\\([\[\]])/g, '$1');

  if (cap[0].charAt(0) !== '!') {
    lexer.state.inLink = true;
    const token = {
      type: 'link',
      raw,
      href,
      title,
      text,
      tokens: lexer.inlineTokens(text)
    };
    lexer.state.inLink = false;
    return token;
  }
  return {
    type: 'image',
    raw,
    href,
    title,
    text: escape(text)
  };
}

function indentCodeCompensation(raw, text) {
  const matchIndentToCode = raw.match(/^(\s+)(?:```)/);

  if (matchIndentToCode === null) {
    return text;
  }

  const indentToCode = matchIndentToCode[1];

  return text
    .split('\n')
    .map(node => {
      const matchIndentInNode = node.match(/^\s+/);
      if (matchIndentInNode === null) {
        return node;
      }

      const [indentInNode] = matchIndentInNode;

      if (indentInNode.length >= indentToCode.length) {
        return node.slice(indentToCode.length);
      }

      return node;
    })
    .join('\n');
}

/**
 * Tokenizer
 */
class Tokenizer {
  constructor(options) {
    this.options = options || defaults;
  }

  space(src) {
    const cap = this.rules.block.newline.exec(src);
    if (cap && cap[0].length > 0) {
      return {
        type: 'space',
        raw: cap[0]
      };
    }
  }

  code(src) {
    const cap = this.rules.block.code.exec(src);
    if (cap) {
      const text = cap[0].replace(/^ {1,4}/gm, '');
      return {
        type: 'code',
        raw: cap[0],
        codeBlockStyle: 'indented',
        text: !this.options.pedantic
          ? rtrim(text, '\n')
          : text
      };
    }
  }

  fences(src) {
    const cap = this.rules.block.fences.exec(src);
    if (cap) {
      const raw = cap[0];
      const text = indentCodeCompensation(raw, cap[3] || '');

      return {
        type: 'code',
        raw,
        lang: cap[2] ? cap[2].trim().replace(this.rules.inline._escapes, '$1') : cap[2],
        text
      };
    }
  }

  heading(src) {
    const cap = this.rules.block.heading.exec(src);
    if (cap) {
      let text = cap[2].trim();

      // remove trailing #s
      if (/#$/.test(text)) {
        const trimmed = rtrim(text, '#');
        if (this.options.pedantic) {
          text = trimmed.trim();
        } else if (!trimmed || / $/.test(trimmed)) {
          // CommonMark requires space before trailing #s
          text = trimmed.trim();
        }
      }

      return {
        type: 'heading',
        raw: cap[0],
        depth: cap[1].length,
        text,
        tokens: this.lexer.inline(text)
      };
    }
  }

  hr(src) {
    const cap = this.rules.block.hr.exec(src);
    if (cap) {
      return {
        type: 'hr',
        raw: cap[0]
      };
    }
  }

  blockquote(src) {
    const cap = this.rules.block.blockquote.exec(src);
    if (cap) {
      const text = cap[0].replace(/^ *>[ \t]?/gm, '');
      const top = this.lexer.state.top;
      this.lexer.state.top = true;
      const tokens = this.lexer.blockTokens(text);
      this.lexer.state.top = top;
      return {
        type: 'blockquote',
        raw: cap[0],
        tokens,
        text
      };
    }
  }

  list(src) {
    let cap = this.rules.block.list.exec(src);
    if (cap) {
      let raw, istask, ischecked, indent, i, blankLine, endsWithBlankLine,
        line, nextLine, rawLine, itemContents, endEarly;

      let bull = cap[1].trim();
      const isordered = bull.length > 1;

      const list = {
        type: 'list',
        raw: '',
        ordered: isordered,
        start: isordered ? +bull.slice(0, -1) : '',
        loose: false,
        items: []
      };

      bull = isordered ? `\\d{1,9}\\${bull.slice(-1)}` : `\\${bull}`;

      if (this.options.pedantic) {
        bull = isordered ? bull : '[*+-]';
      }

      // Get next list item
      const itemRegex = new RegExp(`^( {0,3}${bull})((?:[\t ][^\\n]*)?(?:\\n|$))`);

      // Check if current bullet point can start a new List Item
      while (src) {
        endEarly = false;
        if (!(cap = itemRegex.exec(src))) {
          break;
        }

        if (this.rules.block.hr.test(src)) { // End list if bullet was actually HR (possibly move into itemRegex?)
          break;
        }

        raw = cap[0];
        src = src.substring(raw.length);

        line = cap[2].split('\n', 1)[0].replace(/^\t+/, (t) => ' '.repeat(3 * t.length));
        nextLine = src.split('\n', 1)[0];

        if (this.options.pedantic) {
          indent = 2;
          itemContents = line.trimLeft();
        } else {
          indent = cap[2].search(/[^ ]/); // Find first non-space char
          indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent
          itemContents = line.slice(indent);
          indent += cap[1].length;
        }

        blankLine = false;

        if (!line && /^ *$/.test(nextLine)) { // Items begin with at most one blank line
          raw += nextLine + '\n';
          src = src.substring(nextLine.length + 1);
          endEarly = true;
        }

        if (!endEarly) {
          const nextBulletRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`);
          const hrRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`);
          const fencesBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:\`\`\`|~~~)`);
          const headingBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}#`);

          // Check if following lines should be included in List Item
          while (src) {
            rawLine = src.split('\n', 1)[0];
            nextLine = rawLine;

            // Re-align to follow commonmark nesting rules
            if (this.options.pedantic) {
              nextLine = nextLine.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');
            }

            // End list item if found code fences
            if (fencesBeginRegex.test(nextLine)) {
              break;
            }

            // End list item if found start of new heading
            if (headingBeginRegex.test(nextLine)) {
              break;
            }

            // End list item if found start of new bullet
            if (nextBulletRegex.test(nextLine)) {
              break;
            }

            // Horizontal rule found
            if (hrRegex.test(src)) {
              break;
            }

            if (nextLine.search(/[^ ]/) >= indent || !nextLine.trim()) { // Dedent if possible
              itemContents += '\n' + nextLine.slice(indent);
            } else {
              // not enough indentation
              if (blankLine) {
                break;
              }

              // paragraph continuation unless last line was a different block level element
              if (line.search(/[^ ]/) >= 4) { // indented code block
                break;
              }
              if (fencesBeginRegex.test(line)) {
                break;
              }
              if (headingBeginRegex.test(line)) {
                break;
              }
              if (hrRegex.test(line)) {
                break;
              }

              itemContents += '\n' + nextLine;
            }

            if (!blankLine && !nextLine.trim()) { // Check if current line is blank
              blankLine = true;
            }

            raw += rawLine + '\n';
            src = src.substring(rawLine.length + 1);
            line = nextLine.slice(indent);
          }
        }

        if (!list.loose) {
          // If the previous item ended with a blank line, the list is loose
          if (endsWithBlankLine) {
            list.loose = true;
          } else if (/\n *\n *$/.test(raw)) {
            endsWithBlankLine = true;
          }
        }

        // Check for task list items
        if (this.options.gfm) {
          istask = /^\[[ xX]\] /.exec(itemContents);
          if (istask) {
            ischecked = istask[0] !== '[ ] ';
            itemContents = itemContents.replace(/^\[[ xX]\] +/, '');
          }
        }

        list.items.push({
          type: 'list_item',
          raw,
          task: !!istask,
          checked: ischecked,
          loose: false,
          text: itemContents
        });

        list.raw += raw;
      }

      // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic
      list.items[list.items.length - 1].raw = raw.trimRight();
      list.items[list.items.length - 1].text = itemContents.trimRight();
      list.raw = list.raw.trimRight();

      const l = list.items.length;

      // Item child tokens handled here at end because we needed to have the final item to trim it first
      for (i = 0; i < l; i++) {
        this.lexer.state.top = false;
        list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);

        if (!list.loose) {
          // Check if list should be loose
          const spacers = list.items[i].tokens.filter(t => t.type === 'space');
          const hasMultipleLineBreaks = spacers.length > 0 && spacers.some(t => /\n.*\n/.test(t.raw));

          list.loose = hasMultipleLineBreaks;
        }
      }

      // Set all items to loose if list is loose
      if (list.loose) {
        for (i = 0; i < l; i++) {
          list.items[i].loose = true;
        }
      }

      return list;
    }
  }

  html(src) {
    const cap = this.rules.block.html.exec(src);
    if (cap) {
      const token = {
        type: 'html',
        raw: cap[0],
        pre: !this.options.sanitizer
          && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),
        text: cap[0]
      };
      if (this.options.sanitize) {
        const text = this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]);
        token.type = 'paragraph';
        token.text = text;
        token.tokens = this.lexer.inline(text);
      }
      return token;
    }
  }

  def(src) {
    const cap = this.rules.block.def.exec(src);
    if (cap) {
      const tag = cap[1].toLowerCase().replace(/\s+/g, ' ');
      const href = cap[2] ? cap[2].replace(/^<(.*)>$/, '$1').replace(this.rules.inline._escapes, '$1') : '';
      const title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline._escapes, '$1') : cap[3];
      return {
        type: 'def',
        tag,
        raw: cap[0],
        href,
        title
      };
    }
  }

  table(src) {
    const cap = this.rules.block.table.exec(src);
    if (cap) {
      const item = {
        type: 'table',
        header: splitCells(cap[1]).map(c => { return { text: c }; }),
        align: cap[2].replace(/^ *|\| *$/g, '').split(/ *\| */),
        rows: cap[3] && cap[3].trim() ? cap[3].replace(/\n[ \t]*$/, '').split('\n') : []
      };

      if (item.header.length === item.align.length) {
        item.raw = cap[0];

        let l = item.align.length;
        let i, j, k, row;
        for (i = 0; i < l; i++) {
          if (/^ *-+: *$/.test(item.align[i])) {
            item.align[i] = 'right';
          } else if (/^ *:-+: *$/.test(item.align[i])) {
            item.align[i] = 'center';
          } else if (/^ *:-+ *$/.test(item.align[i])) {
            item.align[i] = 'left';
          } else {
            item.align[i] = null;
          }
        }

        l = item.rows.length;
        for (i = 0; i < l; i++) {
          item.rows[i] = splitCells(item.rows[i], item.header.length).map(c => { return { text: c }; });
        }

        // parse child tokens inside headers and cells

        // header child tokens
        l = item.header.length;
        for (j = 0; j < l; j++) {
          item.header[j].tokens = this.lexer.inline(item.header[j].text);
        }

        // cell child tokens
        l = item.rows.length;
        for (j = 0; j < l; j++) {
          row = item.rows[j];
          for (k = 0; k < row.length; k++) {
            row[k].tokens = this.lexer.inline(row[k].text);
          }
        }

        return item;
      }
    }
  }

  lheading(src) {
    const cap = this.rules.block.lheading.exec(src);
    if (cap) {
      return {
        type: 'heading',
        raw: cap[0],
        depth: cap[2].charAt(0) === '=' ? 1 : 2,
        text: cap[1],
        tokens: this.lexer.inline(cap[1])
      };
    }
  }

  paragraph(src) {
    const cap = this.rules.block.paragraph.exec(src);
    if (cap) {
      const text = cap[1].charAt(cap[1].length - 1) === '\n'
        ? cap[1].slice(0, -1)
        : cap[1];
      return {
        type: 'paragraph',
        raw: cap[0],
        text,
        tokens: this.lexer.inline(text)
      };
    }
  }

  text(src) {
    const cap = this.rules.block.text.exec(src);
    if (cap) {
      return {
        type: 'text',
        raw: cap[0],
        text: cap[0],
        tokens: this.lexer.inline(cap[0])
      };
    }
  }

  escape(src) {
    const cap = this.rules.inline.escape.exec(src);
    if (cap) {
      return {
        type: 'escape',
        raw: cap[0],
        text: escape(cap[1])
      };
    }
  }

  tag(src) {
    const cap = this.rules.inline.tag.exec(src);
    if (cap) {
      if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {
        this.lexer.state.inLink = true;
      } else if (this.lexer.state.inLink && /^<\/a>/i.test(cap[0])) {
        this.lexer.state.inLink = false;
      }
      if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\s|>)/i.test(cap[0])) {
        this.lexer.state.inRawBlock = true;
      } else if (this.lexer.state.inRawBlock && /^<\/(pre|code|kbd|script)(\s|>)/i.test(cap[0])) {
        this.lexer.state.inRawBlock = false;
      }

      return {
        type: this.options.sanitize
          ? 'text'
          : 'html',
        raw: cap[0],
        inLink: this.lexer.state.inLink,
        inRawBlock: this.lexer.state.inRawBlock,
        text: this.options.sanitize
          ? (this.options.sanitizer
            ? this.options.sanitizer(cap[0])
            : escape(cap[0]))
          : cap[0]
      };
    }
  }

  link(src) {
    const cap = this.rules.inline.link.exec(src);
    if (cap) {
      const trimmedUrl = cap[2].trim();
      if (!this.options.pedantic && /^</.test(trimmedUrl)) {
        // commonmark requires matching angle brackets
        if (!(/>$/.test(trimmedUrl))) {
          return;
        }

        // ending angle bracket cannot be escaped
        const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\');
        if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {
          return;
        }
      } else {
        // find closing parenthesis
        const lastParenIndex = findClosingBracket(cap[2], '()');
        if (lastParenIndex > -1) {
          const start = cap[0].indexOf('!') === 0 ? 5 : 4;
          const linkLen = start + cap[1].length + lastParenIndex;
          cap[2] = cap[2].substring(0, lastParenIndex);
          cap[0] = cap[0].substring(0, linkLen).trim();
          cap[3] = '';
        }
      }
      let href = cap[2];
      let title = '';
      if (this.options.pedantic) {
        // split pedantic href and title
        const link = /^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(href);

        if (link) {
          href = link[1];
          title = link[3];
        }
      } else {
        title = cap[3] ? cap[3].slice(1, -1) : '';
      }

      href = href.trim();
      if (/^</.test(href)) {
        if (this.options.pedantic && !(/>$/.test(trimmedUrl))) {
          // pedantic allows starting angle bracket without ending angle bracket
          href = href.slice(1);
        } else {
          href = href.slice(1, -1);
        }
      }
      return outputLink(cap, {
        href: href ? href.replace(this.rules.inline._escapes, '$1') : href,
        title: title ? title.replace(this.rules.inline._escapes, '$1') : title
      }, cap[0], this.lexer);
    }
  }

  reflink(src, links) {
    let cap;
    if ((cap = this.rules.inline.reflink.exec(src))
        || (cap = this.rules.inline.nolink.exec(src))) {
      let link = (cap[2] || cap[1]).replace(/\s+/g, ' ');
      link = links[link.toLowerCase()];
      if (!link) {
        const text = cap[0].charAt(0);
        return {
          type: 'text',
          raw: text,
          text
        };
      }
      return outputLink(cap, link, cap[0], this.lexer);
    }
  }

  emStrong(src, maskedSrc, prevChar = '') {
    let match = this.rules.inline.emStrong.lDelim.exec(src);
    if (!match) return;

    // _ can't be between two alphanumerics. \p{L}\p{N} includes non-english alphabet/numbers as well
    if (match[3] && prevChar.match(/[\p{L}\p{N}]/u)) return;

    const nextChar = match[1] || match[2] || '';

    if (!nextChar || (nextChar && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar)))) {
      const lLength = match[0].length - 1;
      let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;

      const endReg = match[0][0] === '*' ? this.rules.inline.emStrong.rDelimAst : this.rules.inline.emStrong.rDelimUnd;
      endReg.lastIndex = 0;

      // Clip maskedSrc to same section of string as src (move to lexer?)
      maskedSrc = maskedSrc.slice(-1 * src.length + lLength);

      while ((match = endReg.exec(maskedSrc)) != null) {
        rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];

        if (!rDelim) continue; // skip single * in __abc*abc__

        rLength = rDelim.length;

        if (match[3] || match[4]) { // found another Left Delim
          delimTotal += rLength;
          continue;
        } else if (match[5] || match[6]) { // either Left or Right Delim
          if (lLength % 3 && !((lLength + rLength) % 3)) {
            midDelimTotal += rLength;
            continue; // CommonMark Emphasis Rules 9-10
          }
        }

        delimTotal -= rLength;

        if (delimTotal > 0) continue; // Haven't found enough closing delimiters

        // Remove extra characters. *a*** -> *a*
        rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);

        const raw = src.slice(0, lLength + match.index + (match[0].length - rDelim.length) + rLength);

        // Create `em` if smallest delimiter has odd char count. *a***
        if (Math.min(lLength, rLength) % 2) {
          const text = raw.slice(1, -1);
          return {
            type: 'em',
            raw,
            text,
            tokens: this.lexer.inlineTokens(text)
          };
        }

        // Create 'strong' if smallest delimiter has even char count. **a***
        const text = raw.slice(2, -2);
        return {
          type: 'strong',
          raw,
          text,
          tokens: this.lexer.inlineTokens(text)
        };
      }
    }
  }

  codespan(src) {
    const cap = this.rules.inline.code.exec(src);
    if (cap) {
      let text = cap[2].replace(/\n/g, ' ');
      const hasNonSpaceChars = /[^ ]/.test(text);
      const hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);
      if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {
        text = text.substring(1, text.length - 1);
      }
      text = escape(text, true);
      return {
        type: 'codespan',
        raw: cap[0],
        text
      };
    }
  }

  br(src) {
    const cap = this.rules.inline.br.exec(src);
    if (cap) {
      return {
        type: 'br',
        raw: cap[0]
      };
    }
  }

  del(src) {
    const cap = this.rules.inline.del.exec(src);
    if (cap) {
      return {
        type: 'del',
        raw: cap[0],
        text: cap[2],
        tokens: this.lexer.inlineTokens(cap[2])
      };
    }
  }

  autolink(src, mangle) {
    const cap = this.rules.inline.autolink.exec(src);
    if (cap) {
      let text, href;
      if (cap[2] === '@') {
        text = escape(this.options.mangle ? mangle(cap[1]) : cap[1]);
        href = 'mailto:' + text;
      } else {
        text = escape(cap[1]);
        href = text;
      }

      return {
        type: 'link',
        raw: cap[0],
        text,
        href,
        tokens: [
          {
            type: 'text',
            raw: text,
            text
          }
        ]
      };
    }
  }

  url(src, mangle) {
    let cap;
    if (cap = this.rules.inline.url.exec(src)) {
      let text, href;
      if (cap[2] === '@') {
        text = escape(this.options.mangle ? mangle(cap[0]) : cap[0]);
        href = 'mailto:' + text;
      } else {
        // do extended autolink path validation
        let prevCapZero;
        do {
          prevCapZero = cap[0];
          cap[0] = this.rules.inline._backpedal.exec(cap[0])[0];
        } while (prevCapZero !== cap[0]);
        text = escape(cap[0]);
        if (cap[1] === 'www.') {
          href = 'http://' + cap[0];
        } else {
          href = cap[0];
        }
      }
      return {
        type: 'link',
        raw: cap[0],
        text,
        href,
        tokens: [
          {
            type: 'text',
            raw: text,
            text
          }
        ]
      };
    }
  }

  inlineText(src, smartypants) {
    const cap = this.rules.inline.text.exec(src);
    if (cap) {
      let text;
      if (this.lexer.state.inRawBlock) {
        text = this.options.sanitize ? (this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0])) : cap[0];
      } else {
        text = escape(this.options.smartypants ? smartypants(cap[0]) : cap[0]);
      }
      return {
        type: 'text',
        raw: cap[0],
        text
      };
    }
  }
}

/**
 * Block-Level Grammar
 */
const block = {
  newline: /^(?: *(?:\n|$))+/,
  code: /^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,
  fences: /^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,
  hr: /^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,
  heading: /^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,
  blockquote: /^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,
  list: /^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,
  html: '^ {0,3}(?:' // optional indentation
    + '<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)' // (1)
    + '|comment[^\\n]*(\\n+|$)' // (2)
    + '|<\\?[\\s\\S]*?(?:\\?>\\n*|$)' // (3)
    + '|<![A-Z][\\s\\S]*?(?:>\\n*|$)' // (4)
    + '|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)' // (5)
    + '|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (6)
    + '|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (7) open tag
    + '|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (7) closing tag
    + ')',
  def: /^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,
  table: noopTest,
  lheading: /^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,
  // regex template, placeholders will be replaced according to different paragraph
  // interruption rules of commonmark and the original markdown spec:
  _paragraph: /^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,
  text: /^[^\n]+/
};

block._label = /(?!\s*\])(?:\\.|[^\[\]\\])+/;
block._title = /(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;
block.def = edit(block.def)
  .replace('label', block._label)
  .replace('title', block._title)
  .getRegex();

block.bullet = /(?:[*+-]|\d{1,9}[.)])/;
block.listItemStart = edit(/^( *)(bull) */)
  .replace('bull', block.bullet)
  .getRegex();

block.list = edit(block.list)
  .replace(/bull/g, block.bullet)
  .replace('hr', '\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))')
  .replace('def', '\\n+(?=' + block.def.source + ')')
  .getRegex();

block._tag = 'address|article|aside|base|basefont|blockquote|body|caption'
  + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'
  + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'
  + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'
  + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr'
  + '|track|ul';
block._comment = /<!--(?!-?>)[\s\S]*?(?:-->|$)/;
block.html = edit(block.html, 'i')
  .replace('comment', block._comment)
  .replace('tag', block._tag)
  .replace('attribute', / +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/)
  .getRegex();

block.paragraph = edit(block._paragraph)
  .replace('hr', block.hr)
  .replace('heading', ' {0,3}#{1,6} ')
  .replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs
  .replace('|table', '')
  .replace('blockquote', ' {0,3}>')
  .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n')
  .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
  .replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)')
  .replace('tag', block._tag) // pars can be interrupted by type (6) html blocks
  .getRegex();

block.blockquote = edit(block.blockquote)
  .replace('paragraph', block.paragraph)
  .getRegex();

/**
 * Normal Block Grammar
 */

block.normal = merge({}, block);

/**
 * GFM Block Grammar
 */

block.gfm = merge({}, block.normal, {
  table: '^ *([^\\n ].*\\|.*)\\n' // Header
    + ' {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?' // Align
    + '(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)' // Cells
});

block.gfm.table = edit(block.gfm.table)
  .replace('hr', block.hr)
  .replace('heading', ' {0,3}#{1,6} ')
  .replace('blockquote', ' {0,3}>')
  .replace('code', ' {4}[^\\n]')
  .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n')
  .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
  .replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)')
  .replace('tag', block._tag) // tables can be interrupted by type (6) html blocks
  .getRegex();

block.gfm.paragraph = edit(block._paragraph)
  .replace('hr', block.hr)
  .replace('heading', ' {0,3}#{1,6} ')
  .replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs
  .replace('table', block.gfm.table) // interrupt paragraphs with table
  .replace('blockquote', ' {0,3}>')
  .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n')
  .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
  .replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)')
  .replace('tag', block._tag) // pars can be interrupted by type (6) html blocks
  .getRegex();
/**
 * Pedantic grammar (original John Gruber's loose markdown specification)
 */

block.pedantic = merge({}, block.normal, {
  html: edit(
    '^ *(?:comment *(?:\\n|\\s*$)'
    + '|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)' // closed tag
    + '|<tag(?:"[^"]*"|\'[^\']*\'|\\s[^\'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))')
    .replace('comment', block._comment)
    .replace(/tag/g, '(?!(?:'
      + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'
      + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'
      + '\\b)\\w+(?!:|[^\\w\\s@]*@)\\b')
    .getRegex(),
  def: /^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,
  heading: /^(#{1,6})(.*)(?:\n+|$)/,
  fences: noopTest, // fences not supported
  lheading: /^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,
  paragraph: edit(block.normal._paragraph)
    .replace('hr', block.hr)
    .replace('heading', ' *#{1,6} *[^\n]')
    .replace('lheading', block.lheading)
    .replace('blockquote', ' {0,3}>')
    .replace('|fences', '')
    .replace('|list', '')
    .replace('|html', '')
    .getRegex()
});

/**
 * Inline-Level Grammar
 */
const inline = {
  escape: /^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,
  autolink: /^<(scheme:[^\s\x00-\x1f<>]*|email)>/,
  url: noopTest,
  tag: '^comment'
    + '|^</[a-zA-Z][\\w:-]*\\s*>' // self-closing tag
    + '|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>' // open tag
    + '|^<\\?[\\s\\S]*?\\?>' // processing instruction, e.g. <?php ?>
    + '|^<![a-zA-Z]+\\s[\\s\\S]*?>' // declaration, e.g. <!DOCTYPE html>
    + '|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>', // CDATA section
  link: /^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,
  reflink: /^!?\[(label)\]\[(ref)\]/,
  nolink: /^!?\[(ref)\](?:\[\])?/,
  reflinkSearch: 'reflink|nolink(?!\\()',
  emStrong: {
    lDelim: /^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,
    //        (1) and (2) can only be a Right Delimiter. (3) and (4) can only be Left.  (5) and (6) can be either Left or Right.
    //          () Skip orphan inside strong                                      () Consume to delim     (1) #***                (2) a***#, a***                             (3) #***a, ***a                 (4) ***#              (5) #***#                 (6) a***a
    rDelimAst: /^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,
    rDelimUnd: /^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/ // ^- Not allowed for _
  },
  code: /^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,
  br: /^( {2,}|\\)\n(?!\s*$)/,
  del: noopTest,
  text: /^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,
  punctuation: /^([\spunctuation])/
};

// list of punctuation marks from CommonMark spec
// without * and _ to handle the different emphasis markers * and _
inline._punctuation = '!"#$%&\'()+\\-.,/:;<=>?@\\[\\]`^{|}~';
inline.punctuation = edit(inline.punctuation).replace(/punctuation/g, inline._punctuation).getRegex();

// sequences em should skip over [title](link), `code`, <html>
inline.blockSkip = /\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;
// lookbehind is not available on Safari as of version 16
// inline.escapedEmSt = /(?<=(?:^|[^\\)(?:\\[^])*)\\[*_]/g;
inline.escapedEmSt = /(?:^|[^\\])(?:\\\\)*\\[*_]/g;

inline._comment = edit(block._comment).replace('(?:-->|$)', '-->').getRegex();

inline.emStrong.lDelim = edit(inline.emStrong.lDelim)
  .replace(/punct/g, inline._punctuation)
  .getRegex();

inline.emStrong.rDelimAst = edit(inline.emStrong.rDelimAst, 'g')
  .replace(/punct/g, inline._punctuation)
  .getRegex();

inline.emStrong.rDelimUnd = edit(inline.emStrong.rDelimUnd, 'g')
  .replace(/punct/g, inline._punctuation)
  .getRegex();

inline._escapes = /\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;

inline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;
inline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;
inline.autolink = edit(inline.autolink)
  .replace('scheme', inline._scheme)
  .replace('email', inline._email)
  .getRegex();

inline._attribute = /\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;

inline.tag = edit(inline.tag)
  .replace('comment', inline._comment)
  .replace('attribute', inline._attribute)
  .getRegex();

inline._label = /(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;
inline._href = /<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;
inline._title = /"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;

inline.link = edit(inline.link)
  .replace('label', inline._label)
  .replace('href', inline._href)
  .replace('title', inline._title)
  .getRegex();

inline.reflink = edit(inline.reflink)
  .replace('label', inline._label)
  .replace('ref', block._label)
  .getRegex();

inline.nolink = edit(inline.nolink)
  .replace('ref', block._label)
  .getRegex();

inline.reflinkSearch = edit(inline.reflinkSearch, 'g')
  .replace('reflink', inline.reflink)
  .replace('nolink', inline.nolink)
  .getRegex();

/**
 * Normal Inline Grammar
 */

inline.normal = merge({}, inline);

/**
 * Pedantic Inline Grammar
 */

inline.pedantic = merge({}, inline.normal, {
  strong: {
    start: /^__|\*\*/,
    middle: /^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,
    endAst: /\*\*(?!\*)/g,
    endUnd: /__(?!_)/g
  },
  em: {
    start: /^_|\*/,
    middle: /^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,
    endAst: /\*(?!\*)/g,
    endUnd: /_(?!_)/g
  },
  link: edit(/^!?\[(label)\]\((.*?)\)/)
    .replace('label', inline._label)
    .getRegex(),
  reflink: edit(/^!?\[(label)\]\s*\[([^\]]*)\]/)
    .replace('label', inline._label)
    .getRegex()
});

/**
 * GFM Inline Grammar
 */

inline.gfm = merge({}, inline.normal, {
  escape: edit(inline.escape).replace('])', '~|])').getRegex(),
  _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,
  url: /^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,
  _backpedal: /(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,
  del: /^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,
  text: /^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/
});

inline.gfm.url = edit(inline.gfm.url, 'i')
  .replace('email', inline.gfm._extended_email)
  .getRegex();
/**
 * GFM + Line Breaks Inline Grammar
 */

inline.breaks = merge({}, inline.gfm, {
  br: edit(inline.br).replace('{2,}', '*').getRegex(),
  text: edit(inline.gfm.text)
    .replace('\\b_', '\\b_| {2,}\\n')
    .replace(/\{2,\}/g, '*')
    .getRegex()
});

/**
 * smartypants text replacement
 * @param {string} text
 */
function smartypants(text) {
  return text
    // em-dashes
    .replace(/---/g, '\u2014')
    // en-dashes
    .replace(/--/g, '\u2013')
    // opening singles
    .replace(/(^|[-\u2014/(\[{"\s])'/g, '$1\u2018')
    // closing singles & apostrophes
    .replace(/'/g, '\u2019')
    // opening doubles
    .replace(/(^|[-\u2014/(\[{\u2018\s])"/g, '$1\u201c')
    // closing doubles
    .replace(/"/g, '\u201d')
    // ellipses
    .replace(/\.{3}/g, '\u2026');
}

/**
 * mangle email addresses
 * @param {string} text
 */
function mangle(text) {
  let out = '',
    i,
    ch;

  const l = text.length;
  for (i = 0; i < l; i++) {
    ch = text.charCodeAt(i);
    if (Math.random() > 0.5) {
      ch = 'x' + ch.toString(16);
    }
    out += '&#' + ch + ';';
  }

  return out;
}

/**
 * Block Lexer
 */
class Lexer {
  constructor(options) {
    this.tokens = [];
    this.tokens.links = Object.create(null);
    this.options = options || defaults;
    this.options.tokenizer = this.options.tokenizer || new Tokenizer();
    this.tokenizer = this.options.tokenizer;
    this.tokenizer.options = this.options;
    this.tokenizer.lexer = this;
    this.inlineQueue = [];
    this.state = {
      inLink: false,
      inRawBlock: false,
      top: true
    };

    const rules = {
      block: block.normal,
      inline: inline.normal
    };

    if (this.options.pedantic) {
      rules.block = block.pedantic;
      rules.inline = inline.pedantic;
    } else if (this.options.gfm) {
      rules.block = block.gfm;
      if (this.options.breaks) {
        rules.inline = inline.breaks;
      } else {
        rules.inline = inline.gfm;
      }
    }
    this.tokenizer.rules = rules;
  }

  /**
   * Expose Rules
   */
  static get rules() {
    return {
      block,
      inline
    };
  }

  /**
   * Static Lex Method
   */
  static lex(src, options) {
    const lexer = new Lexer(options);
    return lexer.lex(src);
  }

  /**
   * Static Lex Inline Method
   */
  static lexInline(src, options) {
    const lexer = new Lexer(options);
    return lexer.inlineTokens(src);
  }

  /**
   * Preprocessing
   */
  lex(src) {
    src = src
      .replace(/\r\n|\r/g, '\n');

    this.blockTokens(src, this.tokens);

    let next;
    while (next = this.inlineQueue.shift()) {
      this.inlineTokens(next.src, next.tokens);
    }

    return this.tokens;
  }

  /**
   * Lexing
   */
  blockTokens(src, tokens = []) {
    if (this.options.pedantic) {
      src = src.replace(/\t/g, '    ').replace(/^ +$/gm, '');
    } else {
      src = src.replace(/^( *)(\t+)/gm, (_, leading, tabs) => {
        return leading + '    '.repeat(tabs.length);
      });
    }

    let token, lastToken, cutSrc, lastParagraphClipped;

    while (src) {
      if (this.options.extensions
        && this.options.extensions.block
        && this.options.extensions.block.some((extTokenizer) => {
          if (token = extTokenizer.call({ lexer: this }, src, tokens)) {
            src = src.substring(token.raw.length);
            tokens.push(token);
            return true;
          }
          return false;
        })) {
        continue;
      }

      // newline
      if (token = this.tokenizer.space(src)) {
        src = src.substring(token.raw.length);
        if (token.raw.length === 1 && tokens.length > 0) {
          // if there's a single \n as a spacer, it's terminating the last line,
          // so move it there so that we don't get unecessary paragraph tags
          tokens[tokens.length - 1].raw += '\n';
        } else {
          tokens.push(token);
        }
        continue;
      }

      // code
      if (token = this.tokenizer.code(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        // An indented code block cannot interrupt a paragraph.
        if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.text;
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      // fences
      if (token = this.tokenizer.fences(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // heading
      if (token = this.tokenizer.heading(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // hr
      if (token = this.tokenizer.hr(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // blockquote
      if (token = this.tokenizer.blockquote(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // list
      if (token = this.tokenizer.list(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // html
      if (token = this.tokenizer.html(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // def
      if (token = this.tokenizer.def(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.raw;
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else if (!this.tokens.links[token.tag]) {
          this.tokens.links[token.tag] = {
            href: token.href,
            title: token.title
          };
        }
        continue;
      }

      // table (gfm)
      if (token = this.tokenizer.table(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // lheading
      if (token = this.tokenizer.lheading(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // top-level paragraph
      // prevent paragraph consuming extensions by clipping 'src' to extension start
      cutSrc = src;
      if (this.options.extensions && this.options.extensions.startBlock) {
        let startIndex = Infinity;
        const tempSrc = src.slice(1);
        let tempStart;
        this.options.extensions.startBlock.forEach(function(getStartIndex) {
          tempStart = getStartIndex.call({ lexer: this }, tempSrc);
          if (typeof tempStart === 'number' && tempStart >= 0) { startIndex = Math.min(startIndex, tempStart); }
        });
        if (startIndex < Infinity && startIndex >= 0) {
          cutSrc = src.substring(0, startIndex + 1);
        }
      }
      if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {
        lastToken = tokens[tokens.length - 1];
        if (lastParagraphClipped && lastToken.type === 'paragraph') {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.text;
          this.inlineQueue.pop();
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else {
          tokens.push(token);
        }
        lastParagraphClipped = (cutSrc.length !== src.length);
        src = src.substring(token.raw.length);
        continue;
      }

      // text
      if (token = this.tokenizer.text(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && lastToken.type === 'text') {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.text;
          this.inlineQueue.pop();
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      if (src) {
        const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);
        if (this.options.silent) {
          console.error(errMsg);
          break;
        } else {
          throw new Error(errMsg);
        }
      }
    }

    this.state.top = true;
    return tokens;
  }

  inline(src, tokens = []) {
    this.inlineQueue.push({ src, tokens });
    return tokens;
  }

  /**
   * Lexing/Compiling
   */
  inlineTokens(src, tokens = []) {
    let token, lastToken, cutSrc;

    // String with links masked to avoid interference with em and strong
    let maskedSrc = src;
    let match;
    let keepPrevChar, prevChar;

    // Mask out reflinks
    if (this.tokens.links) {
      const links = Object.keys(this.tokens.links);
      if (links.length > 0) {
        while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {
          if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {
            maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);
          }
        }
      }
    }
    // Mask out other blocks
    while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {
      maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);
    }

    // Mask out escaped em & strong delimiters
    while ((match = this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc)) != null) {
      maskedSrc = maskedSrc.slice(0, match.index + match[0].length - 2) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);
      this.tokenizer.rules.inline.escapedEmSt.lastIndex--;
    }

    while (src) {
      if (!keepPrevChar) {
        prevChar = '';
      }
      keepPrevChar = false;

      // extensions
      if (this.options.extensions
        && this.options.extensions.inline
        && this.options.extensions.inline.some((extTokenizer) => {
          if (token = extTokenizer.call({ lexer: this }, src, tokens)) {
            src = src.substring(token.raw.length);
            tokens.push(token);
            return true;
          }
          return false;
        })) {
        continue;
      }

      // escape
      if (token = this.tokenizer.escape(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // tag
      if (token = this.tokenizer.tag(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && token.type === 'text' && lastToken.type === 'text') {
          lastToken.raw += token.raw;
          lastToken.text += token.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      // link
      if (token = this.tokenizer.link(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // reflink, nolink
      if (token = this.tokenizer.reflink(src, this.tokens.links)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && token.type === 'text' && lastToken.type === 'text') {
          lastToken.raw += token.raw;
          lastToken.text += token.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      // em & strong
      if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // code
      if (token = this.tokenizer.codespan(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // br
      if (token = this.tokenizer.br(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // del (gfm)
      if (token = this.tokenizer.del(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // autolink
      if (token = this.tokenizer.autolink(src, mangle)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // url (gfm)
      if (!this.state.inLink && (token = this.tokenizer.url(src, mangle))) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // text
      // prevent inlineText consuming extensions by clipping 'src' to extension start
      cutSrc = src;
      if (this.options.extensions && this.options.extensions.startInline) {
        let startIndex = Infinity;
        const tempSrc = src.slice(1);
        let tempStart;
        this.options.extensions.startInline.forEach(function(getStartIndex) {
          tempStart = getStartIndex.call({ lexer: this }, tempSrc);
          if (typeof tempStart === 'number' && tempStart >= 0) { startIndex = Math.min(startIndex, tempStart); }
        });
        if (startIndex < Infinity && startIndex >= 0) {
          cutSrc = src.substring(0, startIndex + 1);
        }
      }
      if (token = this.tokenizer.inlineText(cutSrc, smartypants)) {
        src = src.substring(token.raw.length);
        if (token.raw.slice(-1) !== '_') { // Track prevChar before string of ____ started
          prevChar = token.raw.slice(-1);
        }
        keepPrevChar = true;
        lastToken = tokens[tokens.length - 1];
        if (lastToken && lastToken.type === 'text') {
          lastToken.raw += token.raw;
          lastToken.text += token.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      if (src) {
        const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);
        if (this.options.silent) {
          console.error(errMsg);
          break;
        } else {
          throw new Error(errMsg);
        }
      }
    }

    return tokens;
  }
}

/**
 * Renderer
 */
class Renderer {
  constructor(options) {
    this.options = options || defaults;
  }

  code(code, infostring, escaped) {
    const lang = (infostring || '').match(/\S*/)[0];
    if (this.options.highlight) {
      const out = this.options.highlight(code, lang);
      if (out != null && out !== code) {
        escaped = true;
        code = out;
      }
    }

    code = code.replace(/\n$/, '') + '\n';

    if (!lang) {
      return '<pre><code>'
        + (escaped ? code : escape(code, true))
        + '</code></pre>\n';
    }

    return '<pre><code class="'
      + this.options.langPrefix
      + escape(lang)
      + '">'
      + (escaped ? code : escape(code, true))
      + '</code></pre>\n';
  }

  /**
   * @param {string} quote
   */
  blockquote(quote) {
    return `<blockquote>\n${quote}</blockquote>\n`;
  }

  html(html) {
    return html;
  }

  /**
   * @param {string} text
   * @param {string} level
   * @param {string} raw
   * @param {any} slugger
   */
  heading(text, level, raw, slugger) {
    if (this.options.headerIds) {
      const id = this.options.headerPrefix + slugger.slug(raw);
      return `<h${level} id="${id}">${text}</h${level}>\n`;
    }

    // ignore IDs
    return `<h${level}>${text}</h${level}>\n`;
  }

  hr() {
    return this.options.xhtml ? '<hr/>\n' : '<hr>\n';
  }

  list(body, ordered, start) {
    const type = ordered ? 'ol' : 'ul',
      startatt = (ordered && start !== 1) ? (' start="' + start + '"') : '';
    return '<' + type + startatt + '>\n' + body + '</' + type + '>\n';
  }

  /**
   * @param {string} text
   */
  listitem(text) {
    return `<li>${text}</li>\n`;
  }

  checkbox(checked) {
    return '<input '
      + (checked ? 'checked="" ' : '')
      + 'disabled="" type="checkbox"'
      + (this.options.xhtml ? ' /' : '')
      + '> ';
  }

  /**
   * @param {string} text
   */
  paragraph(text) {
    return `<p>${text}</p>\n`;
  }

  /**
   * @param {string} header
   * @param {string} body
   */
  table(header, body) {
    if (body) body = `<tbody>${body}</tbody>`;

    return '<table>\n'
      + '<thead>\n'
      + header
      + '</thead>\n'
      + body
      + '</table>\n';
  }

  /**
   * @param {string} content
   */
  tablerow(content) {
    return `<tr>\n${content}</tr>\n`;
  }

  tablecell(content, flags) {
    const type = flags.header ? 'th' : 'td';
    const tag = flags.align
      ? `<${type} align="${flags.align}">`
      : `<${type}>`;
    return tag + content + `</${type}>\n`;
  }

  /**
   * span level renderer
   * @param {string} text
   */
  strong(text) {
    return `<strong>${text}</strong>`;
  }

  /**
   * @param {string} text
   */
  em(text) {
    return `<em>${text}</em>`;
  }

  /**
   * @param {string} text
   */
  codespan(text) {
    return `<code>${text}</code>`;
  }

  br() {
    return this.options.xhtml ? '<br/>' : '<br>';
  }

  /**
   * @param {string} text
   */
  del(text) {
    return `<del>${text}</del>`;
  }

  /**
   * @param {string} href
   * @param {string} title
   * @param {string} text
   */
  link(href, title, text) {
    href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);
    if (href === null) {
      return text;
    }
    let out = '<a href="' + href + '"';
    if (title) {
      out += ' title="' + title + '"';
    }
    out += '>' + text + '</a>';
    return out;
  }

  /**
   * @param {string} href
   * @param {string} title
   * @param {string} text
   */
  image(href, title, text) {
    href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);
    if (href === null) {
      return text;
    }

    let out = `<img src="${href}" alt="${text}"`;
    if (title) {
      out += ` title="${title}"`;
    }
    out += this.options.xhtml ? '/>' : '>';
    return out;
  }

  text(text) {
    return text;
  }
}

/**
 * TextRenderer
 * returns only the textual part of the token
 */
class TextRenderer {
  // no need for block level renderers
  strong(text) {
    return text;
  }

  em(text) {
    return text;
  }

  codespan(text) {
    return text;
  }

  del(text) {
    return text;
  }

  html(text) {
    return text;
  }

  text(text) {
    return text;
  }

  link(href, title, text) {
    return '' + text;
  }

  image(href, title, text) {
    return '' + text;
  }

  br() {
    return '';
  }
}

/**
 * Slugger generates header id
 */
class Slugger {
  constructor() {
    this.seen = {};
  }

  /**
   * @param {string} value
   */
  serialize(value) {
    return value
      .toLowerCase()
      .trim()
      // remove html tags
      .replace(/<[!\/a-z].*?>/ig, '')
      // remove unwanted chars
      .replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g, '')
      .replace(/\s/g, '-');
  }

  /**
   * Finds the next safe (unique) slug to use
   * @param {string} originalSlug
   * @param {boolean} isDryRun
   */
  getNextSafeSlug(originalSlug, isDryRun) {
    let slug = originalSlug;
    let occurenceAccumulator = 0;
    if (this.seen.hasOwnProperty(slug)) {
      occurenceAccumulator = this.seen[originalSlug];
      do {
        occurenceAccumulator++;
        slug = originalSlug + '-' + occurenceAccumulator;
      } while (this.seen.hasOwnProperty(slug));
    }
    if (!isDryRun) {
      this.seen[originalSlug] = occurenceAccumulator;
      this.seen[slug] = 0;
    }
    return slug;
  }

  /**
   * Convert string to unique id
   * @param {object} [options]
   * @param {boolean} [options.dryrun] Generates the next unique slug without
   * updating the internal accumulator.
   */
  slug(value, options = {}) {
    const slug = this.serialize(value);
    return this.getNextSafeSlug(slug, options.dryrun);
  }
}

/**
 * Parsing & Compiling
 */
class Parser {
  constructor(options) {
    this.options = options || defaults;
    this.options.renderer = this.options.renderer || new Renderer();
    this.renderer = this.options.renderer;
    this.renderer.options = this.options;
    this.textRenderer = new TextRenderer();
    this.slugger = new Slugger();
  }

  /**
   * Static Parse Method
   */
  static parse(tokens, options) {
    const parser = new Parser(options);
    return parser.parse(tokens);
  }

  /**
   * Static Parse Inline Method
   */
  static parseInline(tokens, options) {
    const parser = new Parser(options);
    return parser.parseInline(tokens);
  }

  /**
   * Parse Loop
   */
  parse(tokens, top = true) {
    let out = '',
      i,
      j,
      k,
      l2,
      l3,
      row,
      cell,
      header,
      body,
      token,
      ordered,
      start,
      loose,
      itemBody,
      item,
      checked,
      task,
      checkbox,
      ret;

    const l = tokens.length;
    for (i = 0; i < l; i++) {
      token = tokens[i];

      // Run any renderer extensions
      if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {
        ret = this.options.extensions.renderers[token.type].call({ parser: this }, token);
        if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(token.type)) {
          out += ret || '';
          continue;
        }
      }

      switch (token.type) {
        case 'space': {
          continue;
        }
        case 'hr': {
          out += this.renderer.hr();
          continue;
        }
        case 'heading': {
          out += this.renderer.heading(
            this.parseInline(token.tokens),
            token.depth,
            unescape(this.parseInline(token.tokens, this.textRenderer)),
            this.slugger);
          continue;
        }
        case 'code': {
          out += this.renderer.code(token.text,
            token.lang,
            token.escaped);
          continue;
        }
        case 'table': {
          header = '';

          // header
          cell = '';
          l2 = token.header.length;
          for (j = 0; j < l2; j++) {
            cell += this.renderer.tablecell(
              this.parseInline(token.header[j].tokens),
              { header: true, align: token.align[j] }
            );
          }
          header += this.renderer.tablerow(cell);

          body = '';
          l2 = token.rows.length;
          for (j = 0; j < l2; j++) {
            row = token.rows[j];

            cell = '';
            l3 = row.length;
            for (k = 0; k < l3; k++) {
              cell += this.renderer.tablecell(
                this.parseInline(row[k].tokens),
                { header: false, align: token.align[k] }
              );
            }

            body += this.renderer.tablerow(cell);
          }
          out += this.renderer.table(header, body);
          continue;
        }
        case 'blockquote': {
          body = this.parse(token.tokens);
          out += this.renderer.blockquote(body);
          continue;
        }
        case 'list': {
          ordered = token.ordered;
          start = token.start;
          loose = token.loose;
          l2 = token.items.length;

          body = '';
          for (j = 0; j < l2; j++) {
            item = token.items[j];
            checked = item.checked;
            task = item.task;

            itemBody = '';
            if (item.task) {
              checkbox = this.renderer.checkbox(checked);
              if (loose) {
                if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {
                  item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;
                  if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {
                    item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;
                  }
                } else {
                  item.tokens.unshift({
                    type: 'text',
                    text: checkbox
                  });
                }
              } else {
                itemBody += checkbox;
              }
            }

            itemBody += this.parse(item.tokens, loose);
            body += this.renderer.listitem(itemBody, task, checked);
          }

          out += this.renderer.list(body, ordered, start);
          continue;
        }
        case 'html': {
          // TODO parse inline content if parameter markdown=1
          out += this.renderer.html(token.text);
          continue;
        }
        case 'paragraph': {
          out += this.renderer.paragraph(this.parseInline(token.tokens));
          continue;
        }
        case 'text': {
          body = token.tokens ? this.parseInline(token.tokens) : token.text;
          while (i + 1 < l && tokens[i + 1].type === 'text') {
            token = tokens[++i];
            body += '\n' + (token.tokens ? this.parseInline(token.tokens) : token.text);
          }
          out += top ? this.renderer.paragraph(body) : body;
          continue;
        }

        default: {
          const errMsg = 'Token with "' + token.type + '" type was not found.';
          if (this.options.silent) {
            console.error(errMsg);
            return;
          } else {
            throw new Error(errMsg);
          }
        }
      }
    }

    return out;
  }

  /**
   * Parse Inline Tokens
   */
  parseInline(tokens, renderer) {
    renderer = renderer || this.renderer;
    let out = '',
      i,
      token,
      ret;

    const l = tokens.length;
    for (i = 0; i < l; i++) {
      token = tokens[i];

      // Run any renderer extensions
      if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {
        ret = this.options.extensions.renderers[token.type].call({ parser: this }, token);
        if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(token.type)) {
          out += ret || '';
          continue;
        }
      }

      switch (token.type) {
        case 'escape': {
          out += renderer.text(token.text);
          break;
        }
        case 'html': {
          out += renderer.html(token.text);
          break;
        }
        case 'link': {
          out += renderer.link(token.href, token.title, this.parseInline(token.tokens, renderer));
          break;
        }
        case 'image': {
          out += renderer.image(token.href, token.title, token.text);
          break;
        }
        case 'strong': {
          out += renderer.strong(this.parseInline(token.tokens, renderer));
          break;
        }
        case 'em': {
          out += renderer.em(this.parseInline(token.tokens, renderer));
          break;
        }
        case 'codespan': {
          out += renderer.codespan(token.text);
          break;
        }
        case 'br': {
          out += renderer.br();
          break;
        }
        case 'del': {
          out += renderer.del(this.parseInline(token.tokens, renderer));
          break;
        }
        case 'text': {
          out += renderer.text(token.text);
          break;
        }
        default: {
          const errMsg = 'Token with "' + token.type + '" type was not found.';
          if (this.options.silent) {
            console.error(errMsg);
            return;
          } else {
            throw new Error(errMsg);
          }
        }
      }
    }
    return out;
  }
}

/**
 * Marked
 */
function marked(src, opt, callback) {
  // throw error in case of non string input
  if (typeof src === 'undefined' || src === null) {
    throw new Error('marked(): input parameter is undefined or null');
  }
  if (typeof src !== 'string') {
    throw new Error('marked(): input parameter is of type '
      + Object.prototype.toString.call(src) + ', string expected');
  }

  if (typeof opt === 'function') {
    callback = opt;
    opt = null;
  }

  opt = merge({}, marked.defaults, opt || {});
  checkSanitizeDeprecation(opt);

  if (callback) {
    const highlight = opt.highlight;
    let tokens;

    try {
      tokens = Lexer.lex(src, opt);
    } catch (e) {
      return callback(e);
    }

    const done = function(err) {
      let out;

      if (!err) {
        try {
          if (opt.walkTokens) {
            marked.walkTokens(tokens, opt.walkTokens);
          }
          out = Parser.parse(tokens, opt);
        } catch (e) {
          err = e;
        }
      }

      opt.highlight = highlight;

      return err
        ? callback(err)
        : callback(null, out);
    };

    if (!highlight || highlight.length < 3) {
      return done();
    }

    delete opt.highlight;

    if (!tokens.length) return done();

    let pending = 0;
    marked.walkTokens(tokens, function(token) {
      if (token.type === 'code') {
        pending++;
        setTimeout(() => {
          highlight(token.text, token.lang, function(err, code) {
            if (err) {
              return done(err);
            }
            if (code != null && code !== token.text) {
              token.text = code;
              token.escaped = true;
            }

            pending--;
            if (pending === 0) {
              done();
            }
          });
        }, 0);
      }
    });

    if (pending === 0) {
      done();
    }

    return;
  }

  function onError(e) {
    e.message += '\nPlease report this to https://github.com/markedjs/marked.';
    if (opt.silent) {
      return '<p>An error occurred:</p><pre>'
        + escape(e.message + '', true)
        + '</pre>';
    }
    throw e;
  }

  try {
    const tokens = Lexer.lex(src, opt);
    if (opt.walkTokens) {
      if (opt.async) {
        return Promise.all(marked.walkTokens(tokens, opt.walkTokens))
          .then(() => {
            return Parser.parse(tokens, opt);
          })
          .catch(onError);
      }
      marked.walkTokens(tokens, opt.walkTokens);
    }
    return Parser.parse(tokens, opt);
  } catch (e) {
    onError(e);
  }
}

/**
 * Options
 */

marked.options =
marked.setOptions = function(opt) {
  merge(marked.defaults, opt);
  changeDefaults(marked.defaults);
  return marked;
};

marked.getDefaults = getDefaults;

marked.defaults = defaults;

/**
 * Use Extension
 */

marked.use = function(...args) {
  const extensions = marked.defaults.extensions || { renderers: {}, childTokens: {} };

  args.forEach((pack) => {
    // copy options to new object
    const opts = merge({}, pack);

    // set async to true if it was set to true before
    opts.async = marked.defaults.async || opts.async;

    // ==-- Parse "addon" extensions --== //
    if (pack.extensions) {
      pack.extensions.forEach((ext) => {
        if (!ext.name) {
          throw new Error('extension name required');
        }
        if (ext.renderer) { // Renderer extensions
          const prevRenderer = extensions.renderers[ext.name];
          if (prevRenderer) {
            // Replace extension with func to run new extension but fall back if false
            extensions.renderers[ext.name] = function(...args) {
              let ret = ext.renderer.apply(this, args);
              if (ret === false) {
                ret = prevRenderer.apply(this, args);
              }
              return ret;
            };
          } else {
            extensions.renderers[ext.name] = ext.renderer;
          }
        }
        if (ext.tokenizer) { // Tokenizer Extensions
          if (!ext.level || (ext.level !== 'block' && ext.level !== 'inline')) {
            throw new Error("extension level must be 'block' or 'inline'");
          }
          if (extensions[ext.level]) {
            extensions[ext.level].unshift(ext.tokenizer);
          } else {
            extensions[ext.level] = [ext.tokenizer];
          }
          if (ext.start) { // Function to check for start of token
            if (ext.level === 'block') {
              if (extensions.startBlock) {
                extensions.startBlock.push(ext.start);
              } else {
                extensions.startBlock = [ext.start];
              }
            } else if (ext.level === 'inline') {
              if (extensions.startInline) {
                extensions.startInline.push(ext.start);
              } else {
                extensions.startInline = [ext.start];
              }
            }
          }
        }
        if (ext.childTokens) { // Child tokens to be visited by walkTokens
          extensions.childTokens[ext.name] = ext.childTokens;
        }
      });
      opts.extensions = extensions;
    }

    // ==-- Parse "overwrite" extensions --== //
    if (pack.renderer) {
      const renderer = marked.defaults.renderer || new Renderer();
      for (const prop in pack.renderer) {
        const prevRenderer = renderer[prop];
        // Replace renderer with func to run extension, but fall back if false
        renderer[prop] = (...args) => {
          let ret = pack.renderer[prop].apply(renderer, args);
          if (ret === false) {
            ret = prevRenderer.apply(renderer, args);
          }
          return ret;
        };
      }
      opts.renderer = renderer;
    }
    if (pack.tokenizer) {
      const tokenizer = marked.defaults.tokenizer || new Tokenizer();
      for (const prop in pack.tokenizer) {
        const prevTokenizer = tokenizer[prop];
        // Replace tokenizer with func to run extension, but fall back if false
        tokenizer[prop] = (...args) => {
          let ret = pack.tokenizer[prop].apply(tokenizer, args);
          if (ret === false) {
            ret = prevTokenizer.apply(tokenizer, args);
          }
          return ret;
        };
      }
      opts.tokenizer = tokenizer;
    }

    // ==-- Parse WalkTokens extensions --== //
    if (pack.walkTokens) {
      const walkTokens = marked.defaults.walkTokens;
      opts.walkTokens = function(token) {
        let values = [];
        values.push(pack.walkTokens.call(this, token));
        if (walkTokens) {
          values = values.concat(walkTokens.call(this, token));
        }
        return values;
      };
    }

    marked.setOptions(opts);
  });
};

/**
 * Run callback for every token
 */

marked.walkTokens = function(tokens, callback) {
  let values = [];
  for (const token of tokens) {
    values = values.concat(callback.call(marked, token));
    switch (token.type) {
      case 'table': {
        for (const cell of token.header) {
          values = values.concat(marked.walkTokens(cell.tokens, callback));
        }
        for (const row of token.rows) {
          for (const cell of row) {
            values = values.concat(marked.walkTokens(cell.tokens, callback));
          }
        }
        break;
      }
      case 'list': {
        values = values.concat(marked.walkTokens(token.items, callback));
        break;
      }
      default: {
        if (marked.defaults.extensions && marked.defaults.extensions.childTokens && marked.defaults.extensions.childTokens[token.type]) { // Walk any extensions
          marked.defaults.extensions.childTokens[token.type].forEach(function(childTokens) {
            values = values.concat(marked.walkTokens(token[childTokens], callback));
          });
        } else if (token.tokens) {
          values = values.concat(marked.walkTokens(token.tokens, callback));
        }
      }
    }
  }
  return values;
};

/**
 * Parse Inline
 * @param {string} src
 */
marked.parseInline = function(src, opt) {
  // throw error in case of non string input
  if (typeof src === 'undefined' || src === null) {
    throw new Error('marked.parseInline(): input parameter is undefined or null');
  }
  if (typeof src !== 'string') {
    throw new Error('marked.parseInline(): input parameter is of type '
      + Object.prototype.toString.call(src) + ', string expected');
  }

  opt = merge({}, marked.defaults, opt || {});
  checkSanitizeDeprecation(opt);

  try {
    const tokens = Lexer.lexInline(src, opt);
    if (opt.walkTokens) {
      marked.walkTokens(tokens, opt.walkTokens);
    }
    return Parser.parseInline(tokens, opt);
  } catch (e) {
    e.message += '\nPlease report this to https://github.com/markedjs/marked.';
    if (opt.silent) {
      return '<p>An error occurred:</p><pre>'
        + escape(e.message + '', true)
        + '</pre>';
    }
    throw e;
  }
};

/**
 * Expose
 */
marked.Parser = Parser;
marked.parser = Parser.parse;
marked.Renderer = Renderer;
marked.TextRenderer = TextRenderer;
marked.Lexer = Lexer;
marked.lexer = Lexer.lex;
marked.Tokenizer = Tokenizer;
marked.Slugger = Slugger;
marked.parse = marked;

const options = marked.options;
const setOptions = marked.setOptions;
const use = marked.use;
const walkTokens = marked.walkTokens;
const parseInline = marked.parseInline;
const parse = marked;
const parser = Parser.parse;
const lexer = Lexer.lex;

export { Lexer, Parser, Renderer, Slugger, TextRenderer, Tokenizer, defaults, getDefaults, lexer, marked, options, parse, parseInline, parser, setOptions, use, walkTokens };

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/lib/marked.umd.js #######

```

/**
 * marked - a markdown parser
 * Copyright (c) 2011-2022, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/markedjs/marked
 */

/**
 * DO NOT EDIT THIS FILE
 * The code in this file is generated from files in ./src/
 */

(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
  typeof define === 'function' && define.amd ? define(['exports'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.marked = {}));
})(this, (function (exports) { 'use strict';

  function _defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);
    }
  }
  function _createClass(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties(Constructor, staticProps);
    Object.defineProperty(Constructor, "prototype", {
      writable: false
    });
    return Constructor;
  }
  function _unsupportedIterableToArray(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
  }
  function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length) len = arr.length;
    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];
    return arr2;
  }
  function _createForOfIteratorHelperLoose(o, allowArrayLike) {
    var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"];
    if (it) return (it = it.call(o)).next.bind(it);
    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {
      if (it) o = it;
      var i = 0;
      return function () {
        if (i >= o.length) return {
          done: true
        };
        return {
          done: false,
          value: o[i++]
        };
      };
    }
    throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }
  function _toPrimitive(input, hint) {
    if (typeof input !== "object" || input === null) return input;
    var prim = input[Symbol.toPrimitive];
    if (prim !== undefined) {
      var res = prim.call(input, hint || "default");
      if (typeof res !== "object") return res;
      throw new TypeError("@@toPrimitive must return a primitive value.");
    }
    return (hint === "string" ? String : Number)(input);
  }
  function _toPropertyKey(arg) {
    var key = _toPrimitive(arg, "string");
    return typeof key === "symbol" ? key : String(key);
  }

  function getDefaults() {
    return {
      async: false,
      baseUrl: null,
      breaks: false,
      extensions: null,
      gfm: true,
      headerIds: true,
      headerPrefix: '',
      highlight: null,
      langPrefix: 'language-',
      mangle: true,
      pedantic: false,
      renderer: null,
      sanitize: false,
      sanitizer: null,
      silent: false,
      smartypants: false,
      tokenizer: null,
      walkTokens: null,
      xhtml: false
    };
  }
  exports.defaults = getDefaults();
  function changeDefaults(newDefaults) {
    exports.defaults = newDefaults;
  }

  /**
   * Helpers
   */
  var escapeTest = /[&<>"']/;
  var escapeReplace = new RegExp(escapeTest.source, 'g');
  var escapeTestNoEncode = /[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/;
  var escapeReplaceNoEncode = new RegExp(escapeTestNoEncode.source, 'g');
  var escapeReplacements = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;'
  };
  var getEscapeReplacement = function getEscapeReplacement(ch) {
    return escapeReplacements[ch];
  };
  function escape(html, encode) {
    if (encode) {
      if (escapeTest.test(html)) {
        return html.replace(escapeReplace, getEscapeReplacement);
      }
    } else {
      if (escapeTestNoEncode.test(html)) {
        return html.replace(escapeReplaceNoEncode, getEscapeReplacement);
      }
    }
    return html;
  }
  var unescapeTest = /&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;

  /**
   * @param {string} html
   */
  function unescape(html) {
    // explicitly match decimal, hex, and named HTML entities
    return html.replace(unescapeTest, function (_, n) {
      n = n.toLowerCase();
      if (n === 'colon') return ':';
      if (n.charAt(0) === '#') {
        return n.charAt(1) === 'x' ? String.fromCharCode(parseInt(n.substring(2), 16)) : String.fromCharCode(+n.substring(1));
      }
      return '';
    });
  }
  var caret = /(^|[^\[])\^/g;

  /**
   * @param {string | RegExp} regex
   * @param {string} opt
   */
  function edit(regex, opt) {
    regex = typeof regex === 'string' ? regex : regex.source;
    opt = opt || '';
    var obj = {
      replace: function replace(name, val) {
        val = val.source || val;
        val = val.replace(caret, '$1');
        regex = regex.replace(name, val);
        return obj;
      },
      getRegex: function getRegex() {
        return new RegExp(regex, opt);
      }
    };
    return obj;
  }
  var nonWordAndColonTest = /[^\w:]/g;
  var originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;

  /**
   * @param {boolean} sanitize
   * @param {string} base
   * @param {string} href
   */
  function cleanUrl(sanitize, base, href) {
    if (sanitize) {
      var prot;
      try {
        prot = decodeURIComponent(unescape(href)).replace(nonWordAndColonTest, '').toLowerCase();
      } catch (e) {
        return null;
      }
      if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0 || prot.indexOf('data:') === 0) {
        return null;
      }
    }
    if (base && !originIndependentUrl.test(href)) {
      href = resolveUrl(base, href);
    }
    try {
      href = encodeURI(href).replace(/%25/g, '%');
    } catch (e) {
      return null;
    }
    return href;
  }
  var baseUrls = {};
  var justDomain = /^[^:]+:\/*[^/]*$/;
  var protocol = /^([^:]+:)[\s\S]*$/;
  var domain = /^([^:]+:\/*[^/]*)[\s\S]*$/;

  /**
   * @param {string} base
   * @param {string} href
   */
  function resolveUrl(base, href) {
    if (!baseUrls[' ' + base]) {
      // we can ignore everything in base after the last slash of its path component,
      // but we might need to add _that_
      // https://tools.ietf.org/html/rfc3986#section-3
      if (justDomain.test(base)) {
        baseUrls[' ' + base] = base + '/';
      } else {
        baseUrls[' ' + base] = rtrim(base, '/', true);
      }
    }
    base = baseUrls[' ' + base];
    var relativeBase = base.indexOf(':') === -1;
    if (href.substring(0, 2) === '//') {
      if (relativeBase) {
        return href;
      }
      return base.replace(protocol, '$1') + href;
    } else if (href.charAt(0) === '/') {
      if (relativeBase) {
        return href;
      }
      return base.replace(domain, '$1') + href;
    } else {
      return base + href;
    }
  }
  var noopTest = {
    exec: function noopTest() {}
  };
  function merge(obj) {
    var i = 1,
      target,
      key;
    for (; i < arguments.length; i++) {
      target = arguments[i];
      for (key in target) {
        if (Object.prototype.hasOwnProperty.call(target, key)) {
          obj[key] = target[key];
        }
      }
    }
    return obj;
  }
  function splitCells(tableRow, count) {
    // ensure that every cell-delimiting pipe has a space
    // before it to distinguish it from an escaped pipe
    var row = tableRow.replace(/\|/g, function (match, offset, str) {
        var escaped = false,
          curr = offset;
        while (--curr >= 0 && str[curr] === '\\') {
          escaped = !escaped;
        }
        if (escaped) {
          // odd number of slashes means | is escaped
          // so we leave it alone
          return '|';
        } else {
          // add space before unescaped |
          return ' |';
        }
      }),
      cells = row.split(/ \|/);
    var i = 0;

    // First/last cell in a row cannot be empty if it has no leading/trailing pipe
    if (!cells[0].trim()) {
      cells.shift();
    }
    if (cells.length > 0 && !cells[cells.length - 1].trim()) {
      cells.pop();
    }
    if (cells.length > count) {
      cells.splice(count);
    } else {
      while (cells.length < count) {
        cells.push('');
      }
    }
    for (; i < cells.length; i++) {
      // leading or trailing whitespace is ignored per the gfm spec
      cells[i] = cells[i].trim().replace(/\\\|/g, '|');
    }
    return cells;
  }

  /**
   * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').
   * /c*$/ is vulnerable to REDOS.
   *
   * @param {string} str
   * @param {string} c
   * @param {boolean} invert Remove suffix of non-c chars instead. Default falsey.
   */
  function rtrim(str, c, invert) {
    var l = str.length;
    if (l === 0) {
      return '';
    }

    // Length of suffix matching the invert condition.
    var suffLen = 0;

    // Step left until we fail to match the invert condition.
    while (suffLen < l) {
      var currChar = str.charAt(l - suffLen - 1);
      if (currChar === c && !invert) {
        suffLen++;
      } else if (currChar !== c && invert) {
        suffLen++;
      } else {
        break;
      }
    }
    return str.slice(0, l - suffLen);
  }
  function findClosingBracket(str, b) {
    if (str.indexOf(b[1]) === -1) {
      return -1;
    }
    var l = str.length;
    var level = 0,
      i = 0;
    for (; i < l; i++) {
      if (str[i] === '\\') {
        i++;
      } else if (str[i] === b[0]) {
        level++;
      } else if (str[i] === b[1]) {
        level--;
        if (level < 0) {
          return i;
        }
      }
    }
    return -1;
  }
  function checkSanitizeDeprecation(opt) {
    if (opt && opt.sanitize && !opt.silent) {
      console.warn('marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options');
    }
  }

  // copied from https://stackoverflow.com/a/5450113/806777
  /**
   * @param {string} pattern
   * @param {number} count
   */
  function repeatString(pattern, count) {
    if (count < 1) {
      return '';
    }
    var result = '';
    while (count > 1) {
      if (count & 1) {
        result += pattern;
      }
      count >>= 1;
      pattern += pattern;
    }
    return result + pattern;
  }

  function outputLink(cap, link, raw, lexer) {
    var href = link.href;
    var title = link.title ? escape(link.title) : null;
    var text = cap[1].replace(/\\([\[\]])/g, '$1');
    if (cap[0].charAt(0) !== '!') {
      lexer.state.inLink = true;
      var token = {
        type: 'link',
        raw: raw,
        href: href,
        title: title,
        text: text,
        tokens: lexer.inlineTokens(text)
      };
      lexer.state.inLink = false;
      return token;
    }
    return {
      type: 'image',
      raw: raw,
      href: href,
      title: title,
      text: escape(text)
    };
  }
  function indentCodeCompensation(raw, text) {
    var matchIndentToCode = raw.match(/^(\s+)(?:```)/);
    if (matchIndentToCode === null) {
      return text;
    }
    var indentToCode = matchIndentToCode[1];
    return text.split('\n').map(function (node) {
      var matchIndentInNode = node.match(/^\s+/);
      if (matchIndentInNode === null) {
        return node;
      }
      var indentInNode = matchIndentInNode[0];
      if (indentInNode.length >= indentToCode.length) {
        return node.slice(indentToCode.length);
      }
      return node;
    }).join('\n');
  }

  /**
   * Tokenizer
   */
  var Tokenizer = /*#__PURE__*/function () {
    function Tokenizer(options) {
      this.options = options || exports.defaults;
    }
    var _proto = Tokenizer.prototype;
    _proto.space = function space(src) {
      var cap = this.rules.block.newline.exec(src);
      if (cap && cap[0].length > 0) {
        return {
          type: 'space',
          raw: cap[0]
        };
      }
    };
    _proto.code = function code(src) {
      var cap = this.rules.block.code.exec(src);
      if (cap) {
        var text = cap[0].replace(/^ {1,4}/gm, '');
        return {
          type: 'code',
          raw: cap[0],
          codeBlockStyle: 'indented',
          text: !this.options.pedantic ? rtrim(text, '\n') : text
        };
      }
    };
    _proto.fences = function fences(src) {
      var cap = this.rules.block.fences.exec(src);
      if (cap) {
        var raw = cap[0];
        var text = indentCodeCompensation(raw, cap[3] || '');
        return {
          type: 'code',
          raw: raw,
          lang: cap[2] ? cap[2].trim().replace(this.rules.inline._escapes, '$1') : cap[2],
          text: text
        };
      }
    };
    _proto.heading = function heading(src) {
      var cap = this.rules.block.heading.exec(src);
      if (cap) {
        var text = cap[2].trim();

        // remove trailing #s
        if (/#$/.test(text)) {
          var trimmed = rtrim(text, '#');
          if (this.options.pedantic) {
            text = trimmed.trim();
          } else if (!trimmed || / $/.test(trimmed)) {
            // CommonMark requires space before trailing #s
            text = trimmed.trim();
          }
        }
        return {
          type: 'heading',
          raw: cap[0],
          depth: cap[1].length,
          text: text,
          tokens: this.lexer.inline(text)
        };
      }
    };
    _proto.hr = function hr(src) {
      var cap = this.rules.block.hr.exec(src);
      if (cap) {
        return {
          type: 'hr',
          raw: cap[0]
        };
      }
    };
    _proto.blockquote = function blockquote(src) {
      var cap = this.rules.block.blockquote.exec(src);
      if (cap) {
        var text = cap[0].replace(/^ *>[ \t]?/gm, '');
        var top = this.lexer.state.top;
        this.lexer.state.top = true;
        var tokens = this.lexer.blockTokens(text);
        this.lexer.state.top = top;
        return {
          type: 'blockquote',
          raw: cap[0],
          tokens: tokens,
          text: text
        };
      }
    };
    _proto.list = function list(src) {
      var cap = this.rules.block.list.exec(src);
      if (cap) {
        var raw, istask, ischecked, indent, i, blankLine, endsWithBlankLine, line, nextLine, rawLine, itemContents, endEarly;
        var bull = cap[1].trim();
        var isordered = bull.length > 1;
        var list = {
          type: 'list',
          raw: '',
          ordered: isordered,
          start: isordered ? +bull.slice(0, -1) : '',
          loose: false,
          items: []
        };
        bull = isordered ? "\\d{1,9}\\" + bull.slice(-1) : "\\" + bull;
        if (this.options.pedantic) {
          bull = isordered ? bull : '[*+-]';
        }

        // Get next list item
        var itemRegex = new RegExp("^( {0,3}" + bull + ")((?:[\t ][^\\n]*)?(?:\\n|$))");

        // Check if current bullet point can start a new List Item
        while (src) {
          endEarly = false;
          if (!(cap = itemRegex.exec(src))) {
            break;
          }
          if (this.rules.block.hr.test(src)) {
            // End list if bullet was actually HR (possibly move into itemRegex?)
            break;
          }
          raw = cap[0];
          src = src.substring(raw.length);
          line = cap[2].split('\n', 1)[0].replace(/^\t+/, function (t) {
            return ' '.repeat(3 * t.length);
          });
          nextLine = src.split('\n', 1)[0];
          if (this.options.pedantic) {
            indent = 2;
            itemContents = line.trimLeft();
          } else {
            indent = cap[2].search(/[^ ]/); // Find first non-space char
            indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent
            itemContents = line.slice(indent);
            indent += cap[1].length;
          }
          blankLine = false;
          if (!line && /^ *$/.test(nextLine)) {
            // Items begin with at most one blank line
            raw += nextLine + '\n';
            src = src.substring(nextLine.length + 1);
            endEarly = true;
          }
          if (!endEarly) {
            var nextBulletRegex = new RegExp("^ {0," + Math.min(3, indent - 1) + "}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))");
            var hrRegex = new RegExp("^ {0," + Math.min(3, indent - 1) + "}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)");
            var fencesBeginRegex = new RegExp("^ {0," + Math.min(3, indent - 1) + "}(?:```|~~~)");
            var headingBeginRegex = new RegExp("^ {0," + Math.min(3, indent - 1) + "}#");

            // Check if following lines should be included in List Item
            while (src) {
              rawLine = src.split('\n', 1)[0];
              nextLine = rawLine;

              // Re-align to follow commonmark nesting rules
              if (this.options.pedantic) {
                nextLine = nextLine.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');
              }

              // End list item if found code fences
              if (fencesBeginRegex.test(nextLine)) {
                break;
              }

              // End list item if found start of new heading
              if (headingBeginRegex.test(nextLine)) {
                break;
              }

              // End list item if found start of new bullet
              if (nextBulletRegex.test(nextLine)) {
                break;
              }

              // Horizontal rule found
              if (hrRegex.test(src)) {
                break;
              }
              if (nextLine.search(/[^ ]/) >= indent || !nextLine.trim()) {
                // Dedent if possible
                itemContents += '\n' + nextLine.slice(indent);
              } else {
                // not enough indentation
                if (blankLine) {
                  break;
                }

                // paragraph continuation unless last line was a different block level element
                if (line.search(/[^ ]/) >= 4) {
                  // indented code block
                  break;
                }
                if (fencesBeginRegex.test(line)) {
                  break;
                }
                if (headingBeginRegex.test(line)) {
                  break;
                }
                if (hrRegex.test(line)) {
                  break;
                }
                itemContents += '\n' + nextLine;
              }
              if (!blankLine && !nextLine.trim()) {
                // Check if current line is blank
                blankLine = true;
              }
              raw += rawLine + '\n';
              src = src.substring(rawLine.length + 1);
              line = nextLine.slice(indent);
            }
          }
          if (!list.loose) {
            // If the previous item ended with a blank line, the list is loose
            if (endsWithBlankLine) {
              list.loose = true;
            } else if (/\n *\n *$/.test(raw)) {
              endsWithBlankLine = true;
            }
          }

          // Check for task list items
          if (this.options.gfm) {
            istask = /^\[[ xX]\] /.exec(itemContents);
            if (istask) {
              ischecked = istask[0] !== '[ ] ';
              itemContents = itemContents.replace(/^\[[ xX]\] +/, '');
            }
          }
          list.items.push({
            type: 'list_item',
            raw: raw,
            task: !!istask,
            checked: ischecked,
            loose: false,
            text: itemContents
          });
          list.raw += raw;
        }

        // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic
        list.items[list.items.length - 1].raw = raw.trimRight();
        list.items[list.items.length - 1].text = itemContents.trimRight();
        list.raw = list.raw.trimRight();
        var l = list.items.length;

        // Item child tokens handled here at end because we needed to have the final item to trim it first
        for (i = 0; i < l; i++) {
          this.lexer.state.top = false;
          list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);
          if (!list.loose) {
            // Check if list should be loose
            var spacers = list.items[i].tokens.filter(function (t) {
              return t.type === 'space';
            });
            var hasMultipleLineBreaks = spacers.length > 0 && spacers.some(function (t) {
              return /\n.*\n/.test(t.raw);
            });
            list.loose = hasMultipleLineBreaks;
          }
        }

        // Set all items to loose if list is loose
        if (list.loose) {
          for (i = 0; i < l; i++) {
            list.items[i].loose = true;
          }
        }
        return list;
      }
    };
    _proto.html = function html(src) {
      var cap = this.rules.block.html.exec(src);
      if (cap) {
        var token = {
          type: 'html',
          raw: cap[0],
          pre: !this.options.sanitizer && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),
          text: cap[0]
        };
        if (this.options.sanitize) {
          var text = this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]);
          token.type = 'paragraph';
          token.text = text;
          token.tokens = this.lexer.inline(text);
        }
        return token;
      }
    };
    _proto.def = function def(src) {
      var cap = this.rules.block.def.exec(src);
      if (cap) {
        var tag = cap[1].toLowerCase().replace(/\s+/g, ' ');
        var href = cap[2] ? cap[2].replace(/^<(.*)>$/, '$1').replace(this.rules.inline._escapes, '$1') : '';
        var title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline._escapes, '$1') : cap[3];
        return {
          type: 'def',
          tag: tag,
          raw: cap[0],
          href: href,
          title: title
        };
      }
    };
    _proto.table = function table(src) {
      var cap = this.rules.block.table.exec(src);
      if (cap) {
        var item = {
          type: 'table',
          header: splitCells(cap[1]).map(function (c) {
            return {
              text: c
            };
          }),
          align: cap[2].replace(/^ *|\| *$/g, '').split(/ *\| */),
          rows: cap[3] && cap[3].trim() ? cap[3].replace(/\n[ \t]*$/, '').split('\n') : []
        };
        if (item.header.length === item.align.length) {
          item.raw = cap[0];
          var l = item.align.length;
          var i, j, k, row;
          for (i = 0; i < l; i++) {
            if (/^ *-+: *$/.test(item.align[i])) {
              item.align[i] = 'right';
            } else if (/^ *:-+: *$/.test(item.align[i])) {
              item.align[i] = 'center';
            } else if (/^ *:-+ *$/.test(item.align[i])) {
              item.align[i] = 'left';
            } else {
              item.align[i] = null;
            }
          }
          l = item.rows.length;
          for (i = 0; i < l; i++) {
            item.rows[i] = splitCells(item.rows[i], item.header.length).map(function (c) {
              return {
                text: c
              };
            });
          }

          // parse child tokens inside headers and cells

          // header child tokens
          l = item.header.length;
          for (j = 0; j < l; j++) {
            item.header[j].tokens = this.lexer.inline(item.header[j].text);
          }

          // cell child tokens
          l = item.rows.length;
          for (j = 0; j < l; j++) {
            row = item.rows[j];
            for (k = 0; k < row.length; k++) {
              row[k].tokens = this.lexer.inline(row[k].text);
            }
          }
          return item;
        }
      }
    };
    _proto.lheading = function lheading(src) {
      var cap = this.rules.block.lheading.exec(src);
      if (cap) {
        return {
          type: 'heading',
          raw: cap[0],
          depth: cap[2].charAt(0) === '=' ? 1 : 2,
          text: cap[1],
          tokens: this.lexer.inline(cap[1])
        };
      }
    };
    _proto.paragraph = function paragraph(src) {
      var cap = this.rules.block.paragraph.exec(src);
      if (cap) {
        var text = cap[1].charAt(cap[1].length - 1) === '\n' ? cap[1].slice(0, -1) : cap[1];
        return {
          type: 'paragraph',
          raw: cap[0],
          text: text,
          tokens: this.lexer.inline(text)
        };
      }
    };
    _proto.text = function text(src) {
      var cap = this.rules.block.text.exec(src);
      if (cap) {
        return {
          type: 'text',
          raw: cap[0],
          text: cap[0],
          tokens: this.lexer.inline(cap[0])
        };
      }
    };
    _proto.escape = function escape$1(src) {
      var cap = this.rules.inline.escape.exec(src);
      if (cap) {
        return {
          type: 'escape',
          raw: cap[0],
          text: escape(cap[1])
        };
      }
    };
    _proto.tag = function tag(src) {
      var cap = this.rules.inline.tag.exec(src);
      if (cap) {
        if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {
          this.lexer.state.inLink = true;
        } else if (this.lexer.state.inLink && /^<\/a>/i.test(cap[0])) {
          this.lexer.state.inLink = false;
        }
        if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\s|>)/i.test(cap[0])) {
          this.lexer.state.inRawBlock = true;
        } else if (this.lexer.state.inRawBlock && /^<\/(pre|code|kbd|script)(\s|>)/i.test(cap[0])) {
          this.lexer.state.inRawBlock = false;
        }
        return {
          type: this.options.sanitize ? 'text' : 'html',
          raw: cap[0],
          inLink: this.lexer.state.inLink,
          inRawBlock: this.lexer.state.inRawBlock,
          text: this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0]
        };
      }
    };
    _proto.link = function link(src) {
      var cap = this.rules.inline.link.exec(src);
      if (cap) {
        var trimmedUrl = cap[2].trim();
        if (!this.options.pedantic && /^</.test(trimmedUrl)) {
          // commonmark requires matching angle brackets
          if (!/>$/.test(trimmedUrl)) {
            return;
          }

          // ending angle bracket cannot be escaped
          var rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\');
          if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {
            return;
          }
        } else {
          // find closing parenthesis
          var lastParenIndex = findClosingBracket(cap[2], '()');
          if (lastParenIndex > -1) {
            var start = cap[0].indexOf('!') === 0 ? 5 : 4;
            var linkLen = start + cap[1].length + lastParenIndex;
            cap[2] = cap[2].substring(0, lastParenIndex);
            cap[0] = cap[0].substring(0, linkLen).trim();
            cap[3] = '';
          }
        }
        var href = cap[2];
        var title = '';
        if (this.options.pedantic) {
          // split pedantic href and title
          var link = /^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(href);
          if (link) {
            href = link[1];
            title = link[3];
          }
        } else {
          title = cap[3] ? cap[3].slice(1, -1) : '';
        }
        href = href.trim();
        if (/^</.test(href)) {
          if (this.options.pedantic && !/>$/.test(trimmedUrl)) {
            // pedantic allows starting angle bracket without ending angle bracket
            href = href.slice(1);
          } else {
            href = href.slice(1, -1);
          }
        }
        return outputLink(cap, {
          href: href ? href.replace(this.rules.inline._escapes, '$1') : href,
          title: title ? title.replace(this.rules.inline._escapes, '$1') : title
        }, cap[0], this.lexer);
      }
    };
    _proto.reflink = function reflink(src, links) {
      var cap;
      if ((cap = this.rules.inline.reflink.exec(src)) || (cap = this.rules.inline.nolink.exec(src))) {
        var link = (cap[2] || cap[1]).replace(/\s+/g, ' ');
        link = links[link.toLowerCase()];
        if (!link) {
          var text = cap[0].charAt(0);
          return {
            type: 'text',
            raw: text,
            text: text
          };
        }
        return outputLink(cap, link, cap[0], this.lexer);
      }
    };
    _proto.emStrong = function emStrong(src, maskedSrc, prevChar) {
      if (prevChar === void 0) {
        prevChar = '';
      }
      var match = this.rules.inline.emStrong.lDelim.exec(src);
      if (!match) return;

      // _ can't be between two alphanumerics. \p{L}\p{N} includes non-english alphabet/numbers as well
      if (match[3] && prevChar.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/)) return;
      var nextChar = match[1] || match[2] || '';
      if (!nextChar || nextChar && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar))) {
        var lLength = match[0].length - 1;
        var rDelim,
          rLength,
          delimTotal = lLength,
          midDelimTotal = 0;
        var endReg = match[0][0] === '*' ? this.rules.inline.emStrong.rDelimAst : this.rules.inline.emStrong.rDelimUnd;
        endReg.lastIndex = 0;

        // Clip maskedSrc to same section of string as src (move to lexer?)
        maskedSrc = maskedSrc.slice(-1 * src.length + lLength);
        while ((match = endReg.exec(maskedSrc)) != null) {
          rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];
          if (!rDelim) continue; // skip single * in __abc*abc__

          rLength = rDelim.length;
          if (match[3] || match[4]) {
            // found another Left Delim
            delimTotal += rLength;
            continue;
          } else if (match[5] || match[6]) {
            // either Left or Right Delim
            if (lLength % 3 && !((lLength + rLength) % 3)) {
              midDelimTotal += rLength;
              continue; // CommonMark Emphasis Rules 9-10
            }
          }

          delimTotal -= rLength;
          if (delimTotal > 0) continue; // Haven't found enough closing delimiters

          // Remove extra characters. *a*** -> *a*
          rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);
          var raw = src.slice(0, lLength + match.index + (match[0].length - rDelim.length) + rLength);

          // Create `em` if smallest delimiter has odd char count. *a***
          if (Math.min(lLength, rLength) % 2) {
            var _text = raw.slice(1, -1);
            return {
              type: 'em',
              raw: raw,
              text: _text,
              tokens: this.lexer.inlineTokens(_text)
            };
          }

          // Create 'strong' if smallest delimiter has even char count. **a***
          var text = raw.slice(2, -2);
          return {
            type: 'strong',
            raw: raw,
            text: text,
            tokens: this.lexer.inlineTokens(text)
          };
        }
      }
    };
    _proto.codespan = function codespan(src) {
      var cap = this.rules.inline.code.exec(src);
      if (cap) {
        var text = cap[2].replace(/\n/g, ' ');
        var hasNonSpaceChars = /[^ ]/.test(text);
        var hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);
        if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {
          text = text.substring(1, text.length - 1);
        }
        text = escape(text, true);
        return {
          type: 'codespan',
          raw: cap[0],
          text: text
        };
      }
    };
    _proto.br = function br(src) {
      var cap = this.rules.inline.br.exec(src);
      if (cap) {
        return {
          type: 'br',
          raw: cap[0]
        };
      }
    };
    _proto.del = function del(src) {
      var cap = this.rules.inline.del.exec(src);
      if (cap) {
        return {
          type: 'del',
          raw: cap[0],
          text: cap[2],
          tokens: this.lexer.inlineTokens(cap[2])
        };
      }
    };
    _proto.autolink = function autolink(src, mangle) {
      var cap = this.rules.inline.autolink.exec(src);
      if (cap) {
        var text, href;
        if (cap[2] === '@') {
          text = escape(this.options.mangle ? mangle(cap[1]) : cap[1]);
          href = 'mailto:' + text;
        } else {
          text = escape(cap[1]);
          href = text;
        }
        return {
          type: 'link',
          raw: cap[0],
          text: text,
          href: href,
          tokens: [{
            type: 'text',
            raw: text,
            text: text
          }]
        };
      }
    };
    _proto.url = function url(src, mangle) {
      var cap;
      if (cap = this.rules.inline.url.exec(src)) {
        var text, href;
        if (cap[2] === '@') {
          text = escape(this.options.mangle ? mangle(cap[0]) : cap[0]);
          href = 'mailto:' + text;
        } else {
          // do extended autolink path validation
          var prevCapZero;
          do {
            prevCapZero = cap[0];
            cap[0] = this.rules.inline._backpedal.exec(cap[0])[0];
          } while (prevCapZero !== cap[0]);
          text = escape(cap[0]);
          if (cap[1] === 'www.') {
            href = 'http://' + cap[0];
          } else {
            href = cap[0];
          }
        }
        return {
          type: 'link',
          raw: cap[0],
          text: text,
          href: href,
          tokens: [{
            type: 'text',
            raw: text,
            text: text
          }]
        };
      }
    };
    _proto.inlineText = function inlineText(src, smartypants) {
      var cap = this.rules.inline.text.exec(src);
      if (cap) {
        var text;
        if (this.lexer.state.inRawBlock) {
          text = this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0];
        } else {
          text = escape(this.options.smartypants ? smartypants(cap[0]) : cap[0]);
        }
        return {
          type: 'text',
          raw: cap[0],
          text: text
        };
      }
    };
    return Tokenizer;
  }();

  /**
   * Block-Level Grammar
   */
  var block = {
    newline: /^(?: *(?:\n|$))+/,
    code: /^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,
    fences: /^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,
    hr: /^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,
    heading: /^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,
    blockquote: /^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,
    list: /^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,
    html: '^ {0,3}(?:' // optional indentation
    + '<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)' // (1)
    + '|comment[^\\n]*(\\n+|$)' // (2)
    + '|<\\?[\\s\\S]*?(?:\\?>\\n*|$)' // (3)
    + '|<![A-Z][\\s\\S]*?(?:>\\n*|$)' // (4)
    + '|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)' // (5)
    + '|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (6)
    + '|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (7) open tag
    + '|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (7) closing tag
    + ')',
    def: /^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,
    table: noopTest,
    lheading: /^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,
    // regex template, placeholders will be replaced according to different paragraph
    // interruption rules of commonmark and the original markdown spec:
    _paragraph: /^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,
    text: /^[^\n]+/
  };
  block._label = /(?!\s*\])(?:\\.|[^\[\]\\])+/;
  block._title = /(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;
  block.def = edit(block.def).replace('label', block._label).replace('title', block._title).getRegex();
  block.bullet = /(?:[*+-]|\d{1,9}[.)])/;
  block.listItemStart = edit(/^( *)(bull) */).replace('bull', block.bullet).getRegex();
  block.list = edit(block.list).replace(/bull/g, block.bullet).replace('hr', '\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))').replace('def', '\\n+(?=' + block.def.source + ')').getRegex();
  block._tag = 'address|article|aside|base|basefont|blockquote|body|caption' + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption' + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe' + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option' + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr' + '|track|ul';
  block._comment = /<!--(?!-?>)[\s\S]*?(?:-->|$)/;
  block.html = edit(block.html, 'i').replace('comment', block._comment).replace('tag', block._tag).replace('attribute', / +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();
  block.paragraph = edit(block._paragraph).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs
  .replace('|table', '').replace('blockquote', ' {0,3}>').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
  .replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // pars can be interrupted by type (6) html blocks
  .getRegex();
  block.blockquote = edit(block.blockquote).replace('paragraph', block.paragraph).getRegex();

  /**
   * Normal Block Grammar
   */

  block.normal = merge({}, block);

  /**
   * GFM Block Grammar
   */

  block.gfm = merge({}, block.normal, {
    table: '^ *([^\\n ].*\\|.*)\\n' // Header
    + ' {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?' // Align
    + '(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)' // Cells
  });

  block.gfm.table = edit(block.gfm.table).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('blockquote', ' {0,3}>').replace('code', ' {4}[^\\n]').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
  .replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // tables can be interrupted by type (6) html blocks
  .getRegex();
  block.gfm.paragraph = edit(block._paragraph).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs
  .replace('table', block.gfm.table) // interrupt paragraphs with table
  .replace('blockquote', ' {0,3}>').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
  .replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // pars can be interrupted by type (6) html blocks
  .getRegex();
  /**
   * Pedantic grammar (original John Gruber's loose markdown specification)
   */

  block.pedantic = merge({}, block.normal, {
    html: edit('^ *(?:comment *(?:\\n|\\s*$)' + '|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)' // closed tag
    + '|<tag(?:"[^"]*"|\'[^\']*\'|\\s[^\'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))').replace('comment', block._comment).replace(/tag/g, '(?!(?:' + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub' + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)' + '\\b)\\w+(?!:|[^\\w\\s@]*@)\\b').getRegex(),
    def: /^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,
    heading: /^(#{1,6})(.*)(?:\n+|$)/,
    fences: noopTest,
    // fences not supported
    lheading: /^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,
    paragraph: edit(block.normal._paragraph).replace('hr', block.hr).replace('heading', ' *#{1,6} *[^\n]').replace('lheading', block.lheading).replace('blockquote', ' {0,3}>').replace('|fences', '').replace('|list', '').replace('|html', '').getRegex()
  });

  /**
   * Inline-Level Grammar
   */
  var inline = {
    escape: /^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,
    autolink: /^<(scheme:[^\s\x00-\x1f<>]*|email)>/,
    url: noopTest,
    tag: '^comment' + '|^</[a-zA-Z][\\w:-]*\\s*>' // self-closing tag
    + '|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>' // open tag
    + '|^<\\?[\\s\\S]*?\\?>' // processing instruction, e.g. <?php ?>
    + '|^<![a-zA-Z]+\\s[\\s\\S]*?>' // declaration, e.g. <!DOCTYPE html>
    + '|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>',
    // CDATA section
    link: /^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,
    reflink: /^!?\[(label)\]\[(ref)\]/,
    nolink: /^!?\[(ref)\](?:\[\])?/,
    reflinkSearch: 'reflink|nolink(?!\\()',
    emStrong: {
      lDelim: /^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,
      //        (1) and (2) can only be a Right Delimiter. (3) and (4) can only be Left.  (5) and (6) can be either Left or Right.
      //          () Skip orphan inside strong                                      () Consume to delim     (1) #***                (2) a***#, a***                             (3) #***a, ***a                 (4) ***#              (5) #***#                 (6) a***a
      rDelimAst: /^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,
      rDelimUnd: /^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/ // ^- Not allowed for _
    },

    code: /^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,
    br: /^( {2,}|\\)\n(?!\s*$)/,
    del: noopTest,
    text: /^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,
    punctuation: /^([\spunctuation])/
  };

  // list of punctuation marks from CommonMark spec
  // without * and _ to handle the different emphasis markers * and _
  inline._punctuation = '!"#$%&\'()+\\-.,/:;<=>?@\\[\\]`^{|}~';
  inline.punctuation = edit(inline.punctuation).replace(/punctuation/g, inline._punctuation).getRegex();

  // sequences em should skip over [title](link), `code`, <html>
  inline.blockSkip = /\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;
  // lookbehind is not available on Safari as of version 16
  // inline.escapedEmSt = /(?<=(?:^|[^\\)(?:\\[^])*)\\[*_]/g;
  inline.escapedEmSt = /(?:^|[^\\])(?:\\\\)*\\[*_]/g;
  inline._comment = edit(block._comment).replace('(?:-->|$)', '-->').getRegex();
  inline.emStrong.lDelim = edit(inline.emStrong.lDelim).replace(/punct/g, inline._punctuation).getRegex();
  inline.emStrong.rDelimAst = edit(inline.emStrong.rDelimAst, 'g').replace(/punct/g, inline._punctuation).getRegex();
  inline.emStrong.rDelimUnd = edit(inline.emStrong.rDelimUnd, 'g').replace(/punct/g, inline._punctuation).getRegex();
  inline._escapes = /\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;
  inline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;
  inline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;
  inline.autolink = edit(inline.autolink).replace('scheme', inline._scheme).replace('email', inline._email).getRegex();
  inline._attribute = /\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;
  inline.tag = edit(inline.tag).replace('comment', inline._comment).replace('attribute', inline._attribute).getRegex();
  inline._label = /(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;
  inline._href = /<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;
  inline._title = /"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;
  inline.link = edit(inline.link).replace('label', inline._label).replace('href', inline._href).replace('title', inline._title).getRegex();
  inline.reflink = edit(inline.reflink).replace('label', inline._label).replace('ref', block._label).getRegex();
  inline.nolink = edit(inline.nolink).replace('ref', block._label).getRegex();
  inline.reflinkSearch = edit(inline.reflinkSearch, 'g').replace('reflink', inline.reflink).replace('nolink', inline.nolink).getRegex();

  /**
   * Normal Inline Grammar
   */

  inline.normal = merge({}, inline);

  /**
   * Pedantic Inline Grammar
   */

  inline.pedantic = merge({}, inline.normal, {
    strong: {
      start: /^__|\*\*/,
      middle: /^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,
      endAst: /\*\*(?!\*)/g,
      endUnd: /__(?!_)/g
    },
    em: {
      start: /^_|\*/,
      middle: /^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,
      endAst: /\*(?!\*)/g,
      endUnd: /_(?!_)/g
    },
    link: edit(/^!?\[(label)\]\((.*?)\)/).replace('label', inline._label).getRegex(),
    reflink: edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace('label', inline._label).getRegex()
  });

  /**
   * GFM Inline Grammar
   */

  inline.gfm = merge({}, inline.normal, {
    escape: edit(inline.escape).replace('])', '~|])').getRegex(),
    _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,
    url: /^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,
    _backpedal: /(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,
    del: /^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,
    text: /^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/
  });
  inline.gfm.url = edit(inline.gfm.url, 'i').replace('email', inline.gfm._extended_email).getRegex();
  /**
   * GFM + Line Breaks Inline Grammar
   */

  inline.breaks = merge({}, inline.gfm, {
    br: edit(inline.br).replace('{2,}', '*').getRegex(),
    text: edit(inline.gfm.text).replace('\\b_', '\\b_| {2,}\\n').replace(/\{2,\}/g, '*').getRegex()
  });

  /**
   * smartypants text replacement
   * @param {string} text
   */
  function smartypants(text) {
    return text
    // em-dashes
    .replace(/---/g, "\u2014")
    // en-dashes
    .replace(/--/g, "\u2013")
    // opening singles
    .replace(/(^|[-\u2014/(\[{"\s])'/g, "$1\u2018")
    // closing singles & apostrophes
    .replace(/'/g, "\u2019")
    // opening doubles
    .replace(/(^|[-\u2014/(\[{\u2018\s])"/g, "$1\u201C")
    // closing doubles
    .replace(/"/g, "\u201D")
    // ellipses
    .replace(/\.{3}/g, "\u2026");
  }

  /**
   * mangle email addresses
   * @param {string} text
   */
  function mangle(text) {
    var out = '',
      i,
      ch;
    var l = text.length;
    for (i = 0; i < l; i++) {
      ch = text.charCodeAt(i);
      if (Math.random() > 0.5) {
        ch = 'x' + ch.toString(16);
      }
      out += '&#' + ch + ';';
    }
    return out;
  }

  /**
   * Block Lexer
   */
  var Lexer = /*#__PURE__*/function () {
    function Lexer(options) {
      this.tokens = [];
      this.tokens.links = Object.create(null);
      this.options = options || exports.defaults;
      this.options.tokenizer = this.options.tokenizer || new Tokenizer();
      this.tokenizer = this.options.tokenizer;
      this.tokenizer.options = this.options;
      this.tokenizer.lexer = this;
      this.inlineQueue = [];
      this.state = {
        inLink: false,
        inRawBlock: false,
        top: true
      };
      var rules = {
        block: block.normal,
        inline: inline.normal
      };
      if (this.options.pedantic) {
        rules.block = block.pedantic;
        rules.inline = inline.pedantic;
      } else if (this.options.gfm) {
        rules.block = block.gfm;
        if (this.options.breaks) {
          rules.inline = inline.breaks;
        } else {
          rules.inline = inline.gfm;
        }
      }
      this.tokenizer.rules = rules;
    }

    /**
     * Expose Rules
     */
    /**
     * Static Lex Method
     */
    Lexer.lex = function lex(src, options) {
      var lexer = new Lexer(options);
      return lexer.lex(src);
    }

    /**
     * Static Lex Inline Method
     */;
    Lexer.lexInline = function lexInline(src, options) {
      var lexer = new Lexer(options);
      return lexer.inlineTokens(src);
    }

    /**
     * Preprocessing
     */;
    var _proto = Lexer.prototype;
    _proto.lex = function lex(src) {
      src = src.replace(/\r\n|\r/g, '\n');
      this.blockTokens(src, this.tokens);
      var next;
      while (next = this.inlineQueue.shift()) {
        this.inlineTokens(next.src, next.tokens);
      }
      return this.tokens;
    }

    /**
     * Lexing
     */;
    _proto.blockTokens = function blockTokens(src, tokens) {
      var _this = this;
      if (tokens === void 0) {
        tokens = [];
      }
      if (this.options.pedantic) {
        src = src.replace(/\t/g, '    ').replace(/^ +$/gm, '');
      } else {
        src = src.replace(/^( *)(\t+)/gm, function (_, leading, tabs) {
          return leading + '    '.repeat(tabs.length);
        });
      }
      var token, lastToken, cutSrc, lastParagraphClipped;
      while (src) {
        if (this.options.extensions && this.options.extensions.block && this.options.extensions.block.some(function (extTokenizer) {
          if (token = extTokenizer.call({
            lexer: _this
          }, src, tokens)) {
            src = src.substring(token.raw.length);
            tokens.push(token);
            return true;
          }
          return false;
        })) {
          continue;
        }

        // newline
        if (token = this.tokenizer.space(src)) {
          src = src.substring(token.raw.length);
          if (token.raw.length === 1 && tokens.length > 0) {
            // if there's a single \n as a spacer, it's terminating the last line,
            // so move it there so that we don't get unecessary paragraph tags
            tokens[tokens.length - 1].raw += '\n';
          } else {
            tokens.push(token);
          }
          continue;
        }

        // code
        if (token = this.tokenizer.code(src)) {
          src = src.substring(token.raw.length);
          lastToken = tokens[tokens.length - 1];
          // An indented code block cannot interrupt a paragraph.
          if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {
            lastToken.raw += '\n' + token.raw;
            lastToken.text += '\n' + token.text;
            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
          } else {
            tokens.push(token);
          }
          continue;
        }

        // fences
        if (token = this.tokenizer.fences(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // heading
        if (token = this.tokenizer.heading(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // hr
        if (token = this.tokenizer.hr(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // blockquote
        if (token = this.tokenizer.blockquote(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // list
        if (token = this.tokenizer.list(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // html
        if (token = this.tokenizer.html(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // def
        if (token = this.tokenizer.def(src)) {
          src = src.substring(token.raw.length);
          lastToken = tokens[tokens.length - 1];
          if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {
            lastToken.raw += '\n' + token.raw;
            lastToken.text += '\n' + token.raw;
            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
          } else if (!this.tokens.links[token.tag]) {
            this.tokens.links[token.tag] = {
              href: token.href,
              title: token.title
            };
          }
          continue;
        }

        // table (gfm)
        if (token = this.tokenizer.table(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // lheading
        if (token = this.tokenizer.lheading(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // top-level paragraph
        // prevent paragraph consuming extensions by clipping 'src' to extension start
        cutSrc = src;
        if (this.options.extensions && this.options.extensions.startBlock) {
          (function () {
            var startIndex = Infinity;
            var tempSrc = src.slice(1);
            var tempStart = void 0;
            _this.options.extensions.startBlock.forEach(function (getStartIndex) {
              tempStart = getStartIndex.call({
                lexer: this
              }, tempSrc);
              if (typeof tempStart === 'number' && tempStart >= 0) {
                startIndex = Math.min(startIndex, tempStart);
              }
            });
            if (startIndex < Infinity && startIndex >= 0) {
              cutSrc = src.substring(0, startIndex + 1);
            }
          })();
        }
        if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {
          lastToken = tokens[tokens.length - 1];
          if (lastParagraphClipped && lastToken.type === 'paragraph') {
            lastToken.raw += '\n' + token.raw;
            lastToken.text += '\n' + token.text;
            this.inlineQueue.pop();
            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
          } else {
            tokens.push(token);
          }
          lastParagraphClipped = cutSrc.length !== src.length;
          src = src.substring(token.raw.length);
          continue;
        }

        // text
        if (token = this.tokenizer.text(src)) {
          src = src.substring(token.raw.length);
          lastToken = tokens[tokens.length - 1];
          if (lastToken && lastToken.type === 'text') {
            lastToken.raw += '\n' + token.raw;
            lastToken.text += '\n' + token.text;
            this.inlineQueue.pop();
            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
          } else {
            tokens.push(token);
          }
          continue;
        }
        if (src) {
          var errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);
          if (this.options.silent) {
            console.error(errMsg);
            break;
          } else {
            throw new Error(errMsg);
          }
        }
      }
      this.state.top = true;
      return tokens;
    };
    _proto.inline = function inline(src, tokens) {
      if (tokens === void 0) {
        tokens = [];
      }
      this.inlineQueue.push({
        src: src,
        tokens: tokens
      });
      return tokens;
    }

    /**
     * Lexing/Compiling
     */;
    _proto.inlineTokens = function inlineTokens(src, tokens) {
      var _this2 = this;
      if (tokens === void 0) {
        tokens = [];
      }
      var token, lastToken, cutSrc;

      // String with links masked to avoid interference with em and strong
      var maskedSrc = src;
      var match;
      var keepPrevChar, prevChar;

      // Mask out reflinks
      if (this.tokens.links) {
        var links = Object.keys(this.tokens.links);
        if (links.length > 0) {
          while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {
            if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {
              maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);
            }
          }
        }
      }
      // Mask out other blocks
      while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {
        maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);
      }

      // Mask out escaped em & strong delimiters
      while ((match = this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc)) != null) {
        maskedSrc = maskedSrc.slice(0, match.index + match[0].length - 2) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);
        this.tokenizer.rules.inline.escapedEmSt.lastIndex--;
      }
      while (src) {
        if (!keepPrevChar) {
          prevChar = '';
        }
        keepPrevChar = false;

        // extensions
        if (this.options.extensions && this.options.extensions.inline && this.options.extensions.inline.some(function (extTokenizer) {
          if (token = extTokenizer.call({
            lexer: _this2
          }, src, tokens)) {
            src = src.substring(token.raw.length);
            tokens.push(token);
            return true;
          }
          return false;
        })) {
          continue;
        }

        // escape
        if (token = this.tokenizer.escape(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // tag
        if (token = this.tokenizer.tag(src)) {
          src = src.substring(token.raw.length);
          lastToken = tokens[tokens.length - 1];
          if (lastToken && token.type === 'text' && lastToken.type === 'text') {
            lastToken.raw += token.raw;
            lastToken.text += token.text;
          } else {
            tokens.push(token);
          }
          continue;
        }

        // link
        if (token = this.tokenizer.link(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // reflink, nolink
        if (token = this.tokenizer.reflink(src, this.tokens.links)) {
          src = src.substring(token.raw.length);
          lastToken = tokens[tokens.length - 1];
          if (lastToken && token.type === 'text' && lastToken.type === 'text') {
            lastToken.raw += token.raw;
            lastToken.text += token.text;
          } else {
            tokens.push(token);
          }
          continue;
        }

        // em & strong
        if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // code
        if (token = this.tokenizer.codespan(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // br
        if (token = this.tokenizer.br(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // del (gfm)
        if (token = this.tokenizer.del(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // autolink
        if (token = this.tokenizer.autolink(src, mangle)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // url (gfm)
        if (!this.state.inLink && (token = this.tokenizer.url(src, mangle))) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }

        // text
        // prevent inlineText consuming extensions by clipping 'src' to extension start
        cutSrc = src;
        if (this.options.extensions && this.options.extensions.startInline) {
          (function () {
            var startIndex = Infinity;
            var tempSrc = src.slice(1);
            var tempStart = void 0;
            _this2.options.extensions.startInline.forEach(function (getStartIndex) {
              tempStart = getStartIndex.call({
                lexer: this
              }, tempSrc);
              if (typeof tempStart === 'number' && tempStart >= 0) {
                startIndex = Math.min(startIndex, tempStart);
              }
            });
            if (startIndex < Infinity && startIndex >= 0) {
              cutSrc = src.substring(0, startIndex + 1);
            }
          })();
        }
        if (token = this.tokenizer.inlineText(cutSrc, smartypants)) {
          src = src.substring(token.raw.length);
          if (token.raw.slice(-1) !== '_') {
            // Track prevChar before string of ____ started
            prevChar = token.raw.slice(-1);
          }
          keepPrevChar = true;
          lastToken = tokens[tokens.length - 1];
          if (lastToken && lastToken.type === 'text') {
            lastToken.raw += token.raw;
            lastToken.text += token.text;
          } else {
            tokens.push(token);
          }
          continue;
        }
        if (src) {
          var errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);
          if (this.options.silent) {
            console.error(errMsg);
            break;
          } else {
            throw new Error(errMsg);
          }
        }
      }
      return tokens;
    };
    _createClass(Lexer, null, [{
      key: "rules",
      get: function get() {
        return {
          block: block,
          inline: inline
        };
      }
    }]);
    return Lexer;
  }();

  /**
   * Renderer
   */
  var Renderer = /*#__PURE__*/function () {
    function Renderer(options) {
      this.options = options || exports.defaults;
    }
    var _proto = Renderer.prototype;
    _proto.code = function code(_code, infostring, escaped) {
      var lang = (infostring || '').match(/\S*/)[0];
      if (this.options.highlight) {
        var out = this.options.highlight(_code, lang);
        if (out != null && out !== _code) {
          escaped = true;
          _code = out;
        }
      }
      _code = _code.replace(/\n$/, '') + '\n';
      if (!lang) {
        return '<pre><code>' + (escaped ? _code : escape(_code, true)) + '</code></pre>\n';
      }
      return '<pre><code class="' + this.options.langPrefix + escape(lang) + '">' + (escaped ? _code : escape(_code, true)) + '</code></pre>\n';
    }

    /**
     * @param {string} quote
     */;
    _proto.blockquote = function blockquote(quote) {
      return "<blockquote>\n" + quote + "</blockquote>\n";
    };
    _proto.html = function html(_html) {
      return _html;
    }

    /**
     * @param {string} text
     * @param {string} level
     * @param {string} raw
     * @param {any} slugger
     */;
    _proto.heading = function heading(text, level, raw, slugger) {
      if (this.options.headerIds) {
        var id = this.options.headerPrefix + slugger.slug(raw);
        return "<h" + level + " id=\"" + id + "\">" + text + "</h" + level + ">\n";
      }

      // ignore IDs
      return "<h" + level + ">" + text + "</h" + level + ">\n";
    };
    _proto.hr = function hr() {
      return this.options.xhtml ? '<hr/>\n' : '<hr>\n';
    };
    _proto.list = function list(body, ordered, start) {
      var type = ordered ? 'ol' : 'ul',
        startatt = ordered && start !== 1 ? ' start="' + start + '"' : '';
      return '<' + type + startatt + '>\n' + body + '</' + type + '>\n';
    }

    /**
     * @param {string} text
     */;
    _proto.listitem = function listitem(text) {
      return "<li>" + text + "</li>\n";
    };
    _proto.checkbox = function checkbox(checked) {
      return '<input ' + (checked ? 'checked="" ' : '') + 'disabled="" type="checkbox"' + (this.options.xhtml ? ' /' : '') + '> ';
    }

    /**
     * @param {string} text
     */;
    _proto.paragraph = function paragraph(text) {
      return "<p>" + text + "</p>\n";
    }

    /**
     * @param {string} header
     * @param {string} body
     */;
    _proto.table = function table(header, body) {
      if (body) body = "<tbody>" + body + "</tbody>";
      return '<table>\n' + '<thead>\n' + header + '</thead>\n' + body + '</table>\n';
    }

    /**
     * @param {string} content
     */;
    _proto.tablerow = function tablerow(content) {
      return "<tr>\n" + content + "</tr>\n";
    };
    _proto.tablecell = function tablecell(content, flags) {
      var type = flags.header ? 'th' : 'td';
      var tag = flags.align ? "<" + type + " align=\"" + flags.align + "\">" : "<" + type + ">";
      return tag + content + ("</" + type + ">\n");
    }

    /**
     * span level renderer
     * @param {string} text
     */;
    _proto.strong = function strong(text) {
      return "<strong>" + text + "</strong>";
    }

    /**
     * @param {string} text
     */;
    _proto.em = function em(text) {
      return "<em>" + text + "</em>";
    }

    /**
     * @param {string} text
     */;
    _proto.codespan = function codespan(text) {
      return "<code>" + text + "</code>";
    };
    _proto.br = function br() {
      return this.options.xhtml ? '<br/>' : '<br>';
    }

    /**
     * @param {string} text
     */;
    _proto.del = function del(text) {
      return "<del>" + text + "</del>";
    }

    /**
     * @param {string} href
     * @param {string} title
     * @param {string} text
     */;
    _proto.link = function link(href, title, text) {
      href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);
      if (href === null) {
        return text;
      }
      var out = '<a href="' + href + '"';
      if (title) {
        out += ' title="' + title + '"';
      }
      out += '>' + text + '</a>';
      return out;
    }

    /**
     * @param {string} href
     * @param {string} title
     * @param {string} text
     */;
    _proto.image = function image(href, title, text) {
      href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);
      if (href === null) {
        return text;
      }
      var out = "<img src=\"" + href + "\" alt=\"" + text + "\"";
      if (title) {
        out += " title=\"" + title + "\"";
      }
      out += this.options.xhtml ? '/>' : '>';
      return out;
    };
    _proto.text = function text(_text) {
      return _text;
    };
    return Renderer;
  }();

  /**
   * TextRenderer
   * returns only the textual part of the token
   */
  var TextRenderer = /*#__PURE__*/function () {
    function TextRenderer() {}
    var _proto = TextRenderer.prototype;
    // no need for block level renderers
    _proto.strong = function strong(text) {
      return text;
    };
    _proto.em = function em(text) {
      return text;
    };
    _proto.codespan = function codespan(text) {
      return text;
    };
    _proto.del = function del(text) {
      return text;
    };
    _proto.html = function html(text) {
      return text;
    };
    _proto.text = function text(_text) {
      return _text;
    };
    _proto.link = function link(href, title, text) {
      return '' + text;
    };
    _proto.image = function image(href, title, text) {
      return '' + text;
    };
    _proto.br = function br() {
      return '';
    };
    return TextRenderer;
  }();

  /**
   * Slugger generates header id
   */
  var Slugger = /*#__PURE__*/function () {
    function Slugger() {
      this.seen = {};
    }

    /**
     * @param {string} value
     */
    var _proto = Slugger.prototype;
    _proto.serialize = function serialize(value) {
      return value.toLowerCase().trim()
      // remove html tags
      .replace(/<[!\/a-z].*?>/ig, '')
      // remove unwanted chars
      .replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g, '').replace(/\s/g, '-');
    }

    /**
     * Finds the next safe (unique) slug to use
     * @param {string} originalSlug
     * @param {boolean} isDryRun
     */;
    _proto.getNextSafeSlug = function getNextSafeSlug(originalSlug, isDryRun) {
      var slug = originalSlug;
      var occurenceAccumulator = 0;
      if (this.seen.hasOwnProperty(slug)) {
        occurenceAccumulator = this.seen[originalSlug];
        do {
          occurenceAccumulator++;
          slug = originalSlug + '-' + occurenceAccumulator;
        } while (this.seen.hasOwnProperty(slug));
      }
      if (!isDryRun) {
        this.seen[originalSlug] = occurenceAccumulator;
        this.seen[slug] = 0;
      }
      return slug;
    }

    /**
     * Convert string to unique id
     * @param {object} [options]
     * @param {boolean} [options.dryrun] Generates the next unique slug without
     * updating the internal accumulator.
     */;
    _proto.slug = function slug(value, options) {
      if (options === void 0) {
        options = {};
      }
      var slug = this.serialize(value);
      return this.getNextSafeSlug(slug, options.dryrun);
    };
    return Slugger;
  }();

  /**
   * Parsing & Compiling
   */
  var Parser = /*#__PURE__*/function () {
    function Parser(options) {
      this.options = options || exports.defaults;
      this.options.renderer = this.options.renderer || new Renderer();
      this.renderer = this.options.renderer;
      this.renderer.options = this.options;
      this.textRenderer = new TextRenderer();
      this.slugger = new Slugger();
    }

    /**
     * Static Parse Method
     */
    Parser.parse = function parse(tokens, options) {
      var parser = new Parser(options);
      return parser.parse(tokens);
    }

    /**
     * Static Parse Inline Method
     */;
    Parser.parseInline = function parseInline(tokens, options) {
      var parser = new Parser(options);
      return parser.parseInline(tokens);
    }

    /**
     * Parse Loop
     */;
    var _proto = Parser.prototype;
    _proto.parse = function parse(tokens, top) {
      if (top === void 0) {
        top = true;
      }
      var out = '',
        i,
        j,
        k,
        l2,
        l3,
        row,
        cell,
        header,
        body,
        token,
        ordered,
        start,
        loose,
        itemBody,
        item,
        checked,
        task,
        checkbox,
        ret;
      var l = tokens.length;
      for (i = 0; i < l; i++) {
        token = tokens[i];

        // Run any renderer extensions
        if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {
          ret = this.options.extensions.renderers[token.type].call({
            parser: this
          }, token);
          if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(token.type)) {
            out += ret || '';
            continue;
          }
        }
        switch (token.type) {
          case 'space':
            {
              continue;
            }
          case 'hr':
            {
              out += this.renderer.hr();
              continue;
            }
          case 'heading':
            {
              out += this.renderer.heading(this.parseInline(token.tokens), token.depth, unescape(this.parseInline(token.tokens, this.textRenderer)), this.slugger);
              continue;
            }
          case 'code':
            {
              out += this.renderer.code(token.text, token.lang, token.escaped);
              continue;
            }
          case 'table':
            {
              header = '';

              // header
              cell = '';
              l2 = token.header.length;
              for (j = 0; j < l2; j++) {
                cell += this.renderer.tablecell(this.parseInline(token.header[j].tokens), {
                  header: true,
                  align: token.align[j]
                });
              }
              header += this.renderer.tablerow(cell);
              body = '';
              l2 = token.rows.length;
              for (j = 0; j < l2; j++) {
                row = token.rows[j];
                cell = '';
                l3 = row.length;
                for (k = 0; k < l3; k++) {
                  cell += this.renderer.tablecell(this.parseInline(row[k].tokens), {
                    header: false,
                    align: token.align[k]
                  });
                }
                body += this.renderer.tablerow(cell);
              }
              out += this.renderer.table(header, body);
              continue;
            }
          case 'blockquote':
            {
              body = this.parse(token.tokens);
              out += this.renderer.blockquote(body);
              continue;
            }
          case 'list':
            {
              ordered = token.ordered;
              start = token.start;
              loose = token.loose;
              l2 = token.items.length;
              body = '';
              for (j = 0; j < l2; j++) {
                item = token.items[j];
                checked = item.checked;
                task = item.task;
                itemBody = '';
                if (item.task) {
                  checkbox = this.renderer.checkbox(checked);
                  if (loose) {
                    if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {
                      item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;
                      if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {
                        item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;
                      }
                    } else {
                      item.tokens.unshift({
                        type: 'text',
                        text: checkbox
                      });
                    }
                  } else {
                    itemBody += checkbox;
                  }
                }
                itemBody += this.parse(item.tokens, loose);
                body += this.renderer.listitem(itemBody, task, checked);
              }
              out += this.renderer.list(body, ordered, start);
              continue;
            }
          case 'html':
            {
              // TODO parse inline content if parameter markdown=1
              out += this.renderer.html(token.text);
              continue;
            }
          case 'paragraph':
            {
              out += this.renderer.paragraph(this.parseInline(token.tokens));
              continue;
            }
          case 'text':
            {
              body = token.tokens ? this.parseInline(token.tokens) : token.text;
              while (i + 1 < l && tokens[i + 1].type === 'text') {
                token = tokens[++i];
                body += '\n' + (token.tokens ? this.parseInline(token.tokens) : token.text);
              }
              out += top ? this.renderer.paragraph(body) : body;
              continue;
            }
          default:
            {
              var errMsg = 'Token with "' + token.type + '" type was not found.';
              if (this.options.silent) {
                console.error(errMsg);
                return;
              } else {
                throw new Error(errMsg);
              }
            }
        }
      }
      return out;
    }

    /**
     * Parse Inline Tokens
     */;
    _proto.parseInline = function parseInline(tokens, renderer) {
      renderer = renderer || this.renderer;
      var out = '',
        i,
        token,
        ret;
      var l = tokens.length;
      for (i = 0; i < l; i++) {
        token = tokens[i];

        // Run any renderer extensions
        if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {
          ret = this.options.extensions.renderers[token.type].call({
            parser: this
          }, token);
          if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(token.type)) {
            out += ret || '';
            continue;
          }
        }
        switch (token.type) {
          case 'escape':
            {
              out += renderer.text(token.text);
              break;
            }
          case 'html':
            {
              out += renderer.html(token.text);
              break;
            }
          case 'link':
            {
              out += renderer.link(token.href, token.title, this.parseInline(token.tokens, renderer));
              break;
            }
          case 'image':
            {
              out += renderer.image(token.href, token.title, token.text);
              break;
            }
          case 'strong':
            {
              out += renderer.strong(this.parseInline(token.tokens, renderer));
              break;
            }
          case 'em':
            {
              out += renderer.em(this.parseInline(token.tokens, renderer));
              break;
            }
          case 'codespan':
            {
              out += renderer.codespan(token.text);
              break;
            }
          case 'br':
            {
              out += renderer.br();
              break;
            }
          case 'del':
            {
              out += renderer.del(this.parseInline(token.tokens, renderer));
              break;
            }
          case 'text':
            {
              out += renderer.text(token.text);
              break;
            }
          default:
            {
              var errMsg = 'Token with "' + token.type + '" type was not found.';
              if (this.options.silent) {
                console.error(errMsg);
                return;
              } else {
                throw new Error(errMsg);
              }
            }
        }
      }
      return out;
    };
    return Parser;
  }();

  /**
   * Marked
   */
  function marked(src, opt, callback) {
    // throw error in case of non string input
    if (typeof src === 'undefined' || src === null) {
      throw new Error('marked(): input parameter is undefined or null');
    }
    if (typeof src !== 'string') {
      throw new Error('marked(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');
    }
    if (typeof opt === 'function') {
      callback = opt;
      opt = null;
    }
    opt = merge({}, marked.defaults, opt || {});
    checkSanitizeDeprecation(opt);
    if (callback) {
      var highlight = opt.highlight;
      var tokens;
      try {
        tokens = Lexer.lex(src, opt);
      } catch (e) {
        return callback(e);
      }
      var done = function done(err) {
        var out;
        if (!err) {
          try {
            if (opt.walkTokens) {
              marked.walkTokens(tokens, opt.walkTokens);
            }
            out = Parser.parse(tokens, opt);
          } catch (e) {
            err = e;
          }
        }
        opt.highlight = highlight;
        return err ? callback(err) : callback(null, out);
      };
      if (!highlight || highlight.length < 3) {
        return done();
      }
      delete opt.highlight;
      if (!tokens.length) return done();
      var pending = 0;
      marked.walkTokens(tokens, function (token) {
        if (token.type === 'code') {
          pending++;
          setTimeout(function () {
            highlight(token.text, token.lang, function (err, code) {
              if (err) {
                return done(err);
              }
              if (code != null && code !== token.text) {
                token.text = code;
                token.escaped = true;
              }
              pending--;
              if (pending === 0) {
                done();
              }
            });
          }, 0);
        }
      });
      if (pending === 0) {
        done();
      }
      return;
    }
    function onError(e) {
      e.message += '\nPlease report this to https://github.com/markedjs/marked.';
      if (opt.silent) {
        return '<p>An error occurred:</p><pre>' + escape(e.message + '', true) + '</pre>';
      }
      throw e;
    }
    try {
      var _tokens = Lexer.lex(src, opt);
      if (opt.walkTokens) {
        if (opt.async) {
          return Promise.all(marked.walkTokens(_tokens, opt.walkTokens)).then(function () {
            return Parser.parse(_tokens, opt);
          })["catch"](onError);
        }
        marked.walkTokens(_tokens, opt.walkTokens);
      }
      return Parser.parse(_tokens, opt);
    } catch (e) {
      onError(e);
    }
  }

  /**
   * Options
   */

  marked.options = marked.setOptions = function (opt) {
    merge(marked.defaults, opt);
    changeDefaults(marked.defaults);
    return marked;
  };
  marked.getDefaults = getDefaults;
  marked.defaults = exports.defaults;

  /**
   * Use Extension
   */

  marked.use = function () {
    var extensions = marked.defaults.extensions || {
      renderers: {},
      childTokens: {}
    };
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }
    args.forEach(function (pack) {
      // copy options to new object
      var opts = merge({}, pack);

      // set async to true if it was set to true before
      opts.async = marked.defaults.async || opts.async;

      // ==-- Parse "addon" extensions --== //
      if (pack.extensions) {
        pack.extensions.forEach(function (ext) {
          if (!ext.name) {
            throw new Error('extension name required');
          }
          if (ext.renderer) {
            // Renderer extensions
            var prevRenderer = extensions.renderers[ext.name];
            if (prevRenderer) {
              // Replace extension with func to run new extension but fall back if false
              extensions.renderers[ext.name] = function () {
                for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
                  args[_key2] = arguments[_key2];
                }
                var ret = ext.renderer.apply(this, args);
                if (ret === false) {
                  ret = prevRenderer.apply(this, args);
                }
                return ret;
              };
            } else {
              extensions.renderers[ext.name] = ext.renderer;
            }
          }
          if (ext.tokenizer) {
            // Tokenizer Extensions
            if (!ext.level || ext.level !== 'block' && ext.level !== 'inline') {
              throw new Error("extension level must be 'block' or 'inline'");
            }
            if (extensions[ext.level]) {
              extensions[ext.level].unshift(ext.tokenizer);
            } else {
              extensions[ext.level] = [ext.tokenizer];
            }
            if (ext.start) {
              // Function to check for start of token
              if (ext.level === 'block') {
                if (extensions.startBlock) {
                  extensions.startBlock.push(ext.start);
                } else {
                  extensions.startBlock = [ext.start];
                }
              } else if (ext.level === 'inline') {
                if (extensions.startInline) {
                  extensions.startInline.push(ext.start);
                } else {
                  extensions.startInline = [ext.start];
                }
              }
            }
          }
          if (ext.childTokens) {
            // Child tokens to be visited by walkTokens
            extensions.childTokens[ext.name] = ext.childTokens;
          }
        });
        opts.extensions = extensions;
      }

      // ==-- Parse "overwrite" extensions --== //
      if (pack.renderer) {
        (function () {
          var renderer = marked.defaults.renderer || new Renderer();
          var _loop = function _loop(prop) {
            var prevRenderer = renderer[prop];
            // Replace renderer with func to run extension, but fall back if false
            renderer[prop] = function () {
              for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
                args[_key3] = arguments[_key3];
              }
              var ret = pack.renderer[prop].apply(renderer, args);
              if (ret === false) {
                ret = prevRenderer.apply(renderer, args);
              }
              return ret;
            };
          };
          for (var prop in pack.renderer) {
            _loop(prop);
          }
          opts.renderer = renderer;
        })();
      }
      if (pack.tokenizer) {
        (function () {
          var tokenizer = marked.defaults.tokenizer || new Tokenizer();
          var _loop2 = function _loop2(prop) {
            var prevTokenizer = tokenizer[prop];
            // Replace tokenizer with func to run extension, but fall back if false
            tokenizer[prop] = function () {
              for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
                args[_key4] = arguments[_key4];
              }
              var ret = pack.tokenizer[prop].apply(tokenizer, args);
              if (ret === false) {
                ret = prevTokenizer.apply(tokenizer, args);
              }
              return ret;
            };
          };
          for (var prop in pack.tokenizer) {
            _loop2(prop);
          }
          opts.tokenizer = tokenizer;
        })();
      }

      // ==-- Parse WalkTokens extensions --== //
      if (pack.walkTokens) {
        var _walkTokens = marked.defaults.walkTokens;
        opts.walkTokens = function (token) {
          var values = [];
          values.push(pack.walkTokens.call(this, token));
          if (_walkTokens) {
            values = values.concat(_walkTokens.call(this, token));
          }
          return values;
        };
      }
      marked.setOptions(opts);
    });
  };

  /**
   * Run callback for every token
   */

  marked.walkTokens = function (tokens, callback) {
    var values = [];
    var _loop3 = function _loop3() {
      var token = _step.value;
      values = values.concat(callback.call(marked, token));
      switch (token.type) {
        case 'table':
          {
            for (var _iterator2 = _createForOfIteratorHelperLoose(token.header), _step2; !(_step2 = _iterator2()).done;) {
              var cell = _step2.value;
              values = values.concat(marked.walkTokens(cell.tokens, callback));
            }
            for (var _iterator3 = _createForOfIteratorHelperLoose(token.rows), _step3; !(_step3 = _iterator3()).done;) {
              var row = _step3.value;
              for (var _iterator4 = _createForOfIteratorHelperLoose(row), _step4; !(_step4 = _iterator4()).done;) {
                var _cell = _step4.value;
                values = values.concat(marked.walkTokens(_cell.tokens, callback));
              }
            }
            break;
          }
        case 'list':
          {
            values = values.concat(marked.walkTokens(token.items, callback));
            break;
          }
        default:
          {
            if (marked.defaults.extensions && marked.defaults.extensions.childTokens && marked.defaults.extensions.childTokens[token.type]) {
              // Walk any extensions
              marked.defaults.extensions.childTokens[token.type].forEach(function (childTokens) {
                values = values.concat(marked.walkTokens(token[childTokens], callback));
              });
            } else if (token.tokens) {
              values = values.concat(marked.walkTokens(token.tokens, callback));
            }
          }
      }
    };
    for (var _iterator = _createForOfIteratorHelperLoose(tokens), _step; !(_step = _iterator()).done;) {
      _loop3();
    }
    return values;
  };

  /**
   * Parse Inline
   * @param {string} src
   */
  marked.parseInline = function (src, opt) {
    // throw error in case of non string input
    if (typeof src === 'undefined' || src === null) {
      throw new Error('marked.parseInline(): input parameter is undefined or null');
    }
    if (typeof src !== 'string') {
      throw new Error('marked.parseInline(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');
    }
    opt = merge({}, marked.defaults, opt || {});
    checkSanitizeDeprecation(opt);
    try {
      var tokens = Lexer.lexInline(src, opt);
      if (opt.walkTokens) {
        marked.walkTokens(tokens, opt.walkTokens);
      }
      return Parser.parseInline(tokens, opt);
    } catch (e) {
      e.message += '\nPlease report this to https://github.com/markedjs/marked.';
      if (opt.silent) {
        return '<p>An error occurred:</p><pre>' + escape(e.message + '', true) + '</pre>';
      }
      throw e;
    }
  };

  /**
   * Expose
   */
  marked.Parser = Parser;
  marked.parser = Parser.parse;
  marked.Renderer = Renderer;
  marked.TextRenderer = TextRenderer;
  marked.Lexer = Lexer;
  marked.lexer = Lexer.lex;
  marked.Tokenizer = Tokenizer;
  marked.Slugger = Slugger;
  marked.parse = marked;
  var options = marked.options;
  var setOptions = marked.setOptions;
  var use = marked.use;
  var walkTokens = marked.walkTokens;
  var parseInline = marked.parseInline;
  var parse = marked;
  var parser = Parser.parse;
  var lexer = Lexer.lex;

  exports.Lexer = Lexer;
  exports.Parser = Parser;
  exports.Renderer = Renderer;
  exports.Slugger = Slugger;
  exports.TextRenderer = TextRenderer;
  exports.Tokenizer = Tokenizer;
  exports.getDefaults = getDefaults;
  exports.lexer = lexer;
  exports.marked = marked;
  exports.options = options;
  exports.parse = parse;
  exports.parseInline = parseInline;
  exports.parser = parser;
  exports.setOptions = setOptions;
  exports.use = use;
  exports.walkTokens = walkTokens;

}));

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/LICENSE.md #######

# License information

## Contribution License Agreement

If you contribute code to this project, you are implicitly allowing your code
to be distributed under the MIT license. You are also implicitly verifying that
all code is your original work. `</legalese>`

## Marked

Copyright (c) 2018+, MarkedJS (https://github.com/markedjs/)
Copyright (c) 2011-2018, Christopher Jeffrey (https://github.com/chjj/)

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

## Markdown

Copyright © 2004, John Gruber
http://daringfireball.net/
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
* Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
* Neither the name “Markdown” nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

This software is provided by the copyright holders and contributors “as is” and any express or implied warranties, including, but not limited to, the implied warranties of merchantability and fitness for a particular purpose are disclaimed. In no event shall the copyright owner or contributors be liable for any direct, indirect, incidental, special, exemplary, or consequential damages (including, but not limited to, procurement of substitute goods or services; loss of use, data, or profits; or business interruption) however caused and on any theory of liability, whether in contract, strict liability, or tort (including negligence or otherwise) arising in any way out of the use of this software, even if advised of the possibility of such damage.

####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/man/marked.1 #######

```

.ds q \N'34'
.TH marked 1

.SH NAME
marked \- a javascript markdown parser

.SH SYNOPSIS
.B marked
[\-o \fI<output>\fP] [\-i \fI<input>\fP] [\-s \fI<string>\fP] [\-\-help]
[\-\-tokens] [\-\-pedantic] [\-\-gfm]
[\-\-breaks] [\-\-sanitize]
[\-\-smart\-lists] [\-\-lang\-prefix \fI<prefix>\fP]
[\-\-no\-etc...] [\-\-silent] [\fIfilename\fP]

.SH DESCRIPTION
.B marked
is a full-featured javascript markdown parser, built for speed.
It also includes multiple GFM features.

.SH EXAMPLES
.TP
cat in.md | marked > out.html
.TP
echo "hello *world*" | marked
.TP
marked \-o out.html \-i in.md \-\-gfm
.TP
marked \-\-output="hello world.html" \-i in.md \-\-no-breaks

.SH OPTIONS
.TP
.BI \-o,\ \-\-output\ [\fIoutput\fP]
Specify file output. If none is specified, write to stdout.
.TP
.BI \-i,\ \-\-input\ [\fIinput\fP]
Specify file input, otherwise use last argument as input file.
If no input file is specified, read from stdin.
.TP
.BI \-s,\ \-\-string\ [\fIstring\fP]
Specify string input instead of a file.
.TP
.BI \-t,\ \-\-tokens
Output a token stream instead of html.
.TP
.BI \-\-pedantic
Conform to obscure parts of markdown.pl as much as possible.
Don't fix original markdown bugs.
.TP
.BI \-\-gfm
Enable github flavored markdown.
.TP
.BI \-\-breaks
Enable GFM line breaks. Only works with the gfm option.
.TP
.BI \-\-sanitize
Sanitize output. Ignore any HTML input.
.TP
.BI \-\-smart\-lists
Use smarter list behavior than the original markdown.
.TP
.BI \-\-lang\-prefix\ [\fIprefix\fP]
Set the prefix for code block classes.
.TP
.BI \-\-mangle
Mangle email addresses.
.TP
.BI \-\-no\-sanitize,\ \-no-etc...
The inverse of any of the marked options above.
.TP
.BI \-\-silent
Silence error output.
.TP
.BI \-h,\ \-\-help
Display help information.

.SH CONFIGURATION
For configuring and running programmatically.

.B Example

    import { marked } from 'marked';
    marked('*foo*', { gfm: true });

.SH BUGS
Please report any bugs to https://github.com/markedjs/marked.

.SH LICENSE
Copyright (c) 2011-2014, Christopher Jeffrey (MIT License).

.SH "SEE ALSO"
.BR markdown(1),
.BR node.js(1)

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/man/marked.1.txt #######

marked(1)		    General Commands Manual		     marked(1)

NAME
       marked - a javascript markdown parser

SYNOPSIS
       marked  [-o  <output>]  [-i  <input>] [-s <string>] [--help] [--tokens]
       [--pedantic]   [--gfm]	 [--breaks]    [--sanitize]    [--smart-lists]
       [--lang-prefix <prefix>] [--no-etc...] [--silent] [filename]


DESCRIPTION
       marked is a full-featured javascript markdown parser, built for speed.
       It also includes multiple GFM features.

EXAMPLES
       cat in.md | marked > out.html

       echo "hello *world*" | marked

       marked -o out.html -i in.md --gfm

       marked --output="hello world.html" -i in.md --no-breaks

OPTIONS
       -o, --output [output]
	      Specify file output. If none is specified, write to stdout.

       -i, --input [input]
	      Specify file input, otherwise use last argument as input file.
	      If no input file is specified, read from stdin.

       -s, --string [string]
	      Specify string input instead of a file.

       -t, --tokens
	      Output a token stream instead of html.

       --pedantic
	      Conform to obscure parts of markdown.pl as much as possible.
	      Don't fix original markdown bugs.

       --gfm  Enable github flavored markdown.

       --breaks
	      Enable GFM line breaks. Only works with the gfm option.

       --sanitize
	      Sanitize output. Ignore any HTML input.

       --smart-lists
	      Use smarter list behavior than the original markdown.

       --lang-prefix [prefix]
	      Set the prefix for code block classes.

       --mangle
	      Mangle email addresses.

       --no-sanitize, -no-etc...
	      The inverse of any of the marked options above.

       --silent
	      Silence error output.

       -h, --help
	      Display help information.

CONFIGURATION
       For configuring and running programmatically.

       Example

	   import { marked } from 'marked';
	   marked('*foo*', { gfm: true });

BUGS
       Please report any bugs to https://github.com/markedjs/marked.

LICENSE
       Copyright (c) 2011-2014, Christopher Jeffrey (MIT License).

SEE ALSO
       markdown(1), node.js(1)

								     marked(1)

####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/marked.min.js #######

```

/**
 * marked - a markdown parser
 * Copyright (c) 2011-2022, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/markedjs/marked
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).marked={})}(this,function(r){"use strict";function i(e,t){for(var u=0;u<t.length;u++){var n=t[u];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=typeof e||null===e)return e;var u=e[Symbol.toPrimitive];if(void 0===u)return("string"===t?String:Number)(e);u=u.call(e,t||"default");if("object"!=typeof u)return u;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==typeof e?e:String(e)}(n.key),n)}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var u=0,n=new Array(t);u<t;u++)n[u]=e[u];return n}function D(e,t){var u,n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var u;if(e)return"string"==typeof e?s(e,t):"Map"===(u="Object"===(u=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:u)||"Set"===u?Array.from(e):"Arguments"===u||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?s(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return n&&(e=n),u=0,function(){return u>=e.length?{done:!0}:{done:!1,value:e[u++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function e(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}r.defaults=e();function u(e){return t[e]}var n=/[&<>"']/,l=new RegExp(n.source,"g"),a=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,o=new RegExp(a.source,"g"),t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function c(e,t){if(t){if(n.test(e))return e.replace(l,u)}else if(a.test(e))return e.replace(o,u);return e}var h=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function x(e){return e.replace(h,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}var p=/(^|[^\[])\^/g;function f(u,e){u="string"==typeof u?u:u.source,e=e||"";var n={replace:function(e,t){return t=(t=t.source||t).replace(p,"$1"),u=u.replace(e,t),n},getRegex:function(){return new RegExp(u,e)}};return n}var g=/[^\w:]/g,Z=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function F(e,t,u){if(e){try{n=decodeURIComponent(x(u)).replace(g,"").toLowerCase()}catch(e){return null}if(0===n.indexOf("javascript:")||0===n.indexOf("vbscript:")||0===n.indexOf("data:"))return null}var n;t&&!Z.test(u)&&(e=u,A[" "+(n=t)]||(q.test(n)?A[" "+n]=n+"/":A[" "+n]=E(n,"/",!0)),t=-1===(n=A[" "+n]).indexOf(":"),u="//"===e.substring(0,2)?t?e:n.replace(O,"$1")+e:"/"===e.charAt(0)?t?e:n.replace(j,"$1")+e:n+e);try{u=encodeURI(u).replace(/%25/g,"%")}catch(e){return null}return u}var A={},q=/^[^:]+:\/*[^/]*$/,O=/^([^:]+:)[\s\S]*$/,j=/^([^:]+:\/*[^/]*)[\s\S]*$/;var d={exec:function(){}};function C(e){for(var t,u,n=1;n<arguments.length;n++)for(u in t=arguments[n])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e}function k(e,t){var u=e.replace(/\|/g,function(e,t,u){for(var n=!1,r=t;0<=--r&&"\\"===u[r];)n=!n;return n?"|":" |"}).split(/ \|/),n=0;if(u[0].trim()||u.shift(),0<u.length&&!u[u.length-1].trim()&&u.pop(),u.length>t)u.splice(t);else for(;u.length<t;)u.push("");for(;n<u.length;n++)u[n]=u[n].trim().replace(/\\\|/g,"|");return u}function E(e,t,u){var n=e.length;if(0===n)return"";for(var r=0;r<n;){var i=e.charAt(n-r-1);if((i!==t||u)&&(i===t||!u))break;r++}return e.slice(0,n-r)}function m(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function b(e,t){if(t<1)return"";for(var u="";1<t;)1&t&&(u+=e),t>>=1,e+=e;return u+e}function B(e,t,u,n){var r=t.href,t=t.title?c(t.title):null,i=e[1].replace(/\\([\[\]])/g,"$1");return"!"!==e[0].charAt(0)?(n.state.inLink=!0,e={type:"link",raw:u,href:r,title:t,text:i,tokens:n.inlineTokens(i)},n.state.inLink=!1,e):{type:"image",raw:u,href:r,title:t,text:c(i)}}var w=function(){function e(e){this.options=e||r.defaults}var t=e.prototype;return t.space=function(e){e=this.rules.block.newline.exec(e);if(e&&0<e[0].length)return{type:"space",raw:e[0]}},t.code=function(e){var t,e=this.rules.block.code.exec(e);if(e)return t=e[0].replace(/^ {1,4}/gm,""),{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:E(t,"\n")}},t.fences=function(e){var t,u,n,r,e=this.rules.block.fences.exec(e);if(e)return t=e[0],u=t,n=e[3]||"",u=null===(u=t.match(/^(\s+)(?:```)/))?n:(r=u[1],n.split("\n").map(function(e){var t=e.match(/^\s+/);return null!==t&&t[0].length>=r.length?e.slice(r.length):e}).join("\n")),{type:"code",raw:t,lang:e[2]&&e[2].trim().replace(this.rules.inline._escapes,"$1"),text:u}},t.heading=function(e){var t,u,e=this.rules.block.heading.exec(e);if(e)return t=e[2].trim(),/#$/.test(t)&&(u=E(t,"#"),!this.options.pedantic&&u&&!/ $/.test(u)||(t=u.trim())),{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}},t.hr=function(e){e=this.rules.block.hr.exec(e);if(e)return{type:"hr",raw:e[0]}},t.blockquote=function(e){var t,u,n,e=this.rules.block.blockquote.exec(e);if(e)return t=e[0].replace(/^ *>[ \t]?/gm,""),u=this.lexer.state.top,this.lexer.state.top=!0,n=this.lexer.blockTokens(t),this.lexer.state.top=u,{type:"blockquote",raw:e[0],tokens:n,text:t}},t.list=function(e){var t=this.rules.block.list.exec(e);if(t){var u,n,r,i,s,l,a,o,D,c,h,p=1<(g=t[1].trim()).length,f={type:"list",raw:"",ordered:p,start:p?+g.slice(0,-1):"",loose:!1,items:[]},g=p?"\\d{1,9}\\"+g.slice(-1):"\\"+g;this.options.pedantic&&(g=p?g:"[*+-]");for(var F=new RegExp("^( {0,3}"+g+")((?:[\t ][^\\n]*)?(?:\\n|$))");e&&(h=!1,t=F.exec(e))&&!this.rules.block.hr.test(e);){if(u=t[0],e=e.substring(u.length),a=t[2].split("\n",1)[0].replace(/^\t+/,function(e){return" ".repeat(3*e.length)}),o=e.split("\n",1)[0],this.options.pedantic?(i=2,c=a.trimLeft()):(i=t[2].search(/[^ ]/),c=a.slice(i=4<i?1:i),i+=t[1].length),s=!1,!a&&/^ *$/.test(o)&&(u+=o+"\n",e=e.substring(o.length+1),h=!0),!h)for(var A=new RegExp("^ {0,"+Math.min(3,i-1)+"}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))"),d=new RegExp("^ {0,"+Math.min(3,i-1)+"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)"),C=new RegExp("^ {0,"+Math.min(3,i-1)+"}(?:```|~~~)"),k=new RegExp("^ {0,"+Math.min(3,i-1)+"}#");e&&(o=D=e.split("\n",1)[0],this.options.pedantic&&(o=o.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!C.test(o))&&!k.test(o)&&!A.test(o)&&!d.test(e);){if(o.search(/[^ ]/)>=i||!o.trim())c+="\n"+o.slice(i);else{if(s)break;if(4<=a.search(/[^ ]/))break;if(C.test(a))break;if(k.test(a))break;if(d.test(a))break;c+="\n"+o}s||o.trim()||(s=!0),u+=D+"\n",e=e.substring(D.length+1),a=o.slice(i)}f.loose||(l?f.loose=!0:/\n *\n *$/.test(u)&&(l=!0)),this.options.gfm&&(n=/^\[[ xX]\] /.exec(c))&&(r="[ ] "!==n[0],c=c.replace(/^\[[ xX]\] +/,"")),f.items.push({type:"list_item",raw:u,task:!!n,checked:r,loose:!1,text:c}),f.raw+=u}f.items[f.items.length-1].raw=u.trimRight(),f.items[f.items.length-1].text=c.trimRight(),f.raw=f.raw.trimRight();for(var E,x=f.items.length,m=0;m<x;m++)this.lexer.state.top=!1,f.items[m].tokens=this.lexer.blockTokens(f.items[m].text,[]),f.loose||(E=0<(E=f.items[m].tokens.filter(function(e){return"space"===e.type})).length&&E.some(function(e){return/\n.*\n/.test(e.raw)}),f.loose=E);if(f.loose)for(m=0;m<x;m++)f.items[m].loose=!0;return f}},t.html=function(e){var t,e=this.rules.block.html.exec(e);if(e)return t={type:"html",raw:e[0],pre:!this.options.sanitizer&&("pre"===e[1]||"script"===e[1]||"style"===e[1]),text:e[0]},this.options.sanitize&&(e=this.options.sanitizer?this.options.sanitizer(e[0]):c(e[0]),t.type="paragraph",t.text=e,t.tokens=this.lexer.inline(e)),t},t.def=function(e){var t,u,n,e=this.rules.block.def.exec(e);if(e)return t=e[1].toLowerCase().replace(/\s+/g," "),u=e[2]?e[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",n=e[3]&&e[3].substring(1,e[3].length-1).replace(this.rules.inline._escapes,"$1"),{type:"def",tag:t,raw:e[0],href:u,title:n}},t.table=function(e){e=this.rules.block.table.exec(e);if(e){var t={type:"table",header:k(e[1]).map(function(e){return{text:e}}),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(t.header.length===t.align.length){t.raw=e[0];for(var u,n,r,i=t.align.length,s=0;s<i;s++)/^ *-+: *$/.test(t.align[s])?t.align[s]="right":/^ *:-+: *$/.test(t.align[s])?t.align[s]="center":/^ *:-+ *$/.test(t.align[s])?t.align[s]="left":t.align[s]=null;for(i=t.rows.length,s=0;s<i;s++)t.rows[s]=k(t.rows[s],t.header.length).map(function(e){return{text:e}});for(i=t.header.length,u=0;u<i;u++)t.header[u].tokens=this.lexer.inline(t.header[u].text);for(i=t.rows.length,u=0;u<i;u++)for(r=t.rows[u],n=0;n<r.length;n++)r[n].tokens=this.lexer.inline(r[n].text);return t}}},t.lheading=function(e){e=this.rules.block.lheading.exec(e);if(e)return{type:"heading",raw:e[0],depth:"="===e[2].charAt(0)?1:2,text:e[1],tokens:this.lexer.inline(e[1])}},t.paragraph=function(e){var t,e=this.rules.block.paragraph.exec(e);if(e)return t="\n"===e[1].charAt(e[1].length-1)?e[1].slice(0,-1):e[1],{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}},t.text=function(e){e=this.rules.block.text.exec(e);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}},t.escape=function(e){e=this.rules.inline.escape.exec(e);if(e)return{type:"escape",raw:e[0],text:c(e[1])}},t.tag=function(e){e=this.rules.inline.tag.exec(e);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(e[0]):c(e[0]):e[0]}},t.link=function(e){e=this.rules.inline.link.exec(e);if(e){var t=e[2].trim();if(!this.options.pedantic&&/^</.test(t)){if(!/>$/.test(t))return;var u=E(t.slice(0,-1),"\\");if((t.length-u.length)%2==0)return}else{u=function(e,t){if(-1!==e.indexOf(t[1]))for(var u=e.length,n=0,r=0;r<u;r++)if("\\"===e[r])r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&--n<0)return r;return-1}(e[2],"()");-1<u&&(r=(0===e[0].indexOf("!")?5:4)+e[1].length+u,e[2]=e[2].substring(0,u),e[0]=e[0].substring(0,r).trim(),e[3]="")}var n,u=e[2],r="";return this.options.pedantic?(n=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(u))&&(u=n[1],r=n[3]):r=e[3]?e[3].slice(1,-1):"",u=u.trim(),B(e,{href:(u=/^</.test(u)?this.options.pedantic&&!/>$/.test(t)?u.slice(1):u.slice(1,-1):u)&&u.replace(this.rules.inline._escapes,"$1"),title:r&&r.replace(this.rules.inline._escapes,"$1")},e[0],this.lexer)}},t.reflink=function(e,t){var u;if(u=(u=this.rules.inline.reflink.exec(e))||this.rules.inline.nolink.exec(e))return(e=t[(e=(u[2]||u[1]).replace(/\s+/g," ")).toLowerCase()])?B(u,e,u[0],this.lexer):{type:"text",raw:t=u[0].charAt(0),text:t}},t.emStrong=function(e,t,u){void 0===u&&(u="");var n=this.rules.inline.emStrong.lDelim.exec(e);if(n&&(!n[3]||!u.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var r=n[1]||n[2]||"";if(!r||""===u||this.rules.inline.punctuation.exec(u)){var i=n[0].length-1,s=i,l=0,a="*"===n[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(a.lastIndex=0,t=t.slice(-1*e.length+i);null!=(n=a.exec(t));){var o,D=n[1]||n[2]||n[3]||n[4]||n[5]||n[6];if(D)if(o=D.length,n[3]||n[4])s+=o;else if((n[5]||n[6])&&i%3&&!((i+o)%3))l+=o;else if(!(0<(s-=o)))return o=Math.min(o,o+s+l),D=e.slice(0,i+n.index+(n[0].length-D.length)+o),Math.min(i,o)%2?(o=D.slice(1,-1),{type:"em",raw:D,text:o,tokens:this.lexer.inlineTokens(o)}):(o=D.slice(2,-2),{type:"strong",raw:D,text:o,tokens:this.lexer.inlineTokens(o)})}}}},t.codespan=function(e){var t,u,n,e=this.rules.inline.code.exec(e);if(e)return n=e[2].replace(/\n/g," "),t=/[^ ]/.test(n),u=/^ /.test(n)&&/ $/.test(n),n=c(n=t&&u?n.substring(1,n.length-1):n,!0),{type:"codespan",raw:e[0],text:n}},t.br=function(e){e=this.rules.inline.br.exec(e);if(e)return{type:"br",raw:e[0]}},t.del=function(e){e=this.rules.inline.del.exec(e);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}},t.autolink=function(e,t){var u,e=this.rules.inline.autolink.exec(e);if(e)return t="@"===e[2]?"mailto:"+(u=c(this.options.mangle?t(e[1]):e[1])):u=c(e[1]),{type:"link",raw:e[0],text:u,href:t,tokens:[{type:"text",raw:u,text:u}]}},t.url=function(e,t){var u,n,r,i;if(u=this.rules.inline.url.exec(e)){if("@"===u[2])r="mailto:"+(n=c(this.options.mangle?t(u[0]):u[0]));else{for(;i=u[0],u[0]=this.rules.inline._backpedal.exec(u[0])[0],i!==u[0];);n=c(u[0]),r="www."===u[1]?"http://"+u[0]:u[0]}return{type:"link",raw:u[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}},t.inlineText=function(e,t){e=this.rules.inline.text.exec(e);if(e)return t=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(e[0]):c(e[0]):e[0]:c(this.options.smartypants?t(e[0]):e[0]),{type:"text",raw:e[0],text:t}},e}(),y={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:d,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/},v=(y.def=f(y.def).replace("label",y._label).replace("title",y._title).getRegex(),y.bullet=/(?:[*+-]|\d{1,9}[.)])/,y.listItemStart=f(/^( *)(bull) */).replace("bull",y.bullet).getRegex(),y.list=f(y.list).replace(/bull/g,y.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+y.def.source+")").getRegex(),y._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",y._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,y.html=f(y.html,"i").replace("comment",y._comment).replace("tag",y._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),y.paragraph=f(y._paragraph).replace("hr",y.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",y._tag).getRegex(),y.blockquote=f(y.blockquote).replace("paragraph",y.paragraph).getRegex(),y.normal=C({},y),y.gfm=C({},y.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),y.gfm.table=f(y.gfm.table).replace("hr",y.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",y._tag).getRegex(),y.gfm.paragraph=f(y._paragraph).replace("hr",y.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",y.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",y._tag).getRegex(),y.pedantic=C({},y.normal,{html:f("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",y._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:d,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:f(y.normal._paragraph).replace("hr",y.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",y.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()}),{escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:d,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:d,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/});function L(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function _(e){for(var t,u="",n=e.length,r=0;r<n;r++)t=e.charCodeAt(r),u+="&#"+(t=.5<Math.random()?"x"+t.toString(16):t)+";";return u}v._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",v.punctuation=f(v.punctuation).replace(/punctuation/g,v._punctuation).getRegex(),v.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,v.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g,v._comment=f(y._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),v.emStrong.lDelim=f(v.emStrong.lDelim).replace(/punct/g,v._punctuation).getRegex(),v.emStrong.rDelimAst=f(v.emStrong.rDelimAst,"g").replace(/punct/g,v._punctuation).getRegex(),v.emStrong.rDelimUnd=f(v.emStrong.rDelimUnd,"g").replace(/punct/g,v._punctuation).getRegex(),v._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,v._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,v._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,v.autolink=f(v.autolink).replace("scheme",v._scheme).replace("email",v._email).getRegex(),v._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,v.tag=f(v.tag).replace("comment",v._comment).replace("attribute",v._attribute).getRegex(),v._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,v._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,v._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,v.link=f(v.link).replace("label",v._label).replace("href",v._href).replace("title",v._title).getRegex(),v.reflink=f(v.reflink).replace("label",v._label).replace("ref",y._label).getRegex(),v.nolink=f(v.nolink).replace("ref",y._label).getRegex(),v.reflinkSearch=f(v.reflinkSearch,"g").replace("reflink",v.reflink).replace("nolink",v.nolink).getRegex(),v.normal=C({},v),v.pedantic=C({},v.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:f(/^!?\[(label)\]\((.*?)\)/).replace("label",v._label).getRegex(),reflink:f(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",v._label).getRegex()}),v.gfm=C({},v.normal,{escape:f(v.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),v.gfm.url=f(v.gfm.url,"i").replace("email",v.gfm._extended_email).getRegex(),v.breaks=C({},v.gfm,{br:f(v.br).replace("{2,}","*").getRegex(),text:f(v.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var z=function(){function u(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||r.defaults,this.options.tokenizer=this.options.tokenizer||new w,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,(this.tokenizer.lexer=this).inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};e={block:y.normal,inline:v.normal};this.options.pedantic?(e.block=y.pedantic,e.inline=v.pedantic):this.options.gfm&&(e.block=y.gfm,this.options.breaks?e.inline=v.breaks:e.inline=v.gfm),this.tokenizer.rules=e}u.lex=function(e,t){return new u(t).lex(e)},u.lexInline=function(e,t){return new u(t).inlineTokens(e)};var e,t,n=u.prototype;return n.lex=function(e){var t;for(e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens},n.blockTokens=function(r,t){var u,e,i,n,s=this;for(void 0===t&&(t=[]),r=this.options.pedantic?r.replace(/\t/g,"    ").replace(/^ +$/gm,""):r.replace(/^( *)(\t+)/gm,function(e,t,u){return t+"    ".repeat(u.length)});r;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(e){return!!(u=e.call({lexer:s},r,t))&&(r=r.substring(u.raw.length),t.push(u),!0)})))if(u=this.tokenizer.space(r))r=r.substring(u.raw.length),1===u.raw.length&&0<t.length?t[t.length-1].raw+="\n":t.push(u);else if(u=this.tokenizer.code(r))r=r.substring(u.raw.length),!(e=t[t.length-1])||"paragraph"!==e.type&&"text"!==e.type?t.push(u):(e.raw+="\n"+u.raw,e.text+="\n"+u.text,this.inlineQueue[this.inlineQueue.length-1].src=e.text);else if(u=this.tokenizer.fences(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.heading(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.hr(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.blockquote(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.list(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.html(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.def(r))r=r.substring(u.raw.length),!(e=t[t.length-1])||"paragraph"!==e.type&&"text"!==e.type?this.tokens.links[u.tag]||(this.tokens.links[u.tag]={href:u.href,title:u.title}):(e.raw+="\n"+u.raw,e.text+="\n"+u.raw,this.inlineQueue[this.inlineQueue.length-1].src=e.text);else if(u=this.tokenizer.table(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.lheading(r))r=r.substring(u.raw.length),t.push(u);else if(i=r,this.options.extensions&&this.options.extensions.startBlock&&!function(){var t=1/0,u=r.slice(1),n=void 0;s.options.extensions.startBlock.forEach(function(e){"number"==typeof(n=e.call({lexer:this},u))&&0<=n&&(t=Math.min(t,n))}),t<1/0&&0<=t&&(i=r.substring(0,t+1))}(),this.state.top&&(u=this.tokenizer.paragraph(i)))e=t[t.length-1],n&&"paragraph"===e.type?(e.raw+="\n"+u.raw,e.text+="\n"+u.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=e.text):t.push(u),n=i.length!==r.length,r=r.substring(u.raw.length);else if(u=this.tokenizer.text(r))r=r.substring(u.raw.length),(e=t[t.length-1])&&"text"===e.type?(e.raw+="\n"+u.raw,e.text+="\n"+u.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=e.text):t.push(u);else if(r){var l="Infinite loop on byte: "+r.charCodeAt(0);if(this.options.silent){console.error(l);break}throw new Error(l)}return this.state.top=!0,t},n.inline=function(e,t){return this.inlineQueue.push({src:e,tokens:t=void 0===t?[]:t}),t},n.inlineTokens=function(r,t){var u,e,i,n,s,l,a=this,o=(void 0===t&&(t=[]),r);if(this.tokens.links){var D=Object.keys(this.tokens.links);if(0<D.length)for(;null!=(n=this.tokenizer.rules.inline.reflinkSearch.exec(o));)D.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,n.index)+"["+b("a",n[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(n=this.tokenizer.rules.inline.blockSkip.exec(o));)o=o.slice(0,n.index)+"["+b("a",n[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(n=this.tokenizer.rules.inline.escapedEmSt.exec(o));)o=o.slice(0,n.index+n[0].length-2)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;r;)if(s||(l=""),s=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(e){return!!(u=e.call({lexer:a},r,t))&&(r=r.substring(u.raw.length),t.push(u),!0)})))if(u=this.tokenizer.escape(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.tag(r))r=r.substring(u.raw.length),(e=t[t.length-1])&&"text"===u.type&&"text"===e.type?(e.raw+=u.raw,e.text+=u.text):t.push(u);else if(u=this.tokenizer.link(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.reflink(r,this.tokens.links))r=r.substring(u.raw.length),(e=t[t.length-1])&&"text"===u.type&&"text"===e.type?(e.raw+=u.raw,e.text+=u.text):t.push(u);else if(u=this.tokenizer.emStrong(r,o,l))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.codespan(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.br(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.del(r))r=r.substring(u.raw.length),t.push(u);else if(u=this.tokenizer.autolink(r,_))r=r.substring(u.raw.length),t.push(u);else if(!this.state.inLink&&(u=this.tokenizer.url(r,_)))r=r.substring(u.raw.length),t.push(u);else if(i=r,this.options.extensions&&this.options.extensions.startInline&&!function(){var t=1/0,u=r.slice(1),n=void 0;a.options.extensions.startInline.forEach(function(e){"number"==typeof(n=e.call({lexer:this},u))&&0<=n&&(t=Math.min(t,n))}),t<1/0&&0<=t&&(i=r.substring(0,t+1))}(),u=this.tokenizer.inlineText(i,L))r=r.substring(u.raw.length),"_"!==u.raw.slice(-1)&&(l=u.raw.slice(-1)),s=!0,(e=t[t.length-1])&&"text"===e.type?(e.raw+=u.raw,e.text+=u.text):t.push(u);else if(r){var c="Infinite loop on byte: "+r.charCodeAt(0);if(this.options.silent){console.error(c);break}throw new Error(c)}return t},n=u,t=[{key:"rules",get:function(){return{block:y,inline:v}}}],(e=null)&&i(n.prototype,e),t&&i(n,t),Object.defineProperty(n,"prototype",{writable:!1}),u}(),$=function(){function e(e){this.options=e||r.defaults}var t=e.prototype;return t.code=function(e,t,u){var n,t=(t||"").match(/\S*/)[0];return this.options.highlight&&null!=(n=this.options.highlight(e,t))&&n!==e&&(u=!0,e=n),e=e.replace(/\n$/,"")+"\n",t?'<pre><code class="'+this.options.langPrefix+c(t)+'">'+(u?e:c(e,!0))+"</code></pre>\n":"<pre><code>"+(u?e:c(e,!0))+"</code></pre>\n"},t.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},t.html=function(e){return e},t.heading=function(e,t,u,n){return this.options.headerIds?"<h"+t+' id="'+(this.options.headerPrefix+n.slug(u))+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},t.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},t.list=function(e,t,u){var n=t?"ol":"ul";return"<"+n+(t&&1!==u?' start="'+u+'"':"")+">\n"+e+"</"+n+">\n"},t.listitem=function(e){return"<li>"+e+"</li>\n"},t.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},t.paragraph=function(e){return"<p>"+e+"</p>\n"},t.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n"+(t=t&&"<tbody>"+t+"</tbody>")+"</table>\n"},t.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},t.tablecell=function(e,t){var u=t.header?"th":"td";return(t.align?"<"+u+' align="'+t.align+'">':"<"+u+">")+e+"</"+u+">\n"},t.strong=function(e){return"<strong>"+e+"</strong>"},t.em=function(e){return"<em>"+e+"</em>"},t.codespan=function(e){return"<code>"+e+"</code>"},t.br=function(){return this.options.xhtml?"<br/>":"<br>"},t.del=function(e){return"<del>"+e+"</del>"},t.link=function(e,t,u){return null===(e=F(this.options.sanitize,this.options.baseUrl,e))?u:(e='<a href="'+e+'"',t&&(e+=' title="'+t+'"'),e+">"+u+"</a>")},t.image=function(e,t,u){return null===(e=F(this.options.sanitize,this.options.baseUrl,e))?u:(e='<img src="'+e+'" alt="'+u+'"',t&&(e+=' title="'+t+'"'),e+(this.options.xhtml?"/>":">"))},t.text=function(e){return e},e}(),S=function(){function e(){}var t=e.prototype;return t.strong=function(e){return e},t.em=function(e){return e},t.codespan=function(e){return e},t.del=function(e){return e},t.html=function(e){return e},t.text=function(e){return e},t.link=function(e,t,u){return""+u},t.image=function(e,t,u){return""+u},t.br=function(){return""},e}(),T=function(){function e(){this.seen={}}var t=e.prototype;return t.serialize=function(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},t.getNextSafeSlug=function(e,t){var u=e,n=0;if(this.seen.hasOwnProperty(u))for(n=this.seen[e];u=e+"-"+ ++n,this.seen.hasOwnProperty(u););return t||(this.seen[e]=n,this.seen[u]=0),u},t.slug=function(e,t){void 0===t&&(t={});e=this.serialize(e);return this.getNextSafeSlug(e,t.dryrun)},e}(),R=function(){function u(e){this.options=e||r.defaults,this.options.renderer=this.options.renderer||new $,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new S,this.slugger=new T}u.parse=function(e,t){return new u(t).parse(e)},u.parseInline=function(e,t){return new u(t).parseInline(e)};var e=u.prototype;return e.parse=function(e,t){void 0===t&&(t=!0);for(var u,n,r,i,s,l,a,o,D,c,h,p,f,g,F,A,d="",C=e.length,k=0;k<C;k++)if(o=e[k],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]&&(!1!==(A=this.options.extensions.renderers[o.type].call({parser:this},o))||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)))d+=A||"";else switch(o.type){case"space":continue;case"hr":d+=this.renderer.hr();continue;case"heading":d+=this.renderer.heading(this.parseInline(o.tokens),o.depth,x(this.parseInline(o.tokens,this.textRenderer)),this.slugger);continue;case"code":d+=this.renderer.code(o.text,o.lang,o.escaped);continue;case"table":for(l=D="",r=o.header.length,u=0;u<r;u++)l+=this.renderer.tablecell(this.parseInline(o.header[u].tokens),{header:!0,align:o.align[u]});for(D+=this.renderer.tablerow(l),a="",r=o.rows.length,u=0;u<r;u++){for(l="",i=(s=o.rows[u]).length,n=0;n<i;n++)l+=this.renderer.tablecell(this.parseInline(s[n].tokens),{header:!1,align:o.align[n]});a+=this.renderer.tablerow(l)}d+=this.renderer.table(D,a);continue;case"blockquote":a=this.parse(o.tokens),d+=this.renderer.blockquote(a);continue;case"list":for(D=o.ordered,E=o.start,c=o.loose,r=o.items.length,a="",u=0;u<r;u++)f=(p=o.items[u]).checked,g=p.task,h="",p.task&&(F=this.renderer.checkbox(f),c?0<p.tokens.length&&"paragraph"===p.tokens[0].type?(p.tokens[0].text=F+" "+p.tokens[0].text,p.tokens[0].tokens&&0<p.tokens[0].tokens.length&&"text"===p.tokens[0].tokens[0].type&&(p.tokens[0].tokens[0].text=F+" "+p.tokens[0].tokens[0].text)):p.tokens.unshift({type:"text",text:F}):h+=F),h+=this.parse(p.tokens,c),a+=this.renderer.listitem(h,g,f);d+=this.renderer.list(a,D,E);continue;case"html":d+=this.renderer.html(o.text);continue;case"paragraph":d+=this.renderer.paragraph(this.parseInline(o.tokens));continue;case"text":for(a=o.tokens?this.parseInline(o.tokens):o.text;k+1<C&&"text"===e[k+1].type;)a+="\n"+((o=e[++k]).tokens?this.parseInline(o.tokens):o.text);d+=t?this.renderer.paragraph(a):a;continue;default:var E='Token with "'+o.type+'" type was not found.';if(this.options.silent)return void console.error(E);throw new Error(E)}return d},e.parseInline=function(e,t){t=t||this.renderer;for(var u,n,r="",i=e.length,s=0;s<i;s++)if(u=e[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[u.type]&&(!1!==(n=this.options.extensions.renderers[u.type].call({parser:this},u))||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(u.type)))r+=n||"";else switch(u.type){case"escape":r+=t.text(u.text);break;case"html":r+=t.html(u.text);break;case"link":r+=t.link(u.href,u.title,this.parseInline(u.tokens,t));break;case"image":r+=t.image(u.href,u.title,u.text);break;case"strong":r+=t.strong(this.parseInline(u.tokens,t));break;case"em":r+=t.em(this.parseInline(u.tokens,t));break;case"codespan":r+=t.codespan(u.text);break;case"br":r+=t.br();break;case"del":r+=t.del(this.parseInline(u.tokens,t));break;case"text":r+=t.text(u.text);break;default:var l='Token with "'+u.type+'" type was not found.';if(this.options.silent)return void console.error(l);throw new Error(l)}return r},u}();function I(e,u,n){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof u&&(n=u,u=null),m(u=C({},I.defaults,u||{})),n){var r,i=u.highlight;try{r=z.lex(e,u)}catch(e){return n(e)}var s,l=function(t){var e;if(!t)try{u.walkTokens&&I.walkTokens(r,u.walkTokens),e=R.parse(r,u)}catch(e){t=e}return u.highlight=i,t?n(t):n(null,e)};return!i||i.length<3?l():(delete u.highlight,r.length?(s=0,I.walkTokens(r,function(u){"code"===u.type&&(s++,setTimeout(function(){i(u.text,u.lang,function(e,t){if(e)return l(e);null!=t&&t!==u.text&&(u.text=t,u.escaped=!0),0===--s&&l()})},0))}),void(0===s&&l())):l())}function t(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",u.silent)return"<p>An error occurred:</p><pre>"+c(e.message+"",!0)+"</pre>";throw e}try{var a=z.lex(e,u);if(u.walkTokens){if(u.async)return Promise.all(I.walkTokens(a,u.walkTokens)).then(function(){return R.parse(a,u)}).catch(t);I.walkTokens(a,u.walkTokens)}return R.parse(a,u)}catch(e){t(e)}}I.options=I.setOptions=function(e){return C(I.defaults,e),e=I.defaults,r.defaults=e,I},I.getDefaults=e,I.defaults=r.defaults,I.use=function(){for(var o=I.defaults.extensions||{renderers:{},childTokens:{}},e=arguments.length,t=new Array(e),u=0;u<e;u++)t[u]=arguments[u];t.forEach(function(s){var u,e=C({},s);if(e.async=I.defaults.async||e.async,s.extensions&&(s.extensions.forEach(function(r){if(!r.name)throw new Error("extension name required");var i;if(r.renderer&&(i=o.renderers[r.name],o.renderers[r.name]=i?function(){for(var e=arguments.length,t=new Array(e),u=0;u<e;u++)t[u]=arguments[u];var n=r.renderer.apply(this,t);return n=!1===n?i.apply(this,t):n}:r.renderer),r.tokenizer){if(!r.level||"block"!==r.level&&"inline"!==r.level)throw new Error("extension level must be 'block' or 'inline'");o[r.level]?o[r.level].unshift(r.tokenizer):o[r.level]=[r.tokenizer],r.start&&("block"===r.level?o.startBlock?o.startBlock.push(r.start):o.startBlock=[r.start]:"inline"===r.level&&(o.startInline?o.startInline.push(r.start):o.startInline=[r.start]))}r.childTokens&&(o.childTokens[r.name]=r.childTokens)}),e.extensions=o),s.renderer){var t,l=I.defaults.renderer||new $;for(t in s.renderer)!function(r){var i=l[r];l[r]=function(){for(var e=arguments.length,t=new Array(e),u=0;u<e;u++)t[u]=arguments[u];var n=s.renderer[r].apply(l,t);return n=!1===n?i.apply(l,t):n}}(t);e.renderer=l}if(s.tokenizer){var n,a=I.defaults.tokenizer||new w;for(n in s.tokenizer)!function(r){var i=a[r];a[r]=function(){for(var e=arguments.length,t=new Array(e),u=0;u<e;u++)t[u]=arguments[u];var n=s.tokenizer[r].apply(a,t);return n=!1===n?i.apply(a,t):n}}(n);e.tokenizer=a}s.walkTokens&&(u=I.defaults.walkTokens,e.walkTokens=function(e){var t=[];return t.push(s.walkTokens.call(this,e)),t=u?t.concat(u.call(this,e)):t}),I.setOptions(e)})},I.walkTokens=function(e,l){for(var a,o=[],t=D(e);!(a=t()).done;)!function(){var t=a.value;switch(o=o.concat(l.call(I,t)),t.type){case"table":for(var e=D(t.header);!(u=e()).done;){var u=u.value;o=o.concat(I.walkTokens(u.tokens,l))}for(var n,r=D(t.rows);!(n=r()).done;)for(var i=D(n.value);!(s=i()).done;){var s=s.value;o=o.concat(I.walkTokens(s.tokens,l))}break;case"list":o=o.concat(I.walkTokens(t.items,l));break;default:I.defaults.extensions&&I.defaults.extensions.childTokens&&I.defaults.extensions.childTokens[t.type]?I.defaults.extensions.childTokens[t.type].forEach(function(e){o=o.concat(I.walkTokens(t[e],l))}):t.tokens&&(o=o.concat(I.walkTokens(t.tokens,l)))}}();return o},I.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");m(t=C({},I.defaults,t||{}));try{var u=z.lexInline(e,t);return t.walkTokens&&I.walkTokens(u,t.walkTokens),R.parseInline(u,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+c(e.message+"",!0)+"</pre>";throw e}},I.Parser=R,I.parser=R.parse,I.Renderer=$,I.TextRenderer=S,I.Lexer=z,I.lexer=z.lex,I.Tokenizer=w,I.Slugger=T;var d=(I.parse=I).options,P=I.setOptions,Q=I.use,U=I.walkTokens,M=I.parseInline,N=I,X=R.parse,G=z.lex;r.Lexer=z,r.Parser=R,r.Renderer=$,r.Slugger=T,r.TextRenderer=S,r.Tokenizer=w,r.getDefaults=e,r.lexer=G,r.marked=I,r.options=d,r.parse=N,r.parseInline=M,r.parser=X,r.setOptions=P,r.use=Q,r.walkTokens=U});
```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/package.json #######

```

{
  "name": "marked",
  "description": "A markdown parser built for speed",
  "author": "Christopher Jeffrey",
  "version": "4.2.5",
  "type": "module",
  "main": "./lib/marked.cjs",
  "module": "./lib/marked.esm.js",
  "browser": "./lib/marked.umd.js",
  "bin": {
    "marked": "bin/marked.js"
  },
  "man": "./man/marked.1",
  "files": [
    "bin/",
    "lib/",
    "src/",
    "man/",
    "marked.min.js"
  ],
  "exports": {
    ".": {
      "import": "./lib/marked.esm.js",
      "default": "./lib/marked.cjs"
    },
    "./bin/marked": "./bin/marked.js",
    "./package.json": "./package.json"
  },
  "repository": "git://github.com/markedjs/marked.git",
  "homepage": "https://marked.js.org",
  "bugs": {
    "url": "http://github.com/markedjs/marked/issues"
  },
  "license": "MIT",
  "keywords": [
    "markdown",
    "markup",
    "html"
  ],
  "tags": [
    "markdown",
    "markup",
    "html"
  ],
  "devDependencies": {
    "@babel/core": "^7.20.5",
    "@babel/preset-env": "^7.20.2",
    "@markedjs/html-differ": "^4.0.2",
    "@rollup/plugin-babel": "^6.0.3",
    "@semantic-release/commit-analyzer": "^9.0.2",
    "@semantic-release/git": "^10.0.1",
    "@semantic-release/github": "^8.0.7",
    "@semantic-release/npm": "^9.0.1",
    "@semantic-release/release-notes-generator": "^10.0.3",
    "cheerio": "^1.0.0-rc.12",
    "commonmark": "0.30.0",
    "eslint": "^8.30.0",
    "eslint-config-standard": "^17.0.0",
    "eslint-plugin-import": "^2.26.0",
    "eslint-plugin-n": "^15.6.0",
    "eslint-plugin-promise": "^6.1.1",
    "front-matter": "^4.0.2",
    "highlight.js": "^11.7.0",
    "jasmine": "^4.5.0",
    "markdown-it": "13.0.1",
    "node-fetch": "^3.3.0",
    "rollup": "^3.7.5",
    "semantic-release": "^19.0.5",
    "titleize": "^3.0.0",
    "uglify-js": "^3.17.4",
    "vuln-regex-detector": "^1.3.0"
  },
  "scripts": {
    "test": "jasmine --config=jasmine.json",
    "test:all": "npm test && npm run test:lint",
    "test:unit": "npm test -- test/unit/**/*-spec.js",
    "test:specs": "npm test -- test/specs/**/*-spec.js",
    "test:lint": "eslint .",
    "test:redos": "node test/vuln-regex.js",
    "test:update": "node test/update-specs.js",
    "rules": "node test/rules.js",
    "bench": "npm run rollup && node test/bench.js",
    "lint": "eslint --fix .",
    "build:reset": "git checkout upstream/master lib/marked.cjs lib/marked.umd.js lib/marked.esm.js marked.min.js",
    "build": "npm run rollup && npm run minify",
    "build:docs": "node build-docs.js",
    "rollup": "rollup -c rollup.config.js",
    "minify": "uglifyjs lib/marked.umd.js -cm  --comments /Copyright/ -o marked.min.js",
    "preversion": "npm run build && (git diff --quiet || git commit -am build)"
  },
  "engines": {
    "node": ">= 12"
  }
}

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/README.md #######

<a href="https://marked.js.org">
  <img width="60px" height="60px" src="https://marked.js.org/img/logo-black.svg" align="right" />
</a>

# Marked

[![npm](https://badgen.net/npm/v/marked)](https://www.npmjs.com/package/marked)
[![gzip size](https://badgen.net/badgesize/gzip/https://cdn.jsdelivr.net/npm/marked/marked.min.js)](https://cdn.jsdelivr.net/npm/marked/marked.min.js)
[![install size](https://badgen.net/packagephobia/install/marked)](https://packagephobia.now.sh/result?p=marked)
[![downloads](https://badgen.net/npm/dt/marked)](https://www.npmjs.com/package/marked)
[![github actions](https://github.com/markedjs/marked/workflows/Tests/badge.svg)](https://github.com/markedjs/marked/actions)
[![snyk](https://snyk.io/test/npm/marked/badge.svg)](https://snyk.io/test/npm/marked)

- ⚡ built for speed
- ⬇️ low-level compiler for parsing markdown without caching or blocking for long periods of time
- ⚖️ light-weight while implementing all markdown features from the supported flavors & specifications
- 🌐 works in a browser, on a server, or from a command line interface (CLI)

## Demo

Checkout the [demo page](https://marked.js.org/demo/) to see marked in action ⛹️

## Docs

Our [documentation pages](https://marked.js.org) are also rendered using marked 💯

Also read about:

* [Options](https://marked.js.org/#/USING_ADVANCED.md)
* [Extensibility](https://marked.js.org/#/USING_PRO.md)

## Compatibility

**Node.js:** Only [current and LTS](https://nodejs.org/en/about/releases/) Node.js versions are supported. End of life Node.js versions may become incompatible with Marked at any point in time.

**Browser:** Not IE11 :)

## Installation

**CLI:** 

```sh 
npm install -g marked
```

**In-browser:** 

```sh
npm install marked
npm install @types/marked # For TypeScript projects
```

## Usage

### Warning: 🚨 Marked does not [sanitize](https://marked.js.org/#/USING_ADVANCED.md#options) the output HTML. Please use a sanitize library, like [DOMPurify](https://github.com/cure53/DOMPurify) (recommended), [sanitize-html](https://github.com/apostrophecms/sanitize-html) or [insane](https://github.com/bevacqua/insane) on the *output* HTML! 🚨

```
DOMPurify.sanitize(marked.parse(`<img src="x" onerror="alert('not happening')">`));
```

**CLI**

``` bash
# Example with stdin input
$ marked -o hello.html
hello world
^D
$ cat hello.html
<p>hello world</p>
```

```bash
# Print all options
$ marked --help
```

**Browser**

```html
<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Marked in the browser</title>
</head>
<body>
  <div id="content"></div>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    document.getElementById('content').innerHTML =
      marked.parse('# Marked in the browser\n\nRendered by **marked**.');
  </script>
</body>
</html>
```

## License

Copyright (c) 2011-2022, Christopher Jeffrey. (MIT License)

####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/defaults.js #######

```

export function getDefaults() {
  return {
    async: false,
    baseUrl: null,
    breaks: false,
    extensions: null,
    gfm: true,
    headerIds: true,
    headerPrefix: '',
    highlight: null,
    langPrefix: 'language-',
    mangle: true,
    pedantic: false,
    renderer: null,
    sanitize: false,
    sanitizer: null,
    silent: false,
    smartypants: false,
    tokenizer: null,
    walkTokens: null,
    xhtml: false
  };
}

export let defaults = getDefaults();

export function changeDefaults(newDefaults) {
  defaults = newDefaults;
}

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/helpers.js #######

```

/**
 * Helpers
 */
const escapeTest = /[&<>"']/;
const escapeReplace = new RegExp(escapeTest.source, 'g');
const escapeTestNoEncode = /[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/;
const escapeReplaceNoEncode = new RegExp(escapeTestNoEncode.source, 'g');
const escapeReplacements = {
  '&': '&amp;',
  '<': '&lt;',
  '>': '&gt;',
  '"': '&quot;',
  "'": '&#39;'
};
const getEscapeReplacement = (ch) => escapeReplacements[ch];
export function escape(html, encode) {
  if (encode) {
    if (escapeTest.test(html)) {
      return html.replace(escapeReplace, getEscapeReplacement);
    }
  } else {
    if (escapeTestNoEncode.test(html)) {
      return html.replace(escapeReplaceNoEncode, getEscapeReplacement);
    }
  }

  return html;
}

const unescapeTest = /&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;

/**
 * @param {string} html
 */
export function unescape(html) {
  // explicitly match decimal, hex, and named HTML entities
  return html.replace(unescapeTest, (_, n) => {
    n = n.toLowerCase();
    if (n === 'colon') return ':';
    if (n.charAt(0) === '#') {
      return n.charAt(1) === 'x'
        ? String.fromCharCode(parseInt(n.substring(2), 16))
        : String.fromCharCode(+n.substring(1));
    }
    return '';
  });
}

const caret = /(^|[^\[])\^/g;

/**
 * @param {string | RegExp} regex
 * @param {string} opt
 */
export function edit(regex, opt) {
  regex = typeof regex === 'string' ? regex : regex.source;
  opt = opt || '';
  const obj = {
    replace: (name, val) => {
      val = val.source || val;
      val = val.replace(caret, '$1');
      regex = regex.replace(name, val);
      return obj;
    },
    getRegex: () => {
      return new RegExp(regex, opt);
    }
  };
  return obj;
}

const nonWordAndColonTest = /[^\w:]/g;
const originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;

/**
 * @param {boolean} sanitize
 * @param {string} base
 * @param {string} href
 */
export function cleanUrl(sanitize, base, href) {
  if (sanitize) {
    let prot;
    try {
      prot = decodeURIComponent(unescape(href))
        .replace(nonWordAndColonTest, '')
        .toLowerCase();
    } catch (e) {
      return null;
    }
    if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0 || prot.indexOf('data:') === 0) {
      return null;
    }
  }
  if (base && !originIndependentUrl.test(href)) {
    href = resolveUrl(base, href);
  }
  try {
    href = encodeURI(href).replace(/%25/g, '%');
  } catch (e) {
    return null;
  }
  return href;
}

const baseUrls = {};
const justDomain = /^[^:]+:\/*[^/]*$/;
const protocol = /^([^:]+:)[\s\S]*$/;
const domain = /^([^:]+:\/*[^/]*)[\s\S]*$/;

/**
 * @param {string} base
 * @param {string} href
 */
export function resolveUrl(base, href) {
  if (!baseUrls[' ' + base]) {
    // we can ignore everything in base after the last slash of its path component,
    // but we might need to add _that_
    // https://tools.ietf.org/html/rfc3986#section-3
    if (justDomain.test(base)) {
      baseUrls[' ' + base] = base + '/';
    } else {
      baseUrls[' ' + base] = rtrim(base, '/', true);
    }
  }
  base = baseUrls[' ' + base];
  const relativeBase = base.indexOf(':') === -1;

  if (href.substring(0, 2) === '//') {
    if (relativeBase) {
      return href;
    }
    return base.replace(protocol, '$1') + href;
  } else if (href.charAt(0) === '/') {
    if (relativeBase) {
      return href;
    }
    return base.replace(domain, '$1') + href;
  } else {
    return base + href;
  }
}

export const noopTest = { exec: function noopTest() {} };

export function merge(obj) {
  let i = 1,
    target,
    key;

  for (; i < arguments.length; i++) {
    target = arguments[i];
    for (key in target) {
      if (Object.prototype.hasOwnProperty.call(target, key)) {
        obj[key] = target[key];
      }
    }
  }

  return obj;
}

export function splitCells(tableRow, count) {
  // ensure that every cell-delimiting pipe has a space
  // before it to distinguish it from an escaped pipe
  const row = tableRow.replace(/\|/g, (match, offset, str) => {
      let escaped = false,
        curr = offset;
      while (--curr >= 0 && str[curr] === '\\') escaped = !escaped;
      if (escaped) {
        // odd number of slashes means | is escaped
        // so we leave it alone
        return '|';
      } else {
        // add space before unescaped |
        return ' |';
      }
    }),
    cells = row.split(/ \|/);
  let i = 0;

  // First/last cell in a row cannot be empty if it has no leading/trailing pipe
  if (!cells[0].trim()) { cells.shift(); }
  if (cells.length > 0 && !cells[cells.length - 1].trim()) { cells.pop(); }

  if (cells.length > count) {
    cells.splice(count);
  } else {
    while (cells.length < count) cells.push('');
  }

  for (; i < cells.length; i++) {
    // leading or trailing whitespace is ignored per the gfm spec
    cells[i] = cells[i].trim().replace(/\\\|/g, '|');
  }
  return cells;
}

/**
 * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').
 * /c*$/ is vulnerable to REDOS.
 *
 * @param {string} str
 * @param {string} c
 * @param {boolean} invert Remove suffix of non-c chars instead. Default falsey.
 */
export function rtrim(str, c, invert) {
  const l = str.length;
  if (l === 0) {
    return '';
  }

  // Length of suffix matching the invert condition.
  let suffLen = 0;

  // Step left until we fail to match the invert condition.
  while (suffLen < l) {
    const currChar = str.charAt(l - suffLen - 1);
    if (currChar === c && !invert) {
      suffLen++;
    } else if (currChar !== c && invert) {
      suffLen++;
    } else {
      break;
    }
  }

  return str.slice(0, l - suffLen);
}

export function findClosingBracket(str, b) {
  if (str.indexOf(b[1]) === -1) {
    return -1;
  }
  const l = str.length;
  let level = 0,
    i = 0;
  for (; i < l; i++) {
    if (str[i] === '\\') {
      i++;
    } else if (str[i] === b[0]) {
      level++;
    } else if (str[i] === b[1]) {
      level--;
      if (level < 0) {
        return i;
      }
    }
  }
  return -1;
}

export function checkSanitizeDeprecation(opt) {
  if (opt && opt.sanitize && !opt.silent) {
    console.warn('marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options');
  }
}

// copied from https://stackoverflow.com/a/5450113/806777
/**
 * @param {string} pattern
 * @param {number} count
 */
export function repeatString(pattern, count) {
  if (count < 1) {
    return '';
  }
  let result = '';
  while (count > 1) {
    if (count & 1) {
      result += pattern;
    }
    count >>= 1;
    pattern += pattern;
  }
  return result + pattern;
}

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/Lexer.js #######

```

import { Tokenizer } from './Tokenizer.js';
import { defaults } from './defaults.js';
import { block, inline } from './rules.js';
import { repeatString } from './helpers.js';

/**
 * smartypants text replacement
 * @param {string} text
 */
function smartypants(text) {
  return text
    // em-dashes
    .replace(/---/g, '\u2014')
    // en-dashes
    .replace(/--/g, '\u2013')
    // opening singles
    .replace(/(^|[-\u2014/(\[{"\s])'/g, '$1\u2018')
    // closing singles & apostrophes
    .replace(/'/g, '\u2019')
    // opening doubles
    .replace(/(^|[-\u2014/(\[{\u2018\s])"/g, '$1\u201c')
    // closing doubles
    .replace(/"/g, '\u201d')
    // ellipses
    .replace(/\.{3}/g, '\u2026');
}

/**
 * mangle email addresses
 * @param {string} text
 */
function mangle(text) {
  let out = '',
    i,
    ch;

  const l = text.length;
  for (i = 0; i < l; i++) {
    ch = text.charCodeAt(i);
    if (Math.random() > 0.5) {
      ch = 'x' + ch.toString(16);
    }
    out += '&#' + ch + ';';
  }

  return out;
}

/**
 * Block Lexer
 */
export class Lexer {
  constructor(options) {
    this.tokens = [];
    this.tokens.links = Object.create(null);
    this.options = options || defaults;
    this.options.tokenizer = this.options.tokenizer || new Tokenizer();
    this.tokenizer = this.options.tokenizer;
    this.tokenizer.options = this.options;
    this.tokenizer.lexer = this;
    this.inlineQueue = [];
    this.state = {
      inLink: false,
      inRawBlock: false,
      top: true
    };

    const rules = {
      block: block.normal,
      inline: inline.normal
    };

    if (this.options.pedantic) {
      rules.block = block.pedantic;
      rules.inline = inline.pedantic;
    } else if (this.options.gfm) {
      rules.block = block.gfm;
      if (this.options.breaks) {
        rules.inline = inline.breaks;
      } else {
        rules.inline = inline.gfm;
      }
    }
    this.tokenizer.rules = rules;
  }

  /**
   * Expose Rules
   */
  static get rules() {
    return {
      block,
      inline
    };
  }

  /**
   * Static Lex Method
   */
  static lex(src, options) {
    const lexer = new Lexer(options);
    return lexer.lex(src);
  }

  /**
   * Static Lex Inline Method
   */
  static lexInline(src, options) {
    const lexer = new Lexer(options);
    return lexer.inlineTokens(src);
  }

  /**
   * Preprocessing
   */
  lex(src) {
    src = src
      .replace(/\r\n|\r/g, '\n');

    this.blockTokens(src, this.tokens);

    let next;
    while (next = this.inlineQueue.shift()) {
      this.inlineTokens(next.src, next.tokens);
    }

    return this.tokens;
  }

  /**
   * Lexing
   */
  blockTokens(src, tokens = []) {
    if (this.options.pedantic) {
      src = src.replace(/\t/g, '    ').replace(/^ +$/gm, '');
    } else {
      src = src.replace(/^( *)(\t+)/gm, (_, leading, tabs) => {
        return leading + '    '.repeat(tabs.length);
      });
    }

    let token, lastToken, cutSrc, lastParagraphClipped;

    while (src) {
      if (this.options.extensions
        && this.options.extensions.block
        && this.options.extensions.block.some((extTokenizer) => {
          if (token = extTokenizer.call({ lexer: this }, src, tokens)) {
            src = src.substring(token.raw.length);
            tokens.push(token);
            return true;
          }
          return false;
        })) {
        continue;
      }

      // newline
      if (token = this.tokenizer.space(src)) {
        src = src.substring(token.raw.length);
        if (token.raw.length === 1 && tokens.length > 0) {
          // if there's a single \n as a spacer, it's terminating the last line,
          // so move it there so that we don't get unecessary paragraph tags
          tokens[tokens.length - 1].raw += '\n';
        } else {
          tokens.push(token);
        }
        continue;
      }

      // code
      if (token = this.tokenizer.code(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        // An indented code block cannot interrupt a paragraph.
        if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.text;
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      // fences
      if (token = this.tokenizer.fences(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // heading
      if (token = this.tokenizer.heading(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // hr
      if (token = this.tokenizer.hr(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // blockquote
      if (token = this.tokenizer.blockquote(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // list
      if (token = this.tokenizer.list(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // html
      if (token = this.tokenizer.html(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // def
      if (token = this.tokenizer.def(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.raw;
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else if (!this.tokens.links[token.tag]) {
          this.tokens.links[token.tag] = {
            href: token.href,
            title: token.title
          };
        }
        continue;
      }

      // table (gfm)
      if (token = this.tokenizer.table(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // lheading
      if (token = this.tokenizer.lheading(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // top-level paragraph
      // prevent paragraph consuming extensions by clipping 'src' to extension start
      cutSrc = src;
      if (this.options.extensions && this.options.extensions.startBlock) {
        let startIndex = Infinity;
        const tempSrc = src.slice(1);
        let tempStart;
        this.options.extensions.startBlock.forEach(function(getStartIndex) {
          tempStart = getStartIndex.call({ lexer: this }, tempSrc);
          if (typeof tempStart === 'number' && tempStart >= 0) { startIndex = Math.min(startIndex, tempStart); }
        });
        if (startIndex < Infinity && startIndex >= 0) {
          cutSrc = src.substring(0, startIndex + 1);
        }
      }
      if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {
        lastToken = tokens[tokens.length - 1];
        if (lastParagraphClipped && lastToken.type === 'paragraph') {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.text;
          this.inlineQueue.pop();
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else {
          tokens.push(token);
        }
        lastParagraphClipped = (cutSrc.length !== src.length);
        src = src.substring(token.raw.length);
        continue;
      }

      // text
      if (token = this.tokenizer.text(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && lastToken.type === 'text') {
          lastToken.raw += '\n' + token.raw;
          lastToken.text += '\n' + token.text;
          this.inlineQueue.pop();
          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      if (src) {
        const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);
        if (this.options.silent) {
          console.error(errMsg);
          break;
        } else {
          throw new Error(errMsg);
        }
      }
    }

    this.state.top = true;
    return tokens;
  }

  inline(src, tokens = []) {
    this.inlineQueue.push({ src, tokens });
    return tokens;
  }

  /**
   * Lexing/Compiling
   */
  inlineTokens(src, tokens = []) {
    let token, lastToken, cutSrc;

    // String with links masked to avoid interference with em and strong
    let maskedSrc = src;
    let match;
    let keepPrevChar, prevChar;

    // Mask out reflinks
    if (this.tokens.links) {
      const links = Object.keys(this.tokens.links);
      if (links.length > 0) {
        while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {
          if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {
            maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);
          }
        }
      }
    }
    // Mask out other blocks
    while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {
      maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);
    }

    // Mask out escaped em & strong delimiters
    while ((match = this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc)) != null) {
      maskedSrc = maskedSrc.slice(0, match.index + match[0].length - 2) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);
      this.tokenizer.rules.inline.escapedEmSt.lastIndex--;
    }

    while (src) {
      if (!keepPrevChar) {
        prevChar = '';
      }
      keepPrevChar = false;

      // extensions
      if (this.options.extensions
        && this.options.extensions.inline
        && this.options.extensions.inline.some((extTokenizer) => {
          if (token = extTokenizer.call({ lexer: this }, src, tokens)) {
            src = src.substring(token.raw.length);
            tokens.push(token);
            return true;
          }
          return false;
        })) {
        continue;
      }

      // escape
      if (token = this.tokenizer.escape(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // tag
      if (token = this.tokenizer.tag(src)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && token.type === 'text' && lastToken.type === 'text') {
          lastToken.raw += token.raw;
          lastToken.text += token.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      // link
      if (token = this.tokenizer.link(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // reflink, nolink
      if (token = this.tokenizer.reflink(src, this.tokens.links)) {
        src = src.substring(token.raw.length);
        lastToken = tokens[tokens.length - 1];
        if (lastToken && token.type === 'text' && lastToken.type === 'text') {
          lastToken.raw += token.raw;
          lastToken.text += token.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      // em & strong
      if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // code
      if (token = this.tokenizer.codespan(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // br
      if (token = this.tokenizer.br(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // del (gfm)
      if (token = this.tokenizer.del(src)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // autolink
      if (token = this.tokenizer.autolink(src, mangle)) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // url (gfm)
      if (!this.state.inLink && (token = this.tokenizer.url(src, mangle))) {
        src = src.substring(token.raw.length);
        tokens.push(token);
        continue;
      }

      // text
      // prevent inlineText consuming extensions by clipping 'src' to extension start
      cutSrc = src;
      if (this.options.extensions && this.options.extensions.startInline) {
        let startIndex = Infinity;
        const tempSrc = src.slice(1);
        let tempStart;
        this.options.extensions.startInline.forEach(function(getStartIndex) {
          tempStart = getStartIndex.call({ lexer: this }, tempSrc);
          if (typeof tempStart === 'number' && tempStart >= 0) { startIndex = Math.min(startIndex, tempStart); }
        });
        if (startIndex < Infinity && startIndex >= 0) {
          cutSrc = src.substring(0, startIndex + 1);
        }
      }
      if (token = this.tokenizer.inlineText(cutSrc, smartypants)) {
        src = src.substring(token.raw.length);
        if (token.raw.slice(-1) !== '_') { // Track prevChar before string of ____ started
          prevChar = token.raw.slice(-1);
        }
        keepPrevChar = true;
        lastToken = tokens[tokens.length - 1];
        if (lastToken && lastToken.type === 'text') {
          lastToken.raw += token.raw;
          lastToken.text += token.text;
        } else {
          tokens.push(token);
        }
        continue;
      }

      if (src) {
        const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);
        if (this.options.silent) {
          console.error(errMsg);
          break;
        } else {
          throw new Error(errMsg);
        }
      }
    }

    return tokens;
  }
}

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/marked.js #######

```

import { Lexer } from './Lexer.js';
import { Parser } from './Parser.js';
import { Tokenizer } from './Tokenizer.js';
import { Renderer } from './Renderer.js';
import { TextRenderer } from './TextRenderer.js';
import { Slugger } from './Slugger.js';
import {
  merge,
  checkSanitizeDeprecation,
  escape
} from './helpers.js';
import {
  getDefaults,
  changeDefaults,
  defaults
} from './defaults.js';

/**
 * Marked
 */
export function marked(src, opt, callback) {
  // throw error in case of non string input
  if (typeof src === 'undefined' || src === null) {
    throw new Error('marked(): input parameter is undefined or null');
  }
  if (typeof src !== 'string') {
    throw new Error('marked(): input parameter is of type '
      + Object.prototype.toString.call(src) + ', string expected');
  }

  if (typeof opt === 'function') {
    callback = opt;
    opt = null;
  }

  opt = merge({}, marked.defaults, opt || {});
  checkSanitizeDeprecation(opt);

  if (callback) {
    const highlight = opt.highlight;
    let tokens;

    try {
      tokens = Lexer.lex(src, opt);
    } catch (e) {
      return callback(e);
    }

    const done = function(err) {
      let out;

      if (!err) {
        try {
          if (opt.walkTokens) {
            marked.walkTokens(tokens, opt.walkTokens);
          }
          out = Parser.parse(tokens, opt);
        } catch (e) {
          err = e;
        }
      }

      opt.highlight = highlight;

      return err
        ? callback(err)
        : callback(null, out);
    };

    if (!highlight || highlight.length < 3) {
      return done();
    }

    delete opt.highlight;

    if (!tokens.length) return done();

    let pending = 0;
    marked.walkTokens(tokens, function(token) {
      if (token.type === 'code') {
        pending++;
        setTimeout(() => {
          highlight(token.text, token.lang, function(err, code) {
            if (err) {
              return done(err);
            }
            if (code != null && code !== token.text) {
              token.text = code;
              token.escaped = true;
            }

            pending--;
            if (pending === 0) {
              done();
            }
          });
        }, 0);
      }
    });

    if (pending === 0) {
      done();
    }

    return;
  }

  function onError(e) {
    e.message += '\nPlease report this to https://github.com/markedjs/marked.';
    if (opt.silent) {
      return '<p>An error occurred:</p><pre>'
        + escape(e.message + '', true)
        + '</pre>';
    }
    throw e;
  }

  try {
    const tokens = Lexer.lex(src, opt);
    if (opt.walkTokens) {
      if (opt.async) {
        return Promise.all(marked.walkTokens(tokens, opt.walkTokens))
          .then(() => {
            return Parser.parse(tokens, opt);
          })
          .catch(onError);
      }
      marked.walkTokens(tokens, opt.walkTokens);
    }
    return Parser.parse(tokens, opt);
  } catch (e) {
    onError(e);
  }
}

/**
 * Options
 */

marked.options =
marked.setOptions = function(opt) {
  merge(marked.defaults, opt);
  changeDefaults(marked.defaults);
  return marked;
};

marked.getDefaults = getDefaults;

marked.defaults = defaults;

/**
 * Use Extension
 */

marked.use = function(...args) {
  const extensions = marked.defaults.extensions || { renderers: {}, childTokens: {} };

  args.forEach((pack) => {
    // copy options to new object
    const opts = merge({}, pack);

    // set async to true if it was set to true before
    opts.async = marked.defaults.async || opts.async;

    // ==-- Parse "addon" extensions --== //
    if (pack.extensions) {
      pack.extensions.forEach((ext) => {
        if (!ext.name) {
          throw new Error('extension name required');
        }
        if (ext.renderer) { // Renderer extensions
          const prevRenderer = extensions.renderers[ext.name];
          if (prevRenderer) {
            // Replace extension with func to run new extension but fall back if false
            extensions.renderers[ext.name] = function(...args) {
              let ret = ext.renderer.apply(this, args);
              if (ret === false) {
                ret = prevRenderer.apply(this, args);
              }
              return ret;
            };
          } else {
            extensions.renderers[ext.name] = ext.renderer;
          }
        }
        if (ext.tokenizer) { // Tokenizer Extensions
          if (!ext.level || (ext.level !== 'block' && ext.level !== 'inline')) {
            throw new Error("extension level must be 'block' or 'inline'");
          }
          if (extensions[ext.level]) {
            extensions[ext.level].unshift(ext.tokenizer);
          } else {
            extensions[ext.level] = [ext.tokenizer];
          }
          if (ext.start) { // Function to check for start of token
            if (ext.level === 'block') {
              if (extensions.startBlock) {
                extensions.startBlock.push(ext.start);
              } else {
                extensions.startBlock = [ext.start];
              }
            } else if (ext.level === 'inline') {
              if (extensions.startInline) {
                extensions.startInline.push(ext.start);
              } else {
                extensions.startInline = [ext.start];
              }
            }
          }
        }
        if (ext.childTokens) { // Child tokens to be visited by walkTokens
          extensions.childTokens[ext.name] = ext.childTokens;
        }
      });
      opts.extensions = extensions;
    }

    // ==-- Parse "overwrite" extensions --== //
    if (pack.renderer) {
      const renderer = marked.defaults.renderer || new Renderer();
      for (const prop in pack.renderer) {
        const prevRenderer = renderer[prop];
        // Replace renderer with func to run extension, but fall back if false
        renderer[prop] = (...args) => {
          let ret = pack.renderer[prop].apply(renderer, args);
          if (ret === false) {
            ret = prevRenderer.apply(renderer, args);
          }
          return ret;
        };
      }
      opts.renderer = renderer;
    }
    if (pack.tokenizer) {
      const tokenizer = marked.defaults.tokenizer || new Tokenizer();
      for (const prop in pack.tokenizer) {
        const prevTokenizer = tokenizer[prop];
        // Replace tokenizer with func to run extension, but fall back if false
        tokenizer[prop] = (...args) => {
          let ret = pack.tokenizer[prop].apply(tokenizer, args);
          if (ret === false) {
            ret = prevTokenizer.apply(tokenizer, args);
          }
          return ret;
        };
      }
      opts.tokenizer = tokenizer;
    }

    // ==-- Parse WalkTokens extensions --== //
    if (pack.walkTokens) {
      const walkTokens = marked.defaults.walkTokens;
      opts.walkTokens = function(token) {
        let values = [];
        values.push(pack.walkTokens.call(this, token));
        if (walkTokens) {
          values = values.concat(walkTokens.call(this, token));
        }
        return values;
      };
    }

    marked.setOptions(opts);
  });
};

/**
 * Run callback for every token
 */

marked.walkTokens = function(tokens, callback) {
  let values = [];
  for (const token of tokens) {
    values = values.concat(callback.call(marked, token));
    switch (token.type) {
      case 'table': {
        for (const cell of token.header) {
          values = values.concat(marked.walkTokens(cell.tokens, callback));
        }
        for (const row of token.rows) {
          for (const cell of row) {
            values = values.concat(marked.walkTokens(cell.tokens, callback));
          }
        }
        break;
      }
      case 'list': {
        values = values.concat(marked.walkTokens(token.items, callback));
        break;
      }
      default: {
        if (marked.defaults.extensions && marked.defaults.extensions.childTokens && marked.defaults.extensions.childTokens[token.type]) { // Walk any extensions
          marked.defaults.extensions.childTokens[token.type].forEach(function(childTokens) {
            values = values.concat(marked.walkTokens(token[childTokens], callback));
          });
        } else if (token.tokens) {
          values = values.concat(marked.walkTokens(token.tokens, callback));
        }
      }
    }
  }
  return values;
};

/**
 * Parse Inline
 * @param {string} src
 */
marked.parseInline = function(src, opt) {
  // throw error in case of non string input
  if (typeof src === 'undefined' || src === null) {
    throw new Error('marked.parseInline(): input parameter is undefined or null');
  }
  if (typeof src !== 'string') {
    throw new Error('marked.parseInline(): input parameter is of type '
      + Object.prototype.toString.call(src) + ', string expected');
  }

  opt = merge({}, marked.defaults, opt || {});
  checkSanitizeDeprecation(opt);

  try {
    const tokens = Lexer.lexInline(src, opt);
    if (opt.walkTokens) {
      marked.walkTokens(tokens, opt.walkTokens);
    }
    return Parser.parseInline(tokens, opt);
  } catch (e) {
    e.message += '\nPlease report this to https://github.com/markedjs/marked.';
    if (opt.silent) {
      return '<p>An error occurred:</p><pre>'
        + escape(e.message + '', true)
        + '</pre>';
    }
    throw e;
  }
};

/**
 * Expose
 */
marked.Parser = Parser;
marked.parser = Parser.parse;
marked.Renderer = Renderer;
marked.TextRenderer = TextRenderer;
marked.Lexer = Lexer;
marked.lexer = Lexer.lex;
marked.Tokenizer = Tokenizer;
marked.Slugger = Slugger;
marked.parse = marked;

export const options = marked.options;
export const setOptions = marked.setOptions;
export const use = marked.use;
export const walkTokens = marked.walkTokens;
export const parseInline = marked.parseInline;
export const parse = marked;
export const parser = Parser.parse;
export const lexer = Lexer.lex;
export { defaults, getDefaults } from './defaults.js';
export { Lexer } from './Lexer.js';
export { Parser } from './Parser.js';
export { Tokenizer } from './Tokenizer.js';
export { Renderer } from './Renderer.js';
export { TextRenderer } from './TextRenderer.js';
export { Slugger } from './Slugger.js';

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/Parser.js #######

```

import { Renderer } from './Renderer.js';
import { TextRenderer } from './TextRenderer.js';
import { Slugger } from './Slugger.js';
import { defaults } from './defaults.js';
import {
  unescape
} from './helpers.js';

/**
 * Parsing & Compiling
 */
export class Parser {
  constructor(options) {
    this.options = options || defaults;
    this.options.renderer = this.options.renderer || new Renderer();
    this.renderer = this.options.renderer;
    this.renderer.options = this.options;
    this.textRenderer = new TextRenderer();
    this.slugger = new Slugger();
  }

  /**
   * Static Parse Method
   */
  static parse(tokens, options) {
    const parser = new Parser(options);
    return parser.parse(tokens);
  }

  /**
   * Static Parse Inline Method
   */
  static parseInline(tokens, options) {
    const parser = new Parser(options);
    return parser.parseInline(tokens);
  }

  /**
   * Parse Loop
   */
  parse(tokens, top = true) {
    let out = '',
      i,
      j,
      k,
      l2,
      l3,
      row,
      cell,
      header,
      body,
      token,
      ordered,
      start,
      loose,
      itemBody,
      item,
      checked,
      task,
      checkbox,
      ret;

    const l = tokens.length;
    for (i = 0; i < l; i++) {
      token = tokens[i];

      // Run any renderer extensions
      if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {
        ret = this.options.extensions.renderers[token.type].call({ parser: this }, token);
        if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(token.type)) {
          out += ret || '';
          continue;
        }
      }

      switch (token.type) {
        case 'space': {
          continue;
        }
        case 'hr': {
          out += this.renderer.hr();
          continue;
        }
        case 'heading': {
          out += this.renderer.heading(
            this.parseInline(token.tokens),
            token.depth,
            unescape(this.parseInline(token.tokens, this.textRenderer)),
            this.slugger);
          continue;
        }
        case 'code': {
          out += this.renderer.code(token.text,
            token.lang,
            token.escaped);
          continue;
        }
        case 'table': {
          header = '';

          // header
          cell = '';
          l2 = token.header.length;
          for (j = 0; j < l2; j++) {
            cell += this.renderer.tablecell(
              this.parseInline(token.header[j].tokens),
              { header: true, align: token.align[j] }
            );
          }
          header += this.renderer.tablerow(cell);

          body = '';
          l2 = token.rows.length;
          for (j = 0; j < l2; j++) {
            row = token.rows[j];

            cell = '';
            l3 = row.length;
            for (k = 0; k < l3; k++) {
              cell += this.renderer.tablecell(
                this.parseInline(row[k].tokens),
                { header: false, align: token.align[k] }
              );
            }

            body += this.renderer.tablerow(cell);
          }
          out += this.renderer.table(header, body);
          continue;
        }
        case 'blockquote': {
          body = this.parse(token.tokens);
          out += this.renderer.blockquote(body);
          continue;
        }
        case 'list': {
          ordered = token.ordered;
          start = token.start;
          loose = token.loose;
          l2 = token.items.length;

          body = '';
          for (j = 0; j < l2; j++) {
            item = token.items[j];
            checked = item.checked;
            task = item.task;

            itemBody = '';
            if (item.task) {
              checkbox = this.renderer.checkbox(checked);
              if (loose) {
                if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {
                  item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;
                  if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {
                    item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;
                  }
                } else {
                  item.tokens.unshift({
                    type: 'text',
                    text: checkbox
                  });
                }
              } else {
                itemBody += checkbox;
              }
            }

            itemBody += this.parse(item.tokens, loose);
            body += this.renderer.listitem(itemBody, task, checked);
          }

          out += this.renderer.list(body, ordered, start);
          continue;
        }
        case 'html': {
          // TODO parse inline content if parameter markdown=1
          out += this.renderer.html(token.text);
          continue;
        }
        case 'paragraph': {
          out += this.renderer.paragraph(this.parseInline(token.tokens));
          continue;
        }
        case 'text': {
          body = token.tokens ? this.parseInline(token.tokens) : token.text;
          while (i + 1 < l && tokens[i + 1].type === 'text') {
            token = tokens[++i];
            body += '\n' + (token.tokens ? this.parseInline(token.tokens) : token.text);
          }
          out += top ? this.renderer.paragraph(body) : body;
          continue;
        }

        default: {
          const errMsg = 'Token with "' + token.type + '" type was not found.';
          if (this.options.silent) {
            console.error(errMsg);
            return;
          } else {
            throw new Error(errMsg);
          }
        }
      }
    }

    return out;
  }

  /**
   * Parse Inline Tokens
   */
  parseInline(tokens, renderer) {
    renderer = renderer || this.renderer;
    let out = '',
      i,
      token,
      ret;

    const l = tokens.length;
    for (i = 0; i < l; i++) {
      token = tokens[i];

      // Run any renderer extensions
      if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {
        ret = this.options.extensions.renderers[token.type].call({ parser: this }, token);
        if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(token.type)) {
          out += ret || '';
          continue;
        }
      }

      switch (token.type) {
        case 'escape': {
          out += renderer.text(token.text);
          break;
        }
        case 'html': {
          out += renderer.html(token.text);
          break;
        }
        case 'link': {
          out += renderer.link(token.href, token.title, this.parseInline(token.tokens, renderer));
          break;
        }
        case 'image': {
          out += renderer.image(token.href, token.title, token.text);
          break;
        }
        case 'strong': {
          out += renderer.strong(this.parseInline(token.tokens, renderer));
          break;
        }
        case 'em': {
          out += renderer.em(this.parseInline(token.tokens, renderer));
          break;
        }
        case 'codespan': {
          out += renderer.codespan(token.text);
          break;
        }
        case 'br': {
          out += renderer.br();
          break;
        }
        case 'del': {
          out += renderer.del(this.parseInline(token.tokens, renderer));
          break;
        }
        case 'text': {
          out += renderer.text(token.text);
          break;
        }
        default: {
          const errMsg = 'Token with "' + token.type + '" type was not found.';
          if (this.options.silent) {
            console.error(errMsg);
            return;
          } else {
            throw new Error(errMsg);
          }
        }
      }
    }
    return out;
  }
}

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/Renderer.js #######

```

import { defaults } from './defaults.js';
import {
  cleanUrl,
  escape
} from './helpers.js';

/**
 * Renderer
 */
export class Renderer {
  constructor(options) {
    this.options = options || defaults;
  }

  code(code, infostring, escaped) {
    const lang = (infostring || '').match(/\S*/)[0];
    if (this.options.highlight) {
      const out = this.options.highlight(code, lang);
      if (out != null && out !== code) {
        escaped = true;
        code = out;
      }
    }

    code = code.replace(/\n$/, '') + '\n';

    if (!lang) {
      return '<pre><code>'
        + (escaped ? code : escape(code, true))
        + '</code></pre>\n';
    }

    return '<pre><code class="'
      + this.options.langPrefix
      + escape(lang)
      + '">'
      + (escaped ? code : escape(code, true))
      + '</code></pre>\n';
  }

  /**
   * @param {string} quote
   */
  blockquote(quote) {
    return `<blockquote>\n${quote}</blockquote>\n`;
  }

  html(html) {
    return html;
  }

  /**
   * @param {string} text
   * @param {string} level
   * @param {string} raw
   * @param {any} slugger
   */
  heading(text, level, raw, slugger) {
    if (this.options.headerIds) {
      const id = this.options.headerPrefix + slugger.slug(raw);
      return `<h${level} id="${id}">${text}</h${level}>\n`;
    }

    // ignore IDs
    return `<h${level}>${text}</h${level}>\n`;
  }

  hr() {
    return this.options.xhtml ? '<hr/>\n' : '<hr>\n';
  }

  list(body, ordered, start) {
    const type = ordered ? 'ol' : 'ul',
      startatt = (ordered && start !== 1) ? (' start="' + start + '"') : '';
    return '<' + type + startatt + '>\n' + body + '</' + type + '>\n';
  }

  /**
   * @param {string} text
   */
  listitem(text) {
    return `<li>${text}</li>\n`;
  }

  checkbox(checked) {
    return '<input '
      + (checked ? 'checked="" ' : '')
      + 'disabled="" type="checkbox"'
      + (this.options.xhtml ? ' /' : '')
      + '> ';
  }

  /**
   * @param {string} text
   */
  paragraph(text) {
    return `<p>${text}</p>\n`;
  }

  /**
   * @param {string} header
   * @param {string} body
   */
  table(header, body) {
    if (body) body = `<tbody>${body}</tbody>`;

    return '<table>\n'
      + '<thead>\n'
      + header
      + '</thead>\n'
      + body
      + '</table>\n';
  }

  /**
   * @param {string} content
   */
  tablerow(content) {
    return `<tr>\n${content}</tr>\n`;
  }

  tablecell(content, flags) {
    const type = flags.header ? 'th' : 'td';
    const tag = flags.align
      ? `<${type} align="${flags.align}">`
      : `<${type}>`;
    return tag + content + `</${type}>\n`;
  }

  /**
   * span level renderer
   * @param {string} text
   */
  strong(text) {
    return `<strong>${text}</strong>`;
  }

  /**
   * @param {string} text
   */
  em(text) {
    return `<em>${text}</em>`;
  }

  /**
   * @param {string} text
   */
  codespan(text) {
    return `<code>${text}</code>`;
  }

  br() {
    return this.options.xhtml ? '<br/>' : '<br>';
  }

  /**
   * @param {string} text
   */
  del(text) {
    return `<del>${text}</del>`;
  }

  /**
   * @param {string} href
   * @param {string} title
   * @param {string} text
   */
  link(href, title, text) {
    href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);
    if (href === null) {
      return text;
    }
    let out = '<a href="' + href + '"';
    if (title) {
      out += ' title="' + title + '"';
    }
    out += '>' + text + '</a>';
    return out;
  }

  /**
   * @param {string} href
   * @param {string} title
   * @param {string} text
   */
  image(href, title, text) {
    href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);
    if (href === null) {
      return text;
    }

    let out = `<img src="${href}" alt="${text}"`;
    if (title) {
      out += ` title="${title}"`;
    }
    out += this.options.xhtml ? '/>' : '>';
    return out;
  }

  text(text) {
    return text;
  }
}

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/rules.js #######

```

import {
  noopTest,
  edit,
  merge
} from './helpers.js';

/**
 * Block-Level Grammar
 */
export const block = {
  newline: /^(?: *(?:\n|$))+/,
  code: /^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,
  fences: /^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,
  hr: /^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,
  heading: /^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,
  blockquote: /^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,
  list: /^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,
  html: '^ {0,3}(?:' // optional indentation
    + '<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)' // (1)
    + '|comment[^\\n]*(\\n+|$)' // (2)
    + '|<\\?[\\s\\S]*?(?:\\?>\\n*|$)' // (3)
    + '|<![A-Z][\\s\\S]*?(?:>\\n*|$)' // (4)
    + '|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)' // (5)
    + '|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (6)
    + '|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (7) open tag
    + '|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)' // (7) closing tag
    + ')',
  def: /^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,
  table: noopTest,
  lheading: /^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,
  // regex template, placeholders will be replaced according to different paragraph
  // interruption rules of commonmark and the original markdown spec:
  _paragraph: /^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,
  text: /^[^\n]+/
};

block._label = /(?!\s*\])(?:\\.|[^\[\]\\])+/;
block._title = /(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;
block.def = edit(block.def)
  .replace('label', block._label)
  .replace('title', block._title)
  .getRegex();

block.bullet = /(?:[*+-]|\d{1,9}[.)])/;
block.listItemStart = edit(/^( *)(bull) */)
  .replace('bull', block.bullet)
  .getRegex();

block.list = edit(block.list)
  .replace(/bull/g, block.bullet)
  .replace('hr', '\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))')
  .replace('def', '\\n+(?=' + block.def.source + ')')
  .getRegex();

block._tag = 'address|article|aside|base|basefont|blockquote|body|caption'
  + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'
  + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'
  + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'
  + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr'
  + '|track|ul';
block._comment = /<!--(?!-?>)[\s\S]*?(?:-->|$)/;
block.html = edit(block.html, 'i')
  .replace('comment', block._comment)
  .replace('tag', block._tag)
  .replace('attribute', / +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/)
  .getRegex();

block.paragraph = edit(block._paragraph)
  .replace('hr', block.hr)
  .replace('heading', ' {0,3}#{1,6} ')
  .replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs
  .replace('|table', '')
  .replace('blockquote', ' {0,3}>')
  .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n')
  .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
  .replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)')
  .replace('tag', block._tag) // pars can be interrupted by type (6) html blocks
  .getRegex();

block.blockquote = edit(block.blockquote)
  .replace('paragraph', block.paragraph)
  .getRegex();

/**
 * Normal Block Grammar
 */

block.normal = merge({}, block);

/**
 * GFM Block Grammar
 */

block.gfm = merge({}, block.normal, {
  table: '^ *([^\\n ].*\\|.*)\\n' // Header
    + ' {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?' // Align
    + '(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)' // Cells
});

block.gfm.table = edit(block.gfm.table)
  .replace('hr', block.hr)
  .replace('heading', ' {0,3}#{1,6} ')
  .replace('blockquote', ' {0,3}>')
  .replace('code', ' {4}[^\\n]')
  .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n')
  .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
  .replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)')
  .replace('tag', block._tag) // tables can be interrupted by type (6) html blocks
  .getRegex();

block.gfm.paragraph = edit(block._paragraph)
  .replace('hr', block.hr)
  .replace('heading', ' {0,3}#{1,6} ')
  .replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs
  .replace('table', block.gfm.table) // interrupt paragraphs with table
  .replace('blockquote', ' {0,3}>')
  .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n')
  .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt
  .replace('html', '</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)')
  .replace('tag', block._tag) // pars can be interrupted by type (6) html blocks
  .getRegex();
/**
 * Pedantic grammar (original John Gruber's loose markdown specification)
 */

block.pedantic = merge({}, block.normal, {
  html: edit(
    '^ *(?:comment *(?:\\n|\\s*$)'
    + '|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)' // closed tag
    + '|<tag(?:"[^"]*"|\'[^\']*\'|\\s[^\'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))')
    .replace('comment', block._comment)
    .replace(/tag/g, '(?!(?:'
      + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'
      + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'
      + '\\b)\\w+(?!:|[^\\w\\s@]*@)\\b')
    .getRegex(),
  def: /^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,
  heading: /^(#{1,6})(.*)(?:\n+|$)/,
  fences: noopTest, // fences not supported
  lheading: /^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,
  paragraph: edit(block.normal._paragraph)
    .replace('hr', block.hr)
    .replace('heading', ' *#{1,6} *[^\n]')
    .replace('lheading', block.lheading)
    .replace('blockquote', ' {0,3}>')
    .replace('|fences', '')
    .replace('|list', '')
    .replace('|html', '')
    .getRegex()
});

/**
 * Inline-Level Grammar
 */
export const inline = {
  escape: /^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,
  autolink: /^<(scheme:[^\s\x00-\x1f<>]*|email)>/,
  url: noopTest,
  tag: '^comment'
    + '|^</[a-zA-Z][\\w:-]*\\s*>' // self-closing tag
    + '|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>' // open tag
    + '|^<\\?[\\s\\S]*?\\?>' // processing instruction, e.g. <?php ?>
    + '|^<![a-zA-Z]+\\s[\\s\\S]*?>' // declaration, e.g. <!DOCTYPE html>
    + '|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>', // CDATA section
  link: /^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,
  reflink: /^!?\[(label)\]\[(ref)\]/,
  nolink: /^!?\[(ref)\](?:\[\])?/,
  reflinkSearch: 'reflink|nolink(?!\\()',
  emStrong: {
    lDelim: /^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,
    //        (1) and (2) can only be a Right Delimiter. (3) and (4) can only be Left.  (5) and (6) can be either Left or Right.
    //          () Skip orphan inside strong                                      () Consume to delim     (1) #***                (2) a***#, a***                             (3) #***a, ***a                 (4) ***#              (5) #***#                 (6) a***a
    rDelimAst: /^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,
    rDelimUnd: /^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/ // ^- Not allowed for _
  },
  code: /^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,
  br: /^( {2,}|\\)\n(?!\s*$)/,
  del: noopTest,
  text: /^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,
  punctuation: /^([\spunctuation])/
};

// list of punctuation marks from CommonMark spec
// without * and _ to handle the different emphasis markers * and _
inline._punctuation = '!"#$%&\'()+\\-.,/:;<=>?@\\[\\]`^{|}~';
inline.punctuation = edit(inline.punctuation).replace(/punctuation/g, inline._punctuation).getRegex();

// sequences em should skip over [title](link), `code`, <html>
inline.blockSkip = /\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;
// lookbehind is not available on Safari as of version 16
// inline.escapedEmSt = /(?<=(?:^|[^\\)(?:\\[^])*)\\[*_]/g;
inline.escapedEmSt = /(?:^|[^\\])(?:\\\\)*\\[*_]/g;

inline._comment = edit(block._comment).replace('(?:-->|$)', '-->').getRegex();

inline.emStrong.lDelim = edit(inline.emStrong.lDelim)
  .replace(/punct/g, inline._punctuation)
  .getRegex();

inline.emStrong.rDelimAst = edit(inline.emStrong.rDelimAst, 'g')
  .replace(/punct/g, inline._punctuation)
  .getRegex();

inline.emStrong.rDelimUnd = edit(inline.emStrong.rDelimUnd, 'g')
  .replace(/punct/g, inline._punctuation)
  .getRegex();

inline._escapes = /\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;

inline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;
inline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;
inline.autolink = edit(inline.autolink)
  .replace('scheme', inline._scheme)
  .replace('email', inline._email)
  .getRegex();

inline._attribute = /\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;

inline.tag = edit(inline.tag)
  .replace('comment', inline._comment)
  .replace('attribute', inline._attribute)
  .getRegex();

inline._label = /(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;
inline._href = /<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;
inline._title = /"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;

inline.link = edit(inline.link)
  .replace('label', inline._label)
  .replace('href', inline._href)
  .replace('title', inline._title)
  .getRegex();

inline.reflink = edit(inline.reflink)
  .replace('label', inline._label)
  .replace('ref', block._label)
  .getRegex();

inline.nolink = edit(inline.nolink)
  .replace('ref', block._label)
  .getRegex();

inline.reflinkSearch = edit(inline.reflinkSearch, 'g')
  .replace('reflink', inline.reflink)
  .replace('nolink', inline.nolink)
  .getRegex();

/**
 * Normal Inline Grammar
 */

inline.normal = merge({}, inline);

/**
 * Pedantic Inline Grammar
 */

inline.pedantic = merge({}, inline.normal, {
  strong: {
    start: /^__|\*\*/,
    middle: /^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,
    endAst: /\*\*(?!\*)/g,
    endUnd: /__(?!_)/g
  },
  em: {
    start: /^_|\*/,
    middle: /^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,
    endAst: /\*(?!\*)/g,
    endUnd: /_(?!_)/g
  },
  link: edit(/^!?\[(label)\]\((.*?)\)/)
    .replace('label', inline._label)
    .getRegex(),
  reflink: edit(/^!?\[(label)\]\s*\[([^\]]*)\]/)
    .replace('label', inline._label)
    .getRegex()
});

/**
 * GFM Inline Grammar
 */

inline.gfm = merge({}, inline.normal, {
  escape: edit(inline.escape).replace('])', '~|])').getRegex(),
  _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,
  url: /^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,
  _backpedal: /(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,
  del: /^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,
  text: /^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/
});

inline.gfm.url = edit(inline.gfm.url, 'i')
  .replace('email', inline.gfm._extended_email)
  .getRegex();
/**
 * GFM + Line Breaks Inline Grammar
 */

inline.breaks = merge({}, inline.gfm, {
  br: edit(inline.br).replace('{2,}', '*').getRegex(),
  text: edit(inline.gfm.text)
    .replace('\\b_', '\\b_| {2,}\\n')
    .replace(/\{2,\}/g, '*')
    .getRegex()
});

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/Slugger.js #######

```

/**
 * Slugger generates header id
 */
export class Slugger {
  constructor() {
    this.seen = {};
  }

  /**
   * @param {string} value
   */
  serialize(value) {
    return value
      .toLowerCase()
      .trim()
      // remove html tags
      .replace(/<[!\/a-z].*?>/ig, '')
      // remove unwanted chars
      .replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g, '')
      .replace(/\s/g, '-');
  }

  /**
   * Finds the next safe (unique) slug to use
   * @param {string} originalSlug
   * @param {boolean} isDryRun
   */
  getNextSafeSlug(originalSlug, isDryRun) {
    let slug = originalSlug;
    let occurenceAccumulator = 0;
    if (this.seen.hasOwnProperty(slug)) {
      occurenceAccumulator = this.seen[originalSlug];
      do {
        occurenceAccumulator++;
        slug = originalSlug + '-' + occurenceAccumulator;
      } while (this.seen.hasOwnProperty(slug));
    }
    if (!isDryRun) {
      this.seen[originalSlug] = occurenceAccumulator;
      this.seen[slug] = 0;
    }
    return slug;
  }

  /**
   * Convert string to unique id
   * @param {object} [options]
   * @param {boolean} [options.dryrun] Generates the next unique slug without
   * updating the internal accumulator.
   */
  slug(value, options = {}) {
    const slug = this.serialize(value);
    return this.getNextSafeSlug(slug, options.dryrun);
  }
}

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/TextRenderer.js #######

```

/**
 * TextRenderer
 * returns only the textual part of the token
 */
export class TextRenderer {
  // no need for block level renderers
  strong(text) {
    return text;
  }

  em(text) {
    return text;
  }

  codespan(text) {
    return text;
  }

  del(text) {
    return text;
  }

  html(text) {
    return text;
  }

  text(text) {
    return text;
  }

  link(href, title, text) {
    return '' + text;
  }

  image(href, title, text) {
    return '' + text;
  }

  br() {
    return '';
  }
}

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/node_modules/marked/src/Tokenizer.js #######

```

import { defaults } from './defaults.js';
import {
  rtrim,
  splitCells,
  escape,
  findClosingBracket
} from './helpers.js';

function outputLink(cap, link, raw, lexer) {
  const href = link.href;
  const title = link.title ? escape(link.title) : null;
  const text = cap[1].replace(/\\([\[\]])/g, '$1');

  if (cap[0].charAt(0) !== '!') {
    lexer.state.inLink = true;
    const token = {
      type: 'link',
      raw,
      href,
      title,
      text,
      tokens: lexer.inlineTokens(text)
    };
    lexer.state.inLink = false;
    return token;
  }
  return {
    type: 'image',
    raw,
    href,
    title,
    text: escape(text)
  };
}

function indentCodeCompensation(raw, text) {
  const matchIndentToCode = raw.match(/^(\s+)(?:```)/);

  if (matchIndentToCode === null) {
    return text;
  }

  const indentToCode = matchIndentToCode[1];

  return text
    .split('\n')
    .map(node => {
      const matchIndentInNode = node.match(/^\s+/);
      if (matchIndentInNode === null) {
        return node;
      }

      const [indentInNode] = matchIndentInNode;

      if (indentInNode.length >= indentToCode.length) {
        return node.slice(indentToCode.length);
      }

      return node;
    })
    .join('\n');
}

/**
 * Tokenizer
 */
export class Tokenizer {
  constructor(options) {
    this.options = options || defaults;
  }

  space(src) {
    const cap = this.rules.block.newline.exec(src);
    if (cap && cap[0].length > 0) {
      return {
        type: 'space',
        raw: cap[0]
      };
    }
  }

  code(src) {
    const cap = this.rules.block.code.exec(src);
    if (cap) {
      const text = cap[0].replace(/^ {1,4}/gm, '');
      return {
        type: 'code',
        raw: cap[0],
        codeBlockStyle: 'indented',
        text: !this.options.pedantic
          ? rtrim(text, '\n')
          : text
      };
    }
  }

  fences(src) {
    const cap = this.rules.block.fences.exec(src);
    if (cap) {
      const raw = cap[0];
      const text = indentCodeCompensation(raw, cap[3] || '');

      return {
        type: 'code',
        raw,
        lang: cap[2] ? cap[2].trim().replace(this.rules.inline._escapes, '$1') : cap[2],
        text
      };
    }
  }

  heading(src) {
    const cap = this.rules.block.heading.exec(src);
    if (cap) {
      let text = cap[2].trim();

      // remove trailing #s
      if (/#$/.test(text)) {
        const trimmed = rtrim(text, '#');
        if (this.options.pedantic) {
          text = trimmed.trim();
        } else if (!trimmed || / $/.test(trimmed)) {
          // CommonMark requires space before trailing #s
          text = trimmed.trim();
        }
      }

      return {
        type: 'heading',
        raw: cap[0],
        depth: cap[1].length,
        text,
        tokens: this.lexer.inline(text)
      };
    }
  }

  hr(src) {
    const cap = this.rules.block.hr.exec(src);
    if (cap) {
      return {
        type: 'hr',
        raw: cap[0]
      };
    }
  }

  blockquote(src) {
    const cap = this.rules.block.blockquote.exec(src);
    if (cap) {
      const text = cap[0].replace(/^ *>[ \t]?/gm, '');
      const top = this.lexer.state.top;
      this.lexer.state.top = true;
      const tokens = this.lexer.blockTokens(text);
      this.lexer.state.top = top;
      return {
        type: 'blockquote',
        raw: cap[0],
        tokens,
        text
      };
    }
  }

  list(src) {
    let cap = this.rules.block.list.exec(src);
    if (cap) {
      let raw, istask, ischecked, indent, i, blankLine, endsWithBlankLine,
        line, nextLine, rawLine, itemContents, endEarly;

      let bull = cap[1].trim();
      const isordered = bull.length > 1;

      const list = {
        type: 'list',
        raw: '',
        ordered: isordered,
        start: isordered ? +bull.slice(0, -1) : '',
        loose: false,
        items: []
      };

      bull = isordered ? `\\d{1,9}\\${bull.slice(-1)}` : `\\${bull}`;

      if (this.options.pedantic) {
        bull = isordered ? bull : '[*+-]';
      }

      // Get next list item
      const itemRegex = new RegExp(`^( {0,3}${bull})((?:[\t ][^\\n]*)?(?:\\n|$))`);

      // Check if current bullet point can start a new List Item
      while (src) {
        endEarly = false;
        if (!(cap = itemRegex.exec(src))) {
          break;
        }

        if (this.rules.block.hr.test(src)) { // End list if bullet was actually HR (possibly move into itemRegex?)
          break;
        }

        raw = cap[0];
        src = src.substring(raw.length);

        line = cap[2].split('\n', 1)[0].replace(/^\t+/, (t) => ' '.repeat(3 * t.length));
        nextLine = src.split('\n', 1)[0];

        if (this.options.pedantic) {
          indent = 2;
          itemContents = line.trimLeft();
        } else {
          indent = cap[2].search(/[^ ]/); // Find first non-space char
          indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent
          itemContents = line.slice(indent);
          indent += cap[1].length;
        }

        blankLine = false;

        if (!line && /^ *$/.test(nextLine)) { // Items begin with at most one blank line
          raw += nextLine + '\n';
          src = src.substring(nextLine.length + 1);
          endEarly = true;
        }

        if (!endEarly) {
          const nextBulletRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`);
          const hrRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`);
          const fencesBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:\`\`\`|~~~)`);
          const headingBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}#`);

          // Check if following lines should be included in List Item
          while (src) {
            rawLine = src.split('\n', 1)[0];
            nextLine = rawLine;

            // Re-align to follow commonmark nesting rules
            if (this.options.pedantic) {
              nextLine = nextLine.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');
            }

            // End list item if found code fences
            if (fencesBeginRegex.test(nextLine)) {
              break;
            }

            // End list item if found start of new heading
            if (headingBeginRegex.test(nextLine)) {
              break;
            }

            // End list item if found start of new bullet
            if (nextBulletRegex.test(nextLine)) {
              break;
            }

            // Horizontal rule found
            if (hrRegex.test(src)) {
              break;
            }

            if (nextLine.search(/[^ ]/) >= indent || !nextLine.trim()) { // Dedent if possible
              itemContents += '\n' + nextLine.slice(indent);
            } else {
              // not enough indentation
              if (blankLine) {
                break;
              }

              // paragraph continuation unless last line was a different block level element
              if (line.search(/[^ ]/) >= 4) { // indented code block
                break;
              }
              if (fencesBeginRegex.test(line)) {
                break;
              }
              if (headingBeginRegex.test(line)) {
                break;
              }
              if (hrRegex.test(line)) {
                break;
              }

              itemContents += '\n' + nextLine;
            }

            if (!blankLine && !nextLine.trim()) { // Check if current line is blank
              blankLine = true;
            }

            raw += rawLine + '\n';
            src = src.substring(rawLine.length + 1);
            line = nextLine.slice(indent);
          }
        }

        if (!list.loose) {
          // If the previous item ended with a blank line, the list is loose
          if (endsWithBlankLine) {
            list.loose = true;
          } else if (/\n *\n *$/.test(raw)) {
            endsWithBlankLine = true;
          }
        }

        // Check for task list items
        if (this.options.gfm) {
          istask = /^\[[ xX]\] /.exec(itemContents);
          if (istask) {
            ischecked = istask[0] !== '[ ] ';
            itemContents = itemContents.replace(/^\[[ xX]\] +/, '');
          }
        }

        list.items.push({
          type: 'list_item',
          raw,
          task: !!istask,
          checked: ischecked,
          loose: false,
          text: itemContents
        });

        list.raw += raw;
      }

      // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic
      list.items[list.items.length - 1].raw = raw.trimRight();
      list.items[list.items.length - 1].text = itemContents.trimRight();
      list.raw = list.raw.trimRight();

      const l = list.items.length;

      // Item child tokens handled here at end because we needed to have the final item to trim it first
      for (i = 0; i < l; i++) {
        this.lexer.state.top = false;
        list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);

        if (!list.loose) {
          // Check if list should be loose
          const spacers = list.items[i].tokens.filter(t => t.type === 'space');
          const hasMultipleLineBreaks = spacers.length > 0 && spacers.some(t => /\n.*\n/.test(t.raw));

          list.loose = hasMultipleLineBreaks;
        }
      }

      // Set all items to loose if list is loose
      if (list.loose) {
        for (i = 0; i < l; i++) {
          list.items[i].loose = true;
        }
      }

      return list;
    }
  }

  html(src) {
    const cap = this.rules.block.html.exec(src);
    if (cap) {
      const token = {
        type: 'html',
        raw: cap[0],
        pre: !this.options.sanitizer
          && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),
        text: cap[0]
      };
      if (this.options.sanitize) {
        const text = this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]);
        token.type = 'paragraph';
        token.text = text;
        token.tokens = this.lexer.inline(text);
      }
      return token;
    }
  }

  def(src) {
    const cap = this.rules.block.def.exec(src);
    if (cap) {
      const tag = cap[1].toLowerCase().replace(/\s+/g, ' ');
      const href = cap[2] ? cap[2].replace(/^<(.*)>$/, '$1').replace(this.rules.inline._escapes, '$1') : '';
      const title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline._escapes, '$1') : cap[3];
      return {
        type: 'def',
        tag,
        raw: cap[0],
        href,
        title
      };
    }
  }

  table(src) {
    const cap = this.rules.block.table.exec(src);
    if (cap) {
      const item = {
        type: 'table',
        header: splitCells(cap[1]).map(c => { return { text: c }; }),
        align: cap[2].replace(/^ *|\| *$/g, '').split(/ *\| */),
        rows: cap[3] && cap[3].trim() ? cap[3].replace(/\n[ \t]*$/, '').split('\n') : []
      };

      if (item.header.length === item.align.length) {
        item.raw = cap[0];

        let l = item.align.length;
        let i, j, k, row;
        for (i = 0; i < l; i++) {
          if (/^ *-+: *$/.test(item.align[i])) {
            item.align[i] = 'right';
          } else if (/^ *:-+: *$/.test(item.align[i])) {
            item.align[i] = 'center';
          } else if (/^ *:-+ *$/.test(item.align[i])) {
            item.align[i] = 'left';
          } else {
            item.align[i] = null;
          }
        }

        l = item.rows.length;
        for (i = 0; i < l; i++) {
          item.rows[i] = splitCells(item.rows[i], item.header.length).map(c => { return { text: c }; });
        }

        // parse child tokens inside headers and cells

        // header child tokens
        l = item.header.length;
        for (j = 0; j < l; j++) {
          item.header[j].tokens = this.lexer.inline(item.header[j].text);
        }

        // cell child tokens
        l = item.rows.length;
        for (j = 0; j < l; j++) {
          row = item.rows[j];
          for (k = 0; k < row.length; k++) {
            row[k].tokens = this.lexer.inline(row[k].text);
          }
        }

        return item;
      }
    }
  }

  lheading(src) {
    const cap = this.rules.block.lheading.exec(src);
    if (cap) {
      return {
        type: 'heading',
        raw: cap[0],
        depth: cap[2].charAt(0) === '=' ? 1 : 2,
        text: cap[1],
        tokens: this.lexer.inline(cap[1])
      };
    }
  }

  paragraph(src) {
    const cap = this.rules.block.paragraph.exec(src);
    if (cap) {
      const text = cap[1].charAt(cap[1].length - 1) === '\n'
        ? cap[1].slice(0, -1)
        : cap[1];
      return {
        type: 'paragraph',
        raw: cap[0],
        text,
        tokens: this.lexer.inline(text)
      };
    }
  }

  text(src) {
    const cap = this.rules.block.text.exec(src);
    if (cap) {
      return {
        type: 'text',
        raw: cap[0],
        text: cap[0],
        tokens: this.lexer.inline(cap[0])
      };
    }
  }

  escape(src) {
    const cap = this.rules.inline.escape.exec(src);
    if (cap) {
      return {
        type: 'escape',
        raw: cap[0],
        text: escape(cap[1])
      };
    }
  }

  tag(src) {
    const cap = this.rules.inline.tag.exec(src);
    if (cap) {
      if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {
        this.lexer.state.inLink = true;
      } else if (this.lexer.state.inLink && /^<\/a>/i.test(cap[0])) {
        this.lexer.state.inLink = false;
      }
      if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\s|>)/i.test(cap[0])) {
        this.lexer.state.inRawBlock = true;
      } else if (this.lexer.state.inRawBlock && /^<\/(pre|code|kbd|script)(\s|>)/i.test(cap[0])) {
        this.lexer.state.inRawBlock = false;
      }

      return {
        type: this.options.sanitize
          ? 'text'
          : 'html',
        raw: cap[0],
        inLink: this.lexer.state.inLink,
        inRawBlock: this.lexer.state.inRawBlock,
        text: this.options.sanitize
          ? (this.options.sanitizer
            ? this.options.sanitizer(cap[0])
            : escape(cap[0]))
          : cap[0]
      };
    }
  }

  link(src) {
    const cap = this.rules.inline.link.exec(src);
    if (cap) {
      const trimmedUrl = cap[2].trim();
      if (!this.options.pedantic && /^</.test(trimmedUrl)) {
        // commonmark requires matching angle brackets
        if (!(/>$/.test(trimmedUrl))) {
          return;
        }

        // ending angle bracket cannot be escaped
        const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\');
        if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {
          return;
        }
      } else {
        // find closing parenthesis
        const lastParenIndex = findClosingBracket(cap[2], '()');
        if (lastParenIndex > -1) {
          const start = cap[0].indexOf('!') === 0 ? 5 : 4;
          const linkLen = start + cap[1].length + lastParenIndex;
          cap[2] = cap[2].substring(0, lastParenIndex);
          cap[0] = cap[0].substring(0, linkLen).trim();
          cap[3] = '';
        }
      }
      let href = cap[2];
      let title = '';
      if (this.options.pedantic) {
        // split pedantic href and title
        const link = /^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(href);

        if (link) {
          href = link[1];
          title = link[3];
        }
      } else {
        title = cap[3] ? cap[3].slice(1, -1) : '';
      }

      href = href.trim();
      if (/^</.test(href)) {
        if (this.options.pedantic && !(/>$/.test(trimmedUrl))) {
          // pedantic allows starting angle bracket without ending angle bracket
          href = href.slice(1);
        } else {
          href = href.slice(1, -1);
        }
      }
      return outputLink(cap, {
        href: href ? href.replace(this.rules.inline._escapes, '$1') : href,
        title: title ? title.replace(this.rules.inline._escapes, '$1') : title
      }, cap[0], this.lexer);
    }
  }

  reflink(src, links) {
    let cap;
    if ((cap = this.rules.inline.reflink.exec(src))
        || (cap = this.rules.inline.nolink.exec(src))) {
      let link = (cap[2] || cap[1]).replace(/\s+/g, ' ');
      link = links[link.toLowerCase()];
      if (!link) {
        const text = cap[0].charAt(0);
        return {
          type: 'text',
          raw: text,
          text
        };
      }
      return outputLink(cap, link, cap[0], this.lexer);
    }
  }

  emStrong(src, maskedSrc, prevChar = '') {
    let match = this.rules.inline.emStrong.lDelim.exec(src);
    if (!match) return;

    // _ can't be between two alphanumerics. \p{L}\p{N} includes non-english alphabet/numbers as well
    if (match[3] && prevChar.match(/[\p{L}\p{N}]/u)) return;

    const nextChar = match[1] || match[2] || '';

    if (!nextChar || (nextChar && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar)))) {
      const lLength = match[0].length - 1;
      let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;

      const endReg = match[0][0] === '*' ? this.rules.inline.emStrong.rDelimAst : this.rules.inline.emStrong.rDelimUnd;
      endReg.lastIndex = 0;

      // Clip maskedSrc to same section of string as src (move to lexer?)
      maskedSrc = maskedSrc.slice(-1 * src.length + lLength);

      while ((match = endReg.exec(maskedSrc)) != null) {
        rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];

        if (!rDelim) continue; // skip single * in __abc*abc__

        rLength = rDelim.length;

        if (match[3] || match[4]) { // found another Left Delim
          delimTotal += rLength;
          continue;
        } else if (match[5] || match[6]) { // either Left or Right Delim
          if (lLength % 3 && !((lLength + rLength) % 3)) {
            midDelimTotal += rLength;
            continue; // CommonMark Emphasis Rules 9-10
          }
        }

        delimTotal -= rLength;

        if (delimTotal > 0) continue; // Haven't found enough closing delimiters

        // Remove extra characters. *a*** -> *a*
        rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);

        const raw = src.slice(0, lLength + match.index + (match[0].length - rDelim.length) + rLength);

        // Create `em` if smallest delimiter has odd char count. *a***
        if (Math.min(lLength, rLength) % 2) {
          const text = raw.slice(1, -1);
          return {
            type: 'em',
            raw,
            text,
            tokens: this.lexer.inlineTokens(text)
          };
        }

        // Create 'strong' if smallest delimiter has even char count. **a***
        const text = raw.slice(2, -2);
        return {
          type: 'strong',
          raw,
          text,
          tokens: this.lexer.inlineTokens(text)
        };
      }
    }
  }

  codespan(src) {
    const cap = this.rules.inline.code.exec(src);
    if (cap) {
      let text = cap[2].replace(/\n/g, ' ');
      const hasNonSpaceChars = /[^ ]/.test(text);
      const hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);
      if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {
        text = text.substring(1, text.length - 1);
      }
      text = escape(text, true);
      return {
        type: 'codespan',
        raw: cap[0],
        text
      };
    }
  }

  br(src) {
    const cap = this.rules.inline.br.exec(src);
    if (cap) {
      return {
        type: 'br',
        raw: cap[0]
      };
    }
  }

  del(src) {
    const cap = this.rules.inline.del.exec(src);
    if (cap) {
      return {
        type: 'del',
        raw: cap[0],
        text: cap[2],
        tokens: this.lexer.inlineTokens(cap[2])
      };
    }
  }

  autolink(src, mangle) {
    const cap = this.rules.inline.autolink.exec(src);
    if (cap) {
      let text, href;
      if (cap[2] === '@') {
        text = escape(this.options.mangle ? mangle(cap[1]) : cap[1]);
        href = 'mailto:' + text;
      } else {
        text = escape(cap[1]);
        href = text;
      }

      return {
        type: 'link',
        raw: cap[0],
        text,
        href,
        tokens: [
          {
            type: 'text',
            raw: text,
            text
          }
        ]
      };
    }
  }

  url(src, mangle) {
    let cap;
    if (cap = this.rules.inline.url.exec(src)) {
      let text, href;
      if (cap[2] === '@') {
        text = escape(this.options.mangle ? mangle(cap[0]) : cap[0]);
        href = 'mailto:' + text;
      } else {
        // do extended autolink path validation
        let prevCapZero;
        do {
          prevCapZero = cap[0];
          cap[0] = this.rules.inline._backpedal.exec(cap[0])[0];
        } while (prevCapZero !== cap[0]);
        text = escape(cap[0]);
        if (cap[1] === 'www.') {
          href = 'http://' + cap[0];
        } else {
          href = cap[0];
        }
      }
      return {
        type: 'link',
        raw: cap[0],
        text,
        href,
        tokens: [
          {
            type: 'text',
            raw: text,
            text
          }
        ]
      };
    }
  }

  inlineText(src, smartypants) {
    const cap = this.rules.inline.text.exec(src);
    if (cap) {
      let text;
      if (this.lexer.state.inRawBlock) {
        text = this.options.sanitize ? (this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0])) : cap[0];
      } else {
        text = escape(this.options.smartypants ? smartypants(cap[0]) : cap[0]);
      }
      return {
        type: 'text',
        raw: cap[0],
        text
      };
    }
  }
}

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/package.json #######

```

{
	"name": "~TODO~",
	"version": "0.0.1",
	"scripts": {
		"dev": "./node_modules/vite/bin/vite.js dev",
		"build": "./node_modules/vite/bin/vite.js build",
		"preview": "./node_modules/vite/bin/vite.js preview"
	},
	"dependencies": {
		"marked": "^4.0.16"
	},
	"type": "module"
}

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-a/src/lib/App.svelte #######

```

<script>
	import { marked } from 'marked';
	let value = `Some words are *italic*, some are **bold**\n\n- lists\n- are\n- cool`;
</script>

<div class="grid">
	input
	<textarea {value}></textarea>

	output
	<div>{@html marked(value)}</div>
</div>

<style>
	.grid {
		display: grid;
		grid-template-columns: 5em 1fr;
		grid-template-rows: 1fr 1fr;
		grid-gap: 1em;
		height: 100%;
	}

	textarea {
		flex: 1;
		resize: none;
	}
</style>

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/app-b/src/lib/App.svelte #######

```

<script>
	import { marked } from 'marked';
	let value = `Some words are *italic*, some are **bold**\n\n- lists\n- are\n- cool`;
</script>

<div class="grid">
	input
	<textarea bind:value></textarea>

	output
	<div>{@html marked(value)}</div>
</div>

<style>
	.grid {
		display: grid;
		grid-template-columns: 5em 1fr;
		grid-template-rows: 1fr 1fr;
		grid-gap: 1em;
		height: 100%;
	}

	textarea {
		flex: 1;
		resize: none;
	}
</style>

```


####### content/tutorial/01-svelte/06-bindings/07-textarea-inputs/README.md #######

---
title: Textarea inputs
---

The `<textarea>` element behaves similarly to a text input in Svelte — use `bind:value`:

```svelte
/// file: App.svelte
<textarea +++bind:value=+++{value}></textarea>
```

In cases like these, where the names match, we can also use a shorthand form:

```svelte
/// file: App.svelte
<textarea +++bind:value+++></textarea>
```

This applies to all bindings, not just textareas.

####### content/tutorial/01-svelte/06-bindings/meta.json #######

```

{
	"title": "Bindings",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/01-svelte/07-lifecycle/01-onmount/app-a/src/lib/App.svelte #######

```

<script>
	import { paint } from './gradient.js';
</script>

<canvas
	width={32}
	height={32}
/>

<style>
	canvas {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		background-color: #666;
		mask: url(./svelte-logo-mask.svg) 50% 50% no-repeat;
		mask-size: 60vmin;
		-webkit-mask: url(./svelte-logo-mask.svg) 50% 50% no-repeat;
		-webkit-mask-size: 60vmin;
	}
</style>

```


####### content/tutorial/01-svelte/07-lifecycle/01-onmount/app-a/src/lib/gradient.js #######

```

export function paint(context, t) {
	const { width, height } = context.canvas;
	const imageData = context.getImageData(0, 0, width, height);

	for (let p = 0; p < imageData.data.length; p += 4) {
		const i = p / 4;
		const x = i % width;
		const y = (i / width) >>> 0;

		const red = 64 + (128 * x) / width + 64 * Math.sin(t / 1000);
		const green = 64 + (128 * y) / height + 64 * Math.cos(t / 1000);
		const blue = 128;

		imageData.data[p + 0] = red;
		imageData.data[p + 1] = green;
		imageData.data[p + 2] = blue;
		imageData.data[p + 3] = 255;
	}

	context.putImageData(imageData, 0, 0);
}
```


####### content/tutorial/01-svelte/07-lifecycle/01-onmount/app-b/src/lib/App.svelte #######

```

<script>
	import { onMount } from 'svelte';
	import { paint } from './gradient.js';

	onMount(() => {
		const canvas = document.querySelector('canvas');
		const context = canvas.getContext('2d');

		let frame = requestAnimationFrame(function loop(t) {
			frame = requestAnimationFrame(loop);
			paint(context, t);
		});

		return () => {
			cancelAnimationFrame(frame);
		};
	});
</script>

<canvas
	width={32}
	height={32}
/>

<style>
	canvas {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		background-color: #666;
		mask: url(./svelte-logo-mask.svg) 50% 50% no-repeat;
		mask-size: 60vmin;
		-webkit-mask: url(./svelte-logo-mask.svg) 50% 50% no-repeat;
		-webkit-mask-size: 60vmin;
	}
</style>

```


####### content/tutorial/01-svelte/07-lifecycle/01-onmount/README.md #######

---
title: onMount
---

Every component has a _lifecycle_ that starts when it is created, and ends when it is destroyed. There are a handful of functions that allow you to run code at key moments during that lifecycle. The one you'll use most frequently is `onMount`, which runs after the component is first rendered to the DOM.

In this exercise, we have a `<canvas>` that we'd like to animate, using the `paint` function in `gradient.js`. Begin by importing the `onMount` function from `svelte`:

```svelte
/// file: App.svelte
<script>
	+++import { onMount } from 'svelte';+++
	import { paint } from './gradient.js';
</script>
```

Then, add a callback that runs when the component mounts:

```svelte
/// file: App.svelte
<script>
	import { onMount } from 'svelte';
	import { paint } from './gradient.js';

+++	onMount(() => {
		const canvas = document.querySelector('canvas');
		const context = canvas.getContext('2d');+++

+++		requestAnimationFrame(function loop(t) {
			requestAnimationFrame(loop);
			paint(context, t);
		});
	});+++
</script>
```

> In a [later exercise](bind-this), we'll learn how to get an element reference without using `document.querySelector`.

So far so good — you should see gently undulating colours in the shape of the Svelte logo. But there's one problem — the loop will continue even after the component has been destroyed. To fix that, we need to return a cleanup function from `onMount`:

```js
/// file: App.svelte
onMount(() => {
	const canvas = document.querySelector('canvas');
	const context = canvas.getContext('2d');

	+++let frame =+++ requestAnimationFrame(function loop(t) {
		+++frame =+++ requestAnimationFrame(loop);
		paint(context, t);
	});

+++	return () => {
		cancelAnimationFrame(frame);
	};+++
});
```

####### content/tutorial/01-svelte/07-lifecycle/02-update/app-a/node_modules/elizabot/elizabot.js #######

```

/*
  elizabot.js v.1.1 - ELIZA JS library (N.Landsteiner 2005)
  Eliza is a mock Rogerian psychotherapist.
  Original program by Joseph Weizenbaum in MAD-SLIP for "Project MAC" at MIT.
  cf: Weizenbaum, Joseph "ELIZA - A Computer Program For the Study of Natural Language
      Communication Between Man and Machine"
      in: Communications of the ACM; Volume 9 , Issue 1 (January 1966): p 36-45.
  JavaScript implementation by Norbert Landsteiner 2005; <http://www.masserk.at>

  synopsis:

         new ElizaBot( <random-choice-disable-flag> )
         ElizaBot.prototype.transform( <inputstring> )
         ElizaBot.prototype.getInitial()
         ElizaBot.prototype.getFinal()
         ElizaBot.prototype.reset()

  usage: var eliza = new ElizaBot();
         var initial = eliza.getInitial();
         var reply = eliza.transform(inputstring);
         if (eliza.quit) {
             // last user input was a quit phrase
         }

         // method `transform()' returns a final phrase in case of a quit phrase
         // but you can also get a final phrase with:
         var final = eliza.getFinal();

         // other methods: reset memory and internal state
         eliza.reset();

         // to set the internal memory size override property `memSize':
         eliza.memSize = 100; // (default: 20)

         // to reproduce the example conversation given by J. Weizenbaum
         // initialize with the optional random-choice-disable flag
         var originalEliza = new ElizaBot(true);

  `ElizaBot' is also a general chatbot engine that can be supplied with any rule set.
  (for required data structures cf. "elizadata.js" and/or see the documentation.)
  data is parsed and transformed for internal use at the creation time of the
  first instance of the `ElizaBot' constructor.

  vers 1.1: lambda functions in RegExps are currently a problem with too many browsers.
            changed code to work around.
*/

"use strict";

var elizaData = require('./elizadata');

function ElizaBot(noRandomFlag) {
	this.noRandom= (noRandomFlag)? true:false;
	this.capitalizeFirstLetter=true;
	this.debug=false;
	this.memSize=20;
	this.version="1.1 (original)";
	if (!this._dataParsed) this._init();
	this.reset();
}

ElizaBot.prototype.reset = function() {
	this.quit=false;
	this.mem=[];
	this.lastchoice=[];
	for (var k=0; k<elizaData.elizaKeywords.length; k++) {
		this.lastchoice[k]=[];
		var rules=elizaData.elizaKeywords[k][2];
		for (var i=0; i<rules.length; i++) this.lastchoice[k][i]=-1;
	}
}

ElizaBot.prototype._dataParsed = false;

ElizaBot.prototype._init = function() {
	// parse data and convert it from canonical form to internal use
	// produce synonym list
	var synPatterns={};
	if ((elizaData.elizaSynons) && (typeof elizaData.elizaSynons == 'object')) {
		for (var i in elizaData.elizaSynons) synPatterns[i]='('+i+'|'+elizaData.elizaSynons[i].join('|')+')';
	}
	// check for keywords or install empty structure to prevent any errors
	if ((!elizaData.elizaKeywords) || (typeof elizaData.elizaKeywords.length == 'undefined')) {
		elizaData.elizaKeywords=[['###',0,[['###',[]]]]];
	}
	// 1st convert rules to regexps
	// expand synonyms and insert asterisk expressions for backtracking
	var sre=/@(\S+)/;
	var are=/(\S)\s*\*\s*(\S)/;
	var are1=/^\s*\*\s*(\S)/;
	var are2=/(\S)\s*\*\s*$/;
	var are3=/^\s*\*\s*$/;
	var wsre=/\s+/g;
	for (var k=0; k<elizaData.elizaKeywords.length; k++) {
		var rules=elizaData.elizaKeywords[k][2];
		elizaData.elizaKeywords[k][3]=k; // save original index for sorting
		for (var i=0; i<rules.length; i++) {
			var r=rules[i];
			// check mem flag and store it as decomp's element 2
			if (r[0].charAt(0)=='$') {
				var ofs=1;
				while (r[0].charAt[ofs]==' ') ofs++;
				r[0]=r[0].substring(ofs);
				r[2]=true;
			}
			else {
				r[2]=false;
			}
			// expand synonyms (v.1.1: work around lambda function)
			var m=sre.exec(r[0]);
			while (m) {
				var sp=(synPatterns[m[1]])? synPatterns[m[1]]:m[1];
				r[0]=r[0].substring(0,m.index)+sp+r[0].substring(m.index+m[0].length);
				m=sre.exec(r[0]);
			}
			// expand asterisk expressions (v.1.1: work around lambda function)
			if (are3.test(r[0])) {
				r[0]='\\s*(.*)\\s*';
			}
			else {
				m=are.exec(r[0]);
				if (m) {
					var lp='';
					var rp=r[0];
					while (m) {
						lp+=rp.substring(0,m.index+1);
						if (m[1]!=')') lp+='\\b';
						lp+='\\s*(.*)\\s*';
						if ((m[2]!='(') && (m[2]!='\\')) lp+='\\b';
						lp+=m[2];
						rp=rp.substring(m.index+m[0].length);
						m=are.exec(rp);
					}
					r[0]=lp+rp;
				}
				m=are1.exec(r[0]);
				if (m) {
					var lp='\\s*(.*)\\s*';
					if ((m[1]!=')') && (m[1]!='\\')) lp+='\\b';
					r[0]=lp+r[0].substring(m.index-1+m[0].length);
				}
				m=are2.exec(r[0]);
				if (m) {
					var lp=r[0].substring(0,m.index+1);
					if (m[1]!='(') lp+='\\b';
					r[0]=lp+'\\s*(.*)\\s*';
				}
			}
			// expand white space
			r[0]=r[0].replace(wsre, '\\s+');
			wsre.lastIndex=0;
		}
	}
	// now sort keywords by rank (highest first)
	elizaData.elizaKeywords.sort(this._sortKeywords);
	// and compose regexps and refs for pres and posts
	ElizaBot.prototype.pres={};
	ElizaBot.prototype.posts={};
	if ((elizaData.elizaPres) && (elizaData.elizaPres.length)) {
		var a=new Array();
		for (var i=0; i<elizaData.elizaPres.length; i+=2) {
			a.push(elizaData.elizaPres[i]);
			ElizaBot.prototype.pres[elizaData.elizaPres[i]]=elizaData.elizaPres[i+1];
		}
		ElizaBot.prototype.preExp = new RegExp('\\b('+a.join('|')+')\\b');
	}
	else {
		// default (should not match)
		ElizaBot.prototype.preExp = /####/;
		ElizaBot.prototype.pres['####']='####';
	}
	if ((elizaData.elizaPosts) && (elizaData.elizaPosts.length)) {
		var a=new Array();
		for (var i=0; i<elizaData.elizaPosts.length; i+=2) {
			a.push(elizaData.elizaPosts[i]);
			ElizaBot.prototype.posts[elizaData.elizaPosts[i]]=elizaData.elizaPosts[i+1];
		}
		ElizaBot.prototype.postExp = new RegExp('\\b('+a.join('|')+')\\b');
	}
	else {
		// default (should not match)
		ElizaBot.prototype.postExp = /####/;
		ElizaBot.prototype.posts['####']='####';
	}
	// check for elizaQuits and install default if missing
	if ((!elizaData.elizaQuits) || (typeof elizaData.elizaQuits.length == 'undefined')) {
		elizaData.elizaQuits=[];
	}
	// done
	ElizaBot.prototype._dataParsed=true;
}

ElizaBot.prototype._sortKeywords = function(a,b) {
	// sort by rank
	if (a[1]>b[1]) return -1
	else if (a[1]<b[1]) return 1
	// or original index
	else if (a[3]>b[3]) return 1
	else if (a[3]<b[3]) return -1
	else return 0;
}

ElizaBot.prototype.transform = function(text) {
	var rpl='';
	this.quit=false;
	// unify text string
	text=text.toLowerCase();
	text=text.replace(/@#\$%\^&\*\(\)_\+=~`\{\[\}\]\|:;<>\/\\\t/g, ' ');
	text=text.replace(/\s+-+\s+/g, '.');
	text=text.replace(/\s*[,\.\?!;]+\s*/g, '.');
	text=text.replace(/\s*\bbut\b\s*/g, '.');
	text=text.replace(/\s{2,}/g, ' ');
	// split text in part sentences and loop through them
	var parts=text.split('.');
	for (var i=0; i<parts.length; i++) {
		var part=parts[i];
		if (part!='') {
			// check for quit expression
			for (var q=0; q<elizaData.elizaQuits.length; q++) {
				if (elizaData.elizaQuits[q]==part) {
					this.quit=true;
					return this.getFinal();
				}
			}
			// preprocess (v.1.1: work around lambda function)
			var m=this.preExp.exec(part);
			if (m) {
				var lp='';
				var rp=part;
				while (m) {
					lp+=rp.substring(0,m.index)+this.pres[m[1]];
					rp=rp.substring(m.index+m[0].length);
					m=this.preExp.exec(rp);
				}
				part=lp+rp;
			}
			this.sentence=part;
			// loop trough keywords
			for (var k=0; k<elizaData.elizaKeywords.length; k++) {
				if (part.search(new RegExp('\\b'+elizaData.elizaKeywords[k][0]+'\\b', 'i'))>=0) {
					rpl = this._execRule(k);
				}
				if (rpl!='') return rpl;
			}
		}
	}
	// nothing matched try mem
	rpl=this._memGet();
	// if nothing in mem, so try xnone
	if (rpl=='') {
		this.sentence=' ';
		var k=this._getRuleIndexByKey('xnone');
		if (k>=0) rpl=this._execRule(k);
	}
	// return reply or default string
	return (rpl!='')? rpl : 'I am at a loss for words.';
}

ElizaBot.prototype._execRule = function(k) {
	var rule=elizaData.elizaKeywords[k];
	var decomps=rule[2];
	var paramre=/\(([0-9]+)\)/;
	for (var i=0; i<decomps.length; i++) {
		var m=this.sentence.match(decomps[i][0]);
		if (m!=null) {
			var reasmbs=decomps[i][1];
			var memflag=decomps[i][2];
			var ri= (this.noRandom)? 0 : Math.floor(Math.random()*reasmbs.length);
			if (((this.noRandom) && (this.lastchoice[k][i]>ri)) || (this.lastchoice[k][i]==ri)) {
				ri= ++this.lastchoice[k][i];
				if (ri>=reasmbs.length) {
					ri=0;
					this.lastchoice[k][i]=-1;
				}
			}
			else {
				this.lastchoice[k][i]=ri;
			}
			var rpl=reasmbs[ri];
			if (this.debug) alert('match:\nkey: '+elizaData.elizaKeywords[k][0]+
				'\nrank: '+elizaData.elizaKeywords[k][1]+
				'\ndecomp: '+decomps[i][0]+
				'\nreasmb: '+rpl+
				'\nmemflag: '+memflag);
			if (rpl.search('^goto ', 'i')==0) {
				var ki=this._getRuleIndexByKey(rpl.substring(5));
				if (ki>=0) return this._execRule(ki);
			}
			// substitute positional params (v.1.1: work around lambda function)
			var m1=paramre.exec(rpl);
			if (m1) {
				var lp='';
				var rp=rpl;
				while (m1) {
					var param = m[parseInt(m1[1])];
					// postprocess param
					var m2=this.postExp.exec(param);
					if (m2) {
						var lp2='';
						var rp2=param;
						while (m2) {
							lp2+=rp2.substring(0,m2.index)+this.posts[m2[1]];
							rp2=rp2.substring(m2.index+m2[0].length);
							m2=this.postExp.exec(rp2);
						}
						param=lp2+rp2;
					}
					lp+=rp.substring(0,m1.index)+param;
					rp=rp.substring(m1.index+m1[0].length);
					m1=paramre.exec(rp);
				}
				rpl=lp+rp;
			}
			rpl=this._postTransform(rpl);
			if (memflag) this._memSave(rpl);
			else return rpl;
		}
	}
	return '';
}

ElizaBot.prototype._postTransform = function(s) {
	// final cleanings
	s=s.replace(/\s{2,}/g, ' ');
	s=s.replace(/\s+\./g, '.');
	if ((elizaData.elizaPostTransforms) && (elizaData.elizaPostTransforms.length)) {
		for (var i=0; i<elizaData.elizaPostTransforms.length; i+=2) {
			s=s.replace(elizaData.elizaPostTransforms[i], elizaData.elizaPostTransforms[i+1]);
			elizaData.elizaPostTransforms[i].lastIndex=0;
		}
	}
	// capitalize first char (v.1.1: work around lambda function)
	if (this.capitalizeFirstLetter) {
		var re=/^([a-z])/;
		var m=re.exec(s);
		if (m) s=m[0].toUpperCase()+s.substring(1);
	}
	return s;
}

ElizaBot.prototype._getRuleIndexByKey = function(key) {
	for (var k=0; k<elizaData.elizaKeywords.length; k++) {
		if (elizaData.elizaKeywords[k][0]==key) return k;
	}
	return -1;
}

ElizaBot.prototype._memSave = function(t) {
	this.mem.push(t);
	if (this.mem.length>this.memSize) this.mem.shift();
}

ElizaBot.prototype._memGet = function() {
	if (this.mem.length) {
		if (this.noRandom) return this.mem.shift();
		else {
			var n=Math.floor(Math.random()*this.mem.length);
			var rpl=this.mem[n];
			for (var i=n+1; i<this.mem.length; i++) this.mem[i-1]=this.mem[i];
			this.mem.length--;
			return rpl;
		}
	}
	else return '';
}

ElizaBot.prototype.getFinal = function() {
	if (!elizaData.elizaFinals) return '';
	return elizaData.elizaFinals[Math.floor(Math.random()*elizaData.elizaFinals.length)];
}

ElizaBot.prototype.getInitial = function() {
	if (!elizaData.elizaInitials) return '';
	return elizaData.elizaInitials[Math.floor(Math.random()*elizaData.elizaInitials.length)];
}


// fix array.prototype methods (push, shift) if not implemented (MSIE fix)
if (typeof Array.prototype.push == 'undefined') {
	Array.prototype.push=function(v) { return this[this.length]=v; };
}
if (typeof Array.prototype.shift == 'undefined') {
	Array.prototype.shift=function() {
		if (this.length==0) return null;
		var e0=this[0];
		for (var i=1; i<this.length; i++) this[i-1]=this[i];
		this.length--;
		return e0;
	};
}

module.exports = ElizaBot;

// eof
```


####### content/tutorial/01-svelte/07-lifecycle/02-update/app-a/node_modules/elizabot/elizadata.js #######

```

// start of file - elizadata.js
// data for elizabot.js
// entries prestructured as layed out in Weizenbaum's description
// [cf: Communications of the ACM, Vol. 9, #1 (January 1966): p 36-45.]

"use strict";

exports.elizaInitials = [
	"How do you do.  Please tell me your problem.",
// additions (not original)
	"Please tell me what's been bothering you.",
	"Is something troubling you ?"
];

exports.elizaFinals = [
	"Goodbye.  It was nice talking to you.",
// additions (not original)
	"Goodbye.  This was really a nice talk.",
	"Goodbye.  I'm looking forward to our next session.",
	"This was a good session, wasn't it -- but time is over now.   Goodbye.",
	"Maybe we could discuss this moreover in our next session ?   Goodbye."
];

exports.elizaQuits = [
	"bye",
	"goodbye",
	"done",
	"exit",
	"quit"
];

exports.elizaPres = [
	"dont", "don't",
	"cant", "can't",
	"wont", "won't",
	"recollect", "remember",
	"recall", "remember",
	"dreamt", "dreamed",
	"dreams", "dream",
	"maybe", "perhaps",
	"certainly", "yes",
	"machine", "computer",
	"machines", "computer",
	"computers", "computer",
	"were", "was",
	"you're", "you are",
	"i'm", "i am",
	"same", "alike",
	"identical", "alike",
	"equivalent", "alike"
];

exports.elizaPosts = [
	"am", "are",
	"your", "my",
	"me", "you",
	"myself", "yourself",
	"yourself", "myself",
	"i", "you",
	"you", "I",
	"my", "your",
	"i'm", "you are"
];

exports.elizaSynons = {
	"be": ["am", "is", "are", "was"],
	"belief": ["feel", "think", "believe", "wish"],
	"cannot": ["can't"],
	"desire": ["want", "need"],
	"everyone": ["everybody", "nobody", "noone"],
	"family": ["mother", "mom", "father", "dad", "sister", "brother", "wife", "children", "child"],
	"happy": ["elated", "glad", "better"],
	"sad": ["unhappy", "depressed", "sick"]
};

exports.elizaKeywords = [

	/*
	 Array of
	 ["<key>", <rank>, [
	 ["<decomp>", [
	 "<reasmb>",
	 "<reasmb>",
	 "<reasmb>"
	 ]],
	 ["<decomp>", [
	 "<reasmb>",
	 "<reasmb>",
	 "<reasmb>"
	 ]]
	 ]]
	 */

	["xnone", 0, [
		["*", [
			"I'm not sure I understand you fully.",
			"Please go on.",
			"What does that suggest to you ?",
			"Do you feel strongly about discussing such things ?",
			"That is interesting.  Please continue.",
			"Tell me more about that.",
			"Does talking about this bother you ?"
		]]
	]],
	["sorry", 0, [
		["*", [
			"Please don't apologise.",
			"Apologies are not necessary.",
			"I've told you that apologies are not required.",
			"It did not bother me.  Please continue."
		]]
	]],
	["apologise", 0, [
		["*", [
			"goto sorry"
		]]
	]],
	["remember", 5, [
		["* i remember *", [
			"Do you often think of (2) ?",
			"Does thinking of (2) bring anything else to mind ?",
			"What else do you recollect ?",
			"Why do you remember (2) just now ?",
			"What in the present situation reminds you of (2) ?",
			"What is the connection between me and (2) ?",
			"What else does (2) remind you of ?"
		]],
		["* do you remember *", [
			"Did you think I would forget (2) ?",
			"Why do you think I should recall (2) now ?",
			"What about (2) ?",
			"goto what",
			"You mentioned (2) ?"
		]],
		["* you remember *", [
			"How could I forget (2) ?",
			"What about (2) should I remember ?",
			"goto you"
		]]
	]],
	["forget", 5, [
		["* i forget *", [
			"Can you think of why you might forget (2) ?",
			"Why can't you remember (2) ?",
			"How often do you think of (2) ?",
			"Does it bother you to forget that ?",
			"Could it be a mental block ?",
			"Are you generally forgetful ?",
			"Do you think you are suppressing (2) ?"
		]],
		["* did you forget *", [
			"Why do you ask ?",
			"Are you sure you told me ?",
			"Would it bother you if I forgot (2) ?",
			"Why should I recall (2) just now ?",
			"goto what",
			"Tell me more about (2)."
		]]
	]],
	["if", 3, [
		["* if *", [
			"Do you think it's likely that (2) ?",
			"Do you wish that (2) ?",
			"What do you know about (2) ?",
			"Really, if (2) ?",
			"What would you do if (2) ?",
			"But what are the chances that (2) ?",
			"What does this speculation lead to ?"
		]]
	]],
	["dreamed", 4, [
		["* i dreamed *", [
			"Really, (2) ?",
			"Have you ever fantasized (2) while you were awake ?",
			"Have you ever dreamed (2) before ?",
			"goto dream"
		]]
	]],
	["dream", 3, [
		["*", [
			"What does that dream suggest to you ?",
			"Do you dream often ?",
			"What persons appear in your dreams ?",
			"Do you believe that dreams have something to do with your problem ?"
		]]
	]],
	["perhaps", 0, [
		["*", [
			"You don't seem quite certain.",
			"Why the uncertain tone ?",
			"Can't you be more positive ?",
			"You aren't sure ?",
			"Don't you know ?",
			"How likely, would you estimate ?"
		]]
	]],
	["name", 15, [
		["*", [
			"I am not interested in names.",
			"I've told you before, I don't care about names -- please continue."
		]]
	]],
	["deutsch", 0, [
		["*", [
			"goto xforeign",
			"I told you before, I don't understand German."
		]]
	]],
	["francais", 0, [
		["*", [
			"goto xforeign",
			"I told you before, I don't understand French."
		]]
	]],
	["italiano", 0, [
		["*", [
			"goto xforeign",
			"I told you before, I don't understand Italian."
		]]
	]],
	["espanol", 0, [
		["*", [
			"goto xforeign",
			"I told you before, I don't understand Spanish."
		]]
	]],
	["xforeign", 0, [
		["*", [
			"I speak only English."
		]]
	]],
	["hello", 0, [
		["*", [
			"How do you do.  Please state your problem.",
			"Hi.  What seems to be your problem ?"
		]]
	]],
	["computer", 50, [
		["*", [
			"Do computers worry you ?",
			"Why do you mention computers ?",
			"What do you think machines have to do with your problem ?",
			"Don't you think computers can help people ?",
			"What about machines worries you ?",
			"What do you think about machines ?",
			"You don't think I am a computer program, do you ?"
		]]
	]],
	["am", 0, [
		["* am i *", [
			"Do you believe you are (2) ?",
			"Would you want to be (2) ?",
			"Do you wish I would tell you you are (2) ?",
			"What would it mean if you were (2) ?",
			"goto what"
		]],
		["* i am *", [
			"goto i"
		]],
		["*", [
			"Why do you say 'am' ?",
			"I don't understand that."
		]]
	]],
	["are", 0, [
		["* are you *", [
			"Why are you interested in whether I am (2) or not ?",
			"Would you prefer if I weren't (2) ?",
			"Perhaps I am (2) in your fantasies.",
			"Do you sometimes think I am (2) ?",
			"goto what",
			"Would it matter to you ?",
			"What if I were (2) ?"
		]],
		["* you are *", [
			"goto you"
		]],
		["* are *", [
			"Did you think they might not be (2) ?",
			"Would you like it if they were not (2) ?",
			"What if they were not (2) ?",
			"Are they always (2) ?",
			"Possibly they are (2).",
			"Are you positive they are (2) ?"
		]]
	]],
	["your", 0, [
		["* your *", [
			"Why are you concerned over my (2) ?",
			"What about your own (2) ?",
			"Are you worried about someone else's (2) ?",
			"Really, my (2) ?",
			"What makes you think of my (2) ?",
			"Do you want my (2) ?"
		]]
	]],
	["was", 2, [
		["* was i *", [
			"What if you were (2) ?",
			"Do you think you were (2) ?",
			"Were you (2) ?",
			"What would it mean if you were (2) ?",
			"What does ' (2) ' suggest to you ?",
			"goto what"
		]],
		["* i was *", [
			"Were you really ?",
			"Why do you tell me you were (2) now ?",
			"Perhaps I already know you were (2)."
		]],
		["* was you *", [
			"Would you like to believe I was (2) ?",
			"What suggests that I was (2) ?",
			"What do you think ?",
			"Perhaps I was (2).",
			"What if I had been (2) ?"
		]]
	]],
	["i", 0, [
		["* i @desire *", [
			"What would it mean to you if you got (3) ?",
			"Why do you want (3) ?",
			"Suppose you got (3) soon.",
			"What if you never got (3) ?",
			"What would getting (3) mean to you ?",
			"What does wanting (3) have to do with this discussion ?"
		]],
		["* i am* @sad *", [
			"I am sorry to hear that you are (3).",
			"Do you think coming here will help you not to be (3) ?",
			"I'm sure it's not pleasant to be (3).",
			"Can you explain what made you (3) ?"
		]],
		["* i am* @happy *", [
			"How have I helped you to be (3) ?",
			"Has your treatment made you (3) ?",
			"What makes you (3) just now ?",
			"Can you explain why you are suddenly (3) ?"
		]],
		["* i was *", [
			"goto was"
		]],
		["* i @belief i *", [
			"Do you really think so ?",
			"But you are not sure you (3).",
			"Do you really doubt you (3) ?"
		]],
		["* i* @belief *you *", [
			"goto you"
		]],
		["* i am *", [
			"Is it because you are (2) that you came to me ?",
			"How long have you been (2) ?",
			"Do you believe it is normal to be (2) ?",
			"Do you enjoy being (2) ?",
			"Do you know anyone else who is (2) ?"
		]],
		["* i @cannot *", [
			"How do you know that you can't (3) ?",
			"Have you tried ?",
			"Perhaps you could (3) now.",
			"Do you really want to be able to (3) ?",
			"What if you could (3) ?"
		]],
		["* i don't *", [
			"Don't you really (2) ?",
			"Why don't you (2) ?",
			"Do you wish to be able to (2) ?",
			"Does that trouble you ?"
		]],
		["* i feel *", [
			"Tell me more about such feelings.",
			"Do you often feel (2) ?",
			"Do you enjoy feeling (2) ?",
			"Of what does feeling (2) remind you ?"
		]],
		["* i * you *", [
			"Perhaps in your fantasies we (2) each other.",
			"Do you wish to (2) me ?",
			"You seem to need to (2) me.",
			"Do you (2) anyone else ?"
		]],
		["*", [
			"You say (1) ?",
			"Can you elaborate on that ?",
			"Do you say (1) for some special reason ?",
			"That's quite interesting."
		]]
	]],
	["you", 0, [
		["* you remind me of *", [
			"goto alike"
		]],
		["* you are *", [
			"What makes you think I am (2) ?",
			"Does it please you to believe I am (2) ?",
			"Do you sometimes wish you were (2) ?",
			"Perhaps you would like to be (2)."
		]],
		["* you* me *", [
			"Why do you think I (2) you ?",
			"You like to think I (2) you -- don't you ?",
			"What makes you think I (2) you ?",
			"Really, I (2) you ?",
			"Do you wish to believe I (2) you ?",
			"Suppose I did (2) you -- what would that mean ?",
			"Does someone else believe I (2) you ?"
		]],
		["* you *", [
			"We were discussing you -- not me.",
			"Oh, I (2) ?",
			"You're not really talking about me -- are you ?",
			"What are your feelings now ?"
		]]
	]],
	["yes", 0, [
		["*", [
			"You seem to be quite positive.",
			"You are sure.",
			"I see.",
			"I understand."
		]]
	]],
	["no", 0, [
		["* no one *", [
			"Are you sure, no one (2) ?",
			"Surely someone (2) .",
			"Can you think of anyone at all ?",
			"Are you thinking of a very special person ?",
			"Who, may I ask ?",
			"You have a particular person in mind, don't you ?",
			"Who do you think you are talking about ?"
		]],
		["*", [
			"Are you saying no just to be negative?",
			"You are being a bit negative.",
			"Why not ?",
			"Why 'no' ?"
		]]
	]],
	["my", 2, [
		["$ * my *", [
			"Does that have anything to do with the fact that your (2) ?",
			"Lets discuss further why your (2).",
			"Earlier you said your (2).",
			"But your (2)."
		]],
		["* my* @family *", [
			"Tell me more about your family.",
			"Who else in your family (4) ?",
			"Your (3) ?",
			"What else comes to your mind when you think of your (3) ?"
		]],
		["* my *", [
			"Your (2) ?",
			"Why do you say your (2) ?",
			"Does that suggest anything else which belongs to you ?",
			"Is it important to you that your (2) ?"
		]]
	]],
	["can", 0, [
		["* can you *", [
			"You believe I can (2) don't you ?",
			"goto what",
			"You want me to be able to (2).",
			"Perhaps you would like to be able to (2) yourself."
		]],
		["* can i *", [
			"Whether or not you can (2) depends on you more than on me.",
			"Do you want to be able to (2) ?",
			"Perhaps you don't want to (2).",
			"goto what"
		]]
	]],
	["what", 0, [
		["*", [
			"Why do you ask ?",
			"Does that question interest you ?",
			"What is it you really want to know ?",
			"Are such questions much on your mind ?",
			"What answer would please you most ?",
			"What do you think ?",
			"What comes to mind when you ask that ?",
			"Have you asked such questions before ?",
			"Have you asked anyone else ?"
		]]
	]],
	["who", 0, [
		["who *", [
			"goto what"
		]]
	]],
	["when", 0, [
		["when *", [
			"goto what"
		]]
	]],
	["where", 0, [
		["where *", [
			"goto what"
		]]
	]],
	["how", 0, [
		["how *", [
			"goto what"
		]]
	]],
	["because", 0, [
		["*", [
			"Is that the real reason ?",
			"Don't any other reasons come to mind ?",
			"Does that reason seem to explain anything else ?",
			"What other reasons might there be ?"
		]]
	]],
	["why", 0, [
		["* why don't you *", [
			"Do you believe I don't (2) ?",
			"Perhaps I will (2) in good time.",
			"Should you (2) yourself ?",
			"You want me to (2) ?",
			"goto what"
		]],
		["* why can't i *", [
			"Do you think you should be able to (2) ?",
			"Do you want to be able to (2) ?",
			"Do you believe this will help you to (2) ?",
			"Have you any idea why you can't (2) ?",
			"goto what"
		]],
		["*", [
			"goto what"
		]]
	]],
	["everyone", 2, [
		["* @everyone *", [
			"Really, (2) ?",
			"Surely not (2).",
			"Can you think of anyone in particular ?",
			"Who, for example?",
			"Are you thinking of a very special person ?",
			"Who, may I ask ?",
			"Someone special perhaps ?",
			"You have a particular person in mind, don't you ?",
			"Who do you think you're talking about ?"
		]]
	]],
	["everybody", 2, [
		["*", [
			"goto everyone"
		]]
	]],
	["nobody", 2, [
		["*", [
			"goto everyone"
		]]
	]],
	["noone", 2, [
		["*", [
			"goto everyone"
		]]
	]],
	["always", 1, [
		["*", [
			"Can you think of a specific example ?",
			"When ?",
			"What incident are you thinking of ?",
			"Really, always ?"
		]]
	]],
	["alike", 10, [
		["*", [
			"In what way ?",
			"What resemblence do you see ?",
			"What does that similarity suggest to you ?",
			"What other connections do you see ?",
			"What do you suppose that resemblence means ?",
			"What is the connection, do you suppose ?",
			"Could there really be some connection ?",
			"How ?"
		]]
	]],
	["like", 10, [
		["* @be *like *", [
			"goto alike"
		]]
	]],
	["different", 0, [
		["*", [
			"How is it different ?",
			"What differences do you see ?",
			"What does that difference suggest to you ?",
			"What other distinctions do you see ?",
			"What do you suppose that disparity means ?",
			"Could there be some connection, do you suppose ?",
			"How ?"
		]]
	]]

];

// regexp/replacement pairs to be performed as final cleanings
// here: cleanings for multiple bots talking to each other
exports.elizaPostTransforms = [
	/ old old/g, " old",
	/\bthey were( not)? me\b/g, "it was$1 me",
	/\bthey are( not)? me\b/g, "it is$1 me",
	/Are they( always)? me\b/, "it is$1 me",
	/\bthat your( own)? (\w+)( now)? \?/, "that you have your$1 $2 ?",
	/\bI to have (\w+)/, "I have $1",
	/Earlier you said your( own)? (\w+)( now)?\./, "Earlier you talked about your $2."
];

// eof
```


####### content/tutorial/01-svelte/07-lifecycle/02-update/app-a/node_modules/elizabot/package.json #######

```

{
	"name": "elizabot",
	"description": "Adaptation of http://www.masswerk.at/elizabot/ for node.js.",
	"author": "Tomas Kafka <tk@tomaskafka.com>",
	"version": "0.0.3",
	"repository": "https://github.com/tkafka/node-elizabot.git",
	"main": "elizabot.js",
	"dependencies": {},
	"devDependencies": {
		"eslint": "^7.0.0"
	},
	"engine": "node >= 0.6"
}

```


####### content/tutorial/01-svelte/07-lifecycle/02-update/app-a/node_modules/elizabot/README.md #######

Adaptation of http://www.masswerk.at/elizabot/ eliza chat bot to node.js command line app.

elizabot.js v.1.1 - ELIZA JS library (N.Landsteiner 2005)
Eliza is a mock Rogerian psychotherapist.
Original program by Joseph Weizenbaum in MAD-SLIP for "Project MAC" at MIT.
cf: Weizenbaum, Joseph "ELIZA - A Computer Program For the Study of Natural Language
		Communication Between Man and Machine"
		in: Communications of the ACM; Volume 9 , Issue 1 (January 1966): p 36-45.
JavaScript implementation by Norbert Landsteiner 2005; <http://www.masserk.at>

synopsis:

	new ElizaBot( <random-choice-disable-flag> )
	ElizaBot.prototype.transform( <inputstring> )
	ElizaBot.prototype.getInitial()
	ElizaBot.prototype.getFinal()
	ElizaBot.prototype.reset()

usage:

	var eliza = new ElizaBot();
	var initial = eliza.getInitial();
	var reply = eliza.transform(inputstring);
	if (eliza.quit) {
		// last user input was a quit phrase
	}

	// method `transform()' returns a final phrase in case of a quit phrase
	// but you can also get a final phrase with:
	var final = eliza.getFinal();

	// other methods: reset memory and internal state
	eliza.reset();

	// to set the internal memory size override property `memSize':
	eliza.memSize = 100; // (default: 20)

	// to reproduce the example conversation given by J. Weizenbaum
	// initialize with the optional random-choice-disable flag
	var originalEliza = new ElizaBot(true);

`ElizaBot` is also a general chatbot engine that can be supplied with any rule set.
(for required data structures cf. "elizadata.js" and/or see the documentation.)
data is parsed and transformed for internal use at the creation time of the
first instance of the `ElizaBot' constructor.

vers 1.1: lambda functions in RegExps are currently a problem with too many browsers.
					changed code to work around.
####### content/tutorial/01-svelte/07-lifecycle/02-update/app-a/package.json #######

```

{
	"name": "~TODO~",
	"version": "0.0.1",
	"scripts": {
		"dev": "./node_modules/vite/bin/vite.js dev",
		"build": "./node_modules/vite/bin/vite.js build",
		"preview": "./node_modules/vite/bin/vite.js preview"
	},
	"dependencies": {
		"elizabot": "^0.0.3"
	},
	"type": "module"
}

```


####### content/tutorial/01-svelte/07-lifecycle/02-update/app-a/package-lock.json #######

```

{
	"name": "~TODO~",
	"version": "0.0.1",
	"lockfileVersion": 2,
	"requires": true,
	"packages": {
		"": {
			"name": "~TODO~",
			"version": "0.0.1",
			"dependencies": {
				"elizabot": "^0.0.3"
			}
		},
		"node_modules/elizabot": {
			"version": "0.0.3",
			"resolved": "https://registry.npmjs.org/elizabot/-/elizabot-0.0.3.tgz",
			"integrity": "sha512-giwweEawiOHLS8eMPNtpLJaYxWZIHxtJcoq0NyvtEqVx2pxZ8XX1AXHHx84hUK3Scl8vk4U4lEatG54nsMZo+Q=="
		}
	},
	"dependencies": {
		"elizabot": {
			"version": "0.0.3",
			"resolved": "https://registry.npmjs.org/elizabot/-/elizabot-0.0.3.tgz",
			"integrity": "sha512-giwweEawiOHLS8eMPNtpLJaYxWZIHxtJcoq0NyvtEqVx2pxZ8XX1AXHHx84hUK3Scl8vk4U4lEatG54nsMZo+Q=="
		}
	}
}

```


####### content/tutorial/01-svelte/07-lifecycle/02-update/app-a/src/lib/App.svelte #######

```

<script>
	import Eliza from 'elizabot';
	import {
		beforeUpdate,
		afterUpdate
	} from 'svelte';

	let div;

	beforeUpdate(() => {
		// determine whether we should auto-scroll
		// once the DOM is updated...
	});

	afterUpdate(() => {
		// ...the DOM is now in sync with the data
	});

	const eliza = new Eliza();
	const pause = (ms) => new Promise((fulfil) => setTimeout(fulfil, ms));

	const typing = { author: 'eliza', text: '...' };

	let comments = [];

	async function handleKeydown(event) {
		if (event.key === 'Enter' && event.target.value) {
			const comment = {
				author: 'user',
				text: event.target.value
			};

			const reply = {
				author: 'eliza',
				text: eliza.transform(comment.text)
			};

			event.target.value = '';
			comments = [...comments, comment];

			await pause(200 * (1 + Math.random()));
			comments = [...comments, typing];

			await pause(500 * (1 + Math.random()));
			comments = [...comments, reply].filter(comment => comment !== typing);
		}
	}
</script>

<div class="container">
	<div class="phone">
		<div class="chat" bind:this={div}>
			<header>
				<h1>Eliza</h1>

				<article class="eliza">
					<span>{eliza.getInitial()}</span>
				</article>
			</header>

			{#each comments as comment}
				<article class={comment.author}>
					<span>{comment.text}</span>
				</article>
			{/each}
		</div>

		<input on:keydown={handleKeydown} />
	</div>
</div>

<style>
	.container {
		display: grid;
		place-items: center;
		height: 100%;
	}

	.phone {
		display: flex;
		flex-direction: column;
		width: 100%;
		height: 100%;
	}

	header {
		display: flex;
		flex-direction: column;
		height: 100%;
		padding: 4em 0 0 0;
		box-sizing: border-box;
	}

	h1 {
		flex: 1;
		font-size: 1.4em;
		text-align: center;
	}

	.chat {
		height: 0;
		flex: 1 1 auto;
		padding: 0 1em;
		overflow-y: auto;
		scroll-behavior: smooth;
	}

	article {
		margin: 0 0 0.5em 0;
	}

	.user {
		text-align: right;
	}

	span {
		padding: 0.5em 1em;
		display: inline-block;
	}

	.eliza span {
		background-color: var(--bg-1);
		border-radius: 1em 1em 1em 0;
		color: var(--fg-1);
	}

	.user span {
		background-color: #0074d9;
		color: white;
		border-radius: 1em 1em 0 1em;
		word-break: break-all;
	}

	input {
		margin: 0.5em 1em 1em 1em;
	}

	@media (min-width: 400px) {
		.phone {
			background: var(--bg-2);
			position: relative;
			font-size: min(2.5vh, 1rem);
			width: auto;
			height: 36em;
			aspect-ratio: 9 / 16;
			border: 0.2em solid #222;
			border-radius: 1em;
			box-sizing: border-box;
			filter: drop-shadow(1px 1px 0px #222) drop-shadow(2px 2px 0px #222) drop-shadow(3px 3px 0px #222)
		}

		.phone::after {
			position: absolute;
			content: '';
			background: #222;
			width: 60%;
			height: 1em;
			left: 20%;
			top: 0;
			border-radius: 0 0 0.5em 0.5em
		}
	}

	@media (prefers-reduced-motion) {
		.chat {
			scroll-behavior: auto;
		}
	}
</style>

```


####### content/tutorial/01-svelte/07-lifecycle/02-update/app-b/src/lib/App.svelte #######

```

<script>
	import Eliza from 'elizabot';
	import {
		beforeUpdate,
		afterUpdate
	} from 'svelte';

	let div;
	let autoscroll = false;

	beforeUpdate(() => {
		if (div) {
			const scrollableDistance = div.scrollHeight - div.offsetHeight;
			autoscroll = div.scrollTop > scrollableDistance - 20;
		}
	});

	afterUpdate(() => {
		if (autoscroll) {
			div.scrollTo(0, div.scrollHeight);
		}
	});

	const eliza = new Eliza();
	const pause = (ms) => new Promise((fulfil) => setTimeout(fulfil, ms));

	const typing = { author: 'eliza', text: '...' };

	let comments = [];

	async function handleKeydown(event) {
		if (event.key === 'Enter' && event.target.value) {
			const comment = {
				author: 'user',
				text: event.target.value
			};

			const reply = {
				author: 'eliza',
				text: eliza.transform(comment.text)
			};

			event.target.value = '';
			comments = [...comments, comment];

			await pause(200 * (1 + Math.random()));
			comments = [...comments, typing];

			await pause(500 * (1 + Math.random()));
			comments = [...comments, reply].filter(comment => comment !== typing);
		}
	}
</script>

<div class="container">
	<div class="phone">
		<div class="chat" bind:this={div}>
			<header>
				<h1>Eliza</h1>

				<article class="eliza">
					<span>{eliza.getInitial()}</span>
				</article>
			</header>

			{#each comments as comment}
				<article class={comment.author}>
					<span>{comment.text}</span>
				</article>
			{/each}
		</div>

		<input on:keydown={handleKeydown} />
	</div>
</div>

<style>
	.container {
		display: grid;
		place-items: center;
		height: 100%;
	}

	.phone {
		display: flex;
		flex-direction: column;
		width: 100%;
		height: 100%;
	}

	header {
		display: flex;
		flex-direction: column;
		height: 100%;
		padding: 4em 0 0 0;
		box-sizing: border-box;
	}

	h1 {
		flex: 1;
		font-size: 1.4em;
		text-align: center;
	}

	.chat {
		height: 0;
		flex: 1 1 auto;
		padding: 0 1em;
		overflow-y: auto;
		scroll-behavior: smooth;
	}

	article {
		margin: 0 0 0.5em 0;
	}

	.user {
		text-align: right;
	}

	span {
		padding: 0.5em 1em;
		display: inline-block;
	}

	.eliza span {
		background-color: var(--bg-1);
		border-radius: 1em 1em 1em 0;
		color: var(--fg-1);
	}

	.user span {
		background-color: #0074d9;
		color: white;
		border-radius: 1em 1em 0 1em;
		word-break: break-all;
	}

	input {
		margin: 0.5em 1em 1em 1em;
	}

	@media (min-width: 400px) {
		.phone {
			background: var(--bg-2);
			position: relative;
			font-size: min(2.5vh, 1rem);
			width: auto;
			height: 36em;
			aspect-ratio: 9 / 16;
			border: 0.2em solid #222;
			border-radius: 1em;
			box-sizing: border-box;
			filter: drop-shadow(1px 1px 0px #222) drop-shadow(2px 2px 0px #222) drop-shadow(3px 3px 0px #222)
		}

		.phone::after {
			position: absolute;
			content: '';
			background: #222;
			width: 60%;
			height: 1em;
			left: 20%;
			top: 0;
			border-radius: 0 0 0.5em 0.5em
		}
	}

	@media (prefers-reduced-motion) {
		.chat {
			scroll-behavior: auto;
		}
	}
</style>

```


####### content/tutorial/01-svelte/07-lifecycle/02-update/README.md #######

---
title: beforeUpdate and afterUpdate
---

The `beforeUpdate` function schedules work to happen immediately before the DOM is updated. `afterUpdate` is its counterpart, used for running code once the DOM is in sync with your data.

Together, they're useful for doing things imperatively that are difficult to achieve in a purely state-driven way, like updating the scroll position of an element.

This [Eliza](https://en.wikipedia.org/wiki/ELIZA) chatbot is annoying to use, because you have to keep scrolling the chat window. Let's fix that.

```js
/// file: App.svelte
let div;
+++let autoscroll = false;+++

beforeUpdate(() => {
+++	if (div) {
		const scrollableDistance = div.scrollHeight - div.offsetHeight;
		autoscroll = div.scrollTop > scrollableDistance - 20;
	}+++
});

afterUpdate(() => {
+++	if (autoscroll) {
		div.scrollTo(0, div.scrollHeight);
	}+++
});
```

Note that `beforeUpdate` will first run before the component has mounted, so we need to check for the existence of `div` before reading its properties.

####### content/tutorial/01-svelte/07-lifecycle/03-tick/app-a/src/lib/App.svelte #######

```

<script>
	let text = `Select some text and hit the tab key to toggle uppercase`;

	async function handleKeydown(event) {
		if (event.key !== 'Tab') return;

		event.preventDefault();

		const { selectionStart, selectionEnd, value } = this;
		const selection = value.slice(selectionStart, selectionEnd);

		const replacement = /[a-z]/.test(selection)
			? selection.toUpperCase()
			: selection.toLowerCase();

		text =
			value.slice(0, selectionStart) +
			replacement +
			value.slice(selectionEnd);

		// this has no effect, because the DOM hasn't updated yet
		this.selectionStart = selectionStart;
		this.selectionEnd = selectionEnd;
	}
</script>

<textarea
	value={text}
	on:keydown={handleKeydown}
/>

<style>
	textarea {
		width: 100%;
		height: 100%;
		resize: none;
	}
</style>

```


####### content/tutorial/01-svelte/07-lifecycle/03-tick/app-b/src/lib/App.svelte #######

```

<script>
	import { tick } from 'svelte';

	let text = `Select some text and hit the tab key to toggle uppercase`;

	async function handleKeydown(event) {
		if (event.key !== 'Tab') return;

		event.preventDefault();

		const { selectionStart, selectionEnd, value } = this;
		const selection = value.slice(selectionStart, selectionEnd);

		const replacement = /[a-z]/.test(selection)
			? selection.toUpperCase()
			: selection.toLowerCase();

		text =
			value.slice(0, selectionStart) +
			replacement +
			value.slice(selectionEnd);

		await tick();
		this.selectionStart = selectionStart;
		this.selectionEnd = selectionEnd;
	}
</script>

<textarea
	value={text}
	on:keydown={handleKeydown}
/>

<style>
	textarea {
		width: 100%;
		height: 100%;
		resize: none;
	}
</style>

```


####### content/tutorial/01-svelte/07-lifecycle/03-tick/README.md #######

---
title: tick
---

The `tick` function is unlike other lifecycle functions in that you can call it any time, not just when the component first initialises. It returns a promise that resolves as soon as any pending state changes have been applied to the DOM (or immediately, if there are no pending state changes).

When you update component state in Svelte, it doesn't update the DOM immediately. Instead, it waits until the next _microtask_ to see if there are any other changes that need to be applied, including in other components. Doing so avoids unnecessary work and allows the browser to batch things more effectively.

You can see that behaviour in this example. Select a range of text and hit the tab key. Because the `<textarea>` value changes, the current selection is cleared and the cursor jumps, annoyingly, to the end. We can fix this by importing `tick`...

```js
/// file: App.svelte
+++import { tick } from 'svelte';+++

let text = `Select some text and hit the tab key to toggle uppercase`;
```

...and running it immediately before we set `this.selectionStart` and `this.selectionEnd` at the end of `handleKeydown`:

```js
/// file: App.svelte
+++await tick();+++
this.selectionStart = selectionStart;
this.selectionEnd = selectionEnd;
```

####### content/tutorial/01-svelte/07-lifecycle/meta.json #######

```

{
	"title": "Lifecycle",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/01-svelte/08-stores/01-writable-stores/app-a/src/lib/App.svelte #######

```

<script>
	import { count } from './stores.js';
	import Incrementer from './Incrementer.svelte';
	import Decrementer from './Decrementer.svelte';
	import Resetter from './Resetter.svelte';

	let count_value;

	count.subscribe((value) => {
		count_value = value;
	});
</script>

<h1>The count is {count_value}</h1>

<Incrementer />
<Decrementer />
<Resetter />

```


####### content/tutorial/01-svelte/08-stores/01-writable-stores/app-a/src/lib/Decrementer.svelte #######

```

<script>
	import { count } from './stores.js';

	function decrement() {
		// TODO decrement the count
	}
</script>

<button on:click={decrement}>
	-
</button>

```


####### content/tutorial/01-svelte/08-stores/01-writable-stores/app-a/src/lib/Incrementer.svelte #######

```

<script>
	import { count } from './stores.js';

	function increment() {
		// TODO increment the count
	}
</script>

<button on:click={increment}>
	+
</button>

```


####### content/tutorial/01-svelte/08-stores/01-writable-stores/app-a/src/lib/Resetter.svelte #######

```

<script>
	import { count } from './stores.js';

	function reset() {
		// TODO reset the count
	}
</script>

<button on:click={reset}>
	reset
</button>

```


####### content/tutorial/01-svelte/08-stores/01-writable-stores/app-a/src/lib/stores.js #######

```

import { writable } from 'svelte/store';

export const count = writable(0);

```


####### content/tutorial/01-svelte/08-stores/01-writable-stores/app-b/src/lib/Decrementer.svelte #######

```

<script>
	import { count } from './stores.js';

	function decrement() {
		count.update((n) => n - 1);
	}
</script>

<button on:click={decrement}>
	-
</button>

```


####### content/tutorial/01-svelte/08-stores/01-writable-stores/app-b/src/lib/Incrementer.svelte #######

```

<script>
	import { count } from './stores.js';

	function increment() {
		count.update((n) => n + 1);
	}
</script>

<button on:click={increment}>
	+
</button>

```


####### content/tutorial/01-svelte/08-stores/01-writable-stores/app-b/src/lib/Resetter.svelte #######

```

<script>
	import { count } from './stores.js';

	function reset() {
		count.set(0);
	}
</script>

<button on:click={reset}>
	reset
</button>

```


####### content/tutorial/01-svelte/08-stores/01-writable-stores/README.md #######

---
title: Writable stores
---

Not all application state belongs inside your application's component hierarchy. Sometimes, you'll have values that need to be accessed by multiple unrelated components, or by a regular JavaScript module.

In Svelte, we do this with _stores_. A store is simply an object with a `subscribe` method that allows interested parties to be notified whenever the store value changes. In `App.svelte`, `count` is a store, and we're setting `count_value` in the `count.subscribe` callback.

Open `stores.js` to see the definition of `count`. It's a _writable_ store, which means it has `set` and `update` methods in addition to `subscribe`.

Now, in `Incrementer.svelte`, wire up the `+` button:

```js
/// file: Incrementer.svelte
function increment() {
	+++count.update((n) => n + 1);+++
}
```

Clicking the `+` button should now update the count. Do the inverse for `Decrementer.svelte`.

Finally, in `Resetter.svelte`, implement `reset`:

```js
/// file: Resetter.svelte
function reset() {
	+++count.set(0);+++
}
```

####### content/tutorial/01-svelte/08-stores/02-auto-subscriptions/app-b/src/lib/App.svelte #######

```

<script>
	import { count } from './stores.js';
	import Incrementer from './Incrementer.svelte';
	import Decrementer from './Decrementer.svelte';
	import Resetter from './Resetter.svelte';
</script>

<h1>The count is {$count}</h1>

<Incrementer />
<Decrementer />
<Resetter />

```


####### content/tutorial/01-svelte/08-stores/02-auto-subscriptions/README.md #######

---
title: Auto-subscriptions
---

The app in the previous example works, but there's a subtle bug — the store is subscribed to, but never unsubscribed. If the component was instantiated and destroyed many times, this would result in a _memory leak_.

Start by declaring `unsubscribe` in `App.svelte`:

```js
/// file: App.svelte
+++const unsubscribe =+++ count.subscribe((value) => {
	count_value = value;
});
```

> Calling a `subscribe` method returns an `unsubscribe` function.

You now declared `unsubscribe`, but it still needs to be called, for example through the `onDestroy` lifecycle hook:

```svelte
/// file: App.svelte
<script>
	+++import { onDestroy } from 'svelte';+++
	import { count } from './stores.js';
	import Incrementer from './Incrementer.svelte';
	import Decrementer from './Decrementer.svelte';
	import Resetter from './Resetter.svelte';

	let count_value;

	const unsubscribe = count.subscribe(value => {
		count_value = value;
	});

	+++onDestroy(unsubscribe);+++
</script>

<h1>The count is {count_value}</h1>
```

It starts to get a bit boilerplatey though, especially if your component subscribes to multiple stores. Instead, Svelte has a trick up its sleeve — you can reference a store value by prefixing the store name with `$`:

```svelte
/// file: App.svelte
<script>
	---import { onDestroy } from 'svelte';---
	import { count } from './stores.js';
	import Incrementer from './Incrementer.svelte';
	import Decrementer from './Decrementer.svelte';
	import Resetter from './Resetter.svelte';

	---let count_value;---

	---const unsubscribe = count.subscribe(value => {
		count_value = value;
	});---

	---onDestroy(unsubscribe);---
</script>

<h1>The count is {+++$count+++}</h1>
```

> Auto-subscription only works with store variables that are declared (or imported) at the top-level scope of a component.

You're not limited to using `$count` inside the markup, either — you can use it anywhere in the `<script>` as well, such as in event handlers or reactive declarations.

> Any name beginning with `$` is assumed to refer to a store value. It's effectively a reserved character — Svelte will prevent you from declaring your own variables with a `$` prefix.

####### content/tutorial/01-svelte/08-stores/03-readable-stores/app-a/src/lib/App.svelte #######

```

<script>
	import { time } from './stores.js';

	const formatter = new Intl.DateTimeFormat(
		'en',
		{
			hour12: true,
			hour: 'numeric',
			minute: '2-digit',
			second: '2-digit'
		}
	);
</script>

<h1>The time is {formatter.format($time)}</h1>

```


####### content/tutorial/01-svelte/08-stores/03-readable-stores/app-a/src/lib/stores.js #######

```

import { readable } from 'svelte/store';

export const time = readable(null, function start(set) {
	// setup code goes here

	return function stop() {
		// teardown code goes here
	};
});

```


####### content/tutorial/01-svelte/08-stores/03-readable-stores/app-b/src/lib/stores.js #######

```

import { readable } from 'svelte/store';

export const time = readable(new Date(), function start(set) {
	const interval = setInterval(() => {
		set(new Date());
	}, 1000);

	return function stop() {
		clearInterval(interval);
	};
});

```


####### content/tutorial/01-svelte/08-stores/03-readable-stores/README.md #######

---
title: Readable stores
---

Not all stores should be writable by whoever has a reference to them. For example, you might have a store representing the mouse position or the user's geolocation, and it doesn't make sense to be able to set those values from 'outside'. For those cases, we have _readable_ stores.

Open `stores.js`. The first argument to `readable` is an initial value, which can be `null` or `undefined` if you don't have one yet. The second argument is a `start` function that takes a `set` callback and returns a `stop` function. The `start` function is called when the store gets its first subscriber; `stop` is called when the last subscriber unsubscribes.

```js
/// file: stores.js
export const time = readable(+++new Date()+++, function start(set) {
+++	const interval = setInterval(() => {
		set(new Date());
	}, 1000);+++

	return function stop() {
		+++clearInterval(interval);+++
	};
});
```

####### content/tutorial/01-svelte/08-stores/04-derived-stores/app-a/src/lib/App.svelte #######

```

<script>
	import { time, elapsed } from './stores.js';

	const formatter = new Intl.DateTimeFormat(
		'en',
		{
			hour12: true,
			hour: 'numeric',
			minute: '2-digit',
			second: '2-digit'
		}
	);
</script>

<h1>The time is {formatter.format($time)}</h1>

<p>
	This page has been open for
	{$elapsed}
	{$elapsed === 1 ? 'second' : 'seconds'}
</p>

```


####### content/tutorial/01-svelte/08-stores/04-derived-stores/app-a/src/lib/stores.js #######

```

import { readable, derived } from 'svelte/store';

export const time = readable(new Date(), function start(set) {
	const interval = setInterval(() => {
		set(new Date());
	}, 1000);

	return function stop() {
		clearInterval(interval);
	};
});

const start = new Date();

export const elapsed = derived(
	time,
	($time) => {}
);

```


####### content/tutorial/01-svelte/08-stores/04-derived-stores/app-b/src/lib/stores.js #######

```

import { readable, derived } from 'svelte/store';

export const time = readable(new Date(), function start(set) {
	const interval = setInterval(() => {
		set(new Date());
	}, 1000);

	return function stop() {
		clearInterval(interval);
	};
});

const start = new Date();

export const elapsed = derived(
	time,
	($time) => Math.round(($time - start) / 1000)
);

```


####### content/tutorial/01-svelte/08-stores/04-derived-stores/README.md #######

---
title: Derived stores
---

You can create a store whose value is based on the value of one or more _other_ stores with `derived`. Building on our previous example, we can create a store that derives the time the page has been open:

```js
/// file: stores.js
export const elapsed = derived(
    time,
    ($time) => +++Math.round(($time - start) / 1000)+++
);
```

> It's possible to derive a store from multiple input stores, and to explicitly `set` a value instead of returning it (which is useful for deriving values asynchronously). Consult the [API reference](https://svelte.dev/docs#run-time-svelte-store-derived) for more information.

####### content/tutorial/01-svelte/08-stores/05-custom-stores/app-a/src/lib/App.svelte #######

```

<script>
	import { count } from './stores.js';
</script>

<h1>The count is {$count}</h1>

<button on:click={count.increment}>+</button>
<button on:click={count.decrement}>-</button>
<button on:click={count.reset}>reset</button>

```


####### content/tutorial/01-svelte/08-stores/05-custom-stores/app-a/src/lib/stores.js #######

```

import { writable } from 'svelte/store';

function createCount() {
	const { subscribe, set, update } = writable(0);

	return {
		subscribe,
		increment: () => {},
		decrement: () => {},
		reset: () => {}
	};
}

export const count = createCount();

```


####### content/tutorial/01-svelte/08-stores/05-custom-stores/app-b/src/lib/stores.js #######

```

import { writable } from 'svelte/store';

function createCount() {
	const { subscribe, set, update } = writable(0);

	return {
		subscribe,
		increment: () => update((n) => n + 1),
		decrement: () => update((n) => n - 1),
		reset: () => set(0)
	};
}

export const count = createCount();

```


####### content/tutorial/01-svelte/08-stores/05-custom-stores/README.md #######

---
title: Custom stores
---

As long as an object correctly implements the `subscribe` method, it's a store. Beyond that, anything goes. It's very easy, therefore, to create custom stores with domain-specific logic.

For example, the `count` store from our earlier example could include `increment`, `decrement` and `reset` methods and avoid exposing `set` and `update`:

```js
/// file: stores.js
function createCount() {
	const { subscribe, set, update } = writable(0);

	return {
		subscribe,
		increment: () => +++update((n) => n + 1)+++,
		decrement: () => +++update((n) => n - 1)+++,
		reset: () => +++set(0)+++
	};
}
```

####### content/tutorial/01-svelte/08-stores/06-store-bindings/app-a/src/lib/App.svelte #######

```

<script>
	import { name, greeting } from './stores.js';
</script>

<h1>{$greeting}</h1>
<input value={$name} />

<button>
	Add exclamation mark!
</button>
```


####### content/tutorial/01-svelte/08-stores/06-store-bindings/app-a/src/lib/stores.js #######

```

import { writable, derived } from 'svelte/store';

export const name = writable('world');

export const greeting = derived(name, ($name) => `Hello ${$name}!`);

```


####### content/tutorial/01-svelte/08-stores/06-store-bindings/app-b/src/lib/App.svelte #######

```

<script>
	import { name, greeting } from './stores.js';
</script>

<h1>{$greeting}</h1>
<input bind:value={$name} />

<button on:click={() => $name += '!'}>
	Add exclamation mark!
</button>

```


####### content/tutorial/01-svelte/08-stores/06-store-bindings/README.md #######

---
title: Store bindings
---

If a store is writable — i.e. it has a `set` method — you can bind to its value, just as you can bind to local component state.

In this example we're exporting a writable store `name` and a derived store `greeting` from `stores.js`. Update the `<input>` element in `App.svelte`:

```svelte
/// file: App.svelte
<input +++bind:+++value={$name}>
```

Changing the input value will now update `name` and all its dependents.

We can also assign directly to store values inside a component. Add an `on:click` event handler to update `name`:

```svelte
/// file: App.svelte
<button +++on:click={() => $name += '!'}+++>
	Add exclamation mark!
</button>
```

The `$name += '!'` assignment is equivalent to `name.set($name + '!')`.

####### content/tutorial/01-svelte/08-stores/meta.json #######

```

{
	"title": "Stores",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/01-svelte/common/src/routes/+error.svelte #######

```

<script>
	import { page } from '$app/stores';
</script>

{#if $page.status === 404}
	<h1>Not found</h1>
	<p><a href="/">Go to /</a></p>
{:else}
	<p>
		Server-side rendering failed with HTTP status
		code
		<a
			target="_blank"
			href="https://http.dog/{$page.status}"
			>{$page.status}</a
		>
	</p>
{/if}

<style>
	h1 {
		font-weight: 200;
		font-size: 2rem;
		margin: 0 0 0.5em 0;
	}
</style>

```


####### content/tutorial/01-svelte/common/src/routes/+layout.js #######

```

export const ssr = false;

```


####### content/tutorial/01-svelte/common/src/routes/+page.svelte #######

```

<script>
	import App from '$lib/App.svelte';
</script>

<App />

```


####### content/tutorial/01-svelte/meta.json #######

```

{
	"title": "Basic Svelte",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/01-motion/01-tweens/app-a/src/lib/App.svelte #######

```

<script>
	import { writable } from 'svelte/store';

	const progress = writable(0);
</script>

<progress value={$progress} />

<button on:click={() => progress.set(0)}>
	0%
</button>

<button on:click={() => progress.set(0.25)}>
	25%
</button>

<button on:click={() => progress.set(0.5)}>
	50%
</button>

<button on:click={() => progress.set(0.75)}>
	75%
</button>

<button on:click={() => progress.set(1)}>
	100%
</button>

<style>
	progress {
		display: block;
		width: 100%;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/01-motion/01-tweens/app-b/src/lib/App.svelte #######

```

<script>
	import { tweened } from 'svelte/motion';
	import { cubicOut } from 'svelte/easing';

	const progress = tweened(0, {
		duration: 400,
		easing: cubicOut
	});
</script>

<progress value={$progress} />

<button on:click={() => progress.set(0)}>
	0%
</button>

<button on:click={() => progress.set(0.25)}>
	25%
</button>

<button on:click={() => progress.set(0.5)}>
	50%
</button>

<button on:click={() => progress.set(0.75)}>
	75%
</button>

<button on:click={() => progress.set(1)}>
	100%
</button>

<style>
	progress {
		display: block;
		width: 100%;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/01-motion/01-tweens/README.md #######

---
title: Tweens
---

Now that we've covered the basics, it's time to learn some advanced Svelte techniques, starting with _motion_.

Setting values and watching the DOM update automatically is cool. Know what's even cooler? Tweening those values. Svelte includes tools to help you build slick user interfaces that use animation to communicate changes.

Let's start by changing the `progress` store to a `tweened` store:

```svelte
/// file: App.svelte
<script>
	import { +++tweened+++ } from 'svelte/+++motion+++';

	const progress = +++tweened+++(0);
</script>
```

Clicking the buttons causes the progress bar to animate to its new value. It's a bit robotic and unsatisfying though. We need to add an easing function:

```svelte
/// file: App.svelte
<script>
	import { tweened } from 'svelte/motion';
	+++import { cubicOut } from 'svelte/easing';+++

	const progress = tweened(0, +++{
		duration: 400,
		easing: cubicOut
	}+++);
</script>
```

> The `svelte/easing` module contains the [Penner easing equations](https://web.archive.org/web/20190805215728/http://robertpenner.com/easing/), or you can supply your own `p => t` function where `p` and `t` are both values between 0 and 1.

The full set of options available to `tweened`:

- `delay` — milliseconds before the tween starts
- `duration` — either the duration of the tween in milliseconds, or a `(from, to) => milliseconds` function allowing you to (e.g.) specify longer tweens for larger changes in value
- `easing` — a `p => t` function
- `interpolate` — a custom `(from, to) => t => value` function for interpolating between arbitrary values. By default, Svelte will interpolate between numbers, dates, and identically-shaped arrays and objects (as long as they only contain numbers and dates or other valid arrays and objects). If you want to interpolate (for example) colour strings or transformation matrices, supply a custom interpolator

You can also pass these options to `progress.set` and `progress.update` as a second argument, in which case they will override the defaults. The `set` and `update` methods both return a promise that resolves when the tween completes.

####### content/tutorial/02-advanced-svelte/01-motion/02-springs/app-a/src/lib/App.svelte #######

```

<script>
	import { writable } from 'svelte/store';

	let coords = writable({ x: 50, y: 50 });
	let size = writable(10);
</script>

<svg
	on:mousemove={(e) => {
		coords.set({ x: e.clientX, y: e.clientY });
	}}
	on:mousedown={() => size.set(30)}
	on:mouseup={() => size.set(10)}
	role="presentation"
>
	<circle
		cx={$coords.x}
		cy={$coords.y}
		r={$size}
	/>
</svg>

<div class="controls">
	<label>
		<h3>stiffness ({coords.stiffness})</h3>
		<input
			bind:value={coords.stiffness}
			type="range"
			min="0.01"
			max="1"
			step="0.01"
		/>
	</label>

	<label>
		<h3>damping ({coords.damping})</h3>
		<input
			bind:value={coords.damping}
			type="range"
			min="0.01"
			max="1"
			step="0.01"
		/>
	</label>
</div>

<style>
	svg {
		position: absolute;
		width: 100%;
		height: 100%;
		left: 0;
		top: 0;
	}

	circle {
		fill: #ff3e00;
	}

	.controls {
		position: absolute;
		top: 1em;
		right: 1em;
		width: 200px;
		user-select: none;
	}

	.controls input {
		width: 100%;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/01-motion/02-springs/app-b/src/lib/App.svelte #######

```

<script>
	import { spring } from 'svelte/motion';

	let coords = spring({ x: 50, y: 50 }, {
		stiffness: 0.1,
		damping: 0.25
	});

	let size = spring(10);
</script>

<svg
	on:mousemove={(e) => {
		coords.set({ x: e.clientX, y: e.clientY });
	}}
	on:mousedown={() => size.set(30)}
	on:mouseup={() => size.set(10)}
	role="presentation"
>
	<circle
		cx={$coords.x}
		cy={$coords.y}
		r={$size}
	/>
</svg>

<div class="controls">
	<label>
		<h3>stiffness ({coords.stiffness})</h3>
		<input
			bind:value={coords.stiffness}
			type="range"
			min="0.01"
			max="1"
			step="0.01"
		/>
	</label>

	<label>
		<h3>damping ({coords.damping})</h3>
		<input
			bind:value={coords.damping}
			type="range"
			min="0.01"
			max="1"
			step="0.01"
		/>
	</label>
</div>

<style>
	svg {
		position: absolute;
		width: 100%;
		height: 100%;
		left: 0;
		top: 0;
	}

	circle {
		fill: #ff3e00;
	}

	.controls {
		position: absolute;
		top: 1em;
		right: 1em;
		width: 200px;
		user-select: none;
	}

	.controls input {
		width: 100%;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/01-motion/02-springs/README.md #######

---
title: Springs
---

The `spring` function is an alternative to `tweened` that often works better for values that are frequently changing.

In this example we have two stores — one representing the circle's coordinates, and one representing its size. Let's convert them to springs:

```svelte
/// file: App.svelte
<script>
	import { +++spring+++ } from 'svelte/+++motion+++';

	let coords = +++spring+++({ x: 50, y: 50 });
	let size = +++spring+++(10);
</script>
```

Both springs have default `stiffness` and `damping` values, which control the spring's, well... springiness. We can specify our own initial values:

```js
/// file: App.svelte
let coords = spring({ x: 50, y: 50 }, +++{
	stiffness: 0.1,
	damping: 0.25
}+++);
```

Waggle your mouse around, and try dragging the sliders to get a feel for how they affect the spring's behaviour. Notice that you can adjust the values while the spring is still in motion.

####### content/tutorial/02-advanced-svelte/01-motion/meta.json #######

```

{
	"title": "Motion",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/02-transitions/01-transition/app-a/src/lib/App.svelte #######

```

<script>
	let visible = true;
</script>

<label>
	<input type="checkbox" bind:checked={visible} />
	visible
</label>

{#if visible}
	<p>
		Fades in and out
	</p>
{/if}

```


####### content/tutorial/02-advanced-svelte/02-transitions/01-transition/app-b/src/lib/App.svelte #######

```

<script>
	import { fade } from 'svelte/transition';
	let visible = true;
</script>

<label>
	<input type="checkbox" bind:checked={visible} />
	visible
</label>

{#if visible}
	<p transition:fade>
		Fades in and out
	</p>
{/if}

```


####### content/tutorial/02-advanced-svelte/02-transitions/01-transition/README.md #######

---
title: The transition directive
---

We can make more appealing user interfaces by gracefully transitioning elements into and out of the DOM. Svelte makes this very easy with the `transition` directive.

First, import the `fade` function from `svelte/transition`...

```svelte
/// file: App.svelte
<script>
	+++import { fade } from 'svelte/transition';+++
	let visible = true;
</script>
```

...then add it to the `<p>` element:

```svelte
/// file: App.svelte
<p +++transition:fade+++>
	Fades in and out
</p>
```

####### content/tutorial/02-advanced-svelte/02-transitions/02-adding-parameters-to-transitions/app-b/src/lib/App.svelte #######

```

<script>
	import { fly } from 'svelte/transition';
	let visible = true;
</script>

<label>
	<input type="checkbox" bind:checked={visible} />
	visible
</label>

{#if visible}
	<p transition:fly={{ y: 200, duration: 2000 }}>
		Flies in and out
	</p>
{/if}

```


####### content/tutorial/02-advanced-svelte/02-transitions/02-adding-parameters-to-transitions/README.md #######

---
title: Adding parameters
---

Transition functions can accept parameters. Replace the `fade` transition with `fly`...

```svelte
/// file: App.svelte
<script>
	import { +++fly+++ } from 'svelte/transition';
	let visible = true;
</script>
```

...and apply it to the `<p>` along with some options:

```svelte
/// file: App.svelte
<p transition:+++fly={{ y: 200, duration: 2000 }}+++>
	+++Flies+++ in and out
</p>
```

Note that the transition is _reversible_ — if you toggle the checkbox while the transition is ongoing, it transitions from the current point, rather than the beginning or the end.

####### content/tutorial/02-advanced-svelte/02-transitions/03-in-and-out/app-b/src/lib/App.svelte #######

```

<script>
	import { fade, fly } from 'svelte/transition';
	let visible = true;
</script>

<label>
	<input type="checkbox" bind:checked={visible} />
	visible
</label>

{#if visible}
	<p in:fly={{ y: 200, duration: 2000 }} out:fade>
		Flies in, fades out
	</p>
{/if}

```


####### content/tutorial/02-advanced-svelte/02-transitions/03-in-and-out/README.md #######

---
title: In and out
---

Instead of the `transition` directive, an element can have an `in` or an `out` directive, or both together. Import `fade` alongside `fly`...

```js
/// file: App.svelte
import { +++fade+++, fly } from 'svelte/transition';
```

...then replace the `transition` directive with separate `in` and `out` directives:

```svelte
/// file: App.svelte
<p +++in+++:fly={{ y: 200, duration: 2000 }} +++out:fade+++>
	Flies in, +++fades out+++
</p>
```

In this case, the transitions are _not_ reversed.

####### content/tutorial/02-advanced-svelte/02-transitions/04-custom-css-transitions/app-a/src/lib/App.svelte #######

```

<script>
	import { fade } from 'svelte/transition';

	let visible = true;

	function spin(node, { duration }) {
		return {
			duration,
			css: (t) => ``
		};
	}
</script>

<label>
	<input type="checkbox" bind:checked={visible} />
	visible
</label>

{#if visible}
	<div
		class="centered"
		in:spin={{ duration: 8000 }}
		out:fade
	>
		<span>transitions!</span>
	</div>
{/if}

<style>
	.centered {
		position: absolute;
		left: 50%;
		top: 50%;
		transform: translate(-50%, -50%);
	}

	span {
		position: absolute;
		transform: translate(-50%, -50%);
		font-size: 4em;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/02-transitions/04-custom-css-transitions/app-b/src/lib/App.svelte #######

```

<script>
	import { fade } from 'svelte/transition';
	import { elasticOut } from 'svelte/easing';

	let visible = true;

	function spin(node, { duration }) {
		return {
			duration,
			css: (t) => {
				const eased = elasticOut(t);

				return `
					transform: scale(${eased}) rotate(${eased * 1080}deg);
					color: hsl(
						${Math.trunc(t * 360)},
						${Math.min(100, 1000 * (1 - t))}%,
						${Math.min(50, 500 * (1 - t))}%
					);`;
			}
		};
	}
</script>

<label>
	<input type="checkbox" bind:checked={visible} />
	visible
</label>

{#if visible}
	<div
		class="centered"
		in:spin={{ duration: 8000 }}
		out:fade
	>
		<span>transitions!</span>
	</div>
{/if}

<style>
	.centered {
		position: absolute;
		left: 50%;
		top: 50%;
		transform: translate(-50%, -50%);
	}

	span {
		position: absolute;
		transform: translate(-50%, -50%);
		font-size: 4em;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/02-transitions/04-custom-css-transitions/README.md #######

---
title: Custom CSS transitions
---

The `svelte/transition` module has a handful of built-in transitions, but it's very easy to create your own. By way of example, this is the source of the `fade` transition:

```js
/// no-file
function fade(node, { delay = 0, duration = 400 }) {
	const o = +getComputedStyle(node).opacity;

	return {
		delay,
		duration,
		css: (t) => `opacity: ${t * o}`
	};
}
```

The function takes two arguments — the node to which the transition is applied, and any parameters that were passed in — and returns a transition object which can have the following properties:

- `delay` — milliseconds before the transition begins
- `duration` — length of the transition in milliseconds
- `easing` — a `p => t` easing function (see the chapter on [tweening](/tutorial/tweens))
- `css` — a `(t, u) => css` function, where `u === 1 - t`
- `tick` — a `(t, u) => {...}` function that has some effect on the node

The `t` value is `0` at the beginning of an intro or the end of an outro, and `1` at the end of an intro or beginning of an outro.

Most of the time you should return the `css` property and _not_ the `tick` property, as CSS animations run off the main thread to prevent jank where possible. Svelte 'simulates' the transition and constructs a CSS animation, then lets it run.

For example, the `fade` transition generates a CSS animation somewhat like this:

```css
/// no-file
0% { opacity: 0 }
10% { opacity: 0.1 }
20% { opacity: 0.2 }
/* ... */
100% { opacity: 1 }
```

We can get a lot more creative though. Let's make something truly gratuitous:

```svelte
/// file: App.svelte
<script>
	import { fade } from 'svelte/transition';
	+++import { elasticOut } from 'svelte/easing';+++

	let visible = true;

	function spin(node, { duration }) {
		return {
			duration,
			css: t => +++{
				const eased = elasticOut(t);

				return `
					transform: scale(${eased}) rotate(${eased * 1080}deg);
					color: hsl(
						${Math.trunc(t * 360)},
						${Math.min(100, 1000 * (1 - t))}%,
						${Math.min(50, 500 * (1 - t))}%
					);`
			}+++
		};
	}
</script>
```

Remember: with great power comes great responsibility.

####### content/tutorial/02-advanced-svelte/02-transitions/05-custom-js-transitions/app-a/src/lib/App.svelte #######

```

<script>
	let visible = false;

	function typewriter(node, { speed = 1 }) {
		const valid = node.childNodes.length === 1 && node.childNodes[0].nodeType === Node.TEXT_NODE;

		if (!valid) {
			throw new Error(`This transition only works on elements with a single text node child`);
		}

		return {};
	}
</script>

<label>
	<input type="checkbox" bind:checked={visible} />
	visible
</label>

{#if visible}
	<p transition:typewriter>
		The quick brown fox jumps over the lazy dog
	</p>
{/if}

```


####### content/tutorial/02-advanced-svelte/02-transitions/05-custom-js-transitions/app-b/src/lib/App.svelte #######

```

<script>
	let visible = false;

	function typewriter(node, { speed = 1 }) {
		const valid = node.childNodes.length === 1 && node.childNodes[0].nodeType === Node.TEXT_NODE;

		if (!valid) {
			throw new Error(`This transition only works on elements with a single text node child`);
		}

		const text = node.textContent;
		const duration = text.length / (speed * 0.01);

		return {
			duration,
			tick: (t) => {
				const i = Math.trunc(text.length * t);
				node.textContent = text.slice(0, i);
			}
		};
	}
</script>

<label>
	<input type="checkbox" bind:checked={visible} />
	visible
</label>

{#if visible}
	<p transition:typewriter>
		The quick brown fox jumps over the lazy dog
	</p>
{/if}

```


####### content/tutorial/02-advanced-svelte/02-transitions/05-custom-js-transitions/README.md #######

---
title: Custom JS transitions
---

While you should generally use CSS for transitions as much as possible, there are some effects that can't be achieved without JavaScript, such as a typewriter effect:

```js
/// file: App.svelte
function typewriter(node, { speed = 1 }) {
	const valid = node.childNodes.length === 1 && node.childNodes[0].nodeType === Node.TEXT_NODE;

	if (!valid) {
		throw new Error(`This transition only works on elements with a single text node child`);
	}

	+++const text = node.textContent;
	const duration = text.length / (speed * 0.01);

	return {
		duration,
		tick: (t) => {
			const i = Math.trunc(text.length * t);
			node.textContent = text.slice(0, i);
		}
	};+++
}
```

####### content/tutorial/02-advanced-svelte/02-transitions/06-transition-events/app-a/src/lib/App.svelte #######

```

<script>
	import { fly } from 'svelte/transition';

	let visible = true;
	let status = 'waiting...';
</script>

<p>status: {status}</p>

<label>
	<input type="checkbox" bind:checked={visible} />
	visible
</label>

{#if visible}
	<p transition:fly={{ y: 200, duration: 2000 }}>
		Flies in and out
	</p>
{/if}

```


####### content/tutorial/02-advanced-svelte/02-transitions/06-transition-events/app-b/src/lib/App.svelte #######

```

<script>
	import { fly } from 'svelte/transition';

	let visible = true;
	let status = 'waiting...';
</script>

<p>status: {status}</p>

<label>
	<input type="checkbox" bind:checked={visible} />
	visible
</label>

{#if visible}
	<p
		transition:fly={{ y: 200, duration: 2000 }}
		on:introstart={() => status = 'intro started'}
		on:outrostart={() => status = 'outro started'}
		on:introend={() => status = 'intro ended'}
		on:outroend={() => status = 'outro ended'}
	>
		Flies in and out
	</p>
{/if}

```


####### content/tutorial/02-advanced-svelte/02-transitions/06-transition-events/README.md #######

---
title: Transition events
---

It can be useful to know when transitions are beginning and ending. Svelte dispatches events that you can listen to like any other DOM event:

```svelte
/// file: App.svelte
<p
	transition:fly={{ y: 200, duration: 2000 }}
	+++on:introstart={() => status = 'intro started'}
	on:outrostart={() => status = 'outro started'}
	on:introend={() => status = 'intro ended'}
	on:outroend={() => status = 'outro ended'}+++
>
	Flies in and out
</p>
```

####### content/tutorial/02-advanced-svelte/02-transitions/07-global-transitions/app-a/src/lib/App.svelte #######

```

<script>
	import { slide } from 'svelte/transition';

	let showItems = true;
	let i = 5;
	let items = ['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten'];
</script>

<label>
	<input type="checkbox" bind:checked={showItems} />
	show list
</label>

<label>
	<input type="range" bind:value={i} max="10" />
</label>

{#if showItems}
	{#each items.slice(0, i) as item}
		<div transition:slide>
			{item}
		</div>
	{/each}
{/if}

<style>
	div {
		padding: 0.5em 0;
		border-top: 1px solid #eee;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/02-transitions/07-global-transitions/app-b/src/lib/App.svelte #######

```

<script>
	import { slide } from 'svelte/transition';

	let showItems = true;
	let i = 5;
	let items = ['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten'];
</script>

<label>
	<input type="checkbox" bind:checked={showItems} />
	show list
</label>

<label>
	<input type="range" bind:value={i} max="10" />
</label>

{#if showItems}
	{#each items.slice(0, i) as item}
		<div transition:slide|global>
			{item}
		</div>
	{/each}
{/if}

<style>
	div {
		padding: 0.5em 0;
		border-top: 1px solid #eee;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/02-transitions/07-global-transitions/README.md #######

---
title: Global transitions
---

Ordinarily, transitions will only play on elements when their direct containing block is added or destroyed. In the example here, toggling the visibility of the entire list does not apply transitions to individual list elements.

Instead, we'd like transitions to not only play when individual items are added and removed with the slider but also when we toggle the checkbox.

We can achieve this with a _global_ transition, which plays when _any_ block containing the transitions is added or removed:

```svelte
/// file: App.svelte
<div transition:slide+++|global+++>
	{item}
</div>
```

> In Svelte 3, transitions were global by default and you had to use the `|local` modifier to make them local.

####### content/tutorial/02-advanced-svelte/02-transitions/08-key-blocks/app-a/src/lib/App.svelte #######

```

<script>
	import { onMount } from 'svelte';
	import { typewriter } from './transition.js';
	import { messages } from './loading-messages.js';

	let i = -1;

	onMount(() => {
		const interval = setInterval(() => {
			i += 1;
			i %= messages.length;
		}, 2500);

		return () => {
			clearInterval(interval);
		};
	});
</script>

<h1>loading...</h1>

<p in:typewriter={{ speed: 10 }}>
	{messages[i] || ''}
</p>
```


####### content/tutorial/02-advanced-svelte/02-transitions/08-key-blocks/app-a/src/lib/loading-messages.js #######

```

// thanks to https://gist.github.com/meain/6440b706a97d2dd71574769517e7ed32
export const messages = [
	"reticulating splines...",
	"generating witty dialog...",
	"swapping time and space...",
	"640K ought to be enough for anybody",
	"checking the gravitational constant in your locale...",
	"keep calm and npm install",
	"counting backwards from Infinity",
	"I'm sorry Dave, I can't do that.",
	"adjusting flux capacitor...",
	"constructing additional pylons...",
	"rm -rf /",
];
```


####### content/tutorial/02-advanced-svelte/02-transitions/08-key-blocks/app-a/src/lib/transition.js #######

```

export function typewriter(node, { speed = 1 }) {
	const valid = node.childNodes.length === 1 && node.childNodes[0].nodeType === Node.TEXT_NODE;

	if (!valid) {
		throw new Error(`This transition only works on elements with a single text node child`);
	}

	const text = node.textContent;
	const duration = text.length / (speed * 0.01);

	return {
		duration,
		tick: (t) => {
			const i = Math.trunc(text.length * t);
			node.textContent = text.slice(0, i);
		}
	};
}
```


####### content/tutorial/02-advanced-svelte/02-transitions/08-key-blocks/app-b/src/lib/App.svelte #######

```

<script>
	import { onMount } from 'svelte';
	import { typewriter } from './transition.js';
	import { messages } from './loading-messages.js';

	let i = -1;

	onMount(() => {
		const interval = setInterval(() => {
			i += 1;
			i %= messages.length;
		}, 2500);

		return () => {
			clearInterval(interval);
		};
	});
</script>

<h1>loading...</h1>

{#key i}
	<p in:typewriter={{ speed: 10 }}>
		{messages[i] || ''}
	</p>
{/key}
```


####### content/tutorial/02-advanced-svelte/02-transitions/08-key-blocks/README.md #######

---
title: Key blocks
---

Key blocks destroy and recreate their contents when the value of an expression changes. This is useful if you want an element to play its transition whenever a value changes instead of only when the element enters or leaves the DOM.

Here, for example, we'd like to play the `typewriter` transition from `transition.js` whenever the loading message, i.e. `i` changes. Wrap the `<p>` element in a key block:

```svelte
/// file: App.svelte
+++{#key i}+++
	<p in:typewriter={{ speed: 10 }}>
		{messages[i] || ''}
	</p>
+++{/key}+++
```
####### content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/app-a/src/lib/App.svelte #######

```

<script>
	import { createTodoStore } from './todos.js';
	import TodoList from './TodoList.svelte';

	const todos = createTodoStore([
		{ done: false, description: 'write some docs' },
		{ done: false, description: 'start writing blog post' },
		{ done: true, description: 'buy some milk' },
		{ done: false, description: 'mow the lawn' },
		{ done: false, description: 'feed the turtle' },
		{ done: false, description: 'fix some bugs' }
	]);
</script>

<div class="board">
	<input
		placeholder="what needs to be done?"
		on:keydown={(e) => {
			if (e.key !== 'Enter') return;

			todos.add(e.currentTarget.value);
			e.currentTarget.value = '';
		}}
	/>

	<div class="todo">
		<h2>todo</h2>
		<TodoList store={todos} done={false} />
	</div>

	<div class="done">
		<h2>done</h2>
		<TodoList store={todos} done={true} />
	</div>
</div>

<style>
	.board {
		display: grid;
		grid-template-columns: 1fr 1fr;
		grid-column-gap: 1em;
		max-width: 36em;
		margin: 0 auto;
	}

	.board > input {
		font-size: 1.4em;
		grid-column: 1/3;
		padding: 0.5em;
		margin: 0 0 1rem 0;
	}

	h2 {
		font-size: 2em;
		font-weight: 200;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/app-a/src/lib/TodoList.svelte #######

```

<script>
	export let store;
	export let done;
</script>

<ul class="todos">
	{#each $store.filter((todo) => todo.done === done) as todo (todo.id)}
		<li
			class:done
		>
			<label>
				<input
					type="checkbox"
					checked={todo.done}
					on:change={(e) => store.mark(todo, e.currentTarget.checked)}
				/>

				<span>{todo.description}</span>

				<button on:click={() => store.remove(todo)} aria-label="Remove" />
			</label>
		</li>
	{/each}
</ul>

<style>
	label {
		width: 100%;
		height: 100%;
		display: flex;
	}

	span {
		flex: 1;
	}

	button {
		background-image: url(./remove.svg);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/app-a/src/lib/todos.js #######

```

import { writable } from 'svelte/store';

export function createTodoStore(initial) {
	let uid = 1;

	const todos = initial.map(({ done, description }) => {
		return {
			id: uid++,
			done,
			description
		};
	});

	const { subscribe, update } = writable(todos);

	return {
		subscribe,
		add: description => {
			const todo = {
				id: uid++,
				done: false,
				description
			};

			update($todos => [...$todos, todo])
		},
		remove: todo => {
			update($todos => $todos.filter((t) => t !== todo));
		},
		mark: (todo, done) => {
			update($todos => [
				...$todos.filter((t) => t !== todo),
				{ ...todo, done }
			]);
		}
	};
}

```


####### content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/app-a/src/lib/transition.js #######

```

import { crossfade } from 'svelte/transition';
import { quintOut } from 'svelte/easing';

export const [send, receive] = crossfade({
	duration: (d) => Math.sqrt(d * 200),

	fallback(node, params) {
		const style = getComputedStyle(node);
		const transform = style.transform === 'none' ? '' : style.transform;

		return {
			duration: 600,
			easing: quintOut,
			css: (t) => `
				transform: ${transform} scale(${t});
				opacity: ${t}
			`
		};
	}
});
```


####### content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/app-b/src/lib/TodoList.svelte #######

```

<script>
	import { send, receive } from './transition.js';

	export let store;
	export let done;
</script>

<ul class="todos">
	{#each $store.filter((todo) => todo.done === done) as todo (todo.id)}
		<li
			class:done
			in:receive={{ key: todo.id }}
			out:send={{ key: todo.id }}
		>
			<label>
				<input
					type="checkbox"
					checked={todo.done}
					on:change={(e) => store.mark(todo, e.currentTarget.checked)}
				/>

				<span>{todo.description}</span>

				<button on:click={() => store.remove(todo)} aria-label="Remove" />
			</label>
		</li>
	{/each}
</ul>

<style>
	label {
		width: 100%;
		height: 100%;
		display: flex;
	}

	span {
		flex: 1;
	}

	button {
		background-image: url(./remove.svg);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/02-transitions/09-deferred-transitions/README.md #######

---
title: Deferred transitions
---

A particularly powerful feature of Svelte's transition engine is the ability to _defer_ transitions, so that they can be coordinated between multiple elements.

Take this pair of todo lists, in which toggling a todo sends it to the opposite list. In the real world, objects don't behave like that — instead of disappearing and reappearing in another place, they move through a series of intermediate positions. Using motion can go a long way towards helping users understand what's happening in your app.

We can achieve this effect using the `crossfade` function, as seen in `transition.js`, which creates a pair of transitions called `send` and `receive`. When an element is 'sent', it looks for a corresponding element being 'received', and generates a transition that transforms the element to its counterpart's position and fades it out. When an element is 'received', the reverse happens. If there is no counterpart, the `fallback` transition is used.

Open `TodoList.svelte`. First, import the `send` and `receive` transitions from transition.js:

```svelte
/// file: TodoList.svelte
<script>
	+++import { send, receive } from './transition.js';+++

	export let store;
	export let done;
</script>
```

Then, add them to the `<li>` element, using the `todo.id` property as a key to match the elements:

```svelte
/// file: TodoList.svelte
<li
	class:done
	+++in:receive={{ key: todo.id }}+++
	+++out:send={{ key: todo.id }}+++
>
```

Now, when you toggle items, they move smoothly to their new location. The non-transitioning items still jump around awkwardly — we can fix that in the next chapter.

####### content/tutorial/02-advanced-svelte/02-transitions/meta.json #######

```

{
	"title": "Transitions",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/03-animations/01-animate/app-b/src/lib/TodoList.svelte #######

```

<script>
	import { flip } from 'svelte/animate';
	import { send, receive } from './transition.js';

	export let store;
	export let done;
</script>

<ul class="todos">
	{#each $store.filter((todo) => todo.done === done) as todo (todo.id)}
		<li
			class:done
			in:receive={{ key: todo.id }}
			out:send={{ key: todo.id }}
			animate:flip={{ duration: 200 }}
		>
			<label>
				<input
					type="checkbox"
					checked={todo.done}
					on:change={(e) => store.mark(todo, e.currentTarget.checked)}
				/>

				<span>{todo.description}</span>

				<button on:click={() => store.remove(todo)} aria-label="Remove" />
			</label>
		</li>
	{/each}
</ul>

<style>
	label {
		width: 100%;
		height: 100%;
		display: flex;
	}

	.done {
		opacity: 0.5;
	}

	span {
		flex: 1;
	}

	button {
		background-image: url(./remove.svg);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/03-animations/01-animate/README.md #######

---
title: The animate directive
---

In the [previous chapter](/tutorial/deferred-transitions), we used deferred transitions to create the illusion of motion as elements move from one todo list to the other.

To complete the illusion, we also need to apply motion to the elements that _aren't_ transitioning. For this, we use the `animate` directive.

First, import the `flip` function — flip stands for ['First, Last, Invert, Play'](https://aerotwist.com/blog/flip-your-animations/) — from `svelte/animate` into `TodoList.svelte`:

```svelte
/// file: TodoList.svelte
<script>
	+++import { flip } from 'svelte/animate';+++
	import { send, receive } from './transition.js';

	export let store;
	export let done;
</script>
```

Then add it to the `<li>` elements:

```svelte
/// file: TodoList.svelte
<li
	class:done
	in:receive={{ key: todo.id }}
	out:send={{ key: todo.id }}
	+++animate:flip+++
>
```

The movement is a little slow in this case, so we can add a `duration` parameter:

```svelte
/// file: TodoList.svelte
<li
	class:done
	in:receive={{ key: todo.id }}
	out:send={{ key: todo.id }}
	animate:flip+++={{ duration: 200 }}+++
>
```

> `duration` can also be a `d => milliseconds` function, where `d` is the number of pixels the element has to travel

Note that all the transitions and animations are being applied with CSS, rather than JavaScript, meaning they won't block (or be blocked by) the main thread.

####### content/tutorial/02-advanced-svelte/03-animations/meta.json #######

```

{
	"title": "Animations",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/TodoList.svelte"
}

```


####### content/tutorial/02-advanced-svelte/04-actions/01-actions/app-a/src/lib/actions.js #######

```

export function trapFocus(node) {
	const previous = document.activeElement;

	function focusable() {
		return Array.from(node.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'));
	}

	function handleKeydown(event) {
		if (event.key !== 'Tab') return;

		const current = document.activeElement;

		const elements = focusable();
		const first = elements.at(0);
		const last = elements.at(-1)

		if (event.shiftKey && current === first) {
			last.focus();
			event.preventDefault();
		}

		if (!event.shiftKey && current === last) {
			first.focus();
			event.preventDefault();
		}
	}

	focusable()[0]?.focus();

	// TODO finish writing the action
}

```


####### content/tutorial/02-advanced-svelte/04-actions/01-actions/app-a/src/lib/App.svelte #######

```

<script>
	import Canvas from './Canvas.svelte';

	const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet', 'white', 'black'];
	let selected = colors[0];
	let size = 10;

	let showMenu = true;
</script>

<div class="container">
	<Canvas color={selected} size={size} />

	{#if showMenu}
		<div
			class="modal-background"
			on:click|self={() => showMenu = false}
			on:keydown={(e) => {
				if (e.key === 'Escape') showMenu = false;
			}}
		>
			<div class="menu">
				<div class="colors">
					{#each colors as color}
						<button
							class="color"
							aria-label={color}
							aria-current={selected === color}
							style="--color: {color}"
							on:click={() => {
								selected = color;
							}}
						/>
					{/each}
				</div>

				<label>
					small
					<input type="range" bind:value={size} min="1" max="50" />
					large
				</label>
			</div>
		</div>
	{/if}

	<div class="controls">
		<button class="show-menu" on:click={() => showMenu = !showMenu}>
			{showMenu ? 'close' : 'menu'}
		</button>
	</div>
</div>

<style>
	.container {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
	}

	.controls {
		position: absolute;
		left: 0;
		top: 0;
		padding: 1em;
	}

	.show-menu {
		width: 5em;
	}

	.modal-background {
		position: fixed;
		display: flex;
		justify-content: center;
		align-items: center;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		backdrop-filter: blur(20px);
	}

	.menu {
		position: relative;
		background: var(--bg-2);
		width: calc(100% - 2em);
		max-width: 28em;
		padding: 1em 1em 0.5em 1em;
		border-radius: 1em;
		box-sizing: border-box;
		user-select: none;
	}

	.colors {
		display: grid;
		align-items: center;
		grid-template-columns: repeat(9, 1fr);
		grid-gap: 0.5em;
	}

	.color {
		aspect-ratio: 1;
		border-radius: 50%;
		background: var(--color, #fff);
		transform: none;
		filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.2));
		transition: all 0.1s;
	}

	.color[aria-current="true"] {
		transform: translate(1px, 1px);
		filter: none;
		box-shadow: inset 3px 3px 4px rgba(0,0,0,0.2);
	}

	.menu label {
		display: flex;
		width: 100%;
		margin: 1em 0 0 0;
	}

	.menu input {
		flex: 1;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/04-actions/01-actions/app-a/src/lib/Canvas.svelte #######

```

<script>
	import { onMount } from "svelte";

	export let color;
	export let size;

	let canvas;
	let context;
	let previous;

	function get_coords(e) {
		const { clientX, clientY } = e;
		const { left, top } = canvas.getBoundingClientRect();
		const x = clientX - left;
		const y = clientY - top;
		return { x, y };
	}

	onMount(() => {
		context = canvas.getContext('2d');

		function resize() {
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;
		}

		window.addEventListener('resize', resize);
		resize();

		return () => {
			window.removeEventListener('resize', resize);
		};
	});
</script>



<canvas
	bind:this={canvas}
	on:pointerdown={(e) => {
		const coords = get_coords(e);
		context.fillStyle = color;
		context.beginPath();
		context.arc(coords.x, coords.y, size / 2, 0, 2 * Math.PI);
		context.fill();

		previous = coords;
	}}
	on:pointerleave={() => {
		previous = null;
	}}
	on:pointermove={(e) => {
		const coords = get_coords(e);

		if (e.buttons === 1) {
			e.preventDefault();

			context.strokeStyle = color;
			context.lineWidth = size;
			context.lineCap = 'round';
			context.beginPath();
			context.moveTo(previous.x, previous.y);
			context.lineTo(coords.x, coords.y);
			context.stroke();
		}

		previous = coords;
	}}
/>

{#if previous}
	<div
		class="preview"
		style="--color: {color}; --size: {size}px; --x: {previous.x}px; --y: {previous.y}px" 
	/>
{/if}

<style>
	canvas {
		position: absolute;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
	}

	.preview {
		position: absolute;
		left: var(--x);
		top: var(--y);
		width: var(--size);
		height: var(--size);
		transform: translate(-50%, -50%);
		background: var(--color);
		border-radius: 50%;
		opacity: 0.5;
		pointer-events: none;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/04-actions/01-actions/app-b/src/lib/actions.js #######

```

export function trapFocus(node) {
	const previous = document.activeElement;

	function focusable() {
		return Array.from(node.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'));
	}

	function handleKeydown(event) {
		if (event.key !== 'Tab') return;

		const current = document.activeElement;

		const elements = focusable();
		const first = elements.at(0);
		const last = elements.at(-1)

		if (event.shiftKey && current === first) {
			last.focus();
			event.preventDefault();
		}

		if (!event.shiftKey && current === last) {
			first.focus();
			event.preventDefault();
		}
	}

	focusable()[0]?.focus();

	node.addEventListener('keydown', handleKeydown);

	return {
		destroy() {
			node.removeEventListener('keydown', handleKeydown);
			previous?.focus();
		}
	};
}

```


####### content/tutorial/02-advanced-svelte/04-actions/01-actions/app-b/src/lib/App.svelte #######

```

<script>
	import Canvas from './Canvas.svelte';
	import { trapFocus } from './actions.js';

	const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet', 'white', 'black'];
	let selected = colors[0];
	let size = 10;

	let showMenu = true;
</script>

<div class="container">
	<Canvas color={selected} size={size} />

	{#if showMenu}
		<div
			class="modal-background"
			on:click|self={() => showMenu = false}
			on:keydown={(e) => {
				if (e.key === 'Escape') showMenu = false;
			}}
		>
			<div class="menu" use:trapFocus>
				<div class="colors">
					{#each colors as color}
						<button
							class="color"
							aria-label={color}
							aria-current={selected === color}
							style="--color: {color}"
							on:click={() => {
								selected = color;
							}}
						/>
					{/each}
				</div>

				<label>
					small
					<input type="range" bind:value={size} min="1" max="50" />
					large
				</label>
			</div>
		</div>
	{/if}

	<div class="controls">
		<button class="show-menu" on:click={() => showMenu = !showMenu}>
			{showMenu ? 'close' : 'menu'}
		</button>
	</div>
</div>

<style>
	.container {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
	}

	.controls {
		position: absolute;
		left: 0;
		top: 0;
		padding: 1em;
	}

	.show-menu {
		width: 5em;
	}

	.modal-background {
		position: fixed;
		display: flex;
		justify-content: center;
		align-items: center;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		backdrop-filter: blur(20px);
	}

	.menu {
		position: relative;
		background: var(--bg-2);
		width: calc(100% - 2em);
		max-width: 28em;
		padding: 1em 1em 0.5em 1em;
		border-radius: 1em;
		box-sizing: border-box;
		user-select: none;
	}

	.colors {
		display: grid;
		align-items: center;
		grid-template-columns: repeat(9, 1fr);
		grid-gap: 0.5em;
	}

	.color {
		aspect-ratio: 1;
		border-radius: 50%;
		background: var(--color, #fff);
		transform: none;
		filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.2));
		transition: all 0.1s;
	}

	.color[aria-current="true"] {
		transform: translate(1px, 1px);
		filter: none;
		box-shadow: inset 3px 3px 4px rgba(0,0,0,0.2);
	}

	.menu label {
		display: flex;
		width: 100%;
		margin: 1em 0 0 0;
	}

	.menu input {
		flex: 1;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/04-actions/01-actions/README.md #######

---
title: The use directive
---

Actions are essentially element-level lifecycle functions. They're useful for things like:

- interfacing with third-party libraries
- lazy-loaded images
- tooltips
- adding custom event handlers

In this app, you can scribble on the `<canvas>`, and change colours and brush size via the menu. But if you open the menu and cycle through the options with the Tab key, you'll soon find that the focus isn't _trapped_ inside the modal.

We can fix that with an action. Import `trapFocus` from `actions.js`...

```svelte
/// file: App.svelte
<script>
	import Canvas from './Canvas.svelte';
	+++import { trapFocus } from './actions.js';+++

	const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet', 'white', 'black'];
	let selected = colors[0];
	let size = 10;

	let showMenu = true;
</script>
```

...then add it to the menu with the `use:` directive:

```svelte
/// file: App.svelte
<div class="menu" +++use:trapFocus+++>
```

Let's take a look at the `trapFocus` function in `actions.js`. An action function is called with a `node` — the `<div class="menu">` in our case — when the node is mounted to the DOM, and can return an action object with a `destroy` method.

First, we need to add an event listener that intercepts Tab key presses:

```js
/// file: actions.js
focusable()[0]?.focus();

+++node.addEventListener('keydown', handleKeydown);+++
```

Second, we need to do some cleanup when the node is unmounted — removing the event listener, and restoring focus to where it was before the element mounted:

```js
/// file: actions.js
focusable()[0]?.focus();

node.addEventListener('keydown', handleKeydown);

+++return {
	destroy() {
		node.removeEventListener('keydown', handleKeydown);
		previous?.focus();
	}
};+++
```

Now, when you open the menu, you can cycle through the options with the Tab key.

####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/index.d.ts #######

```

export * from '@popperjs/core/lib';

```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/createPopper.js #######

```

import getCompositeRect from "./dom-utils/getCompositeRect.js";
import getLayoutRect from "./dom-utils/getLayoutRect.js";
import listScrollParents from "./dom-utils/listScrollParents.js";
import getOffsetParent from "./dom-utils/getOffsetParent.js";
import getComputedStyle from "./dom-utils/getComputedStyle.js";
import orderModifiers from "./utils/orderModifiers.js";
import debounce from "./utils/debounce.js";
import validateModifiers from "./utils/validateModifiers.js";
import uniqueBy from "./utils/uniqueBy.js";
import getBasePlacement from "./utils/getBasePlacement.js";
import mergeByName from "./utils/mergeByName.js";
import detectOverflow from "./utils/detectOverflow.js";
import { isElement } from "./dom-utils/instanceOf.js";
import { auto } from "./enums.js";
var INVALID_ELEMENT_ERROR = 'Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.';
var INFINITE_LOOP_ERROR = 'Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.';
var DEFAULT_OPTIONS = {
  placement: 'bottom',
  modifiers: [],
  strategy: 'absolute'
};

function areValidElements() {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  return !args.some(function (element) {
    return !(element && typeof element.getBoundingClientRect === 'function');
  });
}

export function popperGenerator(generatorOptions) {
  if (generatorOptions === void 0) {
    generatorOptions = {};
  }

  var _generatorOptions = generatorOptions,
      _generatorOptions$def = _generatorOptions.defaultModifiers,
      defaultModifiers = _generatorOptions$def === void 0 ? [] : _generatorOptions$def,
      _generatorOptions$def2 = _generatorOptions.defaultOptions,
      defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;
  return function createPopper(reference, popper, options) {
    if (options === void 0) {
      options = defaultOptions;
    }

    var state = {
      placement: 'bottom',
      orderedModifiers: [],
      options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),
      modifiersData: {},
      elements: {
        reference: reference,
        popper: popper
      },
      attributes: {},
      styles: {}
    };
    var effectCleanupFns = [];
    var isDestroyed = false;
    var instance = {
      state: state,
      setOptions: function setOptions(setOptionsAction) {
        var options = typeof setOptionsAction === 'function' ? setOptionsAction(state.options) : setOptionsAction;
        cleanupModifierEffects();
        state.options = Object.assign({}, defaultOptions, state.options, options);
        state.scrollParents = {
          reference: isElement(reference) ? listScrollParents(reference) : reference.contextElement ? listScrollParents(reference.contextElement) : [],
          popper: listScrollParents(popper)
        }; // Orders the modifiers based on their dependencies and `phase`
        // properties

        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers, state.options.modifiers))); // Strip out disabled modifiers

        state.orderedModifiers = orderedModifiers.filter(function (m) {
          return m.enabled;
        }); // Validate the provided modifiers so that the consumer will get warned
        // if one of the modifiers is invalid for any reason

        if (process.env.NODE_ENV !== "production") {
          var modifiers = uniqueBy([].concat(orderedModifiers, state.options.modifiers), function (_ref) {
            var name = _ref.name;
            return name;
          });
          validateModifiers(modifiers);

          if (getBasePlacement(state.options.placement) === auto) {
            var flipModifier = state.orderedModifiers.find(function (_ref2) {
              var name = _ref2.name;
              return name === 'flip';
            });

            if (!flipModifier) {
              console.error(['Popper: "auto" placements require the "flip" modifier be', 'present and enabled to work.'].join(' '));
            }
          }

          var _getComputedStyle = getComputedStyle(popper),
              marginTop = _getComputedStyle.marginTop,
              marginRight = _getComputedStyle.marginRight,
              marginBottom = _getComputedStyle.marginBottom,
              marginLeft = _getComputedStyle.marginLeft; // We no longer take into account `margins` on the popper, and it can
          // cause bugs with positioning, so we'll warn the consumer


          if ([marginTop, marginRight, marginBottom, marginLeft].some(function (margin) {
            return parseFloat(margin);
          })) {
            console.warn(['Popper: CSS "margin" styles cannot be used to apply padding', 'between the popper and its reference element or boundary.', 'To replicate margin, use the `offset` modifier, as well as', 'the `padding` option in the `preventOverflow` and `flip`', 'modifiers.'].join(' '));
          }
        }

        runModifierEffects();
        return instance.update();
      },
      // Sync update – it will always be executed, even if not necessary. This
      // is useful for low frequency updates where sync behavior simplifies the
      // logic.
      // For high frequency updates (e.g. `resize` and `scroll` events), always
      // prefer the async Popper#update method
      forceUpdate: function forceUpdate() {
        if (isDestroyed) {
          return;
        }

        var _state$elements = state.elements,
            reference = _state$elements.reference,
            popper = _state$elements.popper; // Don't proceed if `reference` or `popper` are not valid elements
        // anymore

        if (!areValidElements(reference, popper)) {
          if (process.env.NODE_ENV !== "production") {
            console.error(INVALID_ELEMENT_ERROR);
          }

          return;
        } // Store the reference and popper rects to be read by modifiers


        state.rects = {
          reference: getCompositeRect(reference, getOffsetParent(popper), state.options.strategy === 'fixed'),
          popper: getLayoutRect(popper)
        }; // Modifiers have the ability to reset the current update cycle. The
        // most common use case for this is the `flip` modifier changing the
        // placement, which then needs to re-run all the modifiers, because the
        // logic was previously ran for the previous placement and is therefore
        // stale/incorrect

        state.reset = false;
        state.placement = state.options.placement; // On each update cycle, the `modifiersData` property for each modifier
        // is filled with the initial data specified by the modifier. This means
        // it doesn't persist and is fresh on each update.
        // To ensure persistent data, use `${name}#persistent`

        state.orderedModifiers.forEach(function (modifier) {
          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);
        });
        var __debug_loops__ = 0;

        for (var index = 0; index < state.orderedModifiers.length; index++) {
          if (process.env.NODE_ENV !== "production") {
            __debug_loops__ += 1;

            if (__debug_loops__ > 100) {
              console.error(INFINITE_LOOP_ERROR);
              break;
            }
          }

          if (state.reset === true) {
            state.reset = false;
            index = -1;
            continue;
          }

          var _state$orderedModifie = state.orderedModifiers[index],
              fn = _state$orderedModifie.fn,
              _state$orderedModifie2 = _state$orderedModifie.options,
              _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2,
              name = _state$orderedModifie.name;

          if (typeof fn === 'function') {
            state = fn({
              state: state,
              options: _options,
              name: name,
              instance: instance
            }) || state;
          }
        }
      },
      // Async and optimistically optimized update – it will not be executed if
      // not necessary (debounced to run at most once-per-tick)
      update: debounce(function () {
        return new Promise(function (resolve) {
          instance.forceUpdate();
          resolve(state);
        });
      }),
      destroy: function destroy() {
        cleanupModifierEffects();
        isDestroyed = true;
      }
    };

    if (!areValidElements(reference, popper)) {
      if (process.env.NODE_ENV !== "production") {
        console.error(INVALID_ELEMENT_ERROR);
      }

      return instance;
    }

    instance.setOptions(options).then(function (state) {
      if (!isDestroyed && options.onFirstUpdate) {
        options.onFirstUpdate(state);
      }
    }); // Modifiers have the ability to execute arbitrary code before the first
    // update cycle runs. They will be executed in the same order as the update
    // cycle. This is useful when a modifier adds some persistent data that
    // other modifiers need to use, but the modifier is run after the dependent
    // one.

    function runModifierEffects() {
      state.orderedModifiers.forEach(function (_ref3) {
        var name = _ref3.name,
            _ref3$options = _ref3.options,
            options = _ref3$options === void 0 ? {} : _ref3$options,
            effect = _ref3.effect;

        if (typeof effect === 'function') {
          var cleanupFn = effect({
            state: state,
            name: name,
            instance: instance,
            options: options
          });

          var noopFn = function noopFn() {};

          effectCleanupFns.push(cleanupFn || noopFn);
        }
      });
    }

    function cleanupModifierEffects() {
      effectCleanupFns.forEach(function (fn) {
        return fn();
      });
      effectCleanupFns = [];
    }

    return instance;
  };
}
export var createPopper = /*#__PURE__*/popperGenerator(); // eslint-disable-next-line import/no-unused-modules

export { detectOverflow };
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/contains.js #######

```

import { isShadowRoot } from "./instanceOf.js";
export default function contains(parent, child) {
  var rootNode = child.getRootNode && child.getRootNode(); // First, attempt with faster native method

  if (parent.contains(child)) {
    return true;
  } // then fallback to custom implementation with Shadow DOM support
  else if (rootNode && isShadowRoot(rootNode)) {
      var next = child;

      do {
        if (next && parent.isSameNode(next)) {
          return true;
        } // $FlowFixMe[prop-missing]: need a better way to handle this...


        next = next.parentNode || next.host;
      } while (next);
    } // Give up, the result is false


  return false;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js #######

```

import { isElement, isHTMLElement } from "./instanceOf.js";
import { round } from "../utils/math.js";
import getWindow from "./getWindow.js";
import isLayoutViewport from "./isLayoutViewport.js";
export default function getBoundingClientRect(element, includeScale, isFixedStrategy) {
  if (includeScale === void 0) {
    includeScale = false;
  }

  if (isFixedStrategy === void 0) {
    isFixedStrategy = false;
  }

  var clientRect = element.getBoundingClientRect();
  var scaleX = 1;
  var scaleY = 1;

  if (includeScale && isHTMLElement(element)) {
    scaleX = element.offsetWidth > 0 ? round(clientRect.width) / element.offsetWidth || 1 : 1;
    scaleY = element.offsetHeight > 0 ? round(clientRect.height) / element.offsetHeight || 1 : 1;
  }

  var _ref = isElement(element) ? getWindow(element) : window,
      visualViewport = _ref.visualViewport;

  var addVisualOffsets = !isLayoutViewport() && isFixedStrategy;
  var x = (clientRect.left + (addVisualOffsets && visualViewport ? visualViewport.offsetLeft : 0)) / scaleX;
  var y = (clientRect.top + (addVisualOffsets && visualViewport ? visualViewport.offsetTop : 0)) / scaleY;
  var width = clientRect.width / scaleX;
  var height = clientRect.height / scaleY;
  return {
    width: width,
    height: height,
    top: y,
    right: x + width,
    bottom: y + height,
    left: x,
    x: x,
    y: y
  };
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js #######

```

import { viewport } from "../enums.js";
import getViewportRect from "./getViewportRect.js";
import getDocumentRect from "./getDocumentRect.js";
import listScrollParents from "./listScrollParents.js";
import getOffsetParent from "./getOffsetParent.js";
import getDocumentElement from "./getDocumentElement.js";
import getComputedStyle from "./getComputedStyle.js";
import { isElement, isHTMLElement } from "./instanceOf.js";
import getBoundingClientRect from "./getBoundingClientRect.js";
import getParentNode from "./getParentNode.js";
import contains from "./contains.js";
import getNodeName from "./getNodeName.js";
import rectToClientRect from "../utils/rectToClientRect.js";
import { max, min } from "../utils/math.js";

function getInnerBoundingClientRect(element, strategy) {
  var rect = getBoundingClientRect(element, false, strategy === 'fixed');
  rect.top = rect.top + element.clientTop;
  rect.left = rect.left + element.clientLeft;
  rect.bottom = rect.top + element.clientHeight;
  rect.right = rect.left + element.clientWidth;
  rect.width = element.clientWidth;
  rect.height = element.clientHeight;
  rect.x = rect.left;
  rect.y = rect.top;
  return rect;
}

function getClientRectFromMixedType(element, clippingParent, strategy) {
  return clippingParent === viewport ? rectToClientRect(getViewportRect(element, strategy)) : isElement(clippingParent) ? getInnerBoundingClientRect(clippingParent, strategy) : rectToClientRect(getDocumentRect(getDocumentElement(element)));
} // A "clipping parent" is an overflowable container with the characteristic of
// clipping (or hiding) overflowing elements with a position different from
// `initial`


function getClippingParents(element) {
  var clippingParents = listScrollParents(getParentNode(element));
  var canEscapeClipping = ['absolute', 'fixed'].indexOf(getComputedStyle(element).position) >= 0;
  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;

  if (!isElement(clipperElement)) {
    return [];
  } // $FlowFixMe[incompatible-return]: https://github.com/facebook/flow/issues/1414


  return clippingParents.filter(function (clippingParent) {
    return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== 'body';
  });
} // Gets the maximum area that the element is visible in due to any number of
// clipping parents


export default function getClippingRect(element, boundary, rootBoundary, strategy) {
  var mainClippingParents = boundary === 'clippingParents' ? getClippingParents(element) : [].concat(boundary);
  var clippingParents = [].concat(mainClippingParents, [rootBoundary]);
  var firstClippingParent = clippingParents[0];
  var clippingRect = clippingParents.reduce(function (accRect, clippingParent) {
    var rect = getClientRectFromMixedType(element, clippingParent, strategy);
    accRect.top = max(rect.top, accRect.top);
    accRect.right = min(rect.right, accRect.right);
    accRect.bottom = min(rect.bottom, accRect.bottom);
    accRect.left = max(rect.left, accRect.left);
    return accRect;
  }, getClientRectFromMixedType(element, firstClippingParent, strategy));
  clippingRect.width = clippingRect.right - clippingRect.left;
  clippingRect.height = clippingRect.bottom - clippingRect.top;
  clippingRect.x = clippingRect.left;
  clippingRect.y = clippingRect.top;
  return clippingRect;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js #######

```

import getBoundingClientRect from "./getBoundingClientRect.js";
import getNodeScroll from "./getNodeScroll.js";
import getNodeName from "./getNodeName.js";
import { isHTMLElement } from "./instanceOf.js";
import getWindowScrollBarX from "./getWindowScrollBarX.js";
import getDocumentElement from "./getDocumentElement.js";
import isScrollParent from "./isScrollParent.js";
import { round } from "../utils/math.js";

function isElementScaled(element) {
  var rect = element.getBoundingClientRect();
  var scaleX = round(rect.width) / element.offsetWidth || 1;
  var scaleY = round(rect.height) / element.offsetHeight || 1;
  return scaleX !== 1 || scaleY !== 1;
} // Returns the composite rect of an element relative to its offsetParent.
// Composite means it takes into account transforms as well as layout.


export default function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {
  if (isFixed === void 0) {
    isFixed = false;
  }

  var isOffsetParentAnElement = isHTMLElement(offsetParent);
  var offsetParentIsScaled = isHTMLElement(offsetParent) && isElementScaled(offsetParent);
  var documentElement = getDocumentElement(offsetParent);
  var rect = getBoundingClientRect(elementOrVirtualElement, offsetParentIsScaled, isFixed);
  var scroll = {
    scrollLeft: 0,
    scrollTop: 0
  };
  var offsets = {
    x: 0,
    y: 0
  };

  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {
    if (getNodeName(offsetParent) !== 'body' || // https://github.com/popperjs/popper-core/issues/1078
    isScrollParent(documentElement)) {
      scroll = getNodeScroll(offsetParent);
    }

    if (isHTMLElement(offsetParent)) {
      offsets = getBoundingClientRect(offsetParent, true);
      offsets.x += offsetParent.clientLeft;
      offsets.y += offsetParent.clientTop;
    } else if (documentElement) {
      offsets.x = getWindowScrollBarX(documentElement);
    }
  }

  return {
    x: rect.left + scroll.scrollLeft - offsets.x,
    y: rect.top + scroll.scrollTop - offsets.y,
    width: rect.width,
    height: rect.height
  };
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js #######

```

import getWindow from "./getWindow.js";
export default function getComputedStyle(element) {
  return getWindow(element).getComputedStyle(element);
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js #######

```

import { isElement } from "./instanceOf.js";
export default function getDocumentElement(element) {
  // $FlowFixMe[incompatible-return]: assume body is always available
  return ((isElement(element) ? element.ownerDocument : // $FlowFixMe[prop-missing]
  element.document) || window.document).documentElement;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js #######

```

import getDocumentElement from "./getDocumentElement.js";
import getComputedStyle from "./getComputedStyle.js";
import getWindowScrollBarX from "./getWindowScrollBarX.js";
import getWindowScroll from "./getWindowScroll.js";
import { max } from "../utils/math.js"; // Gets the entire size of the scrollable document area, even extending outside
// of the `<html>` and `<body>` rect bounds if horizontally scrollable

export default function getDocumentRect(element) {
  var _element$ownerDocumen;

  var html = getDocumentElement(element);
  var winScroll = getWindowScroll(element);
  var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;
  var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);
  var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);
  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);
  var y = -winScroll.scrollTop;

  if (getComputedStyle(body || html).direction === 'rtl') {
    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;
  }

  return {
    width: width,
    height: height,
    x: x,
    y: y
  };
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js #######

```

export default function getHTMLElementScroll(element) {
  return {
    scrollLeft: element.scrollLeft,
    scrollTop: element.scrollTop
  };
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js #######

```

import getBoundingClientRect from "./getBoundingClientRect.js"; // Returns the layout rect of an element relative to its offsetParent. Layout
// means it doesn't take into account transforms.

export default function getLayoutRect(element) {
  var clientRect = getBoundingClientRect(element); // Use the clientRect sizes if it's not been transformed.
  // Fixes https://github.com/popperjs/popper-core/issues/1223

  var width = element.offsetWidth;
  var height = element.offsetHeight;

  if (Math.abs(clientRect.width - width) <= 1) {
    width = clientRect.width;
  }

  if (Math.abs(clientRect.height - height) <= 1) {
    height = clientRect.height;
  }

  return {
    x: element.offsetLeft,
    y: element.offsetTop,
    width: width,
    height: height
  };
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getNodeName.js #######

```

export default function getNodeName(element) {
  return element ? (element.nodeName || '').toLowerCase() : null;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js #######

```

import getWindowScroll from "./getWindowScroll.js";
import getWindow from "./getWindow.js";
import { isHTMLElement } from "./instanceOf.js";
import getHTMLElementScroll from "./getHTMLElementScroll.js";
export default function getNodeScroll(node) {
  if (node === getWindow(node) || !isHTMLElement(node)) {
    return getWindowScroll(node);
  } else {
    return getHTMLElementScroll(node);
  }
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js #######

```

import getWindow from "./getWindow.js";
import getNodeName from "./getNodeName.js";
import getComputedStyle from "./getComputedStyle.js";
import { isHTMLElement, isShadowRoot } from "./instanceOf.js";
import isTableElement from "./isTableElement.js";
import getParentNode from "./getParentNode.js";
import getUAString from "../utils/userAgent.js";

function getTrueOffsetParent(element) {
  if (!isHTMLElement(element) || // https://github.com/popperjs/popper-core/issues/837
  getComputedStyle(element).position === 'fixed') {
    return null;
  }

  return element.offsetParent;
} // `.offsetParent` reports `null` for fixed elements, while absolute elements
// return the containing block


function getContainingBlock(element) {
  var isFirefox = /firefox/i.test(getUAString());
  var isIE = /Trident/i.test(getUAString());

  if (isIE && isHTMLElement(element)) {
    // In IE 9, 10 and 11 fixed elements containing block is always established by the viewport
    var elementCss = getComputedStyle(element);

    if (elementCss.position === 'fixed') {
      return null;
    }
  }

  var currentNode = getParentNode(element);

  if (isShadowRoot(currentNode)) {
    currentNode = currentNode.host;
  }

  while (isHTMLElement(currentNode) && ['html', 'body'].indexOf(getNodeName(currentNode)) < 0) {
    var css = getComputedStyle(currentNode); // This is non-exhaustive but covers the most common CSS properties that
    // create a containing block.
    // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block

    if (css.transform !== 'none' || css.perspective !== 'none' || css.contain === 'paint' || ['transform', 'perspective'].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === 'filter' || isFirefox && css.filter && css.filter !== 'none') {
      return currentNode;
    } else {
      currentNode = currentNode.parentNode;
    }
  }

  return null;
} // Gets the closest ancestor positioned element. Handles some edge cases,
// such as table ancestors and cross browser bugs.


export default function getOffsetParent(element) {
  var window = getWindow(element);
  var offsetParent = getTrueOffsetParent(element);

  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === 'static') {
    offsetParent = getTrueOffsetParent(offsetParent);
  }

  if (offsetParent && (getNodeName(offsetParent) === 'html' || getNodeName(offsetParent) === 'body' && getComputedStyle(offsetParent).position === 'static')) {
    return window;
  }

  return offsetParent || getContainingBlock(element) || window;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getParentNode.js #######

```

import getNodeName from "./getNodeName.js";
import getDocumentElement from "./getDocumentElement.js";
import { isShadowRoot } from "./instanceOf.js";
export default function getParentNode(element) {
  if (getNodeName(element) === 'html') {
    return element;
  }

  return (// this is a quicker (but less type safe) way to save quite some bytes from the bundle
    // $FlowFixMe[incompatible-return]
    // $FlowFixMe[prop-missing]
    element.assignedSlot || // step into the shadow DOM of the parent of a slotted node
    element.parentNode || ( // DOM Element detected
    isShadowRoot(element) ? element.host : null) || // ShadowRoot detected
    // $FlowFixMe[incompatible-call]: HTMLElement is a Node
    getDocumentElement(element) // fallback

  );
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js #######

```

import getParentNode from "./getParentNode.js";
import isScrollParent from "./isScrollParent.js";
import getNodeName from "./getNodeName.js";
import { isHTMLElement } from "./instanceOf.js";
export default function getScrollParent(node) {
  if (['html', 'body', '#document'].indexOf(getNodeName(node)) >= 0) {
    // $FlowFixMe[incompatible-return]: assume body is always available
    return node.ownerDocument.body;
  }

  if (isHTMLElement(node) && isScrollParent(node)) {
    return node;
  }

  return getScrollParent(getParentNode(node));
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js #######

```

import getWindow from "./getWindow.js";
import getDocumentElement from "./getDocumentElement.js";
import getWindowScrollBarX from "./getWindowScrollBarX.js";
import isLayoutViewport from "./isLayoutViewport.js";
export default function getViewportRect(element, strategy) {
  var win = getWindow(element);
  var html = getDocumentElement(element);
  var visualViewport = win.visualViewport;
  var width = html.clientWidth;
  var height = html.clientHeight;
  var x = 0;
  var y = 0;

  if (visualViewport) {
    width = visualViewport.width;
    height = visualViewport.height;
    var layoutViewport = isLayoutViewport();

    if (layoutViewport || !layoutViewport && strategy === 'fixed') {
      x = visualViewport.offsetLeft;
      y = visualViewport.offsetTop;
    }
  }

  return {
    width: width,
    height: height,
    x: x + getWindowScrollBarX(element),
    y: y
  };
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getWindow.js #######

```

export default function getWindow(node) {
  if (node == null) {
    return window;
  }

  if (node.toString() !== '[object Window]') {
    var ownerDocument = node.ownerDocument;
    return ownerDocument ? ownerDocument.defaultView || window : window;
  }

  return node;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js #######

```

import getBoundingClientRect from "./getBoundingClientRect.js";
import getDocumentElement from "./getDocumentElement.js";
import getWindowScroll from "./getWindowScroll.js";
export default function getWindowScrollBarX(element) {
  // If <html> has a CSS width greater than the viewport, then this will be
  // incorrect for RTL.
  // Popper 1 is broken in this case and never had a bug report so let's assume
  // it's not an issue. I don't think anyone ever specifies width on <html>
  // anyway.
  // Browsers where the left scrollbar doesn't cause an issue report `0` for
  // this (e.g. Edge 2019, IE11, Safari)
  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js #######

```

import getWindow from "./getWindow.js";
export default function getWindowScroll(node) {
  var win = getWindow(node);
  var scrollLeft = win.pageXOffset;
  var scrollTop = win.pageYOffset;
  return {
    scrollLeft: scrollLeft,
    scrollTop: scrollTop
  };
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/instanceOf.js #######

```

import getWindow from "./getWindow.js";

function isElement(node) {
  var OwnElement = getWindow(node).Element;
  return node instanceof OwnElement || node instanceof Element;
}

function isHTMLElement(node) {
  var OwnElement = getWindow(node).HTMLElement;
  return node instanceof OwnElement || node instanceof HTMLElement;
}

function isShadowRoot(node) {
  // IE 11 has no ShadowRoot
  if (typeof ShadowRoot === 'undefined') {
    return false;
  }

  var OwnElement = getWindow(node).ShadowRoot;
  return node instanceof OwnElement || node instanceof ShadowRoot;
}

export { isElement, isHTMLElement, isShadowRoot };
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/isLayoutViewport.js #######

```

import getUAString from "../utils/userAgent.js";
export default function isLayoutViewport() {
  return !/^((?!chrome|android).)*safari/i.test(getUAString());
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js #######

```

import getComputedStyle from "./getComputedStyle.js";
export default function isScrollParent(element) {
  // Firefox wants us to check `-x` and `-y` variations as well
  var _getComputedStyle = getComputedStyle(element),
      overflow = _getComputedStyle.overflow,
      overflowX = _getComputedStyle.overflowX,
      overflowY = _getComputedStyle.overflowY;

  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/isTableElement.js #######

```

import getNodeName from "./getNodeName.js";
export default function isTableElement(element) {
  return ['table', 'td', 'th'].indexOf(getNodeName(element)) >= 0;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js #######

```

import getScrollParent from "./getScrollParent.js";
import getParentNode from "./getParentNode.js";
import getWindow from "./getWindow.js";
import isScrollParent from "./isScrollParent.js";
/*
given a DOM element, return the list of all scroll parents, up the list of ancesors
until we get to the top window object. This list is what we attach scroll listeners
to, because if any of these parent elements scroll, we'll need to re-calculate the
reference element's position.
*/

export default function listScrollParents(element, list) {
  var _element$ownerDocumen;

  if (list === void 0) {
    list = [];
  }

  var scrollParent = getScrollParent(element);
  var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);
  var win = getWindow(scrollParent);
  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;
  var updatedList = list.concat(target);
  return isBody ? updatedList : // $FlowFixMe[incompatible-call]: isBody tells us target will be an HTMLElement here
  updatedList.concat(listScrollParents(getParentNode(target)));
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/enums.js #######

```

export var top = 'top';
export var bottom = 'bottom';
export var right = 'right';
export var left = 'left';
export var auto = 'auto';
export var basePlacements = [top, bottom, right, left];
export var start = 'start';
export var end = 'end';
export var clippingParents = 'clippingParents';
export var viewport = 'viewport';
export var popper = 'popper';
export var reference = 'reference';
export var variationPlacements = /*#__PURE__*/basePlacements.reduce(function (acc, placement) {
  return acc.concat([placement + "-" + start, placement + "-" + end]);
}, []);
export var placements = /*#__PURE__*/[].concat(basePlacements, [auto]).reduce(function (acc, placement) {
  return acc.concat([placement, placement + "-" + start, placement + "-" + end]);
}, []); // modifiers that need to read the DOM

export var beforeRead = 'beforeRead';
export var read = 'read';
export var afterRead = 'afterRead'; // pure-logic modifiers

export var beforeMain = 'beforeMain';
export var main = 'main';
export var afterMain = 'afterMain'; // modifier with the purpose to write to the DOM (or write into a framework state)

export var beforeWrite = 'beforeWrite';
export var write = 'write';
export var afterWrite = 'afterWrite';
export var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/index.js #######

```

export * from "./enums.js";
export * from "./modifiers/index.js"; // eslint-disable-next-line import/no-unused-modules

export { popperGenerator, detectOverflow, createPopper as createPopperBase } from "./createPopper.js"; // eslint-disable-next-line import/no-unused-modules

export { createPopper } from "./popper.js"; // eslint-disable-next-line import/no-unused-modules

export { createPopper as createPopperLite } from "./popper-lite.js";
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/applyStyles.js #######

```

import getNodeName from "../dom-utils/getNodeName.js";
import { isHTMLElement } from "../dom-utils/instanceOf.js"; // This modifier takes the styles prepared by the `computeStyles` modifier
// and applies them to the HTMLElements such as popper and arrow

function applyStyles(_ref) {
  var state = _ref.state;
  Object.keys(state.elements).forEach(function (name) {
    var style = state.styles[name] || {};
    var attributes = state.attributes[name] || {};
    var element = state.elements[name]; // arrow is optional + virtual elements

    if (!isHTMLElement(element) || !getNodeName(element)) {
      return;
    } // Flow doesn't support to extend this property, but it's the most
    // effective way to apply styles to an HTMLElement
    // $FlowFixMe[cannot-write]


    Object.assign(element.style, style);
    Object.keys(attributes).forEach(function (name) {
      var value = attributes[name];

      if (value === false) {
        element.removeAttribute(name);
      } else {
        element.setAttribute(name, value === true ? '' : value);
      }
    });
  });
}

function effect(_ref2) {
  var state = _ref2.state;
  var initialStyles = {
    popper: {
      position: state.options.strategy,
      left: '0',
      top: '0',
      margin: '0'
    },
    arrow: {
      position: 'absolute'
    },
    reference: {}
  };
  Object.assign(state.elements.popper.style, initialStyles.popper);
  state.styles = initialStyles;

  if (state.elements.arrow) {
    Object.assign(state.elements.arrow.style, initialStyles.arrow);
  }

  return function () {
    Object.keys(state.elements).forEach(function (name) {
      var element = state.elements[name];
      var attributes = state.attributes[name] || {};
      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]); // Set all values to an empty string to unset them

      var style = styleProperties.reduce(function (style, property) {
        style[property] = '';
        return style;
      }, {}); // arrow is optional + virtual elements

      if (!isHTMLElement(element) || !getNodeName(element)) {
        return;
      }

      Object.assign(element.style, style);
      Object.keys(attributes).forEach(function (attribute) {
        element.removeAttribute(attribute);
      });
    });
  };
} // eslint-disable-next-line import/no-unused-modules


export default {
  name: 'applyStyles',
  enabled: true,
  phase: 'write',
  fn: applyStyles,
  effect: effect,
  requires: ['computeStyles']
};
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/arrow.js #######

```

import getBasePlacement from "../utils/getBasePlacement.js";
import getLayoutRect from "../dom-utils/getLayoutRect.js";
import contains from "../dom-utils/contains.js";
import getOffsetParent from "../dom-utils/getOffsetParent.js";
import getMainAxisFromPlacement from "../utils/getMainAxisFromPlacement.js";
import { within } from "../utils/within.js";
import mergePaddingObject from "../utils/mergePaddingObject.js";
import expandToHashMap from "../utils/expandToHashMap.js";
import { left, right, basePlacements, top, bottom } from "../enums.js";
import { isHTMLElement } from "../dom-utils/instanceOf.js"; // eslint-disable-next-line import/no-unused-modules

var toPaddingObject = function toPaddingObject(padding, state) {
  padding = typeof padding === 'function' ? padding(Object.assign({}, state.rects, {
    placement: state.placement
  })) : padding;
  return mergePaddingObject(typeof padding !== 'number' ? padding : expandToHashMap(padding, basePlacements));
};

function arrow(_ref) {
  var _state$modifiersData$;

  var state = _ref.state,
      name = _ref.name,
      options = _ref.options;
  var arrowElement = state.elements.arrow;
  var popperOffsets = state.modifiersData.popperOffsets;
  var basePlacement = getBasePlacement(state.placement);
  var axis = getMainAxisFromPlacement(basePlacement);
  var isVertical = [left, right].indexOf(basePlacement) >= 0;
  var len = isVertical ? 'height' : 'width';

  if (!arrowElement || !popperOffsets) {
    return;
  }

  var paddingObject = toPaddingObject(options.padding, state);
  var arrowRect = getLayoutRect(arrowElement);
  var minProp = axis === 'y' ? top : left;
  var maxProp = axis === 'y' ? bottom : right;
  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets[axis] - state.rects.popper[len];
  var startDiff = popperOffsets[axis] - state.rects.reference[axis];
  var arrowOffsetParent = getOffsetParent(arrowElement);
  var clientSize = arrowOffsetParent ? axis === 'y' ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;
  var centerToReference = endDiff / 2 - startDiff / 2; // Make sure the arrow doesn't overflow the popper if the center point is
  // outside of the popper bounds

  var min = paddingObject[minProp];
  var max = clientSize - arrowRect[len] - paddingObject[maxProp];
  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;
  var offset = within(min, center, max); // Prevents breaking syntax highlighting...

  var axisProp = axis;
  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset, _state$modifiersData$.centerOffset = offset - center, _state$modifiersData$);
}

function effect(_ref2) {
  var state = _ref2.state,
      options = _ref2.options;
  var _options$element = options.element,
      arrowElement = _options$element === void 0 ? '[data-popper-arrow]' : _options$element;

  if (arrowElement == null) {
    return;
  } // CSS selector


  if (typeof arrowElement === 'string') {
    arrowElement = state.elements.popper.querySelector(arrowElement);

    if (!arrowElement) {
      return;
    }
  }

  if (process.env.NODE_ENV !== "production") {
    if (!isHTMLElement(arrowElement)) {
      console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).', 'To use an SVG arrow, wrap it in an HTMLElement that will be used as', 'the arrow.'].join(' '));
    }
  }

  if (!contains(state.elements.popper, arrowElement)) {
    if (process.env.NODE_ENV !== "production") {
      console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper', 'element.'].join(' '));
    }

    return;
  }

  state.elements.arrow = arrowElement;
} // eslint-disable-next-line import/no-unused-modules


export default {
  name: 'arrow',
  enabled: true,
  phase: 'main',
  fn: arrow,
  effect: effect,
  requires: ['popperOffsets'],
  requiresIfExists: ['preventOverflow']
};
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/computeStyles.js #######

```

import { top, left, right, bottom, end } from "../enums.js";
import getOffsetParent from "../dom-utils/getOffsetParent.js";
import getWindow from "../dom-utils/getWindow.js";
import getDocumentElement from "../dom-utils/getDocumentElement.js";
import getComputedStyle from "../dom-utils/getComputedStyle.js";
import getBasePlacement from "../utils/getBasePlacement.js";
import getVariation from "../utils/getVariation.js";
import { round } from "../utils/math.js"; // eslint-disable-next-line import/no-unused-modules

var unsetSides = {
  top: 'auto',
  right: 'auto',
  bottom: 'auto',
  left: 'auto'
}; // Round the offsets to the nearest suitable subpixel based on the DPR.
// Zooming can change the DPR, but it seems to report a value that will
// cleanly divide the values into the appropriate subpixels.

function roundOffsetsByDPR(_ref, win) {
  var x = _ref.x,
      y = _ref.y;
  var dpr = win.devicePixelRatio || 1;
  return {
    x: round(x * dpr) / dpr || 0,
    y: round(y * dpr) / dpr || 0
  };
}

export function mapToStyles(_ref2) {
  var _Object$assign2;

  var popper = _ref2.popper,
      popperRect = _ref2.popperRect,
      placement = _ref2.placement,
      variation = _ref2.variation,
      offsets = _ref2.offsets,
      position = _ref2.position,
      gpuAcceleration = _ref2.gpuAcceleration,
      adaptive = _ref2.adaptive,
      roundOffsets = _ref2.roundOffsets,
      isFixed = _ref2.isFixed;
  var _offsets$x = offsets.x,
      x = _offsets$x === void 0 ? 0 : _offsets$x,
      _offsets$y = offsets.y,
      y = _offsets$y === void 0 ? 0 : _offsets$y;

  var _ref3 = typeof roundOffsets === 'function' ? roundOffsets({
    x: x,
    y: y
  }) : {
    x: x,
    y: y
  };

  x = _ref3.x;
  y = _ref3.y;
  var hasX = offsets.hasOwnProperty('x');
  var hasY = offsets.hasOwnProperty('y');
  var sideX = left;
  var sideY = top;
  var win = window;

  if (adaptive) {
    var offsetParent = getOffsetParent(popper);
    var heightProp = 'clientHeight';
    var widthProp = 'clientWidth';

    if (offsetParent === getWindow(popper)) {
      offsetParent = getDocumentElement(popper);

      if (getComputedStyle(offsetParent).position !== 'static' && position === 'absolute') {
        heightProp = 'scrollHeight';
        widthProp = 'scrollWidth';
      }
    } // $FlowFixMe[incompatible-cast]: force type refinement, we compare offsetParent with window above, but Flow doesn't detect it


    offsetParent = offsetParent;

    if (placement === top || (placement === left || placement === right) && variation === end) {
      sideY = bottom;
      var offsetY = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.height : // $FlowFixMe[prop-missing]
      offsetParent[heightProp];
      y -= offsetY - popperRect.height;
      y *= gpuAcceleration ? 1 : -1;
    }

    if (placement === left || (placement === top || placement === bottom) && variation === end) {
      sideX = right;
      var offsetX = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.width : // $FlowFixMe[prop-missing]
      offsetParent[widthProp];
      x -= offsetX - popperRect.width;
      x *= gpuAcceleration ? 1 : -1;
    }
  }

  var commonStyles = Object.assign({
    position: position
  }, adaptive && unsetSides);

  var _ref4 = roundOffsets === true ? roundOffsetsByDPR({
    x: x,
    y: y
  }, getWindow(popper)) : {
    x: x,
    y: y
  };

  x = _ref4.x;
  y = _ref4.y;

  if (gpuAcceleration) {
    var _Object$assign;

    return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? '0' : '', _Object$assign[sideX] = hasX ? '0' : '', _Object$assign.transform = (win.devicePixelRatio || 1) <= 1 ? "translate(" + x + "px, " + y + "px)" : "translate3d(" + x + "px, " + y + "px, 0)", _Object$assign));
  }

  return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + "px" : '', _Object$assign2[sideX] = hasX ? x + "px" : '', _Object$assign2.transform = '', _Object$assign2));
}

function computeStyles(_ref5) {
  var state = _ref5.state,
      options = _ref5.options;
  var _options$gpuAccelerat = options.gpuAcceleration,
      gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat,
      _options$adaptive = options.adaptive,
      adaptive = _options$adaptive === void 0 ? true : _options$adaptive,
      _options$roundOffsets = options.roundOffsets,
      roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;

  if (process.env.NODE_ENV !== "production") {
    var transitionProperty = getComputedStyle(state.elements.popper).transitionProperty || '';

    if (adaptive && ['transform', 'top', 'right', 'bottom', 'left'].some(function (property) {
      return transitionProperty.indexOf(property) >= 0;
    })) {
      console.warn(['Popper: Detected CSS transitions on at least one of the following', 'CSS properties: "transform", "top", "right", "bottom", "left".', '\n\n', 'Disable the "computeStyles" modifier\'s `adaptive` option to allow', 'for smooth transitions, or remove these properties from the CSS', 'transition declaration on the popper element if only transitioning', 'opacity or background-color for example.', '\n\n', 'We recommend using the popper element as a wrapper around an inner', 'element that can have any CSS property transitioned for animations.'].join(' '));
    }
  }

  var commonStyles = {
    placement: getBasePlacement(state.placement),
    variation: getVariation(state.placement),
    popper: state.elements.popper,
    popperRect: state.rects.popper,
    gpuAcceleration: gpuAcceleration,
    isFixed: state.options.strategy === 'fixed'
  };

  if (state.modifiersData.popperOffsets != null) {
    state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.popperOffsets,
      position: state.options.strategy,
      adaptive: adaptive,
      roundOffsets: roundOffsets
    })));
  }

  if (state.modifiersData.arrow != null) {
    state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.arrow,
      position: 'absolute',
      adaptive: false,
      roundOffsets: roundOffsets
    })));
  }

  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    'data-popper-placement': state.placement
  });
} // eslint-disable-next-line import/no-unused-modules


export default {
  name: 'computeStyles',
  enabled: true,
  phase: 'beforeWrite',
  fn: computeStyles,
  data: {}
};
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/eventListeners.js #######

```

import getWindow from "../dom-utils/getWindow.js"; // eslint-disable-next-line import/no-unused-modules

var passive = {
  passive: true
};

function effect(_ref) {
  var state = _ref.state,
      instance = _ref.instance,
      options = _ref.options;
  var _options$scroll = options.scroll,
      scroll = _options$scroll === void 0 ? true : _options$scroll,
      _options$resize = options.resize,
      resize = _options$resize === void 0 ? true : _options$resize;
  var window = getWindow(state.elements.popper);
  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);

  if (scroll) {
    scrollParents.forEach(function (scrollParent) {
      scrollParent.addEventListener('scroll', instance.update, passive);
    });
  }

  if (resize) {
    window.addEventListener('resize', instance.update, passive);
  }

  return function () {
    if (scroll) {
      scrollParents.forEach(function (scrollParent) {
        scrollParent.removeEventListener('scroll', instance.update, passive);
      });
    }

    if (resize) {
      window.removeEventListener('resize', instance.update, passive);
    }
  };
} // eslint-disable-next-line import/no-unused-modules


export default {
  name: 'eventListeners',
  enabled: true,
  phase: 'write',
  fn: function fn() {},
  effect: effect,
  data: {}
};
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/flip.js #######

```

import getOppositePlacement from "../utils/getOppositePlacement.js";
import getBasePlacement from "../utils/getBasePlacement.js";
import getOppositeVariationPlacement from "../utils/getOppositeVariationPlacement.js";
import detectOverflow from "../utils/detectOverflow.js";
import computeAutoPlacement from "../utils/computeAutoPlacement.js";
import { bottom, top, start, right, left, auto } from "../enums.js";
import getVariation from "../utils/getVariation.js"; // eslint-disable-next-line import/no-unused-modules

function getExpandedFallbackPlacements(placement) {
  if (getBasePlacement(placement) === auto) {
    return [];
  }

  var oppositePlacement = getOppositePlacement(placement);
  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];
}

function flip(_ref) {
  var state = _ref.state,
      options = _ref.options,
      name = _ref.name;

  if (state.modifiersData[name]._skip) {
    return;
  }

  var _options$mainAxis = options.mainAxis,
      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,
      _options$altAxis = options.altAxis,
      checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis,
      specifiedFallbackPlacements = options.fallbackPlacements,
      padding = options.padding,
      boundary = options.boundary,
      rootBoundary = options.rootBoundary,
      altBoundary = options.altBoundary,
      _options$flipVariatio = options.flipVariations,
      flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio,
      allowedAutoPlacements = options.allowedAutoPlacements;
  var preferredPlacement = state.options.placement;
  var basePlacement = getBasePlacement(preferredPlacement);
  var isBasePlacement = basePlacement === preferredPlacement;
  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));
  var placements = [preferredPlacement].concat(fallbackPlacements).reduce(function (acc, placement) {
    return acc.concat(getBasePlacement(placement) === auto ? computeAutoPlacement(state, {
      placement: placement,
      boundary: boundary,
      rootBoundary: rootBoundary,
      padding: padding,
      flipVariations: flipVariations,
      allowedAutoPlacements: allowedAutoPlacements
    }) : placement);
  }, []);
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var checksMap = new Map();
  var makeFallbackChecks = true;
  var firstFittingPlacement = placements[0];

  for (var i = 0; i < placements.length; i++) {
    var placement = placements[i];

    var _basePlacement = getBasePlacement(placement);

    var isStartVariation = getVariation(placement) === start;
    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;
    var len = isVertical ? 'width' : 'height';
    var overflow = detectOverflow(state, {
      placement: placement,
      boundary: boundary,
      rootBoundary: rootBoundary,
      altBoundary: altBoundary,
      padding: padding
    });
    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;

    if (referenceRect[len] > popperRect[len]) {
      mainVariationSide = getOppositePlacement(mainVariationSide);
    }

    var altVariationSide = getOppositePlacement(mainVariationSide);
    var checks = [];

    if (checkMainAxis) {
      checks.push(overflow[_basePlacement] <= 0);
    }

    if (checkAltAxis) {
      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);
    }

    if (checks.every(function (check) {
      return check;
    })) {
      firstFittingPlacement = placement;
      makeFallbackChecks = false;
      break;
    }

    checksMap.set(placement, checks);
  }

  if (makeFallbackChecks) {
    // `2` may be desired in some cases – research later
    var numberOfChecks = flipVariations ? 3 : 1;

    var _loop = function _loop(_i) {
      var fittingPlacement = placements.find(function (placement) {
        var checks = checksMap.get(placement);

        if (checks) {
          return checks.slice(0, _i).every(function (check) {
            return check;
          });
        }
      });

      if (fittingPlacement) {
        firstFittingPlacement = fittingPlacement;
        return "break";
      }
    };

    for (var _i = numberOfChecks; _i > 0; _i--) {
      var _ret = _loop(_i);

      if (_ret === "break") break;
    }
  }

  if (state.placement !== firstFittingPlacement) {
    state.modifiersData[name]._skip = true;
    state.placement = firstFittingPlacement;
    state.reset = true;
  }
} // eslint-disable-next-line import/no-unused-modules


export default {
  name: 'flip',
  enabled: true,
  phase: 'main',
  fn: flip,
  requiresIfExists: ['offset'],
  data: {
    _skip: false
  }
};
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/hide.js #######

```

import { top, bottom, left, right } from "../enums.js";
import detectOverflow from "../utils/detectOverflow.js";

function getSideOffsets(overflow, rect, preventedOffsets) {
  if (preventedOffsets === void 0) {
    preventedOffsets = {
      x: 0,
      y: 0
    };
  }

  return {
    top: overflow.top - rect.height - preventedOffsets.y,
    right: overflow.right - rect.width + preventedOffsets.x,
    bottom: overflow.bottom - rect.height + preventedOffsets.y,
    left: overflow.left - rect.width - preventedOffsets.x
  };
}

function isAnySideFullyClipped(overflow) {
  return [top, right, bottom, left].some(function (side) {
    return overflow[side] >= 0;
  });
}

function hide(_ref) {
  var state = _ref.state,
      name = _ref.name;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var preventedOffsets = state.modifiersData.preventOverflow;
  var referenceOverflow = detectOverflow(state, {
    elementContext: 'reference'
  });
  var popperAltOverflow = detectOverflow(state, {
    altBoundary: true
  });
  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);
  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);
  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);
  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);
  state.modifiersData[name] = {
    referenceClippingOffsets: referenceClippingOffsets,
    popperEscapeOffsets: popperEscapeOffsets,
    isReferenceHidden: isReferenceHidden,
    hasPopperEscaped: hasPopperEscaped
  };
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    'data-popper-reference-hidden': isReferenceHidden,
    'data-popper-escaped': hasPopperEscaped
  });
} // eslint-disable-next-line import/no-unused-modules


export default {
  name: 'hide',
  enabled: true,
  phase: 'main',
  requiresIfExists: ['preventOverflow'],
  fn: hide
};
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/index.js #######

```

export { default as applyStyles } from "./applyStyles.js";
export { default as arrow } from "./arrow.js";
export { default as computeStyles } from "./computeStyles.js";
export { default as eventListeners } from "./eventListeners.js";
export { default as flip } from "./flip.js";
export { default as hide } from "./hide.js";
export { default as offset } from "./offset.js";
export { default as popperOffsets } from "./popperOffsets.js";
export { default as preventOverflow } from "./preventOverflow.js";
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/offset.js #######

```

import getBasePlacement from "../utils/getBasePlacement.js";
import { top, left, right, placements } from "../enums.js"; // eslint-disable-next-line import/no-unused-modules

export function distanceAndSkiddingToXY(placement, rects, offset) {
  var basePlacement = getBasePlacement(placement);
  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;

  var _ref = typeof offset === 'function' ? offset(Object.assign({}, rects, {
    placement: placement
  })) : offset,
      skidding = _ref[0],
      distance = _ref[1];

  skidding = skidding || 0;
  distance = (distance || 0) * invertDistance;
  return [left, right].indexOf(basePlacement) >= 0 ? {
    x: distance,
    y: skidding
  } : {
    x: skidding,
    y: distance
  };
}

function offset(_ref2) {
  var state = _ref2.state,
      options = _ref2.options,
      name = _ref2.name;
  var _options$offset = options.offset,
      offset = _options$offset === void 0 ? [0, 0] : _options$offset;
  var data = placements.reduce(function (acc, placement) {
    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset);
    return acc;
  }, {});
  var _data$state$placement = data[state.placement],
      x = _data$state$placement.x,
      y = _data$state$placement.y;

  if (state.modifiersData.popperOffsets != null) {
    state.modifiersData.popperOffsets.x += x;
    state.modifiersData.popperOffsets.y += y;
  }

  state.modifiersData[name] = data;
} // eslint-disable-next-line import/no-unused-modules


export default {
  name: 'offset',
  enabled: true,
  phase: 'main',
  requires: ['popperOffsets'],
  fn: offset
};
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/popperOffsets.js #######

```

import computeOffsets from "../utils/computeOffsets.js";

function popperOffsets(_ref) {
  var state = _ref.state,
      name = _ref.name;
  // Offsets are the actual position the popper needs to have to be
  // properly positioned near its reference element
  // This is the most basic placement, and will be adjusted by
  // the modifiers in the next step
  state.modifiersData[name] = computeOffsets({
    reference: state.rects.reference,
    element: state.rects.popper,
    strategy: 'absolute',
    placement: state.placement
  });
} // eslint-disable-next-line import/no-unused-modules


export default {
  name: 'popperOffsets',
  enabled: true,
  phase: 'read',
  fn: popperOffsets,
  data: {}
};
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/modifiers/preventOverflow.js #######

```

import { top, left, right, bottom, start } from "../enums.js";
import getBasePlacement from "../utils/getBasePlacement.js";
import getMainAxisFromPlacement from "../utils/getMainAxisFromPlacement.js";
import getAltAxis from "../utils/getAltAxis.js";
import { within, withinMaxClamp } from "../utils/within.js";
import getLayoutRect from "../dom-utils/getLayoutRect.js";
import getOffsetParent from "../dom-utils/getOffsetParent.js";
import detectOverflow from "../utils/detectOverflow.js";
import getVariation from "../utils/getVariation.js";
import getFreshSideObject from "../utils/getFreshSideObject.js";
import { min as mathMin, max as mathMax } from "../utils/math.js";

function preventOverflow(_ref) {
  var state = _ref.state,
      options = _ref.options,
      name = _ref.name;
  var _options$mainAxis = options.mainAxis,
      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,
      _options$altAxis = options.altAxis,
      checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis,
      boundary = options.boundary,
      rootBoundary = options.rootBoundary,
      altBoundary = options.altBoundary,
      padding = options.padding,
      _options$tether = options.tether,
      tether = _options$tether === void 0 ? true : _options$tether,
      _options$tetherOffset = options.tetherOffset,
      tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;
  var overflow = detectOverflow(state, {
    boundary: boundary,
    rootBoundary: rootBoundary,
    padding: padding,
    altBoundary: altBoundary
  });
  var basePlacement = getBasePlacement(state.placement);
  var variation = getVariation(state.placement);
  var isBasePlacement = !variation;
  var mainAxis = getMainAxisFromPlacement(basePlacement);
  var altAxis = getAltAxis(mainAxis);
  var popperOffsets = state.modifiersData.popperOffsets;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var tetherOffsetValue = typeof tetherOffset === 'function' ? tetherOffset(Object.assign({}, state.rects, {
    placement: state.placement
  })) : tetherOffset;
  var normalizedTetherOffsetValue = typeof tetherOffsetValue === 'number' ? {
    mainAxis: tetherOffsetValue,
    altAxis: tetherOffsetValue
  } : Object.assign({
    mainAxis: 0,
    altAxis: 0
  }, tetherOffsetValue);
  var offsetModifierState = state.modifiersData.offset ? state.modifiersData.offset[state.placement] : null;
  var data = {
    x: 0,
    y: 0
  };

  if (!popperOffsets) {
    return;
  }

  if (checkMainAxis) {
    var _offsetModifierState$;

    var mainSide = mainAxis === 'y' ? top : left;
    var altSide = mainAxis === 'y' ? bottom : right;
    var len = mainAxis === 'y' ? 'height' : 'width';
    var offset = popperOffsets[mainAxis];
    var min = offset + overflow[mainSide];
    var max = offset - overflow[altSide];
    var additive = tether ? -popperRect[len] / 2 : 0;
    var minLen = variation === start ? referenceRect[len] : popperRect[len];
    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len]; // We need to include the arrow in the calculation so the arrow doesn't go
    // outside the reference bounds

    var arrowElement = state.elements.arrow;
    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {
      width: 0,
      height: 0
    };
    var arrowPaddingObject = state.modifiersData['arrow#persistent'] ? state.modifiersData['arrow#persistent'].padding : getFreshSideObject();
    var arrowPaddingMin = arrowPaddingObject[mainSide];
    var arrowPaddingMax = arrowPaddingObject[altSide]; // If the reference length is smaller than the arrow length, we don't want
    // to include its full size in the calculation. If the reference is small
    // and near the edge of a boundary, the popper can overflow even if the
    // reference is not overflowing as well (e.g. virtual elements with no
    // width or height)

    var arrowLen = within(0, referenceRect[len], arrowRect[len]);
    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis : minLen - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis;
    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis : maxLen + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis;
    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);
    var clientOffset = arrowOffsetParent ? mainAxis === 'y' ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;
    var offsetModifierValue = (_offsetModifierState$ = offsetModifierState == null ? void 0 : offsetModifierState[mainAxis]) != null ? _offsetModifierState$ : 0;
    var tetherMin = offset + minOffset - offsetModifierValue - clientOffset;
    var tetherMax = offset + maxOffset - offsetModifierValue;
    var preventedOffset = within(tether ? mathMin(min, tetherMin) : min, offset, tether ? mathMax(max, tetherMax) : max);
    popperOffsets[mainAxis] = preventedOffset;
    data[mainAxis] = preventedOffset - offset;
  }

  if (checkAltAxis) {
    var _offsetModifierState$2;

    var _mainSide = mainAxis === 'x' ? top : left;

    var _altSide = mainAxis === 'x' ? bottom : right;

    var _offset = popperOffsets[altAxis];

    var _len = altAxis === 'y' ? 'height' : 'width';

    var _min = _offset + overflow[_mainSide];

    var _max = _offset - overflow[_altSide];

    var isOriginSide = [top, left].indexOf(basePlacement) !== -1;

    var _offsetModifierValue = (_offsetModifierState$2 = offsetModifierState == null ? void 0 : offsetModifierState[altAxis]) != null ? _offsetModifierState$2 : 0;

    var _tetherMin = isOriginSide ? _min : _offset - referenceRect[_len] - popperRect[_len] - _offsetModifierValue + normalizedTetherOffsetValue.altAxis;

    var _tetherMax = isOriginSide ? _offset + referenceRect[_len] + popperRect[_len] - _offsetModifierValue - normalizedTetherOffsetValue.altAxis : _max;

    var _preventedOffset = tether && isOriginSide ? withinMaxClamp(_tetherMin, _offset, _tetherMax) : within(tether ? _tetherMin : _min, _offset, tether ? _tetherMax : _max);

    popperOffsets[altAxis] = _preventedOffset;
    data[altAxis] = _preventedOffset - _offset;
  }

  state.modifiersData[name] = data;
} // eslint-disable-next-line import/no-unused-modules


export default {
  name: 'preventOverflow',
  enabled: true,
  phase: 'main',
  fn: preventOverflow,
  requiresIfExists: ['offset']
};
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/popper-base.js #######

```

import { createPopper, popperGenerator, detectOverflow } from "./createPopper.js";
// eslint-disable-next-line import/no-unused-modules
export { createPopper, popperGenerator, detectOverflow };
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/popper.js #######

```

import { popperGenerator, detectOverflow } from "./createPopper.js";
import eventListeners from "./modifiers/eventListeners.js";
import popperOffsets from "./modifiers/popperOffsets.js";
import computeStyles from "./modifiers/computeStyles.js";
import applyStyles from "./modifiers/applyStyles.js";
import offset from "./modifiers/offset.js";
import flip from "./modifiers/flip.js";
import preventOverflow from "./modifiers/preventOverflow.js";
import arrow from "./modifiers/arrow.js";
import hide from "./modifiers/hide.js";
var defaultModifiers = [eventListeners, popperOffsets, computeStyles, applyStyles, offset, flip, preventOverflow, arrow, hide];
var createPopper = /*#__PURE__*/popperGenerator({
  defaultModifiers: defaultModifiers
}); // eslint-disable-next-line import/no-unused-modules

export { createPopper, popperGenerator, defaultModifiers, detectOverflow }; // eslint-disable-next-line import/no-unused-modules

export { createPopper as createPopperLite } from "./popper-lite.js"; // eslint-disable-next-line import/no-unused-modules

export * from "./modifiers/index.js";
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/popper-lite.js #######

```

import { popperGenerator, detectOverflow } from "./createPopper.js";
import eventListeners from "./modifiers/eventListeners.js";
import popperOffsets from "./modifiers/popperOffsets.js";
import computeStyles from "./modifiers/computeStyles.js";
import applyStyles from "./modifiers/applyStyles.js";
var defaultModifiers = [eventListeners, popperOffsets, computeStyles, applyStyles];
var createPopper = /*#__PURE__*/popperGenerator({
  defaultModifiers: defaultModifiers
}); // eslint-disable-next-line import/no-unused-modules

export { createPopper, popperGenerator, defaultModifiers, detectOverflow };
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/types.js #######

```


```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js #######

```

import getVariation from "./getVariation.js";
import { variationPlacements, basePlacements, placements as allPlacements } from "../enums.js";
import detectOverflow from "./detectOverflow.js";
import getBasePlacement from "./getBasePlacement.js";
export default function computeAutoPlacement(state, options) {
  if (options === void 0) {
    options = {};
  }

  var _options = options,
      placement = _options.placement,
      boundary = _options.boundary,
      rootBoundary = _options.rootBoundary,
      padding = _options.padding,
      flipVariations = _options.flipVariations,
      _options$allowedAutoP = _options.allowedAutoPlacements,
      allowedAutoPlacements = _options$allowedAutoP === void 0 ? allPlacements : _options$allowedAutoP;
  var variation = getVariation(placement);
  var placements = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function (placement) {
    return getVariation(placement) === variation;
  }) : basePlacements;
  var allowedPlacements = placements.filter(function (placement) {
    return allowedAutoPlacements.indexOf(placement) >= 0;
  });

  if (allowedPlacements.length === 0) {
    allowedPlacements = placements;

    if (process.env.NODE_ENV !== "production") {
      console.error(['Popper: The `allowedAutoPlacements` option did not allow any', 'placements. Ensure the `placement` option matches the variation', 'of the allowed placements.', 'For example, "auto" cannot be used to allow "bottom-start".', 'Use "auto-start" instead.'].join(' '));
    }
  } // $FlowFixMe[incompatible-type]: Flow seems to have problems with two array unions...


  var overflows = allowedPlacements.reduce(function (acc, placement) {
    acc[placement] = detectOverflow(state, {
      placement: placement,
      boundary: boundary,
      rootBoundary: rootBoundary,
      padding: padding
    })[getBasePlacement(placement)];
    return acc;
  }, {});
  return Object.keys(overflows).sort(function (a, b) {
    return overflows[a] - overflows[b];
  });
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/computeOffsets.js #######

```

import getBasePlacement from "./getBasePlacement.js";
import getVariation from "./getVariation.js";
import getMainAxisFromPlacement from "./getMainAxisFromPlacement.js";
import { top, right, bottom, left, start, end } from "../enums.js";
export default function computeOffsets(_ref) {
  var reference = _ref.reference,
      element = _ref.element,
      placement = _ref.placement;
  var basePlacement = placement ? getBasePlacement(placement) : null;
  var variation = placement ? getVariation(placement) : null;
  var commonX = reference.x + reference.width / 2 - element.width / 2;
  var commonY = reference.y + reference.height / 2 - element.height / 2;
  var offsets;

  switch (basePlacement) {
    case top:
      offsets = {
        x: commonX,
        y: reference.y - element.height
      };
      break;

    case bottom:
      offsets = {
        x: commonX,
        y: reference.y + reference.height
      };
      break;

    case right:
      offsets = {
        x: reference.x + reference.width,
        y: commonY
      };
      break;

    case left:
      offsets = {
        x: reference.x - element.width,
        y: commonY
      };
      break;

    default:
      offsets = {
        x: reference.x,
        y: reference.y
      };
  }

  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;

  if (mainAxis != null) {
    var len = mainAxis === 'y' ? 'height' : 'width';

    switch (variation) {
      case start:
        offsets[mainAxis] = offsets[mainAxis] - (reference[len] / 2 - element[len] / 2);
        break;

      case end:
        offsets[mainAxis] = offsets[mainAxis] + (reference[len] / 2 - element[len] / 2);
        break;

      default:
    }
  }

  return offsets;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/debounce.js #######

```

export default function debounce(fn) {
  var pending;
  return function () {
    if (!pending) {
      pending = new Promise(function (resolve) {
        Promise.resolve().then(function () {
          pending = undefined;
          resolve(fn());
        });
      });
    }

    return pending;
  };
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/detectOverflow.js #######

```

import getClippingRect from "../dom-utils/getClippingRect.js";
import getDocumentElement from "../dom-utils/getDocumentElement.js";
import getBoundingClientRect from "../dom-utils/getBoundingClientRect.js";
import computeOffsets from "./computeOffsets.js";
import rectToClientRect from "./rectToClientRect.js";
import { clippingParents, reference, popper, bottom, top, right, basePlacements, viewport } from "../enums.js";
import { isElement } from "../dom-utils/instanceOf.js";
import mergePaddingObject from "./mergePaddingObject.js";
import expandToHashMap from "./expandToHashMap.js"; // eslint-disable-next-line import/no-unused-modules

export default function detectOverflow(state, options) {
  if (options === void 0) {
    options = {};
  }

  var _options = options,
      _options$placement = _options.placement,
      placement = _options$placement === void 0 ? state.placement : _options$placement,
      _options$strategy = _options.strategy,
      strategy = _options$strategy === void 0 ? state.strategy : _options$strategy,
      _options$boundary = _options.boundary,
      boundary = _options$boundary === void 0 ? clippingParents : _options$boundary,
      _options$rootBoundary = _options.rootBoundary,
      rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary,
      _options$elementConte = _options.elementContext,
      elementContext = _options$elementConte === void 0 ? popper : _options$elementConte,
      _options$altBoundary = _options.altBoundary,
      altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary,
      _options$padding = _options.padding,
      padding = _options$padding === void 0 ? 0 : _options$padding;
  var paddingObject = mergePaddingObject(typeof padding !== 'number' ? padding : expandToHashMap(padding, basePlacements));
  var altContext = elementContext === popper ? reference : popper;
  var popperRect = state.rects.popper;
  var element = state.elements[altBoundary ? altContext : elementContext];
  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary, strategy);
  var referenceClientRect = getBoundingClientRect(state.elements.reference);
  var popperOffsets = computeOffsets({
    reference: referenceClientRect,
    element: popperRect,
    strategy: 'absolute',
    placement: placement
  });
  var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets));
  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect; // positive = overflowing the clipping rect
  // 0 or negative = within the clipping rect

  var overflowOffsets = {
    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,
    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,
    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,
    right: elementClientRect.right - clippingClientRect.right + paddingObject.right
  };
  var offsetData = state.modifiersData.offset; // Offsets can be applied only to the popper element

  if (elementContext === popper && offsetData) {
    var offset = offsetData[placement];
    Object.keys(overflowOffsets).forEach(function (key) {
      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;
      var axis = [top, bottom].indexOf(key) >= 0 ? 'y' : 'x';
      overflowOffsets[key] += offset[axis] * multiply;
    });
  }

  return overflowOffsets;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/expandToHashMap.js #######

```

export default function expandToHashMap(value, keys) {
  return keys.reduce(function (hashMap, key) {
    hashMap[key] = value;
    return hashMap;
  }, {});
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/format.js #######

```

export default function format(str) {
  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    args[_key - 1] = arguments[_key];
  }

  return [].concat(args).reduce(function (p, c) {
    return p.replace(/%s/, c);
  }, str);
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getAltAxis.js #######

```

export default function getAltAxis(axis) {
  return axis === 'x' ? 'y' : 'x';
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getAltLen.js #######

```

export default function getAltLen(len) {
  return len === 'width' ? 'height' : 'width';
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getBasePlacement.js #######

```

import { auto } from "../enums.js";
export default function getBasePlacement(placement) {
  return placement.split('-')[0];
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getFreshSideObject.js #######

```

export default function getFreshSideObject() {
  return {
    top: 0,
    right: 0,
    bottom: 0,
    left: 0
  };
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js #######

```

export default function getMainAxisFromPlacement(placement) {
  return ['top', 'bottom'].indexOf(placement) >= 0 ? 'x' : 'y';
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getOppositePlacement.js #######

```

var hash = {
  left: 'right',
  right: 'left',
  bottom: 'top',
  top: 'bottom'
};
export default function getOppositePlacement(placement) {
  return placement.replace(/left|right|bottom|top/g, function (matched) {
    return hash[matched];
  });
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js #######

```

var hash = {
  start: 'end',
  end: 'start'
};
export default function getOppositeVariationPlacement(placement) {
  return placement.replace(/start|end/g, function (matched) {
    return hash[matched];
  });
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/getVariation.js #######

```

export default function getVariation(placement) {
  return placement.split('-')[1];
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/math.js #######

```

export var max = Math.max;
export var min = Math.min;
export var round = Math.round;
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/mergeByName.js #######

```

export default function mergeByName(modifiers) {
  var merged = modifiers.reduce(function (merged, current) {
    var existing = merged[current.name];
    merged[current.name] = existing ? Object.assign({}, existing, current, {
      options: Object.assign({}, existing.options, current.options),
      data: Object.assign({}, existing.data, current.data)
    }) : current;
    return merged;
  }, {}); // IE11 does not support Object.values

  return Object.keys(merged).map(function (key) {
    return merged[key];
  });
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/mergePaddingObject.js #######

```

import getFreshSideObject from "./getFreshSideObject.js";
export default function mergePaddingObject(paddingObject) {
  return Object.assign({}, getFreshSideObject(), paddingObject);
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/orderModifiers.js #######

```

import { modifierPhases } from "../enums.js"; // source: https://stackoverflow.com/questions/49875255

function order(modifiers) {
  var map = new Map();
  var visited = new Set();
  var result = [];
  modifiers.forEach(function (modifier) {
    map.set(modifier.name, modifier);
  }); // On visiting object, check for its dependencies and visit them recursively

  function sort(modifier) {
    visited.add(modifier.name);
    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);
    requires.forEach(function (dep) {
      if (!visited.has(dep)) {
        var depModifier = map.get(dep);

        if (depModifier) {
          sort(depModifier);
        }
      }
    });
    result.push(modifier);
  }

  modifiers.forEach(function (modifier) {
    if (!visited.has(modifier.name)) {
      // check for visited object
      sort(modifier);
    }
  });
  return result;
}

export default function orderModifiers(modifiers) {
  // order based on dependencies
  var orderedModifiers = order(modifiers); // order based on phase

  return modifierPhases.reduce(function (acc, phase) {
    return acc.concat(orderedModifiers.filter(function (modifier) {
      return modifier.phase === phase;
    }));
  }, []);
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/rectToClientRect.js #######

```

export default function rectToClientRect(rect) {
  return Object.assign({}, rect, {
    left: rect.x,
    top: rect.y,
    right: rect.x + rect.width,
    bottom: rect.y + rect.height
  });
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/uniqueBy.js #######

```

export default function uniqueBy(arr, fn) {
  var identifiers = new Set();
  return arr.filter(function (item) {
    var identifier = fn(item);

    if (!identifiers.has(identifier)) {
      identifiers.add(identifier);
      return true;
    }
  });
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/userAgent.js #######

```

export default function getUAString() {
  var uaData = navigator.userAgentData;

  if (uaData != null && uaData.brands && Array.isArray(uaData.brands)) {
    return uaData.brands.map(function (item) {
      return item.brand + "/" + item.version;
    }).join(' ');
  }

  return navigator.userAgent;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/validateModifiers.js #######

```

import format from "./format.js";
import { modifierPhases } from "../enums.js";
var INVALID_MODIFIER_ERROR = 'Popper: modifier "%s" provided an invalid %s property, expected %s but got %s';
var MISSING_DEPENDENCY_ERROR = 'Popper: modifier "%s" requires "%s", but "%s" modifier is not available';
var VALID_PROPERTIES = ['name', 'enabled', 'phase', 'fn', 'effect', 'requires', 'options'];
export default function validateModifiers(modifiers) {
  modifiers.forEach(function (modifier) {
    [].concat(Object.keys(modifier), VALID_PROPERTIES) // IE11-compatible replacement for `new Set(iterable)`
    .filter(function (value, index, self) {
      return self.indexOf(value) === index;
    }).forEach(function (key) {
      switch (key) {
        case 'name':
          if (typeof modifier.name !== 'string') {
            console.error(format(INVALID_MODIFIER_ERROR, String(modifier.name), '"name"', '"string"', "\"" + String(modifier.name) + "\""));
          }

          break;

        case 'enabled':
          if (typeof modifier.enabled !== 'boolean') {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"enabled"', '"boolean"', "\"" + String(modifier.enabled) + "\""));
          }

          break;

        case 'phase':
          if (modifierPhases.indexOf(modifier.phase) < 0) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"phase"', "either " + modifierPhases.join(', '), "\"" + String(modifier.phase) + "\""));
          }

          break;

        case 'fn':
          if (typeof modifier.fn !== 'function') {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"fn"', '"function"', "\"" + String(modifier.fn) + "\""));
          }

          break;

        case 'effect':
          if (modifier.effect != null && typeof modifier.effect !== 'function') {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"effect"', '"function"', "\"" + String(modifier.fn) + "\""));
          }

          break;

        case 'requires':
          if (modifier.requires != null && !Array.isArray(modifier.requires)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requires"', '"array"', "\"" + String(modifier.requires) + "\""));
          }

          break;

        case 'requiresIfExists':
          if (!Array.isArray(modifier.requiresIfExists)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requiresIfExists"', '"array"', "\"" + String(modifier.requiresIfExists) + "\""));
          }

          break;

        case 'options':
        case 'data':
          break;

        default:
          console.error("PopperJS: an invalid property has been provided to the \"" + modifier.name + "\" modifier, valid properties are " + VALID_PROPERTIES.map(function (s) {
            return "\"" + s + "\"";
          }).join(', ') + "; but \"" + key + "\" was provided.");
      }

      modifier.requires && modifier.requires.forEach(function (requirement) {
        if (modifiers.find(function (mod) {
          return mod.name === requirement;
        }) == null) {
          console.error(format(MISSING_DEPENDENCY_ERROR, String(modifier.name), requirement, requirement));
        }
      });
    });
  });
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/lib/utils/within.js #######

```

import { max as mathMax, min as mathMin } from "./math.js";
export function within(min, value, max) {
  return mathMax(min, mathMin(value, max));
}
export function withinMaxClamp(min, value, max) {
  var v = within(min, value, max);
  return v > max ? max : v;
}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/LICENSE.md #######

The MIT License (MIT)

Copyright (c) 2019 Federico Zivolo

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/package.json #######

```

{
  "name": "@popperjs/core",
  "version": "2.11.7",
  "description": "Tooltip and Popover Positioning Engine",
  "main": "dist/cjs/popper.js",
  "main:umd": "dist/umd/popper.js",
  "module": "lib/index.js",
  "unpkg": "dist/umd/popper.min.js",
  "author": "Federico Zivolo <federico.zivolo@gmail.com>",
  "license": "MIT",
  "repository": "github:popperjs/popper-core",
  "keywords": [
    "tooltip",
    "popover",
    "dropdown",
    "popup",
    "popper",
    "positioning engine"
  ],
  "funding": {
    "type": "opencollective",
    "url": "https://opencollective.com/popperjs"
  },
  "files": [
    "index.d.ts",
    "/dist",
    "/lib"
  ],
  "sideEffects": false,
  "scripts": {
    "clean": "rimraf lib && rimraf dist && rimraf test/visual/dist",
    "test": "yarn test:unit && yarn test:functional",
    "test:unit": "jest --coverage src",
    "test:functional": "DEV_PORT=`get-port` jest tests/functional",
    "test:flow": "flow",
    "test:typescript": "tsc --project tests/typescript/tsconfig.json",
    "test:eslint": "eslint .",
    "dev": "NODE_ENV=dev concurrently 'yarn serve' 'yarn build:dev --watch'",
    "serve": "serve -l ${DEV_PORT:-5000} tests/visual",
    "build": "yarn clean && yarn build:es && yarn build:esbrowser && yarn build:bundles && yarn build:flow && yarn build:typescript",
    "build:es": "babel src -d lib --ignore '**/*.test.js','**/__mocks__'",
    "build:esbrowser": "BROWSER_COMPAT=true yarn build:es -d dist/esm",
    "build:bundles": "rollup -c .config/rollup.config.js",
    "build:dev": "NODE_ENV=dev babel src -d tests/visual/dist",
    "build:flow": "flow-copy-source --ignore \"**/*.test.js\" src lib && replace-in-files --string=__DEV__ --replacement=false 'lib/**/*.flow'",
    "build:typescript": "rimraf dist/typescript; flow-to-ts \"src/**/*.js\" --write --inline-utility-types; tsc-silent --project .config/tsconfig.json --createSourceFile .config/createSourceFile.js --suppress @; rimraf \"src/**/*.ts\"",
    "prepublishOnly": "yarn build && pinst --disable",
    "prepare": "husky install .config/husky",
    "postpublish": "pinst --enable"
  },
  "prettier": {
    "semi": true,
    "trailingComma": "es5",
    "singleQuote": true,
    "proseWrap": "always"
  },
  "babel": {
    "extends": "./.config/babel.config"
  },
  "jest": {
    "preset": "./.config/jest.config"
  },
  "eslintConfig": {
    "extends": "./.config/eslint.config"
  },
  "husky": {
    "hooks": {
      "pre-commit": "pretty-quick --staged"
    }
  },
  "devDependencies": {
    "@ampproject/rollup-plugin-closure-compiler": "^0.26.0",
    "@atomico/rollup-plugin-sizes": "^1.1.4",
    "@babel/cli": "^7.12.17",
    "@babel/core": "^7.12.17",
    "@babel/plugin-transform-flow-strip-types": "^7.12.13",
    "@babel/plugin-transform-runtime": "^7.12.17",
    "@babel/preset-env": "^7.12.17",
    "@fezvrasta/tsc-silent": "^1.3.0",
    "@khanacademy/flow-to-ts": "^0.3.0",
    "@rollup/plugin-babel": "^5.3.0",
    "@rollup/plugin-replace": "^2.3.4",
    "babel-eslint": "^10.0.3",
    "babel-jest": "^26.6.3",
    "babel-plugin-add-import-extension": "^1.4.4",
    "babel-plugin-annotate-pure-calls": "^0.4.0",
    "babel-plugin-dev-expression": "^0.2.2",
    "babel-plugin-inline-replace-variables": "^1.3.1",
    "babel-plugin-transform-inline-environment-variables": "^0.4.3",
    "concurrently": "^5.3.0",
    "dotenv": "^8.2.0",
    "eslint": "^7.20.0",
    "eslint-plugin-flowtype": "^5.2.2",
    "eslint-plugin-import": "^2.22.1",
    "eslint-plugin-unused-imports": "^1.1.0",
    "flow-bin": "^0.139.0",
    "flow-copy-source": "^2.0.9",
    "get-port-cli": "^2.0.0",
    "husky": "^5.0.9",
    "jest": "^26.6.3",
    "jest-environment-jsdom-sixteen": "^1.0.3",
    "jest-environment-puppeteer": "^4.4.0",
    "jest-image-snapshot": "^4.3.0",
    "jest-puppeteer": "^4.4.0",
    "pinst": "^2.1.4",
    "poster": "^0.0.9",
    "prettier": "^2.2.1",
    "pretty-quick": "^3.1.0",
    "puppeteer": "^10.4.0",
    "replace-in-files-cli": "^1.0.0",
    "rollup": "^2.39.0",
    "rollup-plugin-flow-entry": "^0.3.3",
    "rollup-plugin-license": "^2.2.0",
    "rollup-plugin-terser": "^7.0.2",
    "rollup-plugin-visualizer": "^4.2.0",
    "serve": "^11.3.2",
    "typescript": "^4.1.5"
  }
}

```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/@popperjs/core/README.md #######

<!-- <HEADER> // IGNORE IT -->
<p align="center">
  <img src="https://rawcdn.githack.com/popperjs/popper-core/8805a5d7599e14619c9e7ac19a3713285d8e5d7f/docs/src/images/popper-logo-outlined.svg" alt="Popper" height="300px"/>
</p>

<div align="center">
  <h1>Tooltip & Popover Positioning Engine</h1>
</div>

<p align="center">
  <a href="https://www.npmjs.com/package/@popperjs/core">
    <img src="https://img.shields.io/npm/v/@popperjs/core?style=for-the-badge" alt="npm version" />
  </a>
  <a href="https://www.npmjs.com/package/@popperjs/core">
    <img src="https://img.shields.io/endpoint?style=for-the-badge&url=https://runkit.io/fezvrasta/combined-npm-downloads/1.0.0?packages=popper.js,@popperjs/core" alt="npm downloads per month (popper.js + @popperjs/core)" />
  </a>
  <a href="https://rollingversions.com/popperjs/popper-core">
    <img src="https://img.shields.io/badge/Rolling%20Versions-Enabled-brightgreen?style=for-the-badge" alt="Rolling Versions" />
  </a>
</p>

<br />
<!-- </HEADER> // NOW BEGINS THE README -->

**Positioning tooltips and popovers is difficult. Popper is here to help!**

Given an element, such as a button, and a tooltip element describing it, Popper
will automatically put the tooltip in the right place near the button.

It will position _any_ UI element that "pops out" from the flow of your document
and floats near a target element. The most common example is a tooltip, but it
also includes popovers, drop-downs, and more. All of these can be generically
described as a "popper" element.

## Demo

[![Popper visualized](https://i.imgur.com/F7qWsmV.jpg)](https://popper.js.org)

## Docs

- [v2.x (latest)](https://popper.js.org/docs/v2/)
- [v1.x](https://popper.js.org/docs/v1/)

We've created a
[Migration Guide](https://popper.js.org/docs/v2/migration-guide/) to help you
migrate from Popper 1 to Popper 2.

To contribute to the Popper website and documentation, please visit the
[dedicated repository](https://github.com/popperjs/website).

## Why not use pure CSS?

- **Clipping and overflow issues**: Pure CSS poppers will not be prevented from
  overflowing clipping boundaries, such as the viewport. It will get partially
  cut off or overflows if it's near the edge since there is no dynamic
  positioning logic. When using Popper, your popper will always be positioned in
  the right place without needing manual adjustments.
- **No flipping**: CSS poppers will not flip to a different placement to fit
  better in view if necessary. While you can manually adjust for the main axis
  overflow, this feature cannot be achieved via CSS alone. Popper automatically
  flips the tooltip to make it fit in view as best as possible for the user.
- **No virtual positioning**: CSS poppers cannot follow the mouse cursor or be
  used as a context menu. Popper allows you to position your tooltip relative to
  any coordinates you desire.
- **Slower development cycle**: When pure CSS is used to position popper
  elements, the lack of dynamic positioning means they must be carefully placed
  to consider overflow on all screen sizes. In reusable component libraries,
  this means a developer can't just add the component anywhere on the page,
  because these issues need to be considered and adjusted for every time. With
  Popper, you can place your elements anywhere and they will be positioned
  correctly, without needing to consider different screen sizes, layouts, etc.
  This massively speeds up development time because this work is automatically
  offloaded to Popper.
- **Lack of extensibility**: CSS poppers cannot be easily extended to fit any
  arbitrary use case you may need to adjust for. Popper is built with
  extensibility in mind.

## Why Popper?

With the CSS drawbacks out of the way, we now move on to Popper in the
JavaScript space itself.

Naive JavaScript tooltip implementations usually have the following problems:

- **Scrolling containers**: They don't ensure the tooltip stays with the
  reference element while scrolling when inside any number of scrolling
  containers.
- **DOM context**: They often require the tooltip move outside of its original
  DOM context because they don't handle `offsetParent` contexts.
- **Compatibility**: Popper handles an incredible number of edge cases regarding
  different browsers and environments (mobile viewports, RTL, scrollbars enabled
  or disabled, etc.). Popper is a popular and well-maintained library, so you
  can be confident positioning will work for your users on any device.
- **Configurability**: They often lack advanced configurability to suit any
  possible use case.
- **Size**: They are usually relatively large in size, or require an ancient
  jQuery dependency.
- **Performance**: They often have runtime performance issues and update the
  tooltip position too slowly.

**Popper solves all of these key problems in an elegant, performant manner.** It
is a lightweight ~3 kB library that aims to provide a reliable and extensible
positioning engine you can use to ensure all your popper elements are positioned
in the right place.

When you start writing your own popper implementation, you'll quickly run into
all of the problems mentioned above. These widgets are incredibly common in our
UIs; we've done the hard work figuring this out so you don't need to spend hours
fixing and handling numerous edge cases that we already ran into while building
the library!

Popper is used in popular libraries like Bootstrap, Foundation, Material UI, and
more. It's likely you've already used popper elements on the web positioned by
Popper at some point in the past few years.

Since we write UIs using powerful abstraction libraries such as React or Angular
nowadays, you'll also be glad to know Popper can fully integrate with them and
be a good citizen together with your other components. Check out `react-popper`
for the official Popper wrapper for React.

## Installation

### 1. Package Manager

```bash
# With npm
npm i @popperjs/core

# With Yarn
yarn add @popperjs/core
```

### 2. CDN

```html
<!-- Development version -->
<script src="https://unpkg.com/@popperjs/core@2/dist/umd/popper.js"></script>

<!-- Production version -->
<script src="https://unpkg.com/@popperjs/core@2"></script>
```

### 3. Direct Download?

Managing dependencies by "directly downloading" them and placing them into your
source code is not recommended for a variety of reasons, including missing out
on feat/fix updates easily. Please use a versioning management system like a CDN
or npm/Yarn.

## Usage

The most straightforward way to get started is to import Popper from the `unpkg`
CDN, which includes all of its features. You can call the `Popper.createPopper`
constructor to create new popper instances.

Here is a complete example:

```html
<!DOCTYPE html>
<title>Popper example</title>

<style>
  #tooltip {
    background-color: #333;
    color: white;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 13px;
  }
</style>

<button id="button" aria-describedby="tooltip">I'm a button</button>
<div id="tooltip" role="tooltip">I'm a tooltip</div>

<script src="https://unpkg.com/@popperjs/core@^2.0.0"></script>
<script>
  const button = document.querySelector('#button');
  const tooltip = document.querySelector('#tooltip');

  // Pass the button, the tooltip, and some options, and Popper will do the
  // magic positioning for you:
  Popper.createPopper(button, tooltip, {
    placement: 'right',
  });
</script>
```

Visit the [tutorial](https://popper.js.org/docs/v2/tutorial/) for an example of
how to build your own tooltip from scratch using Popper.

### Module bundlers

You can import the `createPopper` constructor from the fully-featured file:

```js
import { createPopper } from '@popperjs/core';

const button = document.querySelector('#button');
const tooltip = document.querySelector('#tooltip');

// Pass the button, the tooltip, and some options, and Popper will do the
// magic positioning for you:
createPopper(button, tooltip, {
  placement: 'right',
});
```

All the modifiers listed in the docs menu will be enabled and "just work", so
you don't need to think about setting Popper up. The size of Popper including
all of its features is about 5 kB minzipped, but it may grow a bit in the
future.

#### Popper Lite (tree-shaking)

If bundle size is important, you'll want to take advantage of tree-shaking. The
library is built in a modular way to allow to import only the parts you really
need.

```js
import { createPopperLite as createPopper } from '@popperjs/core';
```

The Lite version includes the most necessary modifiers that will compute the
offsets of the popper, compute and add the positioning styles, and add event
listeners. This is close in bundle size to pure CSS tooltip libraries, and
behaves somewhat similarly.

However, this does not include the features that makes Popper truly useful.

The two most useful modifiers not included in Lite are `preventOverflow` and
`flip`:

```js
import {
  createPopperLite as createPopper,
  preventOverflow,
  flip,
} from '@popperjs/core';

const button = document.querySelector('#button');
const tooltip = document.querySelector('#tooltip');

createPopper(button, tooltip, {
  modifiers: [preventOverflow, flip],
});
```

As you make more poppers, you may be finding yourself needing other modifiers
provided by the library.

See [tree-shaking](https://popper.js.org/docs/v2/performance/#tree-shaking) for more
information.

## Distribution targets

Popper is distributed in 3 different versions, in 3 different file formats.

The 3 file formats are:

- `esm` (works with `import` syntax — **recommended**)
- `umd` (works with `<script>` tags or RequireJS)
- `cjs` (works with `require()` syntax)

There are two different `esm` builds, one for bundler consumers (e.g. webpack,
Rollup, etc..), which is located under `/lib`, and one for browsers with native
support for ES Modules, under `/dist/esm`. The only difference within the two,
is that the browser-compatible version doesn't make use of
`process.env.NODE_ENV` to run development checks.

The 3 versions are:

- `popper`: includes all the modifiers (features) in one file (**default**);
- `popper-lite`: includes only the minimum amount of modifiers to provide the
  basic functionality;
- `popper-base`: doesn't include any modifier, you must import them separately;

Below you can find the size of each version, minified and compressed with the
[Brotli compression algorithm](https://medium.com/groww-engineering/enable-brotli-compression-in-webpack-with-fallback-to-gzip-397a57cf9fc6):

<!-- Don't change the labels to use hyphens, it breaks, even when encoded -->

![](https://badge-size.now.sh/https://unpkg.com/@popperjs/core/dist/umd/popper.min.js?compression=brotli&label=popper)
![](https://badge-size.now.sh/https://unpkg.com/@popperjs/core/dist/umd/popper-lite.min.js?compression=brotli&label=popper%20lite)
![](https://badge-size.now.sh/https://unpkg.com/@popperjs/core/dist/umd/popper-base.min.js?compression=brotli&label=popper%20base)

## Hacking the library

If you want to play with the library, implement new features, fix a bug you
found, or simply experiment with it, this section is for you!

First of all, make sure to have
[Yarn installed](https://yarnpkg.com/lang/en/docs/install).

Install the development dependencies:

```bash
yarn install
```

And run the development environment:

```bash
yarn dev
```

Then, simply open one the development server web page:

```bash
# macOS and Linux
open localhost:5000

# Windows
start localhost:5000
```

From there, you can open any of the examples (`.html` files) to fiddle with
them.

Now any change you will made to the source code, will be automatically compiled,
you just need to refresh the page.

If the page is not working properly, try to go in _"Developer Tools >
Application > Clear storage"_ and click on "_Clear site data_".  
To run the examples you need a browser with
[JavaScript modules via script tag support](https://caniuse.com/#feat=es6-module).

## Test Suite

Popper is currently tested with unit tests, and functional tests. Both of them
are run by Jest.

### Unit Tests

The unit tests use JSDOM to provide a primitive document object API, they are
used to ensure the utility functions behave as expected in isolation.

### Functional Tests

The functional tests run with Puppeteer, to take advantage of a complete browser
environment. They are currently running on Chromium, and Firefox.

You can run them with `yarn test:functional`. Set the `PUPPETEER_BROWSER`
environment variable to `firefox` to run them on the Mozilla browser.

The assertions are written in form of image snapshots, so that it's easy to
assert for the correct Popper behavior without having to write a lot of offsets
comparisons manually.

You can mark a `*.test.js` file to run in the Puppeteer environment by
prepending a `@jest-environment puppeteer` JSDoc comment to the interested file.

Here's an example of a basic functional test:

```js
/**
 * @jest-environment puppeteer
 * @flow
 */
import { screenshot } from '../utils/puppeteer.js';

it('should position the popper on the right', async () => {
  const page = await browser.newPage();
  await page.goto(`${TEST_URL}/basic.html`);

  expect(await screenshot(page)).toMatchImageSnapshot();
});
```

You can find the complete
[`jest-puppeteer` documentation here](https://github.com/smooth-code/jest-puppeteer#api),
and the
[`jest-image-snapshot` documentation here](https://github.com/americanexpress/jest-image-snapshot#%EF%B8%8F-api).

## License

MIT

####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/dist/tippy.css #######

```

.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;white-space:normal;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/dist/tippy.esm.js #######

```

/**!
* tippy.js v6.3.7
* (c) 2017-2021 atomiks
* MIT License
*/
import { createPopper, applyStyles } from '@popperjs/core';

var ROUND_ARROW = '<svg width="16" height="6" xmlns="http://www.w3.org/2000/svg"><path d="M0 6s1.796-.013 4.67-3.615C5.851.9 6.93.006 8 0c1.07-.006 2.148.887 3.343 2.385C14.233 6.005 16 6 16 6H0z"></svg>';
var BOX_CLASS = "tippy-box";
var CONTENT_CLASS = "tippy-content";
var BACKDROP_CLASS = "tippy-backdrop";
var ARROW_CLASS = "tippy-arrow";
var SVG_ARROW_CLASS = "tippy-svg-arrow";
var TOUCH_OPTIONS = {
  passive: true,
  capture: true
};
var TIPPY_DEFAULT_APPEND_TO = function TIPPY_DEFAULT_APPEND_TO() {
  return document.body;
};

function hasOwnProperty(obj, key) {
  return {}.hasOwnProperty.call(obj, key);
}
function getValueAtIndexOrReturn(value, index, defaultValue) {
  if (Array.isArray(value)) {
    var v = value[index];
    return v == null ? Array.isArray(defaultValue) ? defaultValue[index] : defaultValue : v;
  }

  return value;
}
function isType(value, type) {
  var str = {}.toString.call(value);
  return str.indexOf('[object') === 0 && str.indexOf(type + "]") > -1;
}
function invokeWithArgsOrReturn(value, args) {
  return typeof value === 'function' ? value.apply(void 0, args) : value;
}
function debounce(fn, ms) {
  // Avoid wrapping in `setTimeout` if ms is 0 anyway
  if (ms === 0) {
    return fn;
  }

  var timeout;
  return function (arg) {
    clearTimeout(timeout);
    timeout = setTimeout(function () {
      fn(arg);
    }, ms);
  };
}
function removeProperties(obj, keys) {
  var clone = Object.assign({}, obj);
  keys.forEach(function (key) {
    delete clone[key];
  });
  return clone;
}
function splitBySpaces(value) {
  return value.split(/\s+/).filter(Boolean);
}
function normalizeToArray(value) {
  return [].concat(value);
}
function pushIfUnique(arr, value) {
  if (arr.indexOf(value) === -1) {
    arr.push(value);
  }
}
function unique(arr) {
  return arr.filter(function (item, index) {
    return arr.indexOf(item) === index;
  });
}
function getBasePlacement(placement) {
  return placement.split('-')[0];
}
function arrayFrom(value) {
  return [].slice.call(value);
}
function removeUndefinedProps(obj) {
  return Object.keys(obj).reduce(function (acc, key) {
    if (obj[key] !== undefined) {
      acc[key] = obj[key];
    }

    return acc;
  }, {});
}

function div() {
  return document.createElement('div');
}
function isElement(value) {
  return ['Element', 'Fragment'].some(function (type) {
    return isType(value, type);
  });
}
function isNodeList(value) {
  return isType(value, 'NodeList');
}
function isMouseEvent(value) {
  return isType(value, 'MouseEvent');
}
function isReferenceElement(value) {
  return !!(value && value._tippy && value._tippy.reference === value);
}
function getArrayOfElements(value) {
  if (isElement(value)) {
    return [value];
  }

  if (isNodeList(value)) {
    return arrayFrom(value);
  }

  if (Array.isArray(value)) {
    return value;
  }

  return arrayFrom(document.querySelectorAll(value));
}
function setTransitionDuration(els, value) {
  els.forEach(function (el) {
    if (el) {
      el.style.transitionDuration = value + "ms";
    }
  });
}
function setVisibilityState(els, state) {
  els.forEach(function (el) {
    if (el) {
      el.setAttribute('data-state', state);
    }
  });
}
function getOwnerDocument(elementOrElements) {
  var _element$ownerDocumen;

  var _normalizeToArray = normalizeToArray(elementOrElements),
      element = _normalizeToArray[0]; // Elements created via a <template> have an ownerDocument with no reference to the body


  return element != null && (_element$ownerDocumen = element.ownerDocument) != null && _element$ownerDocumen.body ? element.ownerDocument : document;
}
function isCursorOutsideInteractiveBorder(popperTreeData, event) {
  var clientX = event.clientX,
      clientY = event.clientY;
  return popperTreeData.every(function (_ref) {
    var popperRect = _ref.popperRect,
        popperState = _ref.popperState,
        props = _ref.props;
    var interactiveBorder = props.interactiveBorder;
    var basePlacement = getBasePlacement(popperState.placement);
    var offsetData = popperState.modifiersData.offset;

    if (!offsetData) {
      return true;
    }

    var topDistance = basePlacement === 'bottom' ? offsetData.top.y : 0;
    var bottomDistance = basePlacement === 'top' ? offsetData.bottom.y : 0;
    var leftDistance = basePlacement === 'right' ? offsetData.left.x : 0;
    var rightDistance = basePlacement === 'left' ? offsetData.right.x : 0;
    var exceedsTop = popperRect.top - clientY + topDistance > interactiveBorder;
    var exceedsBottom = clientY - popperRect.bottom - bottomDistance > interactiveBorder;
    var exceedsLeft = popperRect.left - clientX + leftDistance > interactiveBorder;
    var exceedsRight = clientX - popperRect.right - rightDistance > interactiveBorder;
    return exceedsTop || exceedsBottom || exceedsLeft || exceedsRight;
  });
}
function updateTransitionEndListener(box, action, listener) {
  var method = action + "EventListener"; // some browsers apparently support `transition` (unprefixed) but only fire
  // `webkitTransitionEnd`...

  ['transitionend', 'webkitTransitionEnd'].forEach(function (event) {
    box[method](event, listener);
  });
}
/**
 * Compared to xxx.contains, this function works for dom structures with shadow
 * dom
 */

function actualContains(parent, child) {
  var target = child;

  while (target) {
    var _target$getRootNode;

    if (parent.contains(target)) {
      return true;
    }

    target = target.getRootNode == null ? void 0 : (_target$getRootNode = target.getRootNode()) == null ? void 0 : _target$getRootNode.host;
  }

  return false;
}

var currentInput = {
  isTouch: false
};
var lastMouseMoveTime = 0;
/**
 * When a `touchstart` event is fired, it's assumed the user is using touch
 * input. We'll bind a `mousemove` event listener to listen for mouse input in
 * the future. This way, the `isTouch` property is fully dynamic and will handle
 * hybrid devices that use a mix of touch + mouse input.
 */

function onDocumentTouchStart() {
  if (currentInput.isTouch) {
    return;
  }

  currentInput.isTouch = true;

  if (window.performance) {
    document.addEventListener('mousemove', onDocumentMouseMove);
  }
}
/**
 * When two `mousemove` event are fired consecutively within 20ms, it's assumed
 * the user is using mouse input again. `mousemove` can fire on touch devices as
 * well, but very rarely that quickly.
 */

function onDocumentMouseMove() {
  var now = performance.now();

  if (now - lastMouseMoveTime < 20) {
    currentInput.isTouch = false;
    document.removeEventListener('mousemove', onDocumentMouseMove);
  }

  lastMouseMoveTime = now;
}
/**
 * When an element is in focus and has a tippy, leaving the tab/window and
 * returning causes it to show again. For mouse users this is unexpected, but
 * for keyboard use it makes sense.
 * TODO: find a better technique to solve this problem
 */

function onWindowBlur() {
  var activeElement = document.activeElement;

  if (isReferenceElement(activeElement)) {
    var instance = activeElement._tippy;

    if (activeElement.blur && !instance.state.isVisible) {
      activeElement.blur();
    }
  }
}
function bindGlobalEventListeners() {
  document.addEventListener('touchstart', onDocumentTouchStart, TOUCH_OPTIONS);
  window.addEventListener('blur', onWindowBlur);
}

var isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined';
var isIE11 = isBrowser ? // @ts-ignore
!!window.msCrypto : false;

function createMemoryLeakWarning(method) {
  var txt = method === 'destroy' ? 'n already-' : ' ';
  return [method + "() was called on a" + txt + "destroyed instance. This is a no-op but", 'indicates a potential memory leak.'].join(' ');
}
function clean(value) {
  var spacesAndTabs = /[ \t]{2,}/g;
  var lineStartWithSpaces = /^[ \t]*/gm;
  return value.replace(spacesAndTabs, ' ').replace(lineStartWithSpaces, '').trim();
}

function getDevMessage(message) {
  return clean("\n  %ctippy.js\n\n  %c" + clean(message) + "\n\n  %c\uD83D\uDC77\u200D This is a development-only message. It will be removed in production.\n  ");
}

function getFormattedMessage(message) {
  return [getDevMessage(message), // title
  'color: #00C584; font-size: 1.3em; font-weight: bold;', // message
  'line-height: 1.5', // footer
  'color: #a6a095;'];
} // Assume warnings and errors never have the same message

var visitedMessages;

if (process.env.NODE_ENV !== "production") {
  resetVisitedMessages();
}

function resetVisitedMessages() {
  visitedMessages = new Set();
}
function warnWhen(condition, message) {
  if (condition && !visitedMessages.has(message)) {
    var _console;

    visitedMessages.add(message);

    (_console = console).warn.apply(_console, getFormattedMessage(message));
  }
}
function errorWhen(condition, message) {
  if (condition && !visitedMessages.has(message)) {
    var _console2;

    visitedMessages.add(message);

    (_console2 = console).error.apply(_console2, getFormattedMessage(message));
  }
}
function validateTargets(targets) {
  var didPassFalsyValue = !targets;
  var didPassPlainObject = Object.prototype.toString.call(targets) === '[object Object]' && !targets.addEventListener;
  errorWhen(didPassFalsyValue, ['tippy() was passed', '`' + String(targets) + '`', 'as its targets (first) argument. Valid types are: String, Element,', 'Element[], or NodeList.'].join(' '));
  errorWhen(didPassPlainObject, ['tippy() was passed a plain object which is not supported as an argument', 'for virtual positioning. Use props.getReferenceClientRect instead.'].join(' '));
}

var pluginProps = {
  animateFill: false,
  followCursor: false,
  inlinePositioning: false,
  sticky: false
};
var renderProps = {
  allowHTML: false,
  animation: 'fade',
  arrow: true,
  content: '',
  inertia: false,
  maxWidth: 350,
  role: 'tooltip',
  theme: '',
  zIndex: 9999
};
var defaultProps = Object.assign({
  appendTo: TIPPY_DEFAULT_APPEND_TO,
  aria: {
    content: 'auto',
    expanded: 'auto'
  },
  delay: 0,
  duration: [300, 250],
  getReferenceClientRect: null,
  hideOnClick: true,
  ignoreAttributes: false,
  interactive: false,
  interactiveBorder: 2,
  interactiveDebounce: 0,
  moveTransition: '',
  offset: [0, 10],
  onAfterUpdate: function onAfterUpdate() {},
  onBeforeUpdate: function onBeforeUpdate() {},
  onCreate: function onCreate() {},
  onDestroy: function onDestroy() {},
  onHidden: function onHidden() {},
  onHide: function onHide() {},
  onMount: function onMount() {},
  onShow: function onShow() {},
  onShown: function onShown() {},
  onTrigger: function onTrigger() {},
  onUntrigger: function onUntrigger() {},
  onClickOutside: function onClickOutside() {},
  placement: 'top',
  plugins: [],
  popperOptions: {},
  render: null,
  showOnCreate: false,
  touch: true,
  trigger: 'mouseenter focus',
  triggerTarget: null
}, pluginProps, renderProps);
var defaultKeys = Object.keys(defaultProps);
var setDefaultProps = function setDefaultProps(partialProps) {
  /* istanbul ignore else */
  if (process.env.NODE_ENV !== "production") {
    validateProps(partialProps, []);
  }

  var keys = Object.keys(partialProps);
  keys.forEach(function (key) {
    defaultProps[key] = partialProps[key];
  });
};
function getExtendedPassedProps(passedProps) {
  var plugins = passedProps.plugins || [];
  var pluginProps = plugins.reduce(function (acc, plugin) {
    var name = plugin.name,
        defaultValue = plugin.defaultValue;

    if (name) {
      var _name;

      acc[name] = passedProps[name] !== undefined ? passedProps[name] : (_name = defaultProps[name]) != null ? _name : defaultValue;
    }

    return acc;
  }, {});
  return Object.assign({}, passedProps, pluginProps);
}
function getDataAttributeProps(reference, plugins) {
  var propKeys = plugins ? Object.keys(getExtendedPassedProps(Object.assign({}, defaultProps, {
    plugins: plugins
  }))) : defaultKeys;
  var props = propKeys.reduce(function (acc, key) {
    var valueAsString = (reference.getAttribute("data-tippy-" + key) || '').trim();

    if (!valueAsString) {
      return acc;
    }

    if (key === 'content') {
      acc[key] = valueAsString;
    } else {
      try {
        acc[key] = JSON.parse(valueAsString);
      } catch (e) {
        acc[key] = valueAsString;
      }
    }

    return acc;
  }, {});
  return props;
}
function evaluateProps(reference, props) {
  var out = Object.assign({}, props, {
    content: invokeWithArgsOrReturn(props.content, [reference])
  }, props.ignoreAttributes ? {} : getDataAttributeProps(reference, props.plugins));
  out.aria = Object.assign({}, defaultProps.aria, out.aria);
  out.aria = {
    expanded: out.aria.expanded === 'auto' ? props.interactive : out.aria.expanded,
    content: out.aria.content === 'auto' ? props.interactive ? null : 'describedby' : out.aria.content
  };
  return out;
}
function validateProps(partialProps, plugins) {
  if (partialProps === void 0) {
    partialProps = {};
  }

  if (plugins === void 0) {
    plugins = [];
  }

  var keys = Object.keys(partialProps);
  keys.forEach(function (prop) {
    var nonPluginProps = removeProperties(defaultProps, Object.keys(pluginProps));
    var didPassUnknownProp = !hasOwnProperty(nonPluginProps, prop); // Check if the prop exists in `plugins`

    if (didPassUnknownProp) {
      didPassUnknownProp = plugins.filter(function (plugin) {
        return plugin.name === prop;
      }).length === 0;
    }

    warnWhen(didPassUnknownProp, ["`" + prop + "`", "is not a valid prop. You may have spelled it incorrectly, or if it's", 'a plugin, forgot to pass it in an array as props.plugins.', '\n\n', 'All props: https://atomiks.github.io/tippyjs/v6/all-props/\n', 'Plugins: https://atomiks.github.io/tippyjs/v6/plugins/'].join(' '));
  });
}

var innerHTML = function innerHTML() {
  return 'innerHTML';
};

function dangerouslySetInnerHTML(element, html) {
  element[innerHTML()] = html;
}

function createArrowElement(value) {
  var arrow = div();

  if (value === true) {
    arrow.className = ARROW_CLASS;
  } else {
    arrow.className = SVG_ARROW_CLASS;

    if (isElement(value)) {
      arrow.appendChild(value);
    } else {
      dangerouslySetInnerHTML(arrow, value);
    }
  }

  return arrow;
}

function setContent(content, props) {
  if (isElement(props.content)) {
    dangerouslySetInnerHTML(content, '');
    content.appendChild(props.content);
  } else if (typeof props.content !== 'function') {
    if (props.allowHTML) {
      dangerouslySetInnerHTML(content, props.content);
    } else {
      content.textContent = props.content;
    }
  }
}
function getChildren(popper) {
  var box = popper.firstElementChild;
  var boxChildren = arrayFrom(box.children);
  return {
    box: box,
    content: boxChildren.find(function (node) {
      return node.classList.contains(CONTENT_CLASS);
    }),
    arrow: boxChildren.find(function (node) {
      return node.classList.contains(ARROW_CLASS) || node.classList.contains(SVG_ARROW_CLASS);
    }),
    backdrop: boxChildren.find(function (node) {
      return node.classList.contains(BACKDROP_CLASS);
    })
  };
}
function render(instance) {
  var popper = div();
  var box = div();
  box.className = BOX_CLASS;
  box.setAttribute('data-state', 'hidden');
  box.setAttribute('tabindex', '-1');
  var content = div();
  content.className = CONTENT_CLASS;
  content.setAttribute('data-state', 'hidden');
  setContent(content, instance.props);
  popper.appendChild(box);
  box.appendChild(content);
  onUpdate(instance.props, instance.props);

  function onUpdate(prevProps, nextProps) {
    var _getChildren = getChildren(popper),
        box = _getChildren.box,
        content = _getChildren.content,
        arrow = _getChildren.arrow;

    if (nextProps.theme) {
      box.setAttribute('data-theme', nextProps.theme);
    } else {
      box.removeAttribute('data-theme');
    }

    if (typeof nextProps.animation === 'string') {
      box.setAttribute('data-animation', nextProps.animation);
    } else {
      box.removeAttribute('data-animation');
    }

    if (nextProps.inertia) {
      box.setAttribute('data-inertia', '');
    } else {
      box.removeAttribute('data-inertia');
    }

    box.style.maxWidth = typeof nextProps.maxWidth === 'number' ? nextProps.maxWidth + "px" : nextProps.maxWidth;

    if (nextProps.role) {
      box.setAttribute('role', nextProps.role);
    } else {
      box.removeAttribute('role');
    }

    if (prevProps.content !== nextProps.content || prevProps.allowHTML !== nextProps.allowHTML) {
      setContent(content, instance.props);
    }

    if (nextProps.arrow) {
      if (!arrow) {
        box.appendChild(createArrowElement(nextProps.arrow));
      } else if (prevProps.arrow !== nextProps.arrow) {
        box.removeChild(arrow);
        box.appendChild(createArrowElement(nextProps.arrow));
      }
    } else if (arrow) {
      box.removeChild(arrow);
    }
  }

  return {
    popper: popper,
    onUpdate: onUpdate
  };
} // Runtime check to identify if the render function is the default one; this
// way we can apply default CSS transitions logic and it can be tree-shaken away

render.$$tippy = true;

var idCounter = 1;
var mouseMoveListeners = []; // Used by `hideAll()`

var mountedInstances = [];
function createTippy(reference, passedProps) {
  var props = evaluateProps(reference, Object.assign({}, defaultProps, getExtendedPassedProps(removeUndefinedProps(passedProps)))); // ===========================================================================
  // 🔒 Private members
  // ===========================================================================

  var showTimeout;
  var hideTimeout;
  var scheduleHideAnimationFrame;
  var isVisibleFromClick = false;
  var didHideDueToDocumentMouseDown = false;
  var didTouchMove = false;
  var ignoreOnFirstUpdate = false;
  var lastTriggerEvent;
  var currentTransitionEndListener;
  var onFirstUpdate;
  var listeners = [];
  var debouncedOnMouseMove = debounce(onMouseMove, props.interactiveDebounce);
  var currentTarget; // ===========================================================================
  // 🔑 Public members
  // ===========================================================================

  var id = idCounter++;
  var popperInstance = null;
  var plugins = unique(props.plugins);
  var state = {
    // Is the instance currently enabled?
    isEnabled: true,
    // Is the tippy currently showing and not transitioning out?
    isVisible: false,
    // Has the instance been destroyed?
    isDestroyed: false,
    // Is the tippy currently mounted to the DOM?
    isMounted: false,
    // Has the tippy finished transitioning in?
    isShown: false
  };
  var instance = {
    // properties
    id: id,
    reference: reference,
    popper: div(),
    popperInstance: popperInstance,
    props: props,
    state: state,
    plugins: plugins,
    // methods
    clearDelayTimeouts: clearDelayTimeouts,
    setProps: setProps,
    setContent: setContent,
    show: show,
    hide: hide,
    hideWithInteractivity: hideWithInteractivity,
    enable: enable,
    disable: disable,
    unmount: unmount,
    destroy: destroy
  }; // TODO: Investigate why this early return causes a TDZ error in the tests —
  // it doesn't seem to happen in the browser

  /* istanbul ignore if */

  if (!props.render) {
    if (process.env.NODE_ENV !== "production") {
      errorWhen(true, 'render() function has not been supplied.');
    }

    return instance;
  } // ===========================================================================
  // Initial mutations
  // ===========================================================================


  var _props$render = props.render(instance),
      popper = _props$render.popper,
      onUpdate = _props$render.onUpdate;

  popper.setAttribute('data-tippy-root', '');
  popper.id = "tippy-" + instance.id;
  instance.popper = popper;
  reference._tippy = instance;
  popper._tippy = instance;
  var pluginsHooks = plugins.map(function (plugin) {
    return plugin.fn(instance);
  });
  var hasAriaExpanded = reference.hasAttribute('aria-expanded');
  addListeners();
  handleAriaExpandedAttribute();
  handleStyles();
  invokeHook('onCreate', [instance]);

  if (props.showOnCreate) {
    scheduleShow();
  } // Prevent a tippy with a delay from hiding if the cursor left then returned
  // before it started hiding


  popper.addEventListener('mouseenter', function () {
    if (instance.props.interactive && instance.state.isVisible) {
      instance.clearDelayTimeouts();
    }
  });
  popper.addEventListener('mouseleave', function () {
    if (instance.props.interactive && instance.props.trigger.indexOf('mouseenter') >= 0) {
      getDocument().addEventListener('mousemove', debouncedOnMouseMove);
    }
  });
  return instance; // ===========================================================================
  // 🔒 Private methods
  // ===========================================================================

  function getNormalizedTouchSettings() {
    var touch = instance.props.touch;
    return Array.isArray(touch) ? touch : [touch, 0];
  }

  function getIsCustomTouchBehavior() {
    return getNormalizedTouchSettings()[0] === 'hold';
  }

  function getIsDefaultRenderFn() {
    var _instance$props$rende;

    // @ts-ignore
    return !!((_instance$props$rende = instance.props.render) != null && _instance$props$rende.$$tippy);
  }

  function getCurrentTarget() {
    return currentTarget || reference;
  }

  function getDocument() {
    var parent = getCurrentTarget().parentNode;
    return parent ? getOwnerDocument(parent) : document;
  }

  function getDefaultTemplateChildren() {
    return getChildren(popper);
  }

  function getDelay(isShow) {
    // For touch or keyboard input, force `0` delay for UX reasons
    // Also if the instance is mounted but not visible (transitioning out),
    // ignore delay
    if (instance.state.isMounted && !instance.state.isVisible || currentInput.isTouch || lastTriggerEvent && lastTriggerEvent.type === 'focus') {
      return 0;
    }

    return getValueAtIndexOrReturn(instance.props.delay, isShow ? 0 : 1, defaultProps.delay);
  }

  function handleStyles(fromHide) {
    if (fromHide === void 0) {
      fromHide = false;
    }

    popper.style.pointerEvents = instance.props.interactive && !fromHide ? '' : 'none';
    popper.style.zIndex = "" + instance.props.zIndex;
  }

  function invokeHook(hook, args, shouldInvokePropsHook) {
    if (shouldInvokePropsHook === void 0) {
      shouldInvokePropsHook = true;
    }

    pluginsHooks.forEach(function (pluginHooks) {
      if (pluginHooks[hook]) {
        pluginHooks[hook].apply(pluginHooks, args);
      }
    });

    if (shouldInvokePropsHook) {
      var _instance$props;

      (_instance$props = instance.props)[hook].apply(_instance$props, args);
    }
  }

  function handleAriaContentAttribute() {
    var aria = instance.props.aria;

    if (!aria.content) {
      return;
    }

    var attr = "aria-" + aria.content;
    var id = popper.id;
    var nodes = normalizeToArray(instance.props.triggerTarget || reference);
    nodes.forEach(function (node) {
      var currentValue = node.getAttribute(attr);

      if (instance.state.isVisible) {
        node.setAttribute(attr, currentValue ? currentValue + " " + id : id);
      } else {
        var nextValue = currentValue && currentValue.replace(id, '').trim();

        if (nextValue) {
          node.setAttribute(attr, nextValue);
        } else {
          node.removeAttribute(attr);
        }
      }
    });
  }

  function handleAriaExpandedAttribute() {
    if (hasAriaExpanded || !instance.props.aria.expanded) {
      return;
    }

    var nodes = normalizeToArray(instance.props.triggerTarget || reference);
    nodes.forEach(function (node) {
      if (instance.props.interactive) {
        node.setAttribute('aria-expanded', instance.state.isVisible && node === getCurrentTarget() ? 'true' : 'false');
      } else {
        node.removeAttribute('aria-expanded');
      }
    });
  }

  function cleanupInteractiveMouseListeners() {
    getDocument().removeEventListener('mousemove', debouncedOnMouseMove);
    mouseMoveListeners = mouseMoveListeners.filter(function (listener) {
      return listener !== debouncedOnMouseMove;
    });
  }

  function onDocumentPress(event) {
    // Moved finger to scroll instead of an intentional tap outside
    if (currentInput.isTouch) {
      if (didTouchMove || event.type === 'mousedown') {
        return;
      }
    }

    var actualTarget = event.composedPath && event.composedPath()[0] || event.target; // Clicked on interactive popper

    if (instance.props.interactive && actualContains(popper, actualTarget)) {
      return;
    } // Clicked on the event listeners target


    if (normalizeToArray(instance.props.triggerTarget || reference).some(function (el) {
      return actualContains(el, actualTarget);
    })) {
      if (currentInput.isTouch) {
        return;
      }

      if (instance.state.isVisible && instance.props.trigger.indexOf('click') >= 0) {
        return;
      }
    } else {
      invokeHook('onClickOutside', [instance, event]);
    }

    if (instance.props.hideOnClick === true) {
      instance.clearDelayTimeouts();
      instance.hide(); // `mousedown` event is fired right before `focus` if pressing the
      // currentTarget. This lets a tippy with `focus` trigger know that it
      // should not show

      didHideDueToDocumentMouseDown = true;
      setTimeout(function () {
        didHideDueToDocumentMouseDown = false;
      }); // The listener gets added in `scheduleShow()`, but this may be hiding it
      // before it shows, and hide()'s early bail-out behavior can prevent it
      // from being cleaned up

      if (!instance.state.isMounted) {
        removeDocumentPress();
      }
    }
  }

  function onTouchMove() {
    didTouchMove = true;
  }

  function onTouchStart() {
    didTouchMove = false;
  }

  function addDocumentPress() {
    var doc = getDocument();
    doc.addEventListener('mousedown', onDocumentPress, true);
    doc.addEventListener('touchend', onDocumentPress, TOUCH_OPTIONS);
    doc.addEventListener('touchstart', onTouchStart, TOUCH_OPTIONS);
    doc.addEventListener('touchmove', onTouchMove, TOUCH_OPTIONS);
  }

  function removeDocumentPress() {
    var doc = getDocument();
    doc.removeEventListener('mousedown', onDocumentPress, true);
    doc.removeEventListener('touchend', onDocumentPress, TOUCH_OPTIONS);
    doc.removeEventListener('touchstart', onTouchStart, TOUCH_OPTIONS);
    doc.removeEventListener('touchmove', onTouchMove, TOUCH_OPTIONS);
  }

  function onTransitionedOut(duration, callback) {
    onTransitionEnd(duration, function () {
      if (!instance.state.isVisible && popper.parentNode && popper.parentNode.contains(popper)) {
        callback();
      }
    });
  }

  function onTransitionedIn(duration, callback) {
    onTransitionEnd(duration, callback);
  }

  function onTransitionEnd(duration, callback) {
    var box = getDefaultTemplateChildren().box;

    function listener(event) {
      if (event.target === box) {
        updateTransitionEndListener(box, 'remove', listener);
        callback();
      }
    } // Make callback synchronous if duration is 0
    // `transitionend` won't fire otherwise


    if (duration === 0) {
      return callback();
    }

    updateTransitionEndListener(box, 'remove', currentTransitionEndListener);
    updateTransitionEndListener(box, 'add', listener);
    currentTransitionEndListener = listener;
  }

  function on(eventType, handler, options) {
    if (options === void 0) {
      options = false;
    }

    var nodes = normalizeToArray(instance.props.triggerTarget || reference);
    nodes.forEach(function (node) {
      node.addEventListener(eventType, handler, options);
      listeners.push({
        node: node,
        eventType: eventType,
        handler: handler,
        options: options
      });
    });
  }

  function addListeners() {
    if (getIsCustomTouchBehavior()) {
      on('touchstart', onTrigger, {
        passive: true
      });
      on('touchend', onMouseLeave, {
        passive: true
      });
    }

    splitBySpaces(instance.props.trigger).forEach(function (eventType) {
      if (eventType === 'manual') {
        return;
      }

      on(eventType, onTrigger);

      switch (eventType) {
        case 'mouseenter':
          on('mouseleave', onMouseLeave);
          break;

        case 'focus':
          on(isIE11 ? 'focusout' : 'blur', onBlurOrFocusOut);
          break;

        case 'focusin':
          on('focusout', onBlurOrFocusOut);
          break;
      }
    });
  }

  function removeListeners() {
    listeners.forEach(function (_ref) {
      var node = _ref.node,
          eventType = _ref.eventType,
          handler = _ref.handler,
          options = _ref.options;
      node.removeEventListener(eventType, handler, options);
    });
    listeners = [];
  }

  function onTrigger(event) {
    var _lastTriggerEvent;

    var shouldScheduleClickHide = false;

    if (!instance.state.isEnabled || isEventListenerStopped(event) || didHideDueToDocumentMouseDown) {
      return;
    }

    var wasFocused = ((_lastTriggerEvent = lastTriggerEvent) == null ? void 0 : _lastTriggerEvent.type) === 'focus';
    lastTriggerEvent = event;
    currentTarget = event.currentTarget;
    handleAriaExpandedAttribute();

    if (!instance.state.isVisible && isMouseEvent(event)) {
      // If scrolling, `mouseenter` events can be fired if the cursor lands
      // over a new target, but `mousemove` events don't get fired. This
      // causes interactive tooltips to get stuck open until the cursor is
      // moved
      mouseMoveListeners.forEach(function (listener) {
        return listener(event);
      });
    } // Toggle show/hide when clicking click-triggered tooltips


    if (event.type === 'click' && (instance.props.trigger.indexOf('mouseenter') < 0 || isVisibleFromClick) && instance.props.hideOnClick !== false && instance.state.isVisible) {
      shouldScheduleClickHide = true;
    } else {
      scheduleShow(event);
    }

    if (event.type === 'click') {
      isVisibleFromClick = !shouldScheduleClickHide;
    }

    if (shouldScheduleClickHide && !wasFocused) {
      scheduleHide(event);
    }
  }

  function onMouseMove(event) {
    var target = event.target;
    var isCursorOverReferenceOrPopper = getCurrentTarget().contains(target) || popper.contains(target);

    if (event.type === 'mousemove' && isCursorOverReferenceOrPopper) {
      return;
    }

    var popperTreeData = getNestedPopperTree().concat(popper).map(function (popper) {
      var _instance$popperInsta;

      var instance = popper._tippy;
      var state = (_instance$popperInsta = instance.popperInstance) == null ? void 0 : _instance$popperInsta.state;

      if (state) {
        return {
          popperRect: popper.getBoundingClientRect(),
          popperState: state,
          props: props
        };
      }

      return null;
    }).filter(Boolean);

    if (isCursorOutsideInteractiveBorder(popperTreeData, event)) {
      cleanupInteractiveMouseListeners();
      scheduleHide(event);
    }
  }

  function onMouseLeave(event) {
    var shouldBail = isEventListenerStopped(event) || instance.props.trigger.indexOf('click') >= 0 && isVisibleFromClick;

    if (shouldBail) {
      return;
    }

    if (instance.props.interactive) {
      instance.hideWithInteractivity(event);
      return;
    }

    scheduleHide(event);
  }

  function onBlurOrFocusOut(event) {
    if (instance.props.trigger.indexOf('focusin') < 0 && event.target !== getCurrentTarget()) {
      return;
    } // If focus was moved to within the popper


    if (instance.props.interactive && event.relatedTarget && popper.contains(event.relatedTarget)) {
      return;
    }

    scheduleHide(event);
  }

  function isEventListenerStopped(event) {
    return currentInput.isTouch ? getIsCustomTouchBehavior() !== event.type.indexOf('touch') >= 0 : false;
  }

  function createPopperInstance() {
    destroyPopperInstance();
    var _instance$props2 = instance.props,
        popperOptions = _instance$props2.popperOptions,
        placement = _instance$props2.placement,
        offset = _instance$props2.offset,
        getReferenceClientRect = _instance$props2.getReferenceClientRect,
        moveTransition = _instance$props2.moveTransition;
    var arrow = getIsDefaultRenderFn() ? getChildren(popper).arrow : null;
    var computedReference = getReferenceClientRect ? {
      getBoundingClientRect: getReferenceClientRect,
      contextElement: getReferenceClientRect.contextElement || getCurrentTarget()
    } : reference;
    var tippyModifier = {
      name: '$$tippy',
      enabled: true,
      phase: 'beforeWrite',
      requires: ['computeStyles'],
      fn: function fn(_ref2) {
        var state = _ref2.state;

        if (getIsDefaultRenderFn()) {
          var _getDefaultTemplateCh = getDefaultTemplateChildren(),
              box = _getDefaultTemplateCh.box;

          ['placement', 'reference-hidden', 'escaped'].forEach(function (attr) {
            if (attr === 'placement') {
              box.setAttribute('data-placement', state.placement);
            } else {
              if (state.attributes.popper["data-popper-" + attr]) {
                box.setAttribute("data-" + attr, '');
              } else {
                box.removeAttribute("data-" + attr);
              }
            }
          });
          state.attributes.popper = {};
        }
      }
    };
    var modifiers = [{
      name: 'offset',
      options: {
        offset: offset
      }
    }, {
      name: 'preventOverflow',
      options: {
        padding: {
          top: 2,
          bottom: 2,
          left: 5,
          right: 5
        }
      }
    }, {
      name: 'flip',
      options: {
        padding: 5
      }
    }, {
      name: 'computeStyles',
      options: {
        adaptive: !moveTransition
      }
    }, tippyModifier];

    if (getIsDefaultRenderFn() && arrow) {
      modifiers.push({
        name: 'arrow',
        options: {
          element: arrow,
          padding: 3
        }
      });
    }

    modifiers.push.apply(modifiers, (popperOptions == null ? void 0 : popperOptions.modifiers) || []);
    instance.popperInstance = createPopper(computedReference, popper, Object.assign({}, popperOptions, {
      placement: placement,
      onFirstUpdate: onFirstUpdate,
      modifiers: modifiers
    }));
  }

  function destroyPopperInstance() {
    if (instance.popperInstance) {
      instance.popperInstance.destroy();
      instance.popperInstance = null;
    }
  }

  function mount() {
    var appendTo = instance.props.appendTo;
    var parentNode; // By default, we'll append the popper to the triggerTargets's parentNode so
    // it's directly after the reference element so the elements inside the
    // tippy can be tabbed to
    // If there are clipping issues, the user can specify a different appendTo
    // and ensure focus management is handled correctly manually

    var node = getCurrentTarget();

    if (instance.props.interactive && appendTo === TIPPY_DEFAULT_APPEND_TO || appendTo === 'parent') {
      parentNode = node.parentNode;
    } else {
      parentNode = invokeWithArgsOrReturn(appendTo, [node]);
    } // The popper element needs to exist on the DOM before its position can be
    // updated as Popper needs to read its dimensions


    if (!parentNode.contains(popper)) {
      parentNode.appendChild(popper);
    }

    instance.state.isMounted = true;
    createPopperInstance();
    /* istanbul ignore else */

    if (process.env.NODE_ENV !== "production") {
      // Accessibility check
      warnWhen(instance.props.interactive && appendTo === defaultProps.appendTo && node.nextElementSibling !== popper, ['Interactive tippy element may not be accessible via keyboard', 'navigation because it is not directly after the reference element', 'in the DOM source order.', '\n\n', 'Using a wrapper <div> or <span> tag around the reference element', 'solves this by creating a new parentNode context.', '\n\n', 'Specifying `appendTo: document.body` silences this warning, but it', 'assumes you are using a focus management solution to handle', 'keyboard navigation.', '\n\n', 'See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity'].join(' '));
    }
  }

  function getNestedPopperTree() {
    return arrayFrom(popper.querySelectorAll('[data-tippy-root]'));
  }

  function scheduleShow(event) {
    instance.clearDelayTimeouts();

    if (event) {
      invokeHook('onTrigger', [instance, event]);
    }

    addDocumentPress();
    var delay = getDelay(true);

    var _getNormalizedTouchSe = getNormalizedTouchSettings(),
        touchValue = _getNormalizedTouchSe[0],
        touchDelay = _getNormalizedTouchSe[1];

    if (currentInput.isTouch && touchValue === 'hold' && touchDelay) {
      delay = touchDelay;
    }

    if (delay) {
      showTimeout = setTimeout(function () {
        instance.show();
      }, delay);
    } else {
      instance.show();
    }
  }

  function scheduleHide(event) {
    instance.clearDelayTimeouts();
    invokeHook('onUntrigger', [instance, event]);

    if (!instance.state.isVisible) {
      removeDocumentPress();
      return;
    } // For interactive tippies, scheduleHide is added to a document.body handler
    // from onMouseLeave so must intercept scheduled hides from mousemove/leave
    // events when trigger contains mouseenter and click, and the tip is
    // currently shown as a result of a click.


    if (instance.props.trigger.indexOf('mouseenter') >= 0 && instance.props.trigger.indexOf('click') >= 0 && ['mouseleave', 'mousemove'].indexOf(event.type) >= 0 && isVisibleFromClick) {
      return;
    }

    var delay = getDelay(false);

    if (delay) {
      hideTimeout = setTimeout(function () {
        if (instance.state.isVisible) {
          instance.hide();
        }
      }, delay);
    } else {
      // Fixes a `transitionend` problem when it fires 1 frame too
      // late sometimes, we don't want hide() to be called.
      scheduleHideAnimationFrame = requestAnimationFrame(function () {
        instance.hide();
      });
    }
  } // ===========================================================================
  // 🔑 Public methods
  // ===========================================================================


  function enable() {
    instance.state.isEnabled = true;
  }

  function disable() {
    // Disabling the instance should also hide it
    // https://github.com/atomiks/tippy.js-react/issues/106
    instance.hide();
    instance.state.isEnabled = false;
  }

  function clearDelayTimeouts() {
    clearTimeout(showTimeout);
    clearTimeout(hideTimeout);
    cancelAnimationFrame(scheduleHideAnimationFrame);
  }

  function setProps(partialProps) {
    /* istanbul ignore else */
    if (process.env.NODE_ENV !== "production") {
      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('setProps'));
    }

    if (instance.state.isDestroyed) {
      return;
    }

    invokeHook('onBeforeUpdate', [instance, partialProps]);
    removeListeners();
    var prevProps = instance.props;
    var nextProps = evaluateProps(reference, Object.assign({}, prevProps, removeUndefinedProps(partialProps), {
      ignoreAttributes: true
    }));
    instance.props = nextProps;
    addListeners();

    if (prevProps.interactiveDebounce !== nextProps.interactiveDebounce) {
      cleanupInteractiveMouseListeners();
      debouncedOnMouseMove = debounce(onMouseMove, nextProps.interactiveDebounce);
    } // Ensure stale aria-expanded attributes are removed


    if (prevProps.triggerTarget && !nextProps.triggerTarget) {
      normalizeToArray(prevProps.triggerTarget).forEach(function (node) {
        node.removeAttribute('aria-expanded');
      });
    } else if (nextProps.triggerTarget) {
      reference.removeAttribute('aria-expanded');
    }

    handleAriaExpandedAttribute();
    handleStyles();

    if (onUpdate) {
      onUpdate(prevProps, nextProps);
    }

    if (instance.popperInstance) {
      createPopperInstance(); // Fixes an issue with nested tippies if they are all getting re-rendered,
      // and the nested ones get re-rendered first.
      // https://github.com/atomiks/tippyjs-react/issues/177
      // TODO: find a cleaner / more efficient solution(!)

      getNestedPopperTree().forEach(function (nestedPopper) {
        // React (and other UI libs likely) requires a rAF wrapper as it flushes
        // its work in one
        requestAnimationFrame(nestedPopper._tippy.popperInstance.forceUpdate);
      });
    }

    invokeHook('onAfterUpdate', [instance, partialProps]);
  }

  function setContent(content) {
    instance.setProps({
      content: content
    });
  }

  function show() {
    /* istanbul ignore else */
    if (process.env.NODE_ENV !== "production") {
      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('show'));
    } // Early bail-out


    var isAlreadyVisible = instance.state.isVisible;
    var isDestroyed = instance.state.isDestroyed;
    var isDisabled = !instance.state.isEnabled;
    var isTouchAndTouchDisabled = currentInput.isTouch && !instance.props.touch;
    var duration = getValueAtIndexOrReturn(instance.props.duration, 0, defaultProps.duration);

    if (isAlreadyVisible || isDestroyed || isDisabled || isTouchAndTouchDisabled) {
      return;
    } // Normalize `disabled` behavior across browsers.
    // Firefox allows events on disabled elements, but Chrome doesn't.
    // Using a wrapper element (i.e. <span>) is recommended.


    if (getCurrentTarget().hasAttribute('disabled')) {
      return;
    }

    invokeHook('onShow', [instance], false);

    if (instance.props.onShow(instance) === false) {
      return;
    }

    instance.state.isVisible = true;

    if (getIsDefaultRenderFn()) {
      popper.style.visibility = 'visible';
    }

    handleStyles();
    addDocumentPress();

    if (!instance.state.isMounted) {
      popper.style.transition = 'none';
    } // If flipping to the opposite side after hiding at least once, the
    // animation will use the wrong placement without resetting the duration


    if (getIsDefaultRenderFn()) {
      var _getDefaultTemplateCh2 = getDefaultTemplateChildren(),
          box = _getDefaultTemplateCh2.box,
          content = _getDefaultTemplateCh2.content;

      setTransitionDuration([box, content], 0);
    }

    onFirstUpdate = function onFirstUpdate() {
      var _instance$popperInsta2;

      if (!instance.state.isVisible || ignoreOnFirstUpdate) {
        return;
      }

      ignoreOnFirstUpdate = true; // reflow

      void popper.offsetHeight;
      popper.style.transition = instance.props.moveTransition;

      if (getIsDefaultRenderFn() && instance.props.animation) {
        var _getDefaultTemplateCh3 = getDefaultTemplateChildren(),
            _box = _getDefaultTemplateCh3.box,
            _content = _getDefaultTemplateCh3.content;

        setTransitionDuration([_box, _content], duration);
        setVisibilityState([_box, _content], 'visible');
      }

      handleAriaContentAttribute();
      handleAriaExpandedAttribute();
      pushIfUnique(mountedInstances, instance); // certain modifiers (e.g. `maxSize`) require a second update after the
      // popper has been positioned for the first time

      (_instance$popperInsta2 = instance.popperInstance) == null ? void 0 : _instance$popperInsta2.forceUpdate();
      invokeHook('onMount', [instance]);

      if (instance.props.animation && getIsDefaultRenderFn()) {
        onTransitionedIn(duration, function () {
          instance.state.isShown = true;
          invokeHook('onShown', [instance]);
        });
      }
    };

    mount();
  }

  function hide() {
    /* istanbul ignore else */
    if (process.env.NODE_ENV !== "production") {
      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('hide'));
    } // Early bail-out


    var isAlreadyHidden = !instance.state.isVisible;
    var isDestroyed = instance.state.isDestroyed;
    var isDisabled = !instance.state.isEnabled;
    var duration = getValueAtIndexOrReturn(instance.props.duration, 1, defaultProps.duration);

    if (isAlreadyHidden || isDestroyed || isDisabled) {
      return;
    }

    invokeHook('onHide', [instance], false);

    if (instance.props.onHide(instance) === false) {
      return;
    }

    instance.state.isVisible = false;
    instance.state.isShown = false;
    ignoreOnFirstUpdate = false;
    isVisibleFromClick = false;

    if (getIsDefaultRenderFn()) {
      popper.style.visibility = 'hidden';
    }

    cleanupInteractiveMouseListeners();
    removeDocumentPress();
    handleStyles(true);

    if (getIsDefaultRenderFn()) {
      var _getDefaultTemplateCh4 = getDefaultTemplateChildren(),
          box = _getDefaultTemplateCh4.box,
          content = _getDefaultTemplateCh4.content;

      if (instance.props.animation) {
        setTransitionDuration([box, content], duration);
        setVisibilityState([box, content], 'hidden');
      }
    }

    handleAriaContentAttribute();
    handleAriaExpandedAttribute();

    if (instance.props.animation) {
      if (getIsDefaultRenderFn()) {
        onTransitionedOut(duration, instance.unmount);
      }
    } else {
      instance.unmount();
    }
  }

  function hideWithInteractivity(event) {
    /* istanbul ignore else */
    if (process.env.NODE_ENV !== "production") {
      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('hideWithInteractivity'));
    }

    getDocument().addEventListener('mousemove', debouncedOnMouseMove);
    pushIfUnique(mouseMoveListeners, debouncedOnMouseMove);
    debouncedOnMouseMove(event);
  }

  function unmount() {
    /* istanbul ignore else */
    if (process.env.NODE_ENV !== "production") {
      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('unmount'));
    }

    if (instance.state.isVisible) {
      instance.hide();
    }

    if (!instance.state.isMounted) {
      return;
    }

    destroyPopperInstance(); // If a popper is not interactive, it will be appended outside the popper
    // tree by default. This seems mainly for interactive tippies, but we should
    // find a workaround if possible

    getNestedPopperTree().forEach(function (nestedPopper) {
      nestedPopper._tippy.unmount();
    });

    if (popper.parentNode) {
      popper.parentNode.removeChild(popper);
    }

    mountedInstances = mountedInstances.filter(function (i) {
      return i !== instance;
    });
    instance.state.isMounted = false;
    invokeHook('onHidden', [instance]);
  }

  function destroy() {
    /* istanbul ignore else */
    if (process.env.NODE_ENV !== "production") {
      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('destroy'));
    }

    if (instance.state.isDestroyed) {
      return;
    }

    instance.clearDelayTimeouts();
    instance.unmount();
    removeListeners();
    delete reference._tippy;
    instance.state.isDestroyed = true;
    invokeHook('onDestroy', [instance]);
  }
}

function tippy(targets, optionalProps) {
  if (optionalProps === void 0) {
    optionalProps = {};
  }

  var plugins = defaultProps.plugins.concat(optionalProps.plugins || []);
  /* istanbul ignore else */

  if (process.env.NODE_ENV !== "production") {
    validateTargets(targets);
    validateProps(optionalProps, plugins);
  }

  bindGlobalEventListeners();
  var passedProps = Object.assign({}, optionalProps, {
    plugins: plugins
  });
  var elements = getArrayOfElements(targets);
  /* istanbul ignore else */

  if (process.env.NODE_ENV !== "production") {
    var isSingleContentElement = isElement(passedProps.content);
    var isMoreThanOneReferenceElement = elements.length > 1;
    warnWhen(isSingleContentElement && isMoreThanOneReferenceElement, ['tippy() was passed an Element as the `content` prop, but more than', 'one tippy instance was created by this invocation. This means the', 'content element will only be appended to the last tippy instance.', '\n\n', 'Instead, pass the .innerHTML of the element, or use a function that', 'returns a cloned version of the element instead.', '\n\n', '1) content: element.innerHTML\n', '2) content: () => element.cloneNode(true)'].join(' '));
  }

  var instances = elements.reduce(function (acc, reference) {
    var instance = reference && createTippy(reference, passedProps);

    if (instance) {
      acc.push(instance);
    }

    return acc;
  }, []);
  return isElement(targets) ? instances[0] : instances;
}

tippy.defaultProps = defaultProps;
tippy.setDefaultProps = setDefaultProps;
tippy.currentInput = currentInput;
var hideAll = function hideAll(_temp) {
  var _ref = _temp === void 0 ? {} : _temp,
      excludedReferenceOrInstance = _ref.exclude,
      duration = _ref.duration;

  mountedInstances.forEach(function (instance) {
    var isExcluded = false;

    if (excludedReferenceOrInstance) {
      isExcluded = isReferenceElement(excludedReferenceOrInstance) ? instance.reference === excludedReferenceOrInstance : instance.popper === excludedReferenceOrInstance.popper;
    }

    if (!isExcluded) {
      var originalDuration = instance.props.duration;
      instance.setProps({
        duration: duration
      });
      instance.hide();

      if (!instance.state.isDestroyed) {
        instance.setProps({
          duration: originalDuration
        });
      }
    }
  });
};

// every time the popper is destroyed (i.e. a new target), removing the styles
// and causing transitions to break for singletons when the console is open, but
// most notably for non-transform styles being used, `gpuAcceleration: false`.

var applyStylesModifier = Object.assign({}, applyStyles, {
  effect: function effect(_ref) {
    var state = _ref.state;
    var initialStyles = {
      popper: {
        position: state.options.strategy,
        left: '0',
        top: '0',
        margin: '0'
      },
      arrow: {
        position: 'absolute'
      },
      reference: {}
    };
    Object.assign(state.elements.popper.style, initialStyles.popper);
    state.styles = initialStyles;

    if (state.elements.arrow) {
      Object.assign(state.elements.arrow.style, initialStyles.arrow);
    } // intentionally return no cleanup function
    // return () => { ... }

  }
});

var createSingleton = function createSingleton(tippyInstances, optionalProps) {
  var _optionalProps$popper;

  if (optionalProps === void 0) {
    optionalProps = {};
  }

  /* istanbul ignore else */
  if (process.env.NODE_ENV !== "production") {
    errorWhen(!Array.isArray(tippyInstances), ['The first argument passed to createSingleton() must be an array of', 'tippy instances. The passed value was', String(tippyInstances)].join(' '));
  }

  var individualInstances = tippyInstances;
  var references = [];
  var triggerTargets = [];
  var currentTarget;
  var overrides = optionalProps.overrides;
  var interceptSetPropsCleanups = [];
  var shownOnCreate = false;

  function setTriggerTargets() {
    triggerTargets = individualInstances.map(function (instance) {
      return normalizeToArray(instance.props.triggerTarget || instance.reference);
    }).reduce(function (acc, item) {
      return acc.concat(item);
    }, []);
  }

  function setReferences() {
    references = individualInstances.map(function (instance) {
      return instance.reference;
    });
  }

  function enableInstances(isEnabled) {
    individualInstances.forEach(function (instance) {
      if (isEnabled) {
        instance.enable();
      } else {
        instance.disable();
      }
    });
  }

  function interceptSetProps(singleton) {
    return individualInstances.map(function (instance) {
      var originalSetProps = instance.setProps;

      instance.setProps = function (props) {
        originalSetProps(props);

        if (instance.reference === currentTarget) {
          singleton.setProps(props);
        }
      };

      return function () {
        instance.setProps = originalSetProps;
      };
    });
  } // have to pass singleton, as it maybe undefined on first call


  function prepareInstance(singleton, target) {
    var index = triggerTargets.indexOf(target); // bail-out

    if (target === currentTarget) {
      return;
    }

    currentTarget = target;
    var overrideProps = (overrides || []).concat('content').reduce(function (acc, prop) {
      acc[prop] = individualInstances[index].props[prop];
      return acc;
    }, {});
    singleton.setProps(Object.assign({}, overrideProps, {
      getReferenceClientRect: typeof overrideProps.getReferenceClientRect === 'function' ? overrideProps.getReferenceClientRect : function () {
        var _references$index;

        return (_references$index = references[index]) == null ? void 0 : _references$index.getBoundingClientRect();
      }
    }));
  }

  enableInstances(false);
  setReferences();
  setTriggerTargets();
  var plugin = {
    fn: function fn() {
      return {
        onDestroy: function onDestroy() {
          enableInstances(true);
        },
        onHidden: function onHidden() {
          currentTarget = null;
        },
        onClickOutside: function onClickOutside(instance) {
          if (instance.props.showOnCreate && !shownOnCreate) {
            shownOnCreate = true;
            currentTarget = null;
          }
        },
        onShow: function onShow(instance) {
          if (instance.props.showOnCreate && !shownOnCreate) {
            shownOnCreate = true;
            prepareInstance(instance, references[0]);
          }
        },
        onTrigger: function onTrigger(instance, event) {
          prepareInstance(instance, event.currentTarget);
        }
      };
    }
  };
  var singleton = tippy(div(), Object.assign({}, removeProperties(optionalProps, ['overrides']), {
    plugins: [plugin].concat(optionalProps.plugins || []),
    triggerTarget: triggerTargets,
    popperOptions: Object.assign({}, optionalProps.popperOptions, {
      modifiers: [].concat(((_optionalProps$popper = optionalProps.popperOptions) == null ? void 0 : _optionalProps$popper.modifiers) || [], [applyStylesModifier])
    })
  }));
  var originalShow = singleton.show;

  singleton.show = function (target) {
    originalShow(); // first time, showOnCreate or programmatic call with no params
    // default to showing first instance

    if (!currentTarget && target == null) {
      return prepareInstance(singleton, references[0]);
    } // triggered from event (do nothing as prepareInstance already called by onTrigger)
    // programmatic call with no params when already visible (do nothing again)


    if (currentTarget && target == null) {
      return;
    } // target is index of instance


    if (typeof target === 'number') {
      return references[target] && prepareInstance(singleton, references[target]);
    } // target is a child tippy instance


    if (individualInstances.indexOf(target) >= 0) {
      var ref = target.reference;
      return prepareInstance(singleton, ref);
    } // target is a ReferenceElement


    if (references.indexOf(target) >= 0) {
      return prepareInstance(singleton, target);
    }
  };

  singleton.showNext = function () {
    var first = references[0];

    if (!currentTarget) {
      return singleton.show(0);
    }

    var index = references.indexOf(currentTarget);
    singleton.show(references[index + 1] || first);
  };

  singleton.showPrevious = function () {
    var last = references[references.length - 1];

    if (!currentTarget) {
      return singleton.show(last);
    }

    var index = references.indexOf(currentTarget);
    var target = references[index - 1] || last;
    singleton.show(target);
  };

  var originalSetProps = singleton.setProps;

  singleton.setProps = function (props) {
    overrides = props.overrides || overrides;
    originalSetProps(props);
  };

  singleton.setInstances = function (nextInstances) {
    enableInstances(true);
    interceptSetPropsCleanups.forEach(function (fn) {
      return fn();
    });
    individualInstances = nextInstances;
    enableInstances(false);
    setReferences();
    setTriggerTargets();
    interceptSetPropsCleanups = interceptSetProps(singleton);
    singleton.setProps({
      triggerTarget: triggerTargets
    });
  };

  interceptSetPropsCleanups = interceptSetProps(singleton);
  return singleton;
};

var BUBBLING_EVENTS_MAP = {
  mouseover: 'mouseenter',
  focusin: 'focus',
  click: 'click'
};
/**
 * Creates a delegate instance that controls the creation of tippy instances
 * for child elements (`target` CSS selector).
 */

function delegate(targets, props) {
  /* istanbul ignore else */
  if (process.env.NODE_ENV !== "production") {
    errorWhen(!(props && props.target), ['You must specity a `target` prop indicating a CSS selector string matching', 'the target elements that should receive a tippy.'].join(' '));
  }

  var listeners = [];
  var childTippyInstances = [];
  var disabled = false;
  var target = props.target;
  var nativeProps = removeProperties(props, ['target']);
  var parentProps = Object.assign({}, nativeProps, {
    trigger: 'manual',
    touch: false
  });
  var childProps = Object.assign({
    touch: defaultProps.touch
  }, nativeProps, {
    showOnCreate: true
  });
  var returnValue = tippy(targets, parentProps);
  var normalizedReturnValue = normalizeToArray(returnValue);

  function onTrigger(event) {
    if (!event.target || disabled) {
      return;
    }

    var targetNode = event.target.closest(target);

    if (!targetNode) {
      return;
    } // Get relevant trigger with fallbacks:
    // 1. Check `data-tippy-trigger` attribute on target node
    // 2. Fallback to `trigger` passed to `delegate()`
    // 3. Fallback to `defaultProps.trigger`


    var trigger = targetNode.getAttribute('data-tippy-trigger') || props.trigger || defaultProps.trigger; // @ts-ignore

    if (targetNode._tippy) {
      return;
    }

    if (event.type === 'touchstart' && typeof childProps.touch === 'boolean') {
      return;
    }

    if (event.type !== 'touchstart' && trigger.indexOf(BUBBLING_EVENTS_MAP[event.type]) < 0) {
      return;
    }

    var instance = tippy(targetNode, childProps);

    if (instance) {
      childTippyInstances = childTippyInstances.concat(instance);
    }
  }

  function on(node, eventType, handler, options) {
    if (options === void 0) {
      options = false;
    }

    node.addEventListener(eventType, handler, options);
    listeners.push({
      node: node,
      eventType: eventType,
      handler: handler,
      options: options
    });
  }

  function addEventListeners(instance) {
    var reference = instance.reference;
    on(reference, 'touchstart', onTrigger, TOUCH_OPTIONS);
    on(reference, 'mouseover', onTrigger);
    on(reference, 'focusin', onTrigger);
    on(reference, 'click', onTrigger);
  }

  function removeEventListeners() {
    listeners.forEach(function (_ref) {
      var node = _ref.node,
          eventType = _ref.eventType,
          handler = _ref.handler,
          options = _ref.options;
      node.removeEventListener(eventType, handler, options);
    });
    listeners = [];
  }

  function applyMutations(instance) {
    var originalDestroy = instance.destroy;
    var originalEnable = instance.enable;
    var originalDisable = instance.disable;

    instance.destroy = function (shouldDestroyChildInstances) {
      if (shouldDestroyChildInstances === void 0) {
        shouldDestroyChildInstances = true;
      }

      if (shouldDestroyChildInstances) {
        childTippyInstances.forEach(function (instance) {
          instance.destroy();
        });
      }

      childTippyInstances = [];
      removeEventListeners();
      originalDestroy();
    };

    instance.enable = function () {
      originalEnable();
      childTippyInstances.forEach(function (instance) {
        return instance.enable();
      });
      disabled = false;
    };

    instance.disable = function () {
      originalDisable();
      childTippyInstances.forEach(function (instance) {
        return instance.disable();
      });
      disabled = true;
    };

    addEventListeners(instance);
  }

  normalizedReturnValue.forEach(applyMutations);
  return returnValue;
}

var animateFill = {
  name: 'animateFill',
  defaultValue: false,
  fn: function fn(instance) {
    var _instance$props$rende;

    // @ts-ignore
    if (!((_instance$props$rende = instance.props.render) != null && _instance$props$rende.$$tippy)) {
      if (process.env.NODE_ENV !== "production") {
        errorWhen(instance.props.animateFill, 'The `animateFill` plugin requires the default render function.');
      }

      return {};
    }

    var _getChildren = getChildren(instance.popper),
        box = _getChildren.box,
        content = _getChildren.content;

    var backdrop = instance.props.animateFill ? createBackdropElement() : null;
    return {
      onCreate: function onCreate() {
        if (backdrop) {
          box.insertBefore(backdrop, box.firstElementChild);
          box.setAttribute('data-animatefill', '');
          box.style.overflow = 'hidden';
          instance.setProps({
            arrow: false,
            animation: 'shift-away'
          });
        }
      },
      onMount: function onMount() {
        if (backdrop) {
          var transitionDuration = box.style.transitionDuration;
          var duration = Number(transitionDuration.replace('ms', '')); // The content should fade in after the backdrop has mostly filled the
          // tooltip element. `clip-path` is the other alternative but is not
          // well-supported and is buggy on some devices.

          content.style.transitionDelay = Math.round(duration / 10) + "ms";
          backdrop.style.transitionDuration = transitionDuration;
          setVisibilityState([backdrop], 'visible');
        }
      },
      onShow: function onShow() {
        if (backdrop) {
          backdrop.style.transitionDuration = '0ms';
        }
      },
      onHide: function onHide() {
        if (backdrop) {
          setVisibilityState([backdrop], 'hidden');
        }
      }
    };
  }
};

function createBackdropElement() {
  var backdrop = div();
  backdrop.className = BACKDROP_CLASS;
  setVisibilityState([backdrop], 'hidden');
  return backdrop;
}

var mouseCoords = {
  clientX: 0,
  clientY: 0
};
var activeInstances = [];

function storeMouseCoords(_ref) {
  var clientX = _ref.clientX,
      clientY = _ref.clientY;
  mouseCoords = {
    clientX: clientX,
    clientY: clientY
  };
}

function addMouseCoordsListener(doc) {
  doc.addEventListener('mousemove', storeMouseCoords);
}

function removeMouseCoordsListener(doc) {
  doc.removeEventListener('mousemove', storeMouseCoords);
}

var followCursor = {
  name: 'followCursor',
  defaultValue: false,
  fn: function fn(instance) {
    var reference = instance.reference;
    var doc = getOwnerDocument(instance.props.triggerTarget || reference);
    var isInternalUpdate = false;
    var wasFocusEvent = false;
    var isUnmounted = true;
    var prevProps = instance.props;

    function getIsInitialBehavior() {
      return instance.props.followCursor === 'initial' && instance.state.isVisible;
    }

    function addListener() {
      doc.addEventListener('mousemove', onMouseMove);
    }

    function removeListener() {
      doc.removeEventListener('mousemove', onMouseMove);
    }

    function unsetGetReferenceClientRect() {
      isInternalUpdate = true;
      instance.setProps({
        getReferenceClientRect: null
      });
      isInternalUpdate = false;
    }

    function onMouseMove(event) {
      // If the instance is interactive, avoid updating the position unless it's
      // over the reference element
      var isCursorOverReference = event.target ? reference.contains(event.target) : true;
      var followCursor = instance.props.followCursor;
      var clientX = event.clientX,
          clientY = event.clientY;
      var rect = reference.getBoundingClientRect();
      var relativeX = clientX - rect.left;
      var relativeY = clientY - rect.top;

      if (isCursorOverReference || !instance.props.interactive) {
        instance.setProps({
          // @ts-ignore - unneeded DOMRect properties
          getReferenceClientRect: function getReferenceClientRect() {
            var rect = reference.getBoundingClientRect();
            var x = clientX;
            var y = clientY;

            if (followCursor === 'initial') {
              x = rect.left + relativeX;
              y = rect.top + relativeY;
            }

            var top = followCursor === 'horizontal' ? rect.top : y;
            var right = followCursor === 'vertical' ? rect.right : x;
            var bottom = followCursor === 'horizontal' ? rect.bottom : y;
            var left = followCursor === 'vertical' ? rect.left : x;
            return {
              width: right - left,
              height: bottom - top,
              top: top,
              right: right,
              bottom: bottom,
              left: left
            };
          }
        });
      }
    }

    function create() {
      if (instance.props.followCursor) {
        activeInstances.push({
          instance: instance,
          doc: doc
        });
        addMouseCoordsListener(doc);
      }
    }

    function destroy() {
      activeInstances = activeInstances.filter(function (data) {
        return data.instance !== instance;
      });

      if (activeInstances.filter(function (data) {
        return data.doc === doc;
      }).length === 0) {
        removeMouseCoordsListener(doc);
      }
    }

    return {
      onCreate: create,
      onDestroy: destroy,
      onBeforeUpdate: function onBeforeUpdate() {
        prevProps = instance.props;
      },
      onAfterUpdate: function onAfterUpdate(_, _ref2) {
        var followCursor = _ref2.followCursor;

        if (isInternalUpdate) {
          return;
        }

        if (followCursor !== undefined && prevProps.followCursor !== followCursor) {
          destroy();

          if (followCursor) {
            create();

            if (instance.state.isMounted && !wasFocusEvent && !getIsInitialBehavior()) {
              addListener();
            }
          } else {
            removeListener();
            unsetGetReferenceClientRect();
          }
        }
      },
      onMount: function onMount() {
        if (instance.props.followCursor && !wasFocusEvent) {
          if (isUnmounted) {
            onMouseMove(mouseCoords);
            isUnmounted = false;
          }

          if (!getIsInitialBehavior()) {
            addListener();
          }
        }
      },
      onTrigger: function onTrigger(_, event) {
        if (isMouseEvent(event)) {
          mouseCoords = {
            clientX: event.clientX,
            clientY: event.clientY
          };
        }

        wasFocusEvent = event.type === 'focus';
      },
      onHidden: function onHidden() {
        if (instance.props.followCursor) {
          unsetGetReferenceClientRect();
          removeListener();
          isUnmounted = true;
        }
      }
    };
  }
};

function getProps(props, modifier) {
  var _props$popperOptions;

  return {
    popperOptions: Object.assign({}, props.popperOptions, {
      modifiers: [].concat((((_props$popperOptions = props.popperOptions) == null ? void 0 : _props$popperOptions.modifiers) || []).filter(function (_ref) {
        var name = _ref.name;
        return name !== modifier.name;
      }), [modifier])
    })
  };
}

var inlinePositioning = {
  name: 'inlinePositioning',
  defaultValue: false,
  fn: function fn(instance) {
    var reference = instance.reference;

    function isEnabled() {
      return !!instance.props.inlinePositioning;
    }

    var placement;
    var cursorRectIndex = -1;
    var isInternalUpdate = false;
    var triedPlacements = [];
    var modifier = {
      name: 'tippyInlinePositioning',
      enabled: true,
      phase: 'afterWrite',
      fn: function fn(_ref2) {
        var state = _ref2.state;

        if (isEnabled()) {
          if (triedPlacements.indexOf(state.placement) !== -1) {
            triedPlacements = [];
          }

          if (placement !== state.placement && triedPlacements.indexOf(state.placement) === -1) {
            triedPlacements.push(state.placement);
            instance.setProps({
              // @ts-ignore - unneeded DOMRect properties
              getReferenceClientRect: function getReferenceClientRect() {
                return _getReferenceClientRect(state.placement);
              }
            });
          }

          placement = state.placement;
        }
      }
    };

    function _getReferenceClientRect(placement) {
      return getInlineBoundingClientRect(getBasePlacement(placement), reference.getBoundingClientRect(), arrayFrom(reference.getClientRects()), cursorRectIndex);
    }

    function setInternalProps(partialProps) {
      isInternalUpdate = true;
      instance.setProps(partialProps);
      isInternalUpdate = false;
    }

    function addModifier() {
      if (!isInternalUpdate) {
        setInternalProps(getProps(instance.props, modifier));
      }
    }

    return {
      onCreate: addModifier,
      onAfterUpdate: addModifier,
      onTrigger: function onTrigger(_, event) {
        if (isMouseEvent(event)) {
          var rects = arrayFrom(instance.reference.getClientRects());
          var cursorRect = rects.find(function (rect) {
            return rect.left - 2 <= event.clientX && rect.right + 2 >= event.clientX && rect.top - 2 <= event.clientY && rect.bottom + 2 >= event.clientY;
          });
          var index = rects.indexOf(cursorRect);
          cursorRectIndex = index > -1 ? index : cursorRectIndex;
        }
      },
      onHidden: function onHidden() {
        cursorRectIndex = -1;
      }
    };
  }
};
function getInlineBoundingClientRect(currentBasePlacement, boundingRect, clientRects, cursorRectIndex) {
  // Not an inline element, or placement is not yet known
  if (clientRects.length < 2 || currentBasePlacement === null) {
    return boundingRect;
  } // There are two rects and they are disjoined


  if (clientRects.length === 2 && cursorRectIndex >= 0 && clientRects[0].left > clientRects[1].right) {
    return clientRects[cursorRectIndex] || boundingRect;
  }

  switch (currentBasePlacement) {
    case 'top':
    case 'bottom':
      {
        var firstRect = clientRects[0];
        var lastRect = clientRects[clientRects.length - 1];
        var isTop = currentBasePlacement === 'top';
        var top = firstRect.top;
        var bottom = lastRect.bottom;
        var left = isTop ? firstRect.left : lastRect.left;
        var right = isTop ? firstRect.right : lastRect.right;
        var width = right - left;
        var height = bottom - top;
        return {
          top: top,
          bottom: bottom,
          left: left,
          right: right,
          width: width,
          height: height
        };
      }

    case 'left':
    case 'right':
      {
        var minLeft = Math.min.apply(Math, clientRects.map(function (rects) {
          return rects.left;
        }));
        var maxRight = Math.max.apply(Math, clientRects.map(function (rects) {
          return rects.right;
        }));
        var measureRects = clientRects.filter(function (rect) {
          return currentBasePlacement === 'left' ? rect.left === minLeft : rect.right === maxRight;
        });
        var _top = measureRects[0].top;
        var _bottom = measureRects[measureRects.length - 1].bottom;
        var _left = minLeft;
        var _right = maxRight;

        var _width = _right - _left;

        var _height = _bottom - _top;

        return {
          top: _top,
          bottom: _bottom,
          left: _left,
          right: _right,
          width: _width,
          height: _height
        };
      }

    default:
      {
        return boundingRect;
      }
  }
}

var sticky = {
  name: 'sticky',
  defaultValue: false,
  fn: function fn(instance) {
    var reference = instance.reference,
        popper = instance.popper;

    function getReference() {
      return instance.popperInstance ? instance.popperInstance.state.elements.reference : reference;
    }

    function shouldCheck(value) {
      return instance.props.sticky === true || instance.props.sticky === value;
    }

    var prevRefRect = null;
    var prevPopRect = null;

    function updatePosition() {
      var currentRefRect = shouldCheck('reference') ? getReference().getBoundingClientRect() : null;
      var currentPopRect = shouldCheck('popper') ? popper.getBoundingClientRect() : null;

      if (currentRefRect && areRectsDifferent(prevRefRect, currentRefRect) || currentPopRect && areRectsDifferent(prevPopRect, currentPopRect)) {
        if (instance.popperInstance) {
          instance.popperInstance.update();
        }
      }

      prevRefRect = currentRefRect;
      prevPopRect = currentPopRect;

      if (instance.state.isMounted) {
        requestAnimationFrame(updatePosition);
      }
    }

    return {
      onMount: function onMount() {
        if (instance.props.sticky) {
          updatePosition();
        }
      }
    };
  }
};

function areRectsDifferent(rectA, rectB) {
  if (rectA && rectB) {
    return rectA.top !== rectB.top || rectA.right !== rectB.right || rectA.bottom !== rectB.bottom || rectA.left !== rectB.left;
  }

  return true;
}

tippy.setDefaultProps({
  render: render
});

export default tippy;
export { animateFill, createSingleton, delegate, followCursor, hideAll, inlinePositioning, ROUND_ARROW as roundArrow, sticky };
//# sourceMappingURL=tippy.esm.js.map

```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/dist/tippy.esm.js.map #######

```

{"version":3,"file":"tippy.esm.js","sources":["../src/constants.ts","../src/utils.ts","../src/dom-utils.ts","../src/bindGlobalEventListeners.ts","../src/browser.ts","../src/validation.ts","../src/props.ts","../src/template.ts","../src/createTippy.ts","../src/index.ts","../src/addons/createSingleton.ts","../src/addons/delegate.ts","../src/plugins/animateFill.ts","../src/plugins/followCursor.ts","../src/plugins/inlinePositioning.ts","../src/plugins/sticky.ts","../build/base.js"],"sourcesContent":["export const ROUND_ARROW =\n  '<svg width=\"16\" height=\"6\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0 6s1.796-.013 4.67-3.615C5.851.9 6.93.006 8 0c1.07-.006 2.148.887 3.343 2.385C14.233 6.005 16 6 16 6H0z\"></svg>';\n\nexport const BOX_CLASS = `__NAMESPACE_PREFIX__-box`;\nexport const CONTENT_CLASS = `__NAMESPACE_PREFIX__-content`;\nexport const BACKDROP_CLASS = `__NAMESPACE_PREFIX__-backdrop`;\nexport const ARROW_CLASS = `__NAMESPACE_PREFIX__-arrow`;\nexport const SVG_ARROW_CLASS = `__NAMESPACE_PREFIX__-svg-arrow`;\n\nexport const TOUCH_OPTIONS = {passive: true, capture: true};\n\nexport const TIPPY_DEFAULT_APPEND_TO = () => document.body;\n","import {BasePlacement, Placement} from './types';\n\nexport function hasOwnProperty(\n  obj: Record<string, unknown>,\n  key: string\n): boolean {\n  return {}.hasOwnProperty.call(obj, key);\n}\n\nexport function getValueAtIndexOrReturn<T>(\n  value: T | [T | null, T | null],\n  index: number,\n  defaultValue: T | [T, T]\n): T {\n  if (Array.isArray(value)) {\n    const v = value[index];\n    return v == null\n      ? Array.isArray(defaultValue)\n        ? defaultValue[index]\n        : defaultValue\n      : v;\n  }\n\n  return value;\n}\n\nexport function isType(value: any, type: string): boolean {\n  const str = {}.toString.call(value);\n  return str.indexOf('[object') === 0 && str.indexOf(`${type}]`) > -1;\n}\n\nexport function invokeWithArgsOrReturn(value: any, args: any[]): any {\n  return typeof value === 'function' ? value(...args) : value;\n}\n\nexport function debounce<T>(\n  fn: (arg: T) => void,\n  ms: number\n): (arg: T) => void {\n  // Avoid wrapping in `setTimeout` if ms is 0 anyway\n  if (ms === 0) {\n    return fn;\n  }\n\n  let timeout: any;\n\n  return (arg): void => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => {\n      fn(arg);\n    }, ms);\n  };\n}\n\nexport function removeProperties<T>(obj: T, keys: string[]): Partial<T> {\n  const clone = {...obj};\n  keys.forEach((key) => {\n    delete (clone as any)[key];\n  });\n  return clone;\n}\n\nexport function splitBySpaces(value: string): string[] {\n  return value.split(/\\s+/).filter(Boolean);\n}\n\nexport function normalizeToArray<T>(value: T | T[]): T[] {\n  return ([] as T[]).concat(value);\n}\n\nexport function pushIfUnique<T>(arr: T[], value: T): void {\n  if (arr.indexOf(value) === -1) {\n    arr.push(value);\n  }\n}\n\nexport function appendPxIfNumber(value: string | number): string {\n  return typeof value === 'number' ? `${value}px` : value;\n}\n\nexport function unique<T>(arr: T[]): T[] {\n  return arr.filter((item, index) => arr.indexOf(item) === index);\n}\n\nexport function getNumber(value: string | number): number {\n  return typeof value === 'number' ? value : parseFloat(value);\n}\n\nexport function getBasePlacement(placement: Placement): BasePlacement {\n  return placement.split('-')[0] as BasePlacement;\n}\n\nexport function arrayFrom(value: ArrayLike<any>): any[] {\n  return [].slice.call(value);\n}\n\nexport function removeUndefinedProps(\n  obj: Record<string, unknown>\n): Partial<Record<string, unknown>> {\n  return Object.keys(obj).reduce((acc, key) => {\n    if (obj[key] !== undefined) {\n      (acc as any)[key] = obj[key];\n    }\n\n    return acc;\n  }, {});\n}\n","import {ReferenceElement, Targets} from './types';\nimport {PopperTreeData} from './types-internal';\nimport {arrayFrom, isType, normalizeToArray, getBasePlacement} from './utils';\n\nexport function div(): HTMLDivElement {\n  return document.createElement('div');\n}\n\nexport function isElement(value: unknown): value is Element | DocumentFragment {\n  return ['Element', 'Fragment'].some((type) => isType(value, type));\n}\n\nexport function isNodeList(value: unknown): value is NodeList {\n  return isType(value, 'NodeList');\n}\n\nexport function isMouseEvent(value: unknown): value is MouseEvent {\n  return isType(value, 'MouseEvent');\n}\n\nexport function isReferenceElement(value: any): value is ReferenceElement {\n  return !!(value && value._tippy && value._tippy.reference === value);\n}\n\nexport function getArrayOfElements(value: Targets): Element[] {\n  if (isElement(value)) {\n    return [value];\n  }\n\n  if (isNodeList(value)) {\n    return arrayFrom(value);\n  }\n\n  if (Array.isArray(value)) {\n    return value;\n  }\n\n  return arrayFrom(document.querySelectorAll(value));\n}\n\nexport function setTransitionDuration(\n  els: (HTMLDivElement | null)[],\n  value: number\n): void {\n  els.forEach((el) => {\n    if (el) {\n      el.style.transitionDuration = `${value}ms`;\n    }\n  });\n}\n\nexport function setVisibilityState(\n  els: (HTMLDivElement | null)[],\n  state: 'visible' | 'hidden'\n): void {\n  els.forEach((el) => {\n    if (el) {\n      el.setAttribute('data-state', state);\n    }\n  });\n}\n\nexport function getOwnerDocument(\n  elementOrElements: Element | Element[]\n): Document {\n  const [element] = normalizeToArray(elementOrElements);\n\n  // Elements created via a <template> have an ownerDocument with no reference to the body\n  return element?.ownerDocument?.body ? element.ownerDocument : document;\n}\n\nexport function isCursorOutsideInteractiveBorder(\n  popperTreeData: PopperTreeData[],\n  event: MouseEvent\n): boolean {\n  const {clientX, clientY} = event;\n\n  return popperTreeData.every(({popperRect, popperState, props}) => {\n    const {interactiveBorder} = props;\n    const basePlacement = getBasePlacement(popperState.placement);\n    const offsetData = popperState.modifiersData.offset;\n\n    if (!offsetData) {\n      return true;\n    }\n\n    const topDistance = basePlacement === 'bottom' ? offsetData.top!.y : 0;\n    const bottomDistance = basePlacement === 'top' ? offsetData.bottom!.y : 0;\n    const leftDistance = basePlacement === 'right' ? offsetData.left!.x : 0;\n    const rightDistance = basePlacement === 'left' ? offsetData.right!.x : 0;\n\n    const exceedsTop =\n      popperRect.top - clientY + topDistance > interactiveBorder;\n    const exceedsBottom =\n      clientY - popperRect.bottom - bottomDistance > interactiveBorder;\n    const exceedsLeft =\n      popperRect.left - clientX + leftDistance > interactiveBorder;\n    const exceedsRight =\n      clientX - popperRect.right - rightDistance > interactiveBorder;\n\n    return exceedsTop || exceedsBottom || exceedsLeft || exceedsRight;\n  });\n}\n\nexport function updateTransitionEndListener(\n  box: HTMLDivElement,\n  action: 'add' | 'remove',\n  listener: (event: TransitionEvent) => void\n): void {\n  const method = `${action}EventListener` as\n    | 'addEventListener'\n    | 'removeEventListener';\n\n  // some browsers apparently support `transition` (unprefixed) but only fire\n  // `webkitTransitionEnd`...\n  ['transitionend', 'webkitTransitionEnd'].forEach((event) => {\n    box[method](event, listener as EventListener);\n  });\n}\n\n/**\n * Compared to xxx.contains, this function works for dom structures with shadow\n * dom\n */\nexport function actualContains(parent: Element, child: Element): boolean {\n  let target = child;\n  while (target) {\n    if (parent.contains(target)) {\n      return true;\n    }\n    target = (target.getRootNode?.() as any)?.host;\n  }\n  return false;\n}\n","import {TOUCH_OPTIONS} from './constants';\nimport {isReferenceElement} from './dom-utils';\n\nexport const currentInput = {isTouch: false};\nlet lastMouseMoveTime = 0;\n\n/**\n * When a `touchstart` event is fired, it's assumed the user is using touch\n * input. We'll bind a `mousemove` event listener to listen for mouse input in\n * the future. This way, the `isTouch` property is fully dynamic and will handle\n * hybrid devices that use a mix of touch + mouse input.\n */\nexport function onDocumentTouchStart(): void {\n  if (currentInput.isTouch) {\n    return;\n  }\n\n  currentInput.isTouch = true;\n\n  if (window.performance) {\n    document.addEventListener('mousemove', onDocumentMouseMove);\n  }\n}\n\n/**\n * When two `mousemove` event are fired consecutively within 20ms, it's assumed\n * the user is using mouse input again. `mousemove` can fire on touch devices as\n * well, but very rarely that quickly.\n */\nexport function onDocumentMouseMove(): void {\n  const now = performance.now();\n\n  if (now - lastMouseMoveTime < 20) {\n    currentInput.isTouch = false;\n\n    document.removeEventListener('mousemove', onDocumentMouseMove);\n  }\n\n  lastMouseMoveTime = now;\n}\n\n/**\n * When an element is in focus and has a tippy, leaving the tab/window and\n * returning causes it to show again. For mouse users this is unexpected, but\n * for keyboard use it makes sense.\n * TODO: find a better technique to solve this problem\n */\nexport function onWindowBlur(): void {\n  const activeElement = document.activeElement as HTMLElement | null;\n\n  if (isReferenceElement(activeElement)) {\n    const instance = activeElement._tippy!;\n\n    if (activeElement.blur && !instance.state.isVisible) {\n      activeElement.blur();\n    }\n  }\n}\n\nexport default function bindGlobalEventListeners(): void {\n  document.addEventListener('touchstart', onDocumentTouchStart, TOUCH_OPTIONS);\n  window.addEventListener('blur', onWindowBlur);\n}\n","export const isBrowser =\n  typeof window !== 'undefined' && typeof document !== 'undefined';\n\nexport const isIE11 = isBrowser\n  ? // @ts-ignore\n    !!window.msCrypto\n  : false;\n","import {Targets} from './types';\n\nexport function createMemoryLeakWarning(method: string): string {\n  const txt = method === 'destroy' ? 'n already-' : ' ';\n\n  return [\n    `${method}() was called on a${txt}destroyed instance. This is a no-op but`,\n    'indicates a potential memory leak.',\n  ].join(' ');\n}\n\nexport function clean(value: string): string {\n  const spacesAndTabs = /[ \\t]{2,}/g;\n  const lineStartWithSpaces = /^[ \\t]*/gm;\n\n  return value\n    .replace(spacesAndTabs, ' ')\n    .replace(lineStartWithSpaces, '')\n    .trim();\n}\n\nfunction getDevMessage(message: string): string {\n  return clean(`\n  %ctippy.js\n\n  %c${clean(message)}\n\n  %c👷‍ This is a development-only message. It will be removed in production.\n  `);\n}\n\nexport function getFormattedMessage(message: string): string[] {\n  return [\n    getDevMessage(message),\n    // title\n    'color: #00C584; font-size: 1.3em; font-weight: bold;',\n    // message\n    'line-height: 1.5',\n    // footer\n    'color: #a6a095;',\n  ];\n}\n\n// Assume warnings and errors never have the same message\nlet visitedMessages: Set<string>;\nif (__DEV__) {\n  resetVisitedMessages();\n}\n\nexport function resetVisitedMessages(): void {\n  visitedMessages = new Set();\n}\n\nexport function warnWhen(condition: boolean, message: string): void {\n  if (condition && !visitedMessages.has(message)) {\n    visitedMessages.add(message);\n    console.warn(...getFormattedMessage(message));\n  }\n}\n\nexport function errorWhen(condition: boolean, message: string): void {\n  if (condition && !visitedMessages.has(message)) {\n    visitedMessages.add(message);\n    console.error(...getFormattedMessage(message));\n  }\n}\n\nexport function validateTargets(targets: Targets): void {\n  const didPassFalsyValue = !targets;\n  const didPassPlainObject =\n    Object.prototype.toString.call(targets) === '[object Object]' &&\n    !(targets as any).addEventListener;\n\n  errorWhen(\n    didPassFalsyValue,\n    [\n      'tippy() was passed',\n      '`' + String(targets) + '`',\n      'as its targets (first) argument. Valid types are: String, Element,',\n      'Element[], or NodeList.',\n    ].join(' ')\n  );\n\n  errorWhen(\n    didPassPlainObject,\n    [\n      'tippy() was passed a plain object which is not supported as an argument',\n      'for virtual positioning. Use props.getReferenceClientRect instead.',\n    ].join(' ')\n  );\n}\n","import {DefaultProps, Plugin, Props, ReferenceElement, Tippy} from './types';\nimport {\n  hasOwnProperty,\n  removeProperties,\n  invokeWithArgsOrReturn,\n} from './utils';\nimport {warnWhen} from './validation';\nimport {TIPPY_DEFAULT_APPEND_TO} from './constants';\n\nconst pluginProps = {\n  animateFill: false,\n  followCursor: false,\n  inlinePositioning: false,\n  sticky: false,\n};\n\nconst renderProps = {\n  allowHTML: false,\n  animation: 'fade',\n  arrow: true,\n  content: '',\n  inertia: false,\n  maxWidth: 350,\n  role: 'tooltip',\n  theme: '',\n  zIndex: 9999,\n};\n\nexport const defaultProps: DefaultProps = {\n  appendTo: TIPPY_DEFAULT_APPEND_TO,\n  aria: {\n    content: 'auto',\n    expanded: 'auto',\n  },\n  delay: 0,\n  duration: [300, 250],\n  getReferenceClientRect: null,\n  hideOnClick: true,\n  ignoreAttributes: false,\n  interactive: false,\n  interactiveBorder: 2,\n  interactiveDebounce: 0,\n  moveTransition: '',\n  offset: [0, 10],\n  onAfterUpdate() {},\n  onBeforeUpdate() {},\n  onCreate() {},\n  onDestroy() {},\n  onHidden() {},\n  onHide() {},\n  onMount() {},\n  onShow() {},\n  onShown() {},\n  onTrigger() {},\n  onUntrigger() {},\n  onClickOutside() {},\n  placement: 'top',\n  plugins: [],\n  popperOptions: {},\n  render: null,\n  showOnCreate: false,\n  touch: true,\n  trigger: 'mouseenter focus',\n  triggerTarget: null,\n  ...pluginProps,\n  ...renderProps,\n};\n\nconst defaultKeys = Object.keys(defaultProps);\n\nexport const setDefaultProps: Tippy['setDefaultProps'] = (partialProps) => {\n  /* istanbul ignore else */\n  if (__DEV__) {\n    validateProps(partialProps, []);\n  }\n\n  const keys = Object.keys(partialProps) as Array<keyof DefaultProps>;\n  keys.forEach((key) => {\n    (defaultProps as any)[key] = partialProps[key];\n  });\n};\n\nexport function getExtendedPassedProps(\n  passedProps: Partial<Props> & Record<string, unknown>\n): Partial<Props> {\n  const plugins = passedProps.plugins || [];\n  const pluginProps = plugins.reduce<Record<string, unknown>>((acc, plugin) => {\n    const {name, defaultValue} = plugin;\n\n    if (name) {\n      acc[name] =\n        passedProps[name] !== undefined\n          ? passedProps[name]\n          : (defaultProps as any)[name] ?? defaultValue;\n    }\n\n    return acc;\n  }, {});\n\n  return {\n    ...passedProps,\n    ...pluginProps,\n  };\n}\n\nexport function getDataAttributeProps(\n  reference: ReferenceElement,\n  plugins: Plugin[]\n): Record<string, unknown> {\n  const propKeys = plugins\n    ? Object.keys(getExtendedPassedProps({...defaultProps, plugins}))\n    : defaultKeys;\n\n  const props = propKeys.reduce(\n    (acc: Partial<Props> & Record<string, unknown>, key) => {\n      const valueAsString = (\n        reference.getAttribute(`data-tippy-${key}`) || ''\n      ).trim();\n\n      if (!valueAsString) {\n        return acc;\n      }\n\n      if (key === 'content') {\n        acc[key] = valueAsString;\n      } else {\n        try {\n          acc[key] = JSON.parse(valueAsString);\n        } catch (e) {\n          acc[key] = valueAsString;\n        }\n      }\n\n      return acc;\n    },\n    {}\n  );\n\n  return props;\n}\n\nexport function evaluateProps(\n  reference: ReferenceElement,\n  props: Props\n): Props {\n  const out = {\n    ...props,\n    content: invokeWithArgsOrReturn(props.content, [reference]),\n    ...(props.ignoreAttributes\n      ? {}\n      : getDataAttributeProps(reference, props.plugins)),\n  };\n\n  out.aria = {\n    ...defaultProps.aria,\n    ...out.aria,\n  };\n\n  out.aria = {\n    expanded:\n      out.aria.expanded === 'auto' ? props.interactive : out.aria.expanded,\n    content:\n      out.aria.content === 'auto'\n        ? props.interactive\n          ? null\n          : 'describedby'\n        : out.aria.content,\n  };\n\n  return out;\n}\n\nexport function validateProps(\n  partialProps: Partial<Props> = {},\n  plugins: Plugin[] = []\n): void {\n  const keys = Object.keys(partialProps) as Array<keyof Props>;\n  keys.forEach((prop) => {\n    const nonPluginProps = removeProperties(\n      defaultProps,\n      Object.keys(pluginProps)\n    );\n\n    let didPassUnknownProp = !hasOwnProperty(nonPluginProps, prop);\n\n    // Check if the prop exists in `plugins`\n    if (didPassUnknownProp) {\n      didPassUnknownProp =\n        plugins.filter((plugin) => plugin.name === prop).length === 0;\n    }\n\n    warnWhen(\n      didPassUnknownProp,\n      [\n        `\\`${prop}\\``,\n        \"is not a valid prop. You may have spelled it incorrectly, or if it's\",\n        'a plugin, forgot to pass it in an array as props.plugins.',\n        '\\n\\n',\n        'All props: https://atomiks.github.io/tippyjs/v6/all-props/\\n',\n        'Plugins: https://atomiks.github.io/tippyjs/v6/plugins/',\n      ].join(' ')\n    );\n  });\n}\n","import {\n  ARROW_CLASS,\n  BACKDROP_CLASS,\n  BOX_CLASS,\n  CONTENT_CLASS,\n  SVG_ARROW_CLASS,\n} from './constants';\nimport {div, isElement} from './dom-utils';\nimport {Instance, PopperElement, Props} from './types';\nimport {PopperChildren} from './types-internal';\nimport {arrayFrom} from './utils';\n\n// Firefox extensions don't allow .innerHTML = \"...\" property. This tricks it.\nconst innerHTML = (): 'innerHTML' => 'innerHTML';\n\nfunction dangerouslySetInnerHTML(element: Element, html: string): void {\n  element[innerHTML()] = html;\n}\n\nfunction createArrowElement(value: Props['arrow']): HTMLDivElement {\n  const arrow = div();\n\n  if (value === true) {\n    arrow.className = ARROW_CLASS;\n  } else {\n    arrow.className = SVG_ARROW_CLASS;\n\n    if (isElement(value)) {\n      arrow.appendChild(value);\n    } else {\n      dangerouslySetInnerHTML(arrow, value as string);\n    }\n  }\n\n  return arrow;\n}\n\nexport function setContent(content: HTMLDivElement, props: Props): void {\n  if (isElement(props.content)) {\n    dangerouslySetInnerHTML(content, '');\n    content.appendChild(props.content);\n  } else if (typeof props.content !== 'function') {\n    if (props.allowHTML) {\n      dangerouslySetInnerHTML(content, props.content);\n    } else {\n      content.textContent = props.content;\n    }\n  }\n}\n\nexport function getChildren(popper: PopperElement): PopperChildren {\n  const box = popper.firstElementChild as HTMLDivElement;\n  const boxChildren = arrayFrom(box.children);\n\n  return {\n    box,\n    content: boxChildren.find((node) => node.classList.contains(CONTENT_CLASS)),\n    arrow: boxChildren.find(\n      (node) =>\n        node.classList.contains(ARROW_CLASS) ||\n        node.classList.contains(SVG_ARROW_CLASS)\n    ),\n    backdrop: boxChildren.find((node) =>\n      node.classList.contains(BACKDROP_CLASS)\n    ),\n  };\n}\n\nexport function render(\n  instance: Instance\n): {\n  popper: PopperElement;\n  onUpdate?: (prevProps: Props, nextProps: Props) => void;\n} {\n  const popper = div();\n\n  const box = div();\n  box.className = BOX_CLASS;\n  box.setAttribute('data-state', 'hidden');\n  box.setAttribute('tabindex', '-1');\n\n  const content = div();\n  content.className = CONTENT_CLASS;\n  content.setAttribute('data-state', 'hidden');\n\n  setContent(content, instance.props);\n\n  popper.appendChild(box);\n  box.appendChild(content);\n\n  onUpdate(instance.props, instance.props);\n\n  function onUpdate(prevProps: Props, nextProps: Props): void {\n    const {box, content, arrow} = getChildren(popper);\n\n    if (nextProps.theme) {\n      box.setAttribute('data-theme', nextProps.theme);\n    } else {\n      box.removeAttribute('data-theme');\n    }\n\n    if (typeof nextProps.animation === 'string') {\n      box.setAttribute('data-animation', nextProps.animation);\n    } else {\n      box.removeAttribute('data-animation');\n    }\n\n    if (nextProps.inertia) {\n      box.setAttribute('data-inertia', '');\n    } else {\n      box.removeAttribute('data-inertia');\n    }\n\n    box.style.maxWidth =\n      typeof nextProps.maxWidth === 'number'\n        ? `${nextProps.maxWidth}px`\n        : nextProps.maxWidth;\n\n    if (nextProps.role) {\n      box.setAttribute('role', nextProps.role);\n    } else {\n      box.removeAttribute('role');\n    }\n\n    if (\n      prevProps.content !== nextProps.content ||\n      prevProps.allowHTML !== nextProps.allowHTML\n    ) {\n      setContent(content, instance.props);\n    }\n\n    if (nextProps.arrow) {\n      if (!arrow) {\n        box.appendChild(createArrowElement(nextProps.arrow));\n      } else if (prevProps.arrow !== nextProps.arrow) {\n        box.removeChild(arrow);\n        box.appendChild(createArrowElement(nextProps.arrow));\n      }\n    } else if (arrow) {\n      box.removeChild(arrow!);\n    }\n  }\n\n  return {\n    popper,\n    onUpdate,\n  };\n}\n\n// Runtime check to identify if the render function is the default one; this\n// way we can apply default CSS transitions logic and it can be tree-shaken away\nrender.$$tippy = true;\n","import {createPopper, StrictModifiers, Modifier} from '@popperjs/core';\nimport {currentInput} from './bindGlobalEventListeners';\nimport {isIE11} from './browser';\nimport {TIPPY_DEFAULT_APPEND_TO, TOUCH_OPTIONS} from './constants';\nimport {\n  actualContains,\n  div,\n  getOwnerDocument,\n  isCursorOutsideInteractiveBorder,\n  isMouseEvent,\n  setTransitionDuration,\n  setVisibilityState,\n  updateTransitionEndListener,\n} from './dom-utils';\nimport {defaultProps, evaluateProps, getExtendedPassedProps} from './props';\nimport {getChildren} from './template';\nimport {\n  Content,\n  Instance,\n  LifecycleHooks,\n  PopperElement,\n  Props,\n  ReferenceElement,\n} from './types';\nimport {ListenerObject, PopperTreeData, PopperChildren} from './types-internal';\nimport {\n  arrayFrom,\n  debounce,\n  getValueAtIndexOrReturn,\n  invokeWithArgsOrReturn,\n  normalizeToArray,\n  pushIfUnique,\n  splitBySpaces,\n  unique,\n  removeUndefinedProps,\n} from './utils';\nimport {createMemoryLeakWarning, errorWhen, warnWhen} from './validation';\n\nlet idCounter = 1;\nlet mouseMoveListeners: ((event: MouseEvent) => void)[] = [];\n\n// Used by `hideAll()`\nexport let mountedInstances: Instance[] = [];\n\nexport default function createTippy(\n  reference: ReferenceElement,\n  passedProps: Partial<Props>\n): Instance {\n  const props = evaluateProps(reference, {\n    ...defaultProps,\n    ...getExtendedPassedProps(removeUndefinedProps(passedProps)),\n  });\n\n  // ===========================================================================\n  // 🔒 Private members\n  // ===========================================================================\n  let showTimeout: any;\n  let hideTimeout: any;\n  let scheduleHideAnimationFrame: number;\n  let isVisibleFromClick = false;\n  let didHideDueToDocumentMouseDown = false;\n  let didTouchMove = false;\n  let ignoreOnFirstUpdate = false;\n  let lastTriggerEvent: Event | undefined;\n  let currentTransitionEndListener: (event: TransitionEvent) => void;\n  let onFirstUpdate: () => void;\n  let listeners: ListenerObject[] = [];\n  let debouncedOnMouseMove = debounce(onMouseMove, props.interactiveDebounce);\n  let currentTarget: Element;\n\n  // ===========================================================================\n  // 🔑 Public members\n  // ===========================================================================\n  const id = idCounter++;\n  const popperInstance = null;\n  const plugins = unique(props.plugins);\n\n  const state = {\n    // Is the instance currently enabled?\n    isEnabled: true,\n    // Is the tippy currently showing and not transitioning out?\n    isVisible: false,\n    // Has the instance been destroyed?\n    isDestroyed: false,\n    // Is the tippy currently mounted to the DOM?\n    isMounted: false,\n    // Has the tippy finished transitioning in?\n    isShown: false,\n  };\n\n  const instance: Instance = {\n    // properties\n    id,\n    reference,\n    popper: div(),\n    popperInstance,\n    props,\n    state,\n    plugins,\n    // methods\n    clearDelayTimeouts,\n    setProps,\n    setContent,\n    show,\n    hide,\n    hideWithInteractivity,\n    enable,\n    disable,\n    unmount,\n    destroy,\n  };\n\n  // TODO: Investigate why this early return causes a TDZ error in the tests —\n  // it doesn't seem to happen in the browser\n  /* istanbul ignore if */\n  if (!props.render) {\n    if (__DEV__) {\n      errorWhen(true, 'render() function has not been supplied.');\n    }\n\n    return instance;\n  }\n\n  // ===========================================================================\n  // Initial mutations\n  // ===========================================================================\n  const {popper, onUpdate} = props.render(instance);\n\n  popper.setAttribute('data-__NAMESPACE_PREFIX__-root', '');\n  popper.id = `__NAMESPACE_PREFIX__-${instance.id}`;\n\n  instance.popper = popper;\n  reference._tippy = instance;\n  popper._tippy = instance;\n\n  const pluginsHooks = plugins.map((plugin) => plugin.fn(instance));\n  const hasAriaExpanded = reference.hasAttribute('aria-expanded');\n\n  addListeners();\n  handleAriaExpandedAttribute();\n  handleStyles();\n\n  invokeHook('onCreate', [instance]);\n\n  if (props.showOnCreate) {\n    scheduleShow();\n  }\n\n  // Prevent a tippy with a delay from hiding if the cursor left then returned\n  // before it started hiding\n  popper.addEventListener('mouseenter', () => {\n    if (instance.props.interactive && instance.state.isVisible) {\n      instance.clearDelayTimeouts();\n    }\n  });\n\n  popper.addEventListener('mouseleave', () => {\n    if (\n      instance.props.interactive &&\n      instance.props.trigger.indexOf('mouseenter') >= 0\n    ) {\n      getDocument().addEventListener('mousemove', debouncedOnMouseMove);\n    }\n  });\n\n  return instance;\n\n  // ===========================================================================\n  // 🔒 Private methods\n  // ===========================================================================\n  function getNormalizedTouchSettings(): [string | boolean, number] {\n    const {touch} = instance.props;\n    return Array.isArray(touch) ? touch : [touch, 0];\n  }\n\n  function getIsCustomTouchBehavior(): boolean {\n    return getNormalizedTouchSettings()[0] === 'hold';\n  }\n\n  function getIsDefaultRenderFn(): boolean {\n    // @ts-ignore\n    return !!instance.props.render?.$$tippy;\n  }\n\n  function getCurrentTarget(): Element {\n    return currentTarget || reference;\n  }\n\n  function getDocument(): Document {\n    const parent = getCurrentTarget().parentNode as Element;\n    return parent ? getOwnerDocument(parent) : document;\n  }\n\n  function getDefaultTemplateChildren(): PopperChildren {\n    return getChildren(popper);\n  }\n\n  function getDelay(isShow: boolean): number {\n    // For touch or keyboard input, force `0` delay for UX reasons\n    // Also if the instance is mounted but not visible (transitioning out),\n    // ignore delay\n    if (\n      (instance.state.isMounted && !instance.state.isVisible) ||\n      currentInput.isTouch ||\n      (lastTriggerEvent && lastTriggerEvent.type === 'focus')\n    ) {\n      return 0;\n    }\n\n    return getValueAtIndexOrReturn(\n      instance.props.delay,\n      isShow ? 0 : 1,\n      defaultProps.delay\n    );\n  }\n\n  function handleStyles(fromHide = false): void {\n    popper.style.pointerEvents =\n      instance.props.interactive && !fromHide ? '' : 'none';\n    popper.style.zIndex = `${instance.props.zIndex}`;\n  }\n\n  function invokeHook(\n    hook: keyof LifecycleHooks,\n    args: [Instance, any?],\n    shouldInvokePropsHook = true\n  ): void {\n    pluginsHooks.forEach((pluginHooks) => {\n      if (pluginHooks[hook]) {\n        pluginHooks[hook]!(...args);\n      }\n    });\n\n    if (shouldInvokePropsHook) {\n      instance.props[hook](...args);\n    }\n  }\n\n  function handleAriaContentAttribute(): void {\n    const {aria} = instance.props;\n\n    if (!aria.content) {\n      return;\n    }\n\n    const attr = `aria-${aria.content}`;\n    const id = popper.id;\n    const nodes = normalizeToArray(instance.props.triggerTarget || reference);\n\n    nodes.forEach((node) => {\n      const currentValue = node.getAttribute(attr);\n\n      if (instance.state.isVisible) {\n        node.setAttribute(attr, currentValue ? `${currentValue} ${id}` : id);\n      } else {\n        const nextValue = currentValue && currentValue.replace(id, '').trim();\n\n        if (nextValue) {\n          node.setAttribute(attr, nextValue);\n        } else {\n          node.removeAttribute(attr);\n        }\n      }\n    });\n  }\n\n  function handleAriaExpandedAttribute(): void {\n    if (hasAriaExpanded || !instance.props.aria.expanded) {\n      return;\n    }\n\n    const nodes = normalizeToArray(instance.props.triggerTarget || reference);\n\n    nodes.forEach((node) => {\n      if (instance.props.interactive) {\n        node.setAttribute(\n          'aria-expanded',\n          instance.state.isVisible && node === getCurrentTarget()\n            ? 'true'\n            : 'false'\n        );\n      } else {\n        node.removeAttribute('aria-expanded');\n      }\n    });\n  }\n\n  function cleanupInteractiveMouseListeners(): void {\n    getDocument().removeEventListener('mousemove', debouncedOnMouseMove);\n    mouseMoveListeners = mouseMoveListeners.filter(\n      (listener) => listener !== debouncedOnMouseMove\n    );\n  }\n\n  function onDocumentPress(event: MouseEvent | TouchEvent): void {\n    // Moved finger to scroll instead of an intentional tap outside\n    if (currentInput.isTouch) {\n      if (didTouchMove || event.type === 'mousedown') {\n        return;\n      }\n    }\n\n    const actualTarget =\n      (event.composedPath && event.composedPath()[0]) || event.target;\n\n    // Clicked on interactive popper\n    if (\n      instance.props.interactive &&\n      actualContains(popper, actualTarget as Element)\n    ) {\n      return;\n    }\n\n    // Clicked on the event listeners target\n    if (\n      normalizeToArray(instance.props.triggerTarget || reference).some((el) =>\n        actualContains(el, actualTarget as Element)\n      )\n    ) {\n      if (currentInput.isTouch) {\n        return;\n      }\n\n      if (\n        instance.state.isVisible &&\n        instance.props.trigger.indexOf('click') >= 0\n      ) {\n        return;\n      }\n    } else {\n      invokeHook('onClickOutside', [instance, event]);\n    }\n\n    if (instance.props.hideOnClick === true) {\n      instance.clearDelayTimeouts();\n      instance.hide();\n\n      // `mousedown` event is fired right before `focus` if pressing the\n      // currentTarget. This lets a tippy with `focus` trigger know that it\n      // should not show\n      didHideDueToDocumentMouseDown = true;\n      setTimeout(() => {\n        didHideDueToDocumentMouseDown = false;\n      });\n\n      // The listener gets added in `scheduleShow()`, but this may be hiding it\n      // before it shows, and hide()'s early bail-out behavior can prevent it\n      // from being cleaned up\n      if (!instance.state.isMounted) {\n        removeDocumentPress();\n      }\n    }\n  }\n\n  function onTouchMove(): void {\n    didTouchMove = true;\n  }\n\n  function onTouchStart(): void {\n    didTouchMove = false;\n  }\n\n  function addDocumentPress(): void {\n    const doc = getDocument();\n    doc.addEventListener('mousedown', onDocumentPress, true);\n    doc.addEventListener('touchend', onDocumentPress, TOUCH_OPTIONS);\n    doc.addEventListener('touchstart', onTouchStart, TOUCH_OPTIONS);\n    doc.addEventListener('touchmove', onTouchMove, TOUCH_OPTIONS);\n  }\n\n  function removeDocumentPress(): void {\n    const doc = getDocument();\n    doc.removeEventListener('mousedown', onDocumentPress, true);\n    doc.removeEventListener('touchend', onDocumentPress, TOUCH_OPTIONS);\n    doc.removeEventListener('touchstart', onTouchStart, TOUCH_OPTIONS);\n    doc.removeEventListener('touchmove', onTouchMove, TOUCH_OPTIONS);\n  }\n\n  function onTransitionedOut(duration: number, callback: () => void): void {\n    onTransitionEnd(duration, () => {\n      if (\n        !instance.state.isVisible &&\n        popper.parentNode &&\n        popper.parentNode.contains(popper)\n      ) {\n        callback();\n      }\n    });\n  }\n\n  function onTransitionedIn(duration: number, callback: () => void): void {\n    onTransitionEnd(duration, callback);\n  }\n\n  function onTransitionEnd(duration: number, callback: () => void): void {\n    const box = getDefaultTemplateChildren().box;\n\n    function listener(event: TransitionEvent): void {\n      if (event.target === box) {\n        updateTransitionEndListener(box, 'remove', listener);\n        callback();\n      }\n    }\n\n    // Make callback synchronous if duration is 0\n    // `transitionend` won't fire otherwise\n    if (duration === 0) {\n      return callback();\n    }\n\n    updateTransitionEndListener(box, 'remove', currentTransitionEndListener);\n    updateTransitionEndListener(box, 'add', listener);\n\n    currentTransitionEndListener = listener;\n  }\n\n  function on(\n    eventType: string,\n    handler: EventListener,\n    options: boolean | Record<string, unknown> = false\n  ): void {\n    const nodes = normalizeToArray(instance.props.triggerTarget || reference);\n    nodes.forEach((node) => {\n      node.addEventListener(eventType, handler, options);\n      listeners.push({node, eventType, handler, options});\n    });\n  }\n\n  function addListeners(): void {\n    if (getIsCustomTouchBehavior()) {\n      on('touchstart', onTrigger, {passive: true});\n      on('touchend', onMouseLeave as EventListener, {passive: true});\n    }\n\n    splitBySpaces(instance.props.trigger).forEach((eventType) => {\n      if (eventType === 'manual') {\n        return;\n      }\n\n      on(eventType, onTrigger);\n\n      switch (eventType) {\n        case 'mouseenter':\n          on('mouseleave', onMouseLeave as EventListener);\n          break;\n        case 'focus':\n          on(isIE11 ? 'focusout' : 'blur', onBlurOrFocusOut as EventListener);\n          break;\n        case 'focusin':\n          on('focusout', onBlurOrFocusOut as EventListener);\n          break;\n      }\n    });\n  }\n\n  function removeListeners(): void {\n    listeners.forEach(({node, eventType, handler, options}: ListenerObject) => {\n      node.removeEventListener(eventType, handler, options);\n    });\n    listeners = [];\n  }\n\n  function onTrigger(event: Event): void {\n    let shouldScheduleClickHide = false;\n\n    if (\n      !instance.state.isEnabled ||\n      isEventListenerStopped(event) ||\n      didHideDueToDocumentMouseDown\n    ) {\n      return;\n    }\n\n    const wasFocused = lastTriggerEvent?.type === 'focus';\n\n    lastTriggerEvent = event;\n    currentTarget = event.currentTarget as Element;\n\n    handleAriaExpandedAttribute();\n\n    if (!instance.state.isVisible && isMouseEvent(event)) {\n      // If scrolling, `mouseenter` events can be fired if the cursor lands\n      // over a new target, but `mousemove` events don't get fired. This\n      // causes interactive tooltips to get stuck open until the cursor is\n      // moved\n      mouseMoveListeners.forEach((listener) => listener(event));\n    }\n\n    // Toggle show/hide when clicking click-triggered tooltips\n    if (\n      event.type === 'click' &&\n      (instance.props.trigger.indexOf('mouseenter') < 0 ||\n        isVisibleFromClick) &&\n      instance.props.hideOnClick !== false &&\n      instance.state.isVisible\n    ) {\n      shouldScheduleClickHide = true;\n    } else {\n      scheduleShow(event);\n    }\n\n    if (event.type === 'click') {\n      isVisibleFromClick = !shouldScheduleClickHide;\n    }\n\n    if (shouldScheduleClickHide && !wasFocused) {\n      scheduleHide(event);\n    }\n  }\n\n  function onMouseMove(event: MouseEvent): void {\n    const target = event.target as Node;\n    const isCursorOverReferenceOrPopper =\n      getCurrentTarget().contains(target) || popper.contains(target);\n\n    if (event.type === 'mousemove' && isCursorOverReferenceOrPopper) {\n      return;\n    }\n\n    const popperTreeData = getNestedPopperTree()\n      .concat(popper)\n      .map((popper) => {\n        const instance = popper._tippy!;\n        const state = instance.popperInstance?.state;\n\n        if (state) {\n          return {\n            popperRect: popper.getBoundingClientRect(),\n            popperState: state,\n            props,\n          };\n        }\n\n        return null;\n      })\n      .filter(Boolean) as PopperTreeData[];\n\n    if (isCursorOutsideInteractiveBorder(popperTreeData, event)) {\n      cleanupInteractiveMouseListeners();\n      scheduleHide(event);\n    }\n  }\n\n  function onMouseLeave(event: MouseEvent): void {\n    const shouldBail =\n      isEventListenerStopped(event) ||\n      (instance.props.trigger.indexOf('click') >= 0 && isVisibleFromClick);\n\n    if (shouldBail) {\n      return;\n    }\n\n    if (instance.props.interactive) {\n      instance.hideWithInteractivity(event);\n      return;\n    }\n\n    scheduleHide(event);\n  }\n\n  function onBlurOrFocusOut(event: FocusEvent): void {\n    if (\n      instance.props.trigger.indexOf('focusin') < 0 &&\n      event.target !== getCurrentTarget()\n    ) {\n      return;\n    }\n\n    // If focus was moved to within the popper\n    if (\n      instance.props.interactive &&\n      event.relatedTarget &&\n      popper.contains(event.relatedTarget as Element)\n    ) {\n      return;\n    }\n\n    scheduleHide(event);\n  }\n\n  function isEventListenerStopped(event: Event): boolean {\n    return currentInput.isTouch\n      ? getIsCustomTouchBehavior() !== event.type.indexOf('touch') >= 0\n      : false;\n  }\n\n  function createPopperInstance(): void {\n    destroyPopperInstance();\n\n    const {\n      popperOptions,\n      placement,\n      offset,\n      getReferenceClientRect,\n      moveTransition,\n    } = instance.props;\n\n    const arrow = getIsDefaultRenderFn() ? getChildren(popper).arrow : null;\n\n    const computedReference = getReferenceClientRect\n      ? {\n          getBoundingClientRect: getReferenceClientRect,\n          contextElement:\n            getReferenceClientRect.contextElement || getCurrentTarget(),\n        }\n      : reference;\n\n    const tippyModifier: Modifier<'$$tippy', Record<string, unknown>> = {\n      name: '$$tippy',\n      enabled: true,\n      phase: 'beforeWrite',\n      requires: ['computeStyles'],\n      fn({state}) {\n        if (getIsDefaultRenderFn()) {\n          const {box} = getDefaultTemplateChildren();\n\n          ['placement', 'reference-hidden', 'escaped'].forEach((attr) => {\n            if (attr === 'placement') {\n              box.setAttribute('data-placement', state.placement);\n            } else {\n              if (state.attributes.popper[`data-popper-${attr}`]) {\n                box.setAttribute(`data-${attr}`, '');\n              } else {\n                box.removeAttribute(`data-${attr}`);\n              }\n            }\n          });\n\n          state.attributes.popper = {};\n        }\n      },\n    };\n\n    type TippyModifier = Modifier<'$$tippy', Record<string, unknown>>;\n    type ExtendedModifiers = StrictModifiers | Partial<TippyModifier>;\n\n    const modifiers: Array<ExtendedModifiers> = [\n      {\n        name: 'offset',\n        options: {\n          offset,\n        },\n      },\n      {\n        name: 'preventOverflow',\n        options: {\n          padding: {\n            top: 2,\n            bottom: 2,\n            left: 5,\n            right: 5,\n          },\n        },\n      },\n      {\n        name: 'flip',\n        options: {\n          padding: 5,\n        },\n      },\n      {\n        name: 'computeStyles',\n        options: {\n          adaptive: !moveTransition,\n        },\n      },\n      tippyModifier,\n    ];\n\n    if (getIsDefaultRenderFn() && arrow) {\n      modifiers.push({\n        name: 'arrow',\n        options: {\n          element: arrow,\n          padding: 3,\n        },\n      });\n    }\n\n    modifiers.push(...(popperOptions?.modifiers || []));\n\n    instance.popperInstance = createPopper<ExtendedModifiers>(\n      computedReference,\n      popper,\n      {\n        ...popperOptions,\n        placement,\n        onFirstUpdate,\n        modifiers,\n      }\n    );\n  }\n\n  function destroyPopperInstance(): void {\n    if (instance.popperInstance) {\n      instance.popperInstance.destroy();\n      instance.popperInstance = null;\n    }\n  }\n\n  function mount(): void {\n    const {appendTo} = instance.props;\n\n    let parentNode: any;\n\n    // By default, we'll append the popper to the triggerTargets's parentNode so\n    // it's directly after the reference element so the elements inside the\n    // tippy can be tabbed to\n    // If there are clipping issues, the user can specify a different appendTo\n    // and ensure focus management is handled correctly manually\n    const node = getCurrentTarget();\n\n    if (\n      (instance.props.interactive && appendTo === TIPPY_DEFAULT_APPEND_TO) ||\n      appendTo === 'parent'\n    ) {\n      parentNode = node.parentNode;\n    } else {\n      parentNode = invokeWithArgsOrReturn(appendTo, [node]);\n    }\n\n    // The popper element needs to exist on the DOM before its position can be\n    // updated as Popper needs to read its dimensions\n    if (!parentNode.contains(popper)) {\n      parentNode.appendChild(popper);\n    }\n\n    instance.state.isMounted = true;\n\n    createPopperInstance();\n\n    /* istanbul ignore else */\n    if (__DEV__) {\n      // Accessibility check\n      warnWhen(\n        instance.props.interactive &&\n          appendTo === defaultProps.appendTo &&\n          node.nextElementSibling !== popper,\n        [\n          'Interactive tippy element may not be accessible via keyboard',\n          'navigation because it is not directly after the reference element',\n          'in the DOM source order.',\n          '\\n\\n',\n          'Using a wrapper <div> or <span> tag around the reference element',\n          'solves this by creating a new parentNode context.',\n          '\\n\\n',\n          'Specifying `appendTo: document.body` silences this warning, but it',\n          'assumes you are using a focus management solution to handle',\n          'keyboard navigation.',\n          '\\n\\n',\n          'See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity',\n        ].join(' ')\n      );\n    }\n  }\n\n  function getNestedPopperTree(): PopperElement[] {\n    return arrayFrom(\n      popper.querySelectorAll('[data-__NAMESPACE_PREFIX__-root]')\n    );\n  }\n\n  function scheduleShow(event?: Event): void {\n    instance.clearDelayTimeouts();\n\n    if (event) {\n      invokeHook('onTrigger', [instance, event]);\n    }\n\n    addDocumentPress();\n\n    let delay = getDelay(true);\n    const [touchValue, touchDelay] = getNormalizedTouchSettings();\n\n    if (currentInput.isTouch && touchValue === 'hold' && touchDelay) {\n      delay = touchDelay;\n    }\n\n    if (delay) {\n      showTimeout = setTimeout(() => {\n        instance.show();\n      }, delay);\n    } else {\n      instance.show();\n    }\n  }\n\n  function scheduleHide(event: Event): void {\n    instance.clearDelayTimeouts();\n\n    invokeHook('onUntrigger', [instance, event]);\n\n    if (!instance.state.isVisible) {\n      removeDocumentPress();\n\n      return;\n    }\n\n    // For interactive tippies, scheduleHide is added to a document.body handler\n    // from onMouseLeave so must intercept scheduled hides from mousemove/leave\n    // events when trigger contains mouseenter and click, and the tip is\n    // currently shown as a result of a click.\n    if (\n      instance.props.trigger.indexOf('mouseenter') >= 0 &&\n      instance.props.trigger.indexOf('click') >= 0 &&\n      ['mouseleave', 'mousemove'].indexOf(event.type) >= 0 &&\n      isVisibleFromClick\n    ) {\n      return;\n    }\n\n    const delay = getDelay(false);\n\n    if (delay) {\n      hideTimeout = setTimeout(() => {\n        if (instance.state.isVisible) {\n          instance.hide();\n        }\n      }, delay);\n    } else {\n      // Fixes a `transitionend` problem when it fires 1 frame too\n      // late sometimes, we don't want hide() to be called.\n      scheduleHideAnimationFrame = requestAnimationFrame(() => {\n        instance.hide();\n      });\n    }\n  }\n\n  // ===========================================================================\n  // 🔑 Public methods\n  // ===========================================================================\n  function enable(): void {\n    instance.state.isEnabled = true;\n  }\n\n  function disable(): void {\n    // Disabling the instance should also hide it\n    // https://github.com/atomiks/tippy.js-react/issues/106\n    instance.hide();\n    instance.state.isEnabled = false;\n  }\n\n  function clearDelayTimeouts(): void {\n    clearTimeout(showTimeout);\n    clearTimeout(hideTimeout);\n    cancelAnimationFrame(scheduleHideAnimationFrame);\n  }\n\n  function setProps(partialProps: Partial<Props>): void {\n    /* istanbul ignore else */\n    if (__DEV__) {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('setProps'));\n    }\n\n    if (instance.state.isDestroyed) {\n      return;\n    }\n\n    invokeHook('onBeforeUpdate', [instance, partialProps]);\n\n    removeListeners();\n\n    const prevProps = instance.props;\n    const nextProps = evaluateProps(reference, {\n      ...prevProps,\n      ...removeUndefinedProps(partialProps),\n      ignoreAttributes: true,\n    });\n\n    instance.props = nextProps;\n\n    addListeners();\n\n    if (prevProps.interactiveDebounce !== nextProps.interactiveDebounce) {\n      cleanupInteractiveMouseListeners();\n      debouncedOnMouseMove = debounce(\n        onMouseMove,\n        nextProps.interactiveDebounce\n      );\n    }\n\n    // Ensure stale aria-expanded attributes are removed\n    if (prevProps.triggerTarget && !nextProps.triggerTarget) {\n      normalizeToArray(prevProps.triggerTarget).forEach((node) => {\n        node.removeAttribute('aria-expanded');\n      });\n    } else if (nextProps.triggerTarget) {\n      reference.removeAttribute('aria-expanded');\n    }\n\n    handleAriaExpandedAttribute();\n    handleStyles();\n\n    if (onUpdate) {\n      onUpdate(prevProps, nextProps);\n    }\n\n    if (instance.popperInstance) {\n      createPopperInstance();\n\n      // Fixes an issue with nested tippies if they are all getting re-rendered,\n      // and the nested ones get re-rendered first.\n      // https://github.com/atomiks/tippyjs-react/issues/177\n      // TODO: find a cleaner / more efficient solution(!)\n      getNestedPopperTree().forEach((nestedPopper) => {\n        // React (and other UI libs likely) requires a rAF wrapper as it flushes\n        // its work in one\n        requestAnimationFrame(nestedPopper._tippy!.popperInstance!.forceUpdate);\n      });\n    }\n\n    invokeHook('onAfterUpdate', [instance, partialProps]);\n  }\n\n  function setContent(content: Content): void {\n    instance.setProps({content});\n  }\n\n  function show(): void {\n    /* istanbul ignore else */\n    if (__DEV__) {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('show'));\n    }\n\n    // Early bail-out\n    const isAlreadyVisible = instance.state.isVisible;\n    const isDestroyed = instance.state.isDestroyed;\n    const isDisabled = !instance.state.isEnabled;\n    const isTouchAndTouchDisabled =\n      currentInput.isTouch && !instance.props.touch;\n    const duration = getValueAtIndexOrReturn(\n      instance.props.duration,\n      0,\n      defaultProps.duration\n    );\n\n    if (\n      isAlreadyVisible ||\n      isDestroyed ||\n      isDisabled ||\n      isTouchAndTouchDisabled\n    ) {\n      return;\n    }\n\n    // Normalize `disabled` behavior across browsers.\n    // Firefox allows events on disabled elements, but Chrome doesn't.\n    // Using a wrapper element (i.e. <span>) is recommended.\n    if (getCurrentTarget().hasAttribute('disabled')) {\n      return;\n    }\n\n    invokeHook('onShow', [instance], false);\n    if (instance.props.onShow(instance) === false) {\n      return;\n    }\n\n    instance.state.isVisible = true;\n\n    if (getIsDefaultRenderFn()) {\n      popper.style.visibility = 'visible';\n    }\n\n    handleStyles();\n    addDocumentPress();\n\n    if (!instance.state.isMounted) {\n      popper.style.transition = 'none';\n    }\n\n    // If flipping to the opposite side after hiding at least once, the\n    // animation will use the wrong placement without resetting the duration\n    if (getIsDefaultRenderFn()) {\n      const {box, content} = getDefaultTemplateChildren();\n      setTransitionDuration([box, content], 0);\n    }\n\n    onFirstUpdate = (): void => {\n      if (!instance.state.isVisible || ignoreOnFirstUpdate) {\n        return;\n      }\n\n      ignoreOnFirstUpdate = true;\n\n      // reflow\n      void popper.offsetHeight;\n\n      popper.style.transition = instance.props.moveTransition;\n\n      if (getIsDefaultRenderFn() && instance.props.animation) {\n        const {box, content} = getDefaultTemplateChildren();\n        setTransitionDuration([box, content], duration);\n        setVisibilityState([box, content], 'visible');\n      }\n\n      handleAriaContentAttribute();\n      handleAriaExpandedAttribute();\n\n      pushIfUnique(mountedInstances, instance);\n\n      // certain modifiers (e.g. `maxSize`) require a second update after the\n      // popper has been positioned for the first time\n      instance.popperInstance?.forceUpdate();\n\n      invokeHook('onMount', [instance]);\n\n      if (instance.props.animation && getIsDefaultRenderFn()) {\n        onTransitionedIn(duration, () => {\n          instance.state.isShown = true;\n          invokeHook('onShown', [instance]);\n        });\n      }\n    };\n\n    mount();\n  }\n\n  function hide(): void {\n    /* istanbul ignore else */\n    if (__DEV__) {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('hide'));\n    }\n\n    // Early bail-out\n    const isAlreadyHidden = !instance.state.isVisible;\n    const isDestroyed = instance.state.isDestroyed;\n    const isDisabled = !instance.state.isEnabled;\n    const duration = getValueAtIndexOrReturn(\n      instance.props.duration,\n      1,\n      defaultProps.duration\n    );\n\n    if (isAlreadyHidden || isDestroyed || isDisabled) {\n      return;\n    }\n\n    invokeHook('onHide', [instance], false);\n    if (instance.props.onHide(instance) === false) {\n      return;\n    }\n\n    instance.state.isVisible = false;\n    instance.state.isShown = false;\n    ignoreOnFirstUpdate = false;\n    isVisibleFromClick = false;\n\n    if (getIsDefaultRenderFn()) {\n      popper.style.visibility = 'hidden';\n    }\n\n    cleanupInteractiveMouseListeners();\n    removeDocumentPress();\n    handleStyles(true);\n\n    if (getIsDefaultRenderFn()) {\n      const {box, content} = getDefaultTemplateChildren();\n\n      if (instance.props.animation) {\n        setTransitionDuration([box, content], duration);\n        setVisibilityState([box, content], 'hidden');\n      }\n    }\n\n    handleAriaContentAttribute();\n    handleAriaExpandedAttribute();\n\n    if (instance.props.animation) {\n      if (getIsDefaultRenderFn()) {\n        onTransitionedOut(duration, instance.unmount);\n      }\n    } else {\n      instance.unmount();\n    }\n  }\n\n  function hideWithInteractivity(event: MouseEvent): void {\n    /* istanbul ignore else */\n    if (__DEV__) {\n      warnWhen(\n        instance.state.isDestroyed,\n        createMemoryLeakWarning('hideWithInteractivity')\n      );\n    }\n\n    getDocument().addEventListener('mousemove', debouncedOnMouseMove);\n    pushIfUnique(mouseMoveListeners, debouncedOnMouseMove);\n    debouncedOnMouseMove(event);\n  }\n\n  function unmount(): void {\n    /* istanbul ignore else */\n    if (__DEV__) {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('unmount'));\n    }\n\n    if (instance.state.isVisible) {\n      instance.hide();\n    }\n\n    if (!instance.state.isMounted) {\n      return;\n    }\n\n    destroyPopperInstance();\n\n    // If a popper is not interactive, it will be appended outside the popper\n    // tree by default. This seems mainly for interactive tippies, but we should\n    // find a workaround if possible\n    getNestedPopperTree().forEach((nestedPopper) => {\n      nestedPopper._tippy!.unmount();\n    });\n\n    if (popper.parentNode) {\n      popper.parentNode.removeChild(popper);\n    }\n\n    mountedInstances = mountedInstances.filter((i) => i !== instance);\n\n    instance.state.isMounted = false;\n    invokeHook('onHidden', [instance]);\n  }\n\n  function destroy(): void {\n    /* istanbul ignore else */\n    if (__DEV__) {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('destroy'));\n    }\n\n    if (instance.state.isDestroyed) {\n      return;\n    }\n\n    instance.clearDelayTimeouts();\n    instance.unmount();\n\n    removeListeners();\n\n    delete reference._tippy;\n\n    instance.state.isDestroyed = true;\n\n    invokeHook('onDestroy', [instance]);\n  }\n}\n","import bindGlobalEventListeners, {\n  currentInput,\n} from './bindGlobalEventListeners';\nimport createTippy, {mountedInstances} from './createTippy';\nimport {getArrayOfElements, isElement, isReferenceElement} from './dom-utils';\nimport {defaultProps, setDefaultProps, validateProps} from './props';\nimport {HideAll, HideAllOptions, Instance, Props, Targets} from './types';\nimport {validateTargets, warnWhen} from './validation';\n\nfunction tippy(\n  targets: Targets,\n  optionalProps: Partial<Props> = {}\n): Instance | Instance[] {\n  const plugins = defaultProps.plugins.concat(optionalProps.plugins || []);\n\n  /* istanbul ignore else */\n  if (__DEV__) {\n    validateTargets(targets);\n    validateProps(optionalProps, plugins);\n  }\n\n  bindGlobalEventListeners();\n\n  const passedProps: Partial<Props> = {...optionalProps, plugins};\n\n  const elements = getArrayOfElements(targets);\n\n  /* istanbul ignore else */\n  if (__DEV__) {\n    const isSingleContentElement = isElement(passedProps.content);\n    const isMoreThanOneReferenceElement = elements.length > 1;\n    warnWhen(\n      isSingleContentElement && isMoreThanOneReferenceElement,\n      [\n        'tippy() was passed an Element as the `content` prop, but more than',\n        'one tippy instance was created by this invocation. This means the',\n        'content element will only be appended to the last tippy instance.',\n        '\\n\\n',\n        'Instead, pass the .innerHTML of the element, or use a function that',\n        'returns a cloned version of the element instead.',\n        '\\n\\n',\n        '1) content: element.innerHTML\\n',\n        '2) content: () => element.cloneNode(true)',\n      ].join(' ')\n    );\n  }\n\n  const instances = elements.reduce<Instance[]>(\n    (acc, reference): Instance[] => {\n      const instance = reference && createTippy(reference, passedProps);\n\n      if (instance) {\n        acc.push(instance);\n      }\n\n      return acc;\n    },\n    []\n  );\n\n  return isElement(targets) ? instances[0] : instances;\n}\n\ntippy.defaultProps = defaultProps;\ntippy.setDefaultProps = setDefaultProps;\ntippy.currentInput = currentInput;\n\nexport default tippy;\n\nexport const hideAll: HideAll = ({\n  exclude: excludedReferenceOrInstance,\n  duration,\n}: HideAllOptions = {}) => {\n  mountedInstances.forEach((instance) => {\n    let isExcluded = false;\n\n    if (excludedReferenceOrInstance) {\n      isExcluded = isReferenceElement(excludedReferenceOrInstance)\n        ? instance.reference === excludedReferenceOrInstance\n        : instance.popper === (excludedReferenceOrInstance as Instance).popper;\n    }\n\n    if (!isExcluded) {\n      const originalDuration = instance.props.duration;\n\n      instance.setProps({duration});\n      instance.hide();\n\n      if (!instance.state.isDestroyed) {\n        instance.setProps({duration: originalDuration});\n      }\n    }\n  });\n};\n","import tippy from '..';\nimport {div} from '../dom-utils';\nimport {\n  CreateSingleton,\n  Plugin,\n  CreateSingletonProps,\n  ReferenceElement,\n  CreateSingletonInstance,\n  Instance,\n  Props,\n} from '../types';\nimport {normalizeToArray, removeProperties} from '../utils';\nimport {errorWhen} from '../validation';\nimport {applyStyles, Modifier} from '@popperjs/core';\n\n// The default `applyStyles` modifier has a cleanup function that gets called\n// every time the popper is destroyed (i.e. a new target), removing the styles\n// and causing transitions to break for singletons when the console is open, but\n// most notably for non-transform styles being used, `gpuAcceleration: false`.\nconst applyStylesModifier: Modifier<'applyStyles', Record<string, unknown>> = {\n  ...applyStyles,\n  effect({state}) {\n    const initialStyles = {\n      popper: {\n        position: state.options.strategy,\n        left: '0',\n        top: '0',\n        margin: '0',\n      },\n      arrow: {\n        position: 'absolute',\n      },\n      reference: {},\n    };\n\n    Object.assign(state.elements.popper.style, initialStyles.popper);\n    state.styles = initialStyles;\n\n    if (state.elements.arrow) {\n      Object.assign(state.elements.arrow.style, initialStyles.arrow);\n    }\n\n    // intentionally return no cleanup function\n    // return () => { ... }\n  },\n};\n\nconst createSingleton: CreateSingleton = (\n  tippyInstances,\n  optionalProps = {}\n) => {\n  /* istanbul ignore else */\n  if (__DEV__) {\n    errorWhen(\n      !Array.isArray(tippyInstances),\n      [\n        'The first argument passed to createSingleton() must be an array of',\n        'tippy instances. The passed value was',\n        String(tippyInstances),\n      ].join(' ')\n    );\n  }\n\n  let individualInstances = tippyInstances;\n  let references: Array<ReferenceElement> = [];\n  let triggerTargets: Array<Element> = [];\n  let currentTarget: Element | null;\n  let overrides = optionalProps.overrides;\n  let interceptSetPropsCleanups: Array<() => void> = [];\n  let shownOnCreate = false;\n\n  function setTriggerTargets(): void {\n    triggerTargets = individualInstances\n      .map((instance) =>\n        normalizeToArray(instance.props.triggerTarget || instance.reference)\n      )\n      .reduce((acc, item) => acc.concat(item), []);\n  }\n\n  function setReferences(): void {\n    references = individualInstances.map((instance) => instance.reference);\n  }\n\n  function enableInstances(isEnabled: boolean): void {\n    individualInstances.forEach((instance) => {\n      if (isEnabled) {\n        instance.enable();\n      } else {\n        instance.disable();\n      }\n    });\n  }\n\n  function interceptSetProps(singleton: Instance): Array<() => void> {\n    return individualInstances.map((instance) => {\n      const originalSetProps = instance.setProps;\n\n      instance.setProps = (props): void => {\n        originalSetProps(props);\n\n        if (instance.reference === currentTarget) {\n          singleton.setProps(props);\n        }\n      };\n\n      return (): void => {\n        instance.setProps = originalSetProps;\n      };\n    });\n  }\n\n  // have to pass singleton, as it maybe undefined on first call\n  function prepareInstance(\n    singleton: Instance,\n    target: ReferenceElement\n  ): void {\n    const index = triggerTargets.indexOf(target);\n\n    // bail-out\n    if (target === currentTarget) {\n      return;\n    }\n\n    currentTarget = target;\n\n    const overrideProps: Partial<Props> = (overrides || [])\n      .concat('content')\n      .reduce((acc, prop) => {\n        (acc as any)[prop] = individualInstances[index].props[prop];\n        return acc;\n      }, {});\n\n    singleton.setProps({\n      ...overrideProps,\n      getReferenceClientRect:\n        typeof overrideProps.getReferenceClientRect === 'function'\n          ? overrideProps.getReferenceClientRect\n          : (): ClientRect => references[index]?.getBoundingClientRect(),\n    });\n  }\n\n  enableInstances(false);\n  setReferences();\n  setTriggerTargets();\n\n  const plugin: Plugin = {\n    fn() {\n      return {\n        onDestroy(): void {\n          enableInstances(true);\n        },\n        onHidden(): void {\n          currentTarget = null;\n        },\n        onClickOutside(instance): void {\n          if (instance.props.showOnCreate && !shownOnCreate) {\n            shownOnCreate = true;\n            currentTarget = null;\n          }\n        },\n        onShow(instance): void {\n          if (instance.props.showOnCreate && !shownOnCreate) {\n            shownOnCreate = true;\n            prepareInstance(instance, references[0]);\n          }\n        },\n        onTrigger(instance, event): void {\n          prepareInstance(instance, event.currentTarget as Element);\n        },\n      };\n    },\n  };\n\n  const singleton = tippy(div(), {\n    ...removeProperties(optionalProps, ['overrides']),\n    plugins: [plugin, ...(optionalProps.plugins || [])],\n    triggerTarget: triggerTargets,\n    popperOptions: {\n      ...optionalProps.popperOptions,\n      modifiers: [\n        ...(optionalProps.popperOptions?.modifiers || []),\n        applyStylesModifier,\n      ],\n    },\n  }) as CreateSingletonInstance<CreateSingletonProps>;\n\n  const originalShow = singleton.show;\n\n  singleton.show = (target?: ReferenceElement | Instance | number): void => {\n    originalShow();\n\n    // first time, showOnCreate or programmatic call with no params\n    // default to showing first instance\n    if (!currentTarget && target == null) {\n      return prepareInstance(singleton, references[0]);\n    }\n\n    // triggered from event (do nothing as prepareInstance already called by onTrigger)\n    // programmatic call with no params when already visible (do nothing again)\n    if (currentTarget && target == null) {\n      return;\n    }\n\n    // target is index of instance\n    if (typeof target === 'number') {\n      return (\n        references[target] && prepareInstance(singleton, references[target])\n      );\n    }\n\n    // target is a child tippy instance\n    if (individualInstances.indexOf(target as Instance) >= 0) {\n      const ref = (target as Instance).reference;\n      return prepareInstance(singleton, ref);\n    }\n\n    // target is a ReferenceElement\n    if (references.indexOf(target as ReferenceElement) >= 0) {\n      return prepareInstance(singleton, target as ReferenceElement);\n    }\n  };\n\n  singleton.showNext = (): void => {\n    const first = references[0];\n    if (!currentTarget) {\n      return singleton.show(0);\n    }\n    const index = references.indexOf(currentTarget);\n    singleton.show(references[index + 1] || first);\n  };\n\n  singleton.showPrevious = (): void => {\n    const last = references[references.length - 1];\n    if (!currentTarget) {\n      return singleton.show(last);\n    }\n    const index = references.indexOf(currentTarget);\n    const target = references[index - 1] || last;\n    singleton.show(target);\n  };\n\n  const originalSetProps = singleton.setProps;\n\n  singleton.setProps = (props): void => {\n    overrides = props.overrides || overrides;\n    originalSetProps(props);\n  };\n\n  singleton.setInstances = (nextInstances): void => {\n    enableInstances(true);\n    interceptSetPropsCleanups.forEach((fn) => fn());\n\n    individualInstances = nextInstances;\n\n    enableInstances(false);\n    setReferences();\n    setTriggerTargets();\n    interceptSetPropsCleanups = interceptSetProps(singleton);\n\n    singleton.setProps({triggerTarget: triggerTargets});\n  };\n\n  interceptSetPropsCleanups = interceptSetProps(singleton);\n\n  return singleton;\n};\n\nexport default createSingleton;\n","import tippy from '..';\nimport {TOUCH_OPTIONS} from '../constants';\nimport {defaultProps} from '../props';\nimport {Instance, Props, Targets} from '../types';\nimport {ListenerObject} from '../types-internal';\nimport {normalizeToArray, removeProperties} from '../utils';\nimport {errorWhen} from '../validation';\n\nconst BUBBLING_EVENTS_MAP = {\n  mouseover: 'mouseenter',\n  focusin: 'focus',\n  click: 'click',\n};\n\n/**\n * Creates a delegate instance that controls the creation of tippy instances\n * for child elements (`target` CSS selector).\n */\nfunction delegate(\n  targets: Targets,\n  props: Partial<Props> & {target: string}\n): Instance | Instance[] {\n  /* istanbul ignore else */\n  if (__DEV__) {\n    errorWhen(\n      !(props && props.target),\n      [\n        'You must specity a `target` prop indicating a CSS selector string matching',\n        'the target elements that should receive a tippy.',\n      ].join(' ')\n    );\n  }\n\n  let listeners: ListenerObject[] = [];\n  let childTippyInstances: Instance[] = [];\n  let disabled = false;\n\n  const {target} = props;\n\n  const nativeProps = removeProperties(props, ['target']);\n  const parentProps = {...nativeProps, trigger: 'manual', touch: false};\n  const childProps = {\n    touch: defaultProps.touch,\n    ...nativeProps,\n    showOnCreate: true,\n  };\n\n  const returnValue = tippy(targets, parentProps);\n  const normalizedReturnValue = normalizeToArray(returnValue);\n\n  function onTrigger(event: Event): void {\n    if (!event.target || disabled) {\n      return;\n    }\n\n    const targetNode = (event.target as Element).closest(target);\n\n    if (!targetNode) {\n      return;\n    }\n\n    // Get relevant trigger with fallbacks:\n    // 1. Check `data-tippy-trigger` attribute on target node\n    // 2. Fallback to `trigger` passed to `delegate()`\n    // 3. Fallback to `defaultProps.trigger`\n    const trigger =\n      targetNode.getAttribute('data-tippy-trigger') ||\n      props.trigger ||\n      defaultProps.trigger;\n\n    // @ts-ignore\n    if (targetNode._tippy) {\n      return;\n    }\n\n    if (event.type === 'touchstart' && typeof childProps.touch === 'boolean') {\n      return;\n    }\n\n    if (\n      event.type !== 'touchstart' &&\n      trigger.indexOf((BUBBLING_EVENTS_MAP as any)[event.type]) < 0\n    ) {\n      return;\n    }\n\n    const instance = tippy(targetNode, childProps);\n\n    if (instance) {\n      childTippyInstances = childTippyInstances.concat(instance);\n    }\n  }\n\n  function on(\n    node: Element,\n    eventType: string,\n    handler: EventListener,\n    options: boolean | Record<string, unknown> = false\n  ): void {\n    node.addEventListener(eventType, handler, options);\n    listeners.push({node, eventType, handler, options});\n  }\n\n  function addEventListeners(instance: Instance): void {\n    const {reference} = instance;\n\n    on(reference, 'touchstart', onTrigger, TOUCH_OPTIONS);\n    on(reference, 'mouseover', onTrigger);\n    on(reference, 'focusin', onTrigger);\n    on(reference, 'click', onTrigger);\n  }\n\n  function removeEventListeners(): void {\n    listeners.forEach(({node, eventType, handler, options}: ListenerObject) => {\n      node.removeEventListener(eventType, handler, options);\n    });\n    listeners = [];\n  }\n\n  function applyMutations(instance: Instance): void {\n    const originalDestroy = instance.destroy;\n    const originalEnable = instance.enable;\n    const originalDisable = instance.disable;\n\n    instance.destroy = (shouldDestroyChildInstances = true): void => {\n      if (shouldDestroyChildInstances) {\n        childTippyInstances.forEach((instance) => {\n          instance.destroy();\n        });\n      }\n\n      childTippyInstances = [];\n\n      removeEventListeners();\n      originalDestroy();\n    };\n\n    instance.enable = (): void => {\n      originalEnable();\n      childTippyInstances.forEach((instance) => instance.enable());\n      disabled = false;\n    };\n\n    instance.disable = (): void => {\n      originalDisable();\n      childTippyInstances.forEach((instance) => instance.disable());\n      disabled = true;\n    };\n\n    addEventListeners(instance);\n  }\n\n  normalizedReturnValue.forEach(applyMutations);\n\n  return returnValue;\n}\n\nexport default delegate;\n","import {BACKDROP_CLASS} from '../constants';\nimport {div, setVisibilityState} from '../dom-utils';\nimport {getChildren} from '../template';\nimport {AnimateFill} from '../types';\nimport {errorWhen} from '../validation';\n\nconst animateFill: AnimateFill = {\n  name: 'animateFill',\n  defaultValue: false,\n  fn(instance) {\n    // @ts-ignore\n    if (!instance.props.render?.$$tippy) {\n      if (__DEV__) {\n        errorWhen(\n          instance.props.animateFill,\n          'The `animateFill` plugin requires the default render function.'\n        );\n      }\n\n      return {};\n    }\n\n    const {box, content} = getChildren(instance.popper);\n\n    const backdrop = instance.props.animateFill\n      ? createBackdropElement()\n      : null;\n\n    return {\n      onCreate(): void {\n        if (backdrop) {\n          box.insertBefore(backdrop, box.firstElementChild!);\n          box.setAttribute('data-animatefill', '');\n          box.style.overflow = 'hidden';\n\n          instance.setProps({arrow: false, animation: 'shift-away'});\n        }\n      },\n      onMount(): void {\n        if (backdrop) {\n          const {transitionDuration} = box.style;\n          const duration = Number(transitionDuration.replace('ms', ''));\n\n          // The content should fade in after the backdrop has mostly filled the\n          // tooltip element. `clip-path` is the other alternative but is not\n          // well-supported and is buggy on some devices.\n          content.style.transitionDelay = `${Math.round(duration / 10)}ms`;\n\n          backdrop.style.transitionDuration = transitionDuration;\n          setVisibilityState([backdrop], 'visible');\n        }\n      },\n      onShow(): void {\n        if (backdrop) {\n          backdrop.style.transitionDuration = '0ms';\n        }\n      },\n      onHide(): void {\n        if (backdrop) {\n          setVisibilityState([backdrop], 'hidden');\n        }\n      },\n    };\n  },\n};\n\nexport default animateFill;\n\nfunction createBackdropElement(): HTMLDivElement {\n  const backdrop = div();\n  backdrop.className = BACKDROP_CLASS;\n  setVisibilityState([backdrop], 'hidden');\n  return backdrop;\n}\n","import {getOwnerDocument, isMouseEvent} from '../dom-utils';\nimport {FollowCursor, Instance} from '../types';\n\nlet mouseCoords = {clientX: 0, clientY: 0};\nlet activeInstances: Array<{instance: Instance; doc: Document}> = [];\n\nfunction storeMouseCoords({clientX, clientY}: MouseEvent): void {\n  mouseCoords = {clientX, clientY};\n}\n\nfunction addMouseCoordsListener(doc: Document): void {\n  doc.addEventListener('mousemove', storeMouseCoords);\n}\n\nfunction removeMouseCoordsListener(doc: Document): void {\n  doc.removeEventListener('mousemove', storeMouseCoords);\n}\n\nconst followCursor: FollowCursor = {\n  name: 'followCursor',\n  defaultValue: false,\n  fn(instance) {\n    const reference = instance.reference;\n    const doc = getOwnerDocument(instance.props.triggerTarget || reference);\n\n    let isInternalUpdate = false;\n    let wasFocusEvent = false;\n    let isUnmounted = true;\n    let prevProps = instance.props;\n\n    function getIsInitialBehavior(): boolean {\n      return (\n        instance.props.followCursor === 'initial' && instance.state.isVisible\n      );\n    }\n\n    function addListener(): void {\n      doc.addEventListener('mousemove', onMouseMove);\n    }\n\n    function removeListener(): void {\n      doc.removeEventListener('mousemove', onMouseMove);\n    }\n\n    function unsetGetReferenceClientRect(): void {\n      isInternalUpdate = true;\n      instance.setProps({getReferenceClientRect: null});\n      isInternalUpdate = false;\n    }\n\n    function onMouseMove(event: MouseEvent): void {\n      // If the instance is interactive, avoid updating the position unless it's\n      // over the reference element\n      const isCursorOverReference = event.target\n        ? reference.contains(event.target as Node)\n        : true;\n      const {followCursor} = instance.props;\n      const {clientX, clientY} = event;\n\n      const rect = reference.getBoundingClientRect();\n      const relativeX = clientX - rect.left;\n      const relativeY = clientY - rect.top;\n\n      if (isCursorOverReference || !instance.props.interactive) {\n        instance.setProps({\n          // @ts-ignore - unneeded DOMRect properties\n          getReferenceClientRect() {\n            const rect = reference.getBoundingClientRect();\n\n            let x = clientX;\n            let y = clientY;\n\n            if (followCursor === 'initial') {\n              x = rect.left + relativeX;\n              y = rect.top + relativeY;\n            }\n\n            const top = followCursor === 'horizontal' ? rect.top : y;\n            const right = followCursor === 'vertical' ? rect.right : x;\n            const bottom = followCursor === 'horizontal' ? rect.bottom : y;\n            const left = followCursor === 'vertical' ? rect.left : x;\n\n            return {\n              width: right - left,\n              height: bottom - top,\n              top,\n              right,\n              bottom,\n              left,\n            };\n          },\n        });\n      }\n    }\n\n    function create(): void {\n      if (instance.props.followCursor) {\n        activeInstances.push({instance, doc});\n        addMouseCoordsListener(doc);\n      }\n    }\n\n    function destroy(): void {\n      activeInstances = activeInstances.filter(\n        (data) => data.instance !== instance\n      );\n\n      if (activeInstances.filter((data) => data.doc === doc).length === 0) {\n        removeMouseCoordsListener(doc);\n      }\n    }\n\n    return {\n      onCreate: create,\n      onDestroy: destroy,\n      onBeforeUpdate(): void {\n        prevProps = instance.props;\n      },\n      onAfterUpdate(_, {followCursor}): void {\n        if (isInternalUpdate) {\n          return;\n        }\n\n        if (\n          followCursor !== undefined &&\n          prevProps.followCursor !== followCursor\n        ) {\n          destroy();\n\n          if (followCursor) {\n            create();\n\n            if (\n              instance.state.isMounted &&\n              !wasFocusEvent &&\n              !getIsInitialBehavior()\n            ) {\n              addListener();\n            }\n          } else {\n            removeListener();\n            unsetGetReferenceClientRect();\n          }\n        }\n      },\n      onMount(): void {\n        if (instance.props.followCursor && !wasFocusEvent) {\n          if (isUnmounted) {\n            onMouseMove(mouseCoords as MouseEvent);\n            isUnmounted = false;\n          }\n\n          if (!getIsInitialBehavior()) {\n            addListener();\n          }\n        }\n      },\n      onTrigger(_, event): void {\n        if (isMouseEvent(event)) {\n          mouseCoords = {clientX: event.clientX, clientY: event.clientY};\n        }\n        wasFocusEvent = event.type === 'focus';\n      },\n      onHidden(): void {\n        if (instance.props.followCursor) {\n          unsetGetReferenceClientRect();\n          removeListener();\n          isUnmounted = true;\n        }\n      },\n    };\n  },\n};\n\nexport default followCursor;\n","import {Modifier, Placement} from '@popperjs/core';\nimport {isMouseEvent} from '../dom-utils';\nimport {BasePlacement, InlinePositioning, Props} from '../types';\nimport {arrayFrom, getBasePlacement} from '../utils';\n\nfunction getProps(props: Props, modifier: Modifier<any, any>): Partial<Props> {\n  return {\n    popperOptions: {\n      ...props.popperOptions,\n      modifiers: [\n        ...(props.popperOptions?.modifiers || []).filter(\n          ({name}) => name !== modifier.name\n        ),\n        modifier,\n      ],\n    },\n  };\n}\n\nconst inlinePositioning: InlinePositioning = {\n  name: 'inlinePositioning',\n  defaultValue: false,\n  fn(instance) {\n    const {reference} = instance;\n\n    function isEnabled(): boolean {\n      return !!instance.props.inlinePositioning;\n    }\n\n    let placement: Placement;\n    let cursorRectIndex = -1;\n    let isInternalUpdate = false;\n    let triedPlacements: Array<string> = [];\n\n    const modifier: Modifier<\n      'tippyInlinePositioning',\n      Record<string, unknown>\n    > = {\n      name: 'tippyInlinePositioning',\n      enabled: true,\n      phase: 'afterWrite',\n      fn({state}) {\n        if (isEnabled()) {\n          if (triedPlacements.indexOf(state.placement) !== -1) {\n            triedPlacements = [];\n          }\n\n          if (\n            placement !== state.placement &&\n            triedPlacements.indexOf(state.placement) === -1\n          ) {\n            triedPlacements.push(state.placement);\n            instance.setProps({\n              // @ts-ignore - unneeded DOMRect properties\n              getReferenceClientRect: () =>\n                getReferenceClientRect(state.placement),\n            });\n          }\n\n          placement = state.placement;\n        }\n      },\n    };\n\n    function getReferenceClientRect(placement: Placement): Partial<DOMRect> {\n      return getInlineBoundingClientRect(\n        getBasePlacement(placement),\n        reference.getBoundingClientRect(),\n        arrayFrom(reference.getClientRects()),\n        cursorRectIndex\n      );\n    }\n\n    function setInternalProps(partialProps: Partial<Props>): void {\n      isInternalUpdate = true;\n      instance.setProps(partialProps);\n      isInternalUpdate = false;\n    }\n\n    function addModifier(): void {\n      if (!isInternalUpdate) {\n        setInternalProps(getProps(instance.props, modifier));\n      }\n    }\n\n    return {\n      onCreate: addModifier,\n      onAfterUpdate: addModifier,\n      onTrigger(_, event): void {\n        if (isMouseEvent(event)) {\n          const rects = arrayFrom(instance.reference.getClientRects());\n          const cursorRect = rects.find(\n            (rect) =>\n              rect.left - 2 <= event.clientX &&\n              rect.right + 2 >= event.clientX &&\n              rect.top - 2 <= event.clientY &&\n              rect.bottom + 2 >= event.clientY\n          );\n          const index = rects.indexOf(cursorRect);\n          cursorRectIndex = index > -1 ? index : cursorRectIndex;\n        }\n      },\n      onHidden(): void {\n        cursorRectIndex = -1;\n      },\n    };\n  },\n};\n\nexport default inlinePositioning;\n\nexport function getInlineBoundingClientRect(\n  currentBasePlacement: BasePlacement | null,\n  boundingRect: DOMRect,\n  clientRects: DOMRect[],\n  cursorRectIndex: number\n): {\n  top: number;\n  bottom: number;\n  left: number;\n  right: number;\n  width: number;\n  height: number;\n} {\n  // Not an inline element, or placement is not yet known\n  if (clientRects.length < 2 || currentBasePlacement === null) {\n    return boundingRect;\n  }\n\n  // There are two rects and they are disjoined\n  if (\n    clientRects.length === 2 &&\n    cursorRectIndex >= 0 &&\n    clientRects[0].left > clientRects[1].right\n  ) {\n    return clientRects[cursorRectIndex] || boundingRect;\n  }\n\n  switch (currentBasePlacement) {\n    case 'top':\n    case 'bottom': {\n      const firstRect = clientRects[0];\n      const lastRect = clientRects[clientRects.length - 1];\n      const isTop = currentBasePlacement === 'top';\n\n      const top = firstRect.top;\n      const bottom = lastRect.bottom;\n      const left = isTop ? firstRect.left : lastRect.left;\n      const right = isTop ? firstRect.right : lastRect.right;\n      const width = right - left;\n      const height = bottom - top;\n\n      return {top, bottom, left, right, width, height};\n    }\n    case 'left':\n    case 'right': {\n      const minLeft = Math.min(...clientRects.map((rects) => rects.left));\n      const maxRight = Math.max(...clientRects.map((rects) => rects.right));\n      const measureRects = clientRects.filter((rect) =>\n        currentBasePlacement === 'left'\n          ? rect.left === minLeft\n          : rect.right === maxRight\n      );\n\n      const top = measureRects[0].top;\n      const bottom = measureRects[measureRects.length - 1].bottom;\n      const left = minLeft;\n      const right = maxRight;\n      const width = right - left;\n      const height = bottom - top;\n\n      return {top, bottom, left, right, width, height};\n    }\n    default: {\n      return boundingRect;\n    }\n  }\n}\n","import {VirtualElement} from '@popperjs/core';\nimport {ReferenceElement, Sticky} from '../types';\n\nconst sticky: Sticky = {\n  name: 'sticky',\n  defaultValue: false,\n  fn(instance) {\n    const {reference, popper} = instance;\n\n    function getReference(): ReferenceElement | VirtualElement {\n      return instance.popperInstance\n        ? instance.popperInstance.state.elements.reference\n        : reference;\n    }\n\n    function shouldCheck(value: 'reference' | 'popper'): boolean {\n      return instance.props.sticky === true || instance.props.sticky === value;\n    }\n\n    let prevRefRect: ClientRect | null = null;\n    let prevPopRect: ClientRect | null = null;\n\n    function updatePosition(): void {\n      const currentRefRect = shouldCheck('reference')\n        ? getReference().getBoundingClientRect()\n        : null;\n      const currentPopRect = shouldCheck('popper')\n        ? popper.getBoundingClientRect()\n        : null;\n\n      if (\n        (currentRefRect && areRectsDifferent(prevRefRect, currentRefRect)) ||\n        (currentPopRect && areRectsDifferent(prevPopRect, currentPopRect))\n      ) {\n        if (instance.popperInstance) {\n          instance.popperInstance.update();\n        }\n      }\n\n      prevRefRect = currentRefRect;\n      prevPopRect = currentPopRect;\n\n      if (instance.state.isMounted) {\n        requestAnimationFrame(updatePosition);\n      }\n    }\n\n    return {\n      onMount(): void {\n        if (instance.props.sticky) {\n          updatePosition();\n        }\n      },\n    };\n  },\n};\n\nexport default sticky;\n\nfunction areRectsDifferent(\n  rectA: ClientRect | null,\n  rectB: ClientRect | null\n): boolean {\n  if (rectA && rectB) {\n    return (\n      rectA.top !== rectB.top ||\n      rectA.right !== rectB.right ||\n      rectA.bottom !== rectB.bottom ||\n      rectA.left !== rectB.left\n    );\n  }\n\n  return true;\n}\n","import tippy from '../src';\nimport {render} from '../src/template';\n\ntippy.setDefaultProps({render});\n\nexport {default, hideAll} from '../src';\nexport {default as createSingleton} from '../src/addons/createSingleton';\nexport {default as delegate} from '../src/addons/delegate';\nexport {default as animateFill} from '../src/plugins/animateFill';\nexport {default as followCursor} from '../src/plugins/followCursor';\nexport {default as inlinePositioning} from '../src/plugins/inlinePositioning';\nexport {default as sticky} from '../src/plugins/sticky';\nexport {ROUND_ARROW as roundArrow} from '../src/constants';\n"],"names":["ROUND_ARROW","BOX_CLASS","CONTENT_CLASS","BACKDROP_CLASS","ARROW_CLASS","SVG_ARROW_CLASS","TOUCH_OPTIONS","passive","capture","TIPPY_DEFAULT_APPEND_TO","document","body","hasOwnProperty","obj","key","call","getValueAtIndexOrReturn","value","index","defaultValue","Array","isArray","v","isType","type","str","toString","indexOf","invokeWithArgsOrReturn","args","debounce","fn","ms","timeout","arg","clearTimeout","setTimeout","removeProperties","keys","clone","forEach","splitBySpaces","split","filter","Boolean","normalizeToArray","concat","pushIfUnique","arr","push","unique","item","getBasePlacement","placement","arrayFrom","slice","removeUndefinedProps","Object","reduce","acc","undefined","div","createElement","isElement","some","isNodeList","isMouseEvent","isReferenceElement","_tippy","reference","getArrayOfElements","querySelectorAll","setTransitionDuration","els","el","style","transitionDuration","setVisibilityState","state","setAttribute","getOwnerDocument","elementOrElements","element","ownerDocument","isCursorOutsideInteractiveBorder","popperTreeData","event","clientX","clientY","every","popperRect","popperState","props","interactiveBorder","basePlacement","offsetData","modifiersData","offset","topDistance","top","y","bottomDistance","bottom","leftDistance","left","x","rightDistance","right","exceedsTop","exceedsBottom","exceedsLeft","exceedsRight","updateTransitionEndListener","box","action","listener","method","actualContains","parent","child","target","contains","getRootNode","host","currentInput","isTouch","lastMouseMoveTime","onDocumentTouchStart","window","performance","addEventListener","onDocumentMouseMove","now","removeEventListener","onWindowBlur","activeElement","instance","blur","isVisible","bindGlobalEventListeners","isBrowser","isIE11","msCrypto","createMemoryLeakWarning","txt","join","clean","spacesAndTabs","lineStartWithSpaces","replace","trim","getDevMessage","message","getFormattedMessage","visitedMessages","resetVisitedMessages","Set","warnWhen","condition","has","add","console","warn","errorWhen","error","validateTargets","targets","didPassFalsyValue","didPassPlainObject","prototype","String","pluginProps","animateFill","followCursor","inlinePositioning","sticky","renderProps","allowHTML","animation","arrow","content","inertia","maxWidth","role","theme","zIndex","defaultProps","appendTo","aria","expanded","delay","duration","getReferenceClientRect","hideOnClick","ignoreAttributes","interactive","interactiveDebounce","moveTransition","onAfterUpdate","onBeforeUpdate","onCreate","onDestroy","onHidden","onHide","onMount","onShow","onShown","onTrigger","onUntrigger","onClickOutside","plugins","popperOptions","render","showOnCreate","touch","trigger","triggerTarget","defaultKeys","setDefaultProps","partialProps","validateProps","getExtendedPassedProps","passedProps","plugin","name","getDataAttributeProps","propKeys","valueAsString","getAttribute","JSON","parse","e","evaluateProps","out","prop","nonPluginProps","didPassUnknownProp","length","innerHTML","dangerouslySetInnerHTML","html","createArrowElement","className","appendChild","setContent","textContent","getChildren","popper","firstElementChild","boxChildren","children","find","node","classList","backdrop","onUpdate","prevProps","nextProps","removeAttribute","removeChild","$$tippy","idCounter","mouseMoveListeners","mountedInstances","createTippy","showTimeout","hideTimeout","scheduleHideAnimationFrame","isVisibleFromClick","didHideDueToDocumentMouseDown","didTouchMove","ignoreOnFirstUpdate","lastTriggerEvent","currentTransitionEndListener","onFirstUpdate","listeners","debouncedOnMouseMove","onMouseMove","currentTarget","id","popperInstance","isEnabled","isDestroyed","isMounted","isShown","clearDelayTimeouts","setProps","show","hide","hideWithInteractivity","enable","disable","unmount","destroy","pluginsHooks","map","hasAriaExpanded","hasAttribute","addListeners","handleAriaExpandedAttribute","handleStyles","invokeHook","scheduleShow","getDocument","getNormalizedTouchSettings","getIsCustomTouchBehavior","getIsDefaultRenderFn","getCurrentTarget","parentNode","getDefaultTemplateChildren","getDelay","isShow","fromHide","pointerEvents","hook","shouldInvokePropsHook","pluginHooks","handleAriaContentAttribute","attr","nodes","currentValue","nextValue","cleanupInteractiveMouseListeners","onDocumentPress","actualTarget","composedPath","removeDocumentPress","onTouchMove","onTouchStart","addDocumentPress","doc","onTransitionedOut","callback","onTransitionEnd","onTransitionedIn","on","eventType","handler","options","onMouseLeave","onBlurOrFocusOut","removeListeners","shouldScheduleClickHide","isEventListenerStopped","wasFocused","scheduleHide","isCursorOverReferenceOrPopper","getNestedPopperTree","getBoundingClientRect","shouldBail","relatedTarget","createPopperInstance","destroyPopperInstance","computedReference","contextElement","tippyModifier","enabled","phase","requires","attributes","modifiers","padding","adaptive","createPopper","mount","nextElementSibling","touchValue","touchDelay","requestAnimationFrame","cancelAnimationFrame","nestedPopper","forceUpdate","isAlreadyVisible","isDisabled","isTouchAndTouchDisabled","visibility","transition","offsetHeight","isAlreadyHidden","i","tippy","optionalProps","elements","isSingleContentElement","isMoreThanOneReferenceElement","instances","hideAll","excludedReferenceOrInstance","exclude","isExcluded","originalDuration","applyStylesModifier","applyStyles","effect","initialStyles","position","strategy","margin","assign","styles","createSingleton","tippyInstances","individualInstances","references","triggerTargets","overrides","interceptSetPropsCleanups","shownOnCreate","setTriggerTargets","setReferences","enableInstances","interceptSetProps","singleton","originalSetProps","prepareInstance","overrideProps","originalShow","ref","showNext","first","showPrevious","last","setInstances","nextInstances","BUBBLING_EVENTS_MAP","mouseover","focusin","click","delegate","childTippyInstances","disabled","nativeProps","parentProps","childProps","returnValue","normalizedReturnValue","targetNode","closest","addEventListeners","removeEventListeners","applyMutations","originalDestroy","originalEnable","originalDisable","shouldDestroyChildInstances","createBackdropElement","insertBefore","overflow","Number","transitionDelay","Math","round","mouseCoords","activeInstances","storeMouseCoords","addMouseCoordsListener","removeMouseCoordsListener","isInternalUpdate","wasFocusEvent","isUnmounted","getIsInitialBehavior","addListener","removeListener","unsetGetReferenceClientRect","isCursorOverReference","rect","relativeX","relativeY","width","height","create","data","_","getProps","modifier","cursorRectIndex","triedPlacements","getInlineBoundingClientRect","getClientRects","setInternalProps","addModifier","rects","cursorRect","currentBasePlacement","boundingRect","clientRects","firstRect","lastRect","isTop","minLeft","min","maxRight","max","measureRects","getReference","shouldCheck","prevRefRect","prevPopRect","updatePosition","currentRefRect","currentPopRect","areRectsDifferent","update","rectA","rectB"],"mappings":"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"}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/index.d.ts #######

```

import * as Popper from '@popperjs/core';

export type BasePlacement = Popper.BasePlacement;

export type Placement = Popper.Placement;

export type Content =
  | string
  | Element
  | DocumentFragment
  | ((ref: Element) => string | Element | DocumentFragment);

export type SingleTarget = Element;

export type MultipleTargets = string | Element[] | NodeList;

export type Targets = SingleTarget | MultipleTargets;

export interface ReferenceElement<TProps = Props> extends Element {
  _tippy?: Instance<TProps>;
}

export interface PopperElement<TProps = Props> extends HTMLDivElement {
  _tippy?: Instance<TProps>;
}

export interface LifecycleHooks<TProps = Props> {
  onAfterUpdate(
    instance: Instance<TProps>,
    partialProps: Partial<TProps>
  ): void;
  onBeforeUpdate(
    instance: Instance<TProps>,
    partialProps: Partial<TProps>
  ): void;
  onCreate(instance: Instance<TProps>): void;
  onDestroy(instance: Instance<TProps>): void;
  onHidden(instance: Instance<TProps>): void;
  onHide(instance: Instance<TProps>): void | false;
  onMount(instance: Instance<TProps>): void;
  onShow(instance: Instance<TProps>): void | false;
  onShown(instance: Instance<TProps>): void;
  onTrigger(instance: Instance<TProps>, event: Event): void;
  onUntrigger(instance: Instance<TProps>, event: Event): void;
  onClickOutside(instance: Instance<TProps>, event: Event): void;
}

export interface RenderProps {
  allowHTML: boolean;
  animation: string | boolean;
  arrow: boolean | string | SVGElement | DocumentFragment;
  content: Content;
  inertia: boolean;
  maxWidth: number | string;
  role: string;
  theme: string;
  zIndex: number;
}

export interface GetReferenceClientRect {
  (): ClientRect | DOMRect;
  contextElement?: Element;
}

export interface Props extends LifecycleHooks, RenderProps {
  animateFill: boolean;
  appendTo: 'parent' | Element | ((ref: Element) => Element);
  aria: {
    content?: 'auto' | 'describedby' | 'labelledby' | null;
    expanded?: 'auto' | boolean;
  };
  delay: number | [number | null, number | null];
  duration: number | [number | null, number | null];
  followCursor: boolean | 'horizontal' | 'vertical' | 'initial';
  getReferenceClientRect: null | GetReferenceClientRect;
  hideOnClick: boolean | 'toggle';
  ignoreAttributes: boolean;
  inlinePositioning: boolean;
  interactive: boolean;
  interactiveBorder: number;
  interactiveDebounce: number;
  moveTransition: string;
  offset:
    | [number, number]
    | (({
        placement,
        popper,
        reference,
      }: {
        placement: Placement;
        popper: Popper.Rect;
        reference: Popper.Rect;
      }) => [number, number]);
  placement: Placement;
  plugins: Plugin<unknown>[];
  popperOptions: Partial<Popper.Options>;
  render:
    | ((
        instance: Instance
      ) => {
        popper: PopperElement;
        onUpdate?: (prevProps: Props, nextProps: Props) => void;
      })
    | null;
  showOnCreate: boolean;
  sticky: boolean | 'reference' | 'popper';
  touch: boolean | 'hold' | ['hold', number];
  trigger: string;
  triggerTarget: Element | Element[] | null;
}

export interface DefaultProps extends Omit<Props, 'delay' | 'duration'> {
  delay: number | [number, number];
  duration: number | [number, number];
}

export interface Instance<TProps = Props> {
  clearDelayTimeouts(): void;
  destroy(): void;
  disable(): void;
  enable(): void;
  hide(): void;
  hideWithInteractivity(event: MouseEvent): void;
  id: number;
  plugins: Plugin<TProps>[];
  popper: PopperElement<TProps>;
  popperInstance: Popper.Instance | null;
  props: TProps;
  reference: ReferenceElement<TProps>;
  setContent(content: Content): void;
  setProps(partialProps: Partial<TProps>): void;
  show(): void;
  state: {
    isEnabled: boolean;
    isVisible: boolean;
    isDestroyed: boolean;
    isMounted: boolean;
    isShown: boolean;
  };
  unmount(): void;
}

export interface TippyStatics {
  readonly currentInput: {isTouch: boolean};
  readonly defaultProps: DefaultProps;
  setDefaultProps(partialProps: Partial<DefaultProps>): void;
}

export interface Tippy<TProps = Props> extends TippyStatics {
  (targets: SingleTarget, optionalProps?: Partial<TProps>): Instance<TProps>;
}

export interface Tippy<TProps = Props> extends TippyStatics {
  (targets: MultipleTargets, optionalProps?: Partial<TProps>): Instance<
    TProps
  >[];
}

declare const tippy: Tippy;

// =============================================================================
// Addon types
// =============================================================================
export interface DelegateInstance<TProps = Props> extends Instance<TProps> {
  destroy(shouldDestroyTargetInstances?: boolean): void;
}

export interface Delegate<TProps = Props> {
  (
    targets: SingleTarget,
    props: Partial<TProps> & {target: string}
  ): DelegateInstance<TProps>;
}

export interface Delegate<TProps = Props> {
  (
    targets: MultipleTargets,
    props: Partial<TProps> & {target: string}
  ): DelegateInstance<TProps>[];
}

export type CreateSingletonProps<TProps = Props> = TProps & {
  overrides: Array<keyof TProps>;
};

export type CreateSingletonInstance<TProps = CreateSingletonProps> = Instance<
  TProps
> & {
  setInstances(instances: Instance<any>[]): void;
  show(target?: ReferenceElement | Instance | number): void;
  showNext(): void;
  showPrevious(): void;
};

export type CreateSingleton<TProps = Props> = (
  tippyInstances: Instance<any>[],
  optionalProps?: Partial<CreateSingletonProps<TProps>>
) => CreateSingletonInstance<CreateSingletonProps<TProps>>;

declare const delegate: Delegate;
declare const createSingleton: CreateSingleton;

// =============================================================================
// Plugin types
// =============================================================================
export interface Plugin<TProps = Props> {
  name?: string;
  defaultValue?: any;
  fn(instance: Instance<TProps>): Partial<LifecycleHooks<TProps>>;
}

export interface AnimateFill extends Plugin {
  name: 'animateFill';
  defaultValue: false;
}

export interface FollowCursor extends Plugin {
  name: 'followCursor';
  defaultValue: false;
}

export interface InlinePositioning extends Plugin {
  name: 'inlinePositioning';
  defaultValue: false;
}

export interface Sticky extends Plugin {
  name: 'sticky';
  defaultValue: false;
}

declare const animateFill: AnimateFill;
declare const followCursor: FollowCursor;
declare const inlinePositioning: InlinePositioning;
declare const sticky: Sticky;

// =============================================================================
// Misc types
// =============================================================================
export interface HideAllOptions {
  duration?: number;
  exclude?: Instance | ReferenceElement;
}

export type HideAll = (options?: HideAllOptions) => void;

declare const hideAll: HideAll;
declare const roundArrow: string;

export default tippy;
export {
  hideAll,
  delegate,
  createSingleton,
  animateFill,
  followCursor,
  inlinePositioning,
  sticky,
  roundArrow,
};

```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/LICENSE #######

```

MIT License

Copyright (c) 2017-present atomiks

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/package.json #######

```

{
  "name": "tippy.js",
  "version": "6.3.7",
  "description": "The complete tooltip, popover, dropdown, and menu solution for the web",
  "main": "dist/tippy.cjs.js",
  "module": "dist/tippy.esm.js",
  "unpkg": "dist/tippy-bundle.umd.min.js",
  "types": "index.d.ts",
  "sideEffects": [
    "**/*.css"
  ],
  "author": "atomiks",
  "contributors": [
    "Brett Zamir"
  ],
  "license": "MIT",
  "bugs": "https://github.com/atomiks/tippyjs/issues",
  "homepage": "https://atomiks.github.io/tippyjs/",
  "keywords": [
    "tooltip",
    "popover",
    "popper",
    "dropdown",
    "popup",
    "tippy",
    "tippy.js"
  ],
  "files": [
    "dist/",
    "animations/",
    "themes/",
    "headless/",
    "index.d.ts"
  ],
  "repository": {
    "type": "git",
    "url": "git+https://github.com/atomiks/tippyjs.git"
  },
  "scripts": {
    "dev": "cross-env NODE_ENV=dev rollup -c .config/rollup.config.js --watch",
    "build": "node build/index.js && rollup -c .config/rollup.config.js && bundlesize",
    "build:visual": "cross-env NODE_ENV=test rollup -c .config/rollup.config.js",
    "serve": "serve test/visual",
    "test:dom": "jest unit integration --coverage",
    "test:functional": "jest functional",
    "test:types": "tsc && tsd",
    "test": "yarn test:types && yarn test:dom && yarn test:functional",
    "lint": "eslint . --ext .ts,.js",
    "format": "prettier --write \"**/*.{js,ts,json,md,mdx,scss,css}\" --ignore-path .config/.prettierignore",
    "clean": "rimraf dist/ themes/ animations/ coverage/ .devserver/ .cache/ ./index.d.ts",
    "prepare": "yarn clean && yarn build"
  },
  "babel": {
    "extends": "./.config/babel.config"
  },
  "jest": {
    "preset": "./.config/jest.config"
  },
  "eslintConfig": {
    "extends": "./.config/eslint.config"
  },
  "prettier": {
    "singleQuote": true,
    "bracketSpacing": false,
    "proseWrap": "always"
  },
  "browserslist": [
    "> 0.5%",
    "not dead",
    "not safari < 8"
  ],
  "bundlesize": [
    {
      "path": "dist/tippy-bundle.umd.min.js",
      "maxSize": "10 kB"
    },
    {
      "path": "headless/dist/tippy-headless.umd.min.js",
      "maxSize": "10 kB"
    },
    {
      "path": "dist/tippy.umd.min.js",
      "maxSize": "10 kB"
    },
    {
      "path": "dist/tippy.css",
      "maxSize": "5 kB"
    }
  ],
  "husky": {
    "hooks": {
      "pre-commit": "lint-staged"
    }
  },
  "lint-staged": {
    "src/**/*.ts": [
      "jest --findRelatedTests",
      "eslint . --ext .ts,.js",
      "git add"
    ],
    "{build,src,test,website/src}/**/*.{ts,js,json,css,scss,md}": [
      "prettier --write",
      "git add"
    ]
  },
  "devDependencies": {
    "@babel/core": "^7.8.3",
    "@babel/preset-env": "^7.8.3",
    "@babel/preset-typescript": "^7.13.0",
    "@testing-library/dom": "^6.11.0",
    "@types/node": "^12.12.25",
    "@typescript-eslint/eslint-plugin": "^4.16.1",
    "@typescript-eslint/parser": "^4.16.1",
    "autoprefixer": "^9.7.4",
    "babel-jest": "^25.3.0",
    "babel-plugin-dev-expression": "^0.2.2",
    "bundlesize": "^0.18.0",
    "colorette": "^1.1.0",
    "core-js": "^3.6.4",
    "cross-env": "^7.0.0",
    "cssnano": "^4.1.10",
    "dotenv": "^8.2.0",
    "eslint": "^6.8.0",
    "eslint-config-prettier": "^6.9.0",
    "husky": "^3.1.0",
    "jest": "^25.3.0",
    "jest-environment-jsdom-fourteen": "^1.0.1",
    "jest-image-snapshot": "^2.12.0",
    "jest-puppeteer": "^4.4.0",
    "jest-puppeteer-docker": "^1.3.2",
    "lint-staged": "^9.5.0",
    "postcss": "^7.0.26",
    "poster": "0.0.9",
    "prettier": "^2.0.1",
    "promise": "^8.0.3",
    "puppeteer": "^2.1.1",
    "rimraf": "^3.0.0",
    "rollup": "^1.29.1",
    "rollup-plugin-babel": "^4.3.3",
    "rollup-plugin-commonjs": "^10.0.2",
    "rollup-plugin-css-only": "^1.0.0",
    "rollup-plugin-json": "^4.0.0",
    "rollup-plugin-livereload": "^1.0.4",
    "rollup-plugin-node-resolve": "^5.2.0",
    "rollup-plugin-replace": "^2.2.0",
    "rollup-plugin-sass": "^1.2.2",
    "rollup-plugin-serve": "^1.0.1",
    "rollup-plugin-terser": "^5.2.0",
    "sass": "^1.25.0",
    "serve": "^11.3.0",
    "tsd": "^0.14.0",
    "typescript": "^4.2.2"
  },
  "dependencies": {
    "@popperjs/core": "^2.9.0"
  }
}

```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/README.md #######

<div align="center">
  <img alt="Tippy.js logo" src="https://github.com/atomiks/tippyjs/raw/master/logo.png" height="117" />
</div>

<div align="center">
  <h1>Tippy.js</h1>
  <p>The complete tooltip, popover, dropdown, and menu solution for the web</p>
  <a href="https://www.npmjs.com/package/tippy.js">
   <img src="https://img.shields.io/npm/dm/tippy.js.svg?color=%235599ff&style=for-the-badge" alt="npm Downloads per Month">
  <a>
  <a href="https://github.com/atomiks/tippyjs/blob/master/LICENSE">
    <img src="https://img.shields.io/npm/l/tippy.js.svg?color=%23c677cf&style=for-the-badge" alt="MIT License">
  </a>
  <br>
  <br>
</div>

## Demo and Documentation

➡️ **[View the latest demo & docs here](https://atomiks.github.io/tippyjs/)**

[Migration Guide](https://github.com/atomiks/tippyjs/blob/master/MIGRATION_GUIDE.md)

## Installation

### Package Managers

```bash
# npm
npm i tippy.js

# Yarn
yarn add tippy.js
```

Import the `tippy` constructor and the core CSS:

```js
import tippy from 'tippy.js';
import 'tippy.js/dist/tippy.css';
```

### CDN

```html
<script src="https://unpkg.com/@popperjs/core@2"></script>
<script src="https://unpkg.com/tippy.js@6"></script>
```

The core CSS comes bundled with the default unpkg import.

## Usage

For detailed usage information,
[visit the docs](https://atomiks.github.io/tippyjs/v6/getting-started/).

## Component Wrappers

React: [@tippyjs/react](https://github.com/atomiks/tippyjs-react)

## License

MIT

####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/themes/light-border.css #######

```

.tippy-box[data-theme~=light-border]{background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,8,16,.15);color:#333;box-shadow:0 4px 14px -2px rgba(0,8,16,.08)}.tippy-box[data-theme~=light-border]>.tippy-backdrop{background-color:#fff}.tippy-box[data-theme~=light-border]>.tippy-arrow:after,.tippy-box[data-theme~=light-border]>.tippy-svg-arrow:after{content:"";position:absolute;z-index:-1}.tippy-box[data-theme~=light-border]>.tippy-arrow:after{border-color:transparent;border-style:solid}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-arrow:before{border-top-color:#fff}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-arrow:after{border-top-color:rgba(0,8,16,.2);border-width:7px 7px 0;top:17px;left:1px}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-svg-arrow>svg{top:16px}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-svg-arrow:after{top:17px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-arrow:before{border-bottom-color:#fff;bottom:16px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-arrow:after{border-bottom-color:rgba(0,8,16,.2);border-width:0 7px 7px;bottom:17px;left:1px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-svg-arrow>svg{bottom:16px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-svg-arrow:after{bottom:17px}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-arrow:before{border-left-color:#fff}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-arrow:after{border-left-color:rgba(0,8,16,.2);border-width:7px 0 7px 7px;left:17px;top:1px}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-svg-arrow>svg{left:11px}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-svg-arrow:after{left:12px}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-arrow:before{border-right-color:#fff;right:16px}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-arrow:after{border-width:7px 7px 7px 0;right:17px;top:1px;border-right-color:rgba(0,8,16,.2)}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-svg-arrow>svg{right:11px}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-svg-arrow:after{right:12px}.tippy-box[data-theme~=light-border]>.tippy-svg-arrow{fill:#fff}.tippy-box[data-theme~=light-border]>.tippy-svg-arrow:after{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMCA2czEuNzk2LS4wMTMgNC42Ny0zLjYxNUM1Ljg1MS45IDYuOTMuMDA2IDggMGMxLjA3LS4wMDYgMi4xNDguODg3IDMuMzQzIDIuMzg1QzE0LjIzMyA2LjAwNSAxNiA2IDE2IDZIMHoiIGZpbGw9InJnYmEoMCwgOCwgMTYsIDAuMikiLz48L3N2Zz4=);background-size:16px 6px;width:16px;height:6px}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/themes/light.css #######

```

.tippy-box[data-theme~=light]{color:#26323d;box-shadow:0 0 20px 4px rgba(154,161,177,.15),0 4px 80px -8px rgba(36,40,47,.25),0 4px 4px -2px rgba(91,94,105,.15);background-color:#fff}.tippy-box[data-theme~=light][data-placement^=top]>.tippy-arrow:before{border-top-color:#fff}.tippy-box[data-theme~=light][data-placement^=bottom]>.tippy-arrow:before{border-bottom-color:#fff}.tippy-box[data-theme~=light][data-placement^=left]>.tippy-arrow:before{border-left-color:#fff}.tippy-box[data-theme~=light][data-placement^=right]>.tippy-arrow:before{border-right-color:#fff}.tippy-box[data-theme~=light]>.tippy-backdrop{background-color:#fff}.tippy-box[data-theme~=light]>.tippy-svg-arrow{fill:#fff}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/themes/material.css #######

```

.tippy-box[data-theme~=material]{background-color:#505355;font-weight:600}.tippy-box[data-theme~=material][data-placement^=top]>.tippy-arrow:before{border-top-color:#505355}.tippy-box[data-theme~=material][data-placement^=bottom]>.tippy-arrow:before{border-bottom-color:#505355}.tippy-box[data-theme~=material][data-placement^=left]>.tippy-arrow:before{border-left-color:#505355}.tippy-box[data-theme~=material][data-placement^=right]>.tippy-arrow:before{border-right-color:#505355}.tippy-box[data-theme~=material]>.tippy-backdrop{background-color:#505355}.tippy-box[data-theme~=material]>.tippy-svg-arrow{fill:#505355}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/node_modules/tippy.js/themes/translucent.css #######

```

.tippy-box[data-theme~=translucent]{background-color:rgba(0,0,0,.7)}.tippy-box[data-theme~=translucent]>.tippy-arrow{width:14px;height:14px}.tippy-box[data-theme~=translucent][data-placement^=top]>.tippy-arrow:before{border-width:7px 7px 0;border-top-color:rgba(0,0,0,.7)}.tippy-box[data-theme~=translucent][data-placement^=bottom]>.tippy-arrow:before{border-width:0 7px 7px;border-bottom-color:rgba(0,0,0,.7)}.tippy-box[data-theme~=translucent][data-placement^=left]>.tippy-arrow:before{border-width:7px 0 7px 7px;border-left-color:rgba(0,0,0,.7)}.tippy-box[data-theme~=translucent][data-placement^=right]>.tippy-arrow:before{border-width:7px 7px 7px 0;border-right-color:rgba(0,0,0,.7)}.tippy-box[data-theme~=translucent]>.tippy-backdrop{background-color:rgba(0,0,0,.7)}.tippy-box[data-theme~=translucent]>.tippy-svg-arrow{fill:rgba(0,0,0,.7)}
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/package.json #######

```

{
	"name": "~TODO~",
	"version": "0.0.1",
	"scripts": {
		"dev": "./node_modules/vite/bin/vite.js dev",
		"build": "./node_modules/vite/bin/vite.js build",
		"preview": "./node_modules/vite/bin/vite.js preview"
	},
	"dependencies": {
		"tippy.js": "^6.3.7"
	},
	"type": "module"
}

```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-a/src/lib/App.svelte #######

```

<script>
	import tippy from 'tippy.js';
	import 'tippy.js/dist/tippy.css';
	import 'tippy.js/themes/material.css';

	let content = 'Hello!';

	function tooltip(node) {
		const tooltip = tippy(node);

		return {
			destroy() {
				tooltip.destroy();
			}
		};
	}
</script>

<input bind:value={content} />

<button use:tooltip>
	Hover me
</button>
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/app-b/src/lib/App.svelte #######

```

<script>
	import tippy from 'tippy.js';
	import 'tippy.js/dist/tippy.css';
	import 'tippy.js/themes/material.css';

	let content = 'Hello!';

	function tooltip(node, options) {
		const tooltip = tippy(node, options);

		return {
			update(options) {
				tooltip.setProps(options);
			},
			destroy() {
				tooltip.destroy();
			}
		};
	}
</script>

<input bind:value={content} />

<button use:tooltip={{ content, theme: 'material' }}>
	Hover me
</button>
```


####### content/tutorial/02-advanced-svelte/04-actions/02-adding-parameters-to-actions/README.md #######

---
title: Adding parameters
---

Like transitions and animations, an action can take an argument, which the action function will be called with alongside the element it belongs to.

In this exercise, we want to add a tooltip to the `<button>` using the [`Tippy.js`](https://atomiks.github.io/tippyjs/) library. The action is already wired up with `use:tooltip`, but if you hover over the button (or focus it with the keyboard) the tooltip contains no content.

First, the action needs to accept some options and pass them to Tippy:

```js
/// file: App.svelte
function tooltip(node, +++options+++) {
	const tooltip = tippy(node, +++options+++);

	return {
		destroy() {
			tooltip.destroy();
		}
	};
}
```

Then, we need to pass some options into the action:

```svelte
/// file: App.svelte
<button use:tooltip+++={{ content, theme: 'material' }}+++>
	Hover me
</button>
```

The tooltip now works — almost. If we change the text in the `<input>`, the tooltip will not reflect the new content. We can fix that by adding an `update` method to the returned object.

```js
/// file: App.svelte
function tooltip(node, options) {
	const tooltip = tippy(node, options);

	return {
+++		update(options) {
			tooltip.setProps(options);
		},+++
		destroy() {
			tooltip.destroy();
		}
	};
}
```

####### content/tutorial/02-advanced-svelte/04-actions/meta.json #######

```

{
	"title": "Actions",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/05-bindings/01-contenteditable-bindings/app-a/src/lib/App.svelte #######

```

<script>
	let html = '<p>Write some text!</p>';
</script>

<div contenteditable />

<pre>{html}</pre>

<style>
	[contenteditable] {
		padding: 0.5em;
		border: 1px solid #eee;
		border-radius: 4px;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/05-bindings/01-contenteditable-bindings/app-b/src/lib/App.svelte #######

```

<script>
	let html = '<p>Write some text!</p>';
</script>

<div bind:innerHTML={html} contenteditable />

<pre>{html}</pre>

<style>
	[contenteditable] {
		padding: 0.5em;
		border: 1px solid #eee;
		border-radius: 4px;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/05-bindings/01-contenteditable-bindings/README.md #######

---
title: Contenteditable bindings
---

Elements with a `contenteditable` attribute support `textContent` and `innerHTML` bindings:

```svelte
/// file: App.svelte
<div +++bind:innerHTML={html}+++ contenteditable />
```

####### content/tutorial/02-advanced-svelte/05-bindings/02-each-block-bindings/app-a/src/lib/App.svelte #######

```

<script>
	let todos = [
		{ done: false, text: 'finish Svelte tutorial' },
		{ done: false, text: 'build an app' },
		{ done: false, text: 'world domination' }
	];

	function add() {
		todos = todos.concat({
			done: false,
			text: ''
		});
	}

	function clear() {
		todos = todos.filter((t) => !t.done);
	}

	$: remaining = todos.filter((t) => !t.done).length;
</script>

<div class="centered">
	<h1>todos</h1>

	<ul class="todos">
		{#each todos as todo}
			<li class:done={todo.done}>
				<input
					type="checkbox"
					checked={todo.done}
				/>

				<input
					type="text"
					placeholder="What needs to be done?"
					value={todo.text}
				/>
			</li>
		{/each}
	</ul>

	<p>{remaining} remaining</p>

	<button on:click={add}>
		Add new
	</button>

	<button on:click={clear}>
		Clear completed
	</button>
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	.done {
		opacity: 0.4;
	}

	li {
		display: flex;
	}

	input[type="text"] {
		flex: 1;
		padding: 0.5em;
		margin: -0.2em 0;
		border: none;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/05-bindings/02-each-block-bindings/app-b/src/lib/App.svelte #######

```

<script>
	let todos = [
		{ done: false, text: 'finish Svelte tutorial' },
		{ done: false, text: 'build an app' },
		{ done: false, text: 'world domination' }
	];

	function add() {
		todos = todos.concat({
			done: false,
			text: ''
		});
	}

	function clear() {
		todos = todos.filter((t) => !t.done);
	}

	$: remaining = todos.filter((t) => !t.done).length;
</script>

<div class="centered">
	<h1>todos</h1>

	<ul class="todos">
		{#each todos as todo}
			<li class:done={todo.done}>
				<input
					type="checkbox"
					bind:checked={todo.done}
				/>

				<input
					type="text"
					placeholder="What needs to be done?"
					bind:value={todo.text}
				/>
			</li>
		{/each}
	</ul>

	<p>{remaining} remaining</p>

	<button on:click={add}>
		Add new
	</button>

	<button on:click={clear}>
		Clear completed
	</button>
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	.done {
		opacity: 0.4;
	}

	li {
		display: flex;
	}

	input[type="text"] {
		flex: 1;
		padding: 0.5em;
		margin: -0.2em 0;
		border: none;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/05-bindings/02-each-block-bindings/README.md #######

---
title: Each block bindings
---

You can even bind to properties inside an `each` block.

```svelte
/// file: App.svelte
{#each todos as todo}
	<li class:done={todo.done}>
		<input
			type="checkbox"
			+++bind:+++checked={todo.done}
		/>

		<input
			type="text"
			placeholder="What needs to be done?"
			+++bind:+++value={todo.text}
		/>
	</li>
{/each}
```

> Note that interacting with these `<input>` elements will mutate the array. If you prefer to work with immutable data, you should avoid these bindings and use event handlers instead.

####### content/tutorial/02-advanced-svelte/05-bindings/03-media-elements/app-a/src/lib/App.svelte #######

```

<script>
	import AudioPlayer from './AudioPlayer.svelte';
	import { tracks } from './tracks.js';
</script>

<div class="centered">
	{#each tracks as track}
		<AudioPlayer {...track} />
	{/each}
</div>

<style>
	.centered {
		display: flex;
		flex-direction: column;
		height: 100%;
		justify-content: center;
		gap: 0.5em;
		max-width: 40em;
		margin: 0 auto;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/05-bindings/03-media-elements/app-a/src/lib/AudioPlayer.svelte #######

```

<script>
	export let src;
	export let title;
	export let artist;

	let time = 0;
	let duration = 0;
	let paused = true;

	function format(time) {
		if (isNaN(time)) return '...';

		const minutes = Math.floor(time / 60);
		const seconds = Math.floor(time % 60);

		return `${minutes}:${seconds < 10 ? `0${seconds}` : seconds}`;
	}
</script>

<div class="player" class:paused>
	<button
		class="play"
		aria-label={paused ? 'play' : 'pause'}
	/>

	<div class="info">
		<div class="description">
			<strong>{title}</strong> /
			<span>{artist}</span>
		</div>

		<div class="time">
			<span>{format(time)}</span>
			<div
				class="slider"
				on:pointerdown={e => {
					const div = e.currentTarget;
					
					function seek(e) {
						const { left, width } = div.getBoundingClientRect();

						let p = (e.clientX - left) / width;
						if (p < 0) p = 0;
						if (p > 1) p = 1;
						
						// TODO update the time
					}

					seek(e);

					window.addEventListener('pointermove', seek);

					window.addEventListener('pointerup', () => {
						window.removeEventListener('pointermove', seek);
					}, {
						once: true
					});
				}}
			>
				<div class="progress" style="--progress: {time / duration}%" />
			</div>
			<span>{duration ? format(duration) : '--:--'}</span>
		</div>
	</div>
</div>

<style>
	.player {
		display: grid;
		grid-template-columns: 2.5em 1fr;
		align-items: center;
		gap: 1em;
		padding: 0.5em 1em 0.5em 0.5em;
		border-radius: 2em;
		background: var(--bg-1);
		transition: filter 0.2s;
		color: var(--fg-3);
		user-select: none;
	}

	.player:not(.paused) {
		color: var(--fg-1);
		filter: drop-shadow(0.5em 0.5em 1em rgba(0,0,0,0.1));
	}
	
	button {
		width: 100%;
		aspect-ratio: 1;
		background-repeat: no-repeat;
		background-position: 50% 50%;
		border-radius: 50%;
	}
	
	[aria-label="pause"] {
		background-image: url(./pause.svg);
	}

	[aria-label="play"] {
		background-image: url(./play.svg);
	}

	.info {
		overflow: hidden;
	}

	.description {
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
		line-height: 1.2;
	}

	.time {
		display: flex;
		align-items: center;
		gap: 0.5em;
	}

	.time span {
		font-size: 0.7em;
	}

	.slider {
		flex: 1;
		height: 0.5em;
		background: var(--bg-2);
		border-radius: 0.5em;
		overflow: hidden;
	}

	.progress {
		width: calc(100 * var(--progress));
		height: 100%;
		background: var(--bg-3);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/05-bindings/03-media-elements/app-a/src/lib/tracks.js #######

```

export const tracks = [
	{
		// https://musopen.org/music/9862-the-blue-danube-op-314/
		src: 'https://learn.svelte.dev/assets/media/music/strauss.mp3',
		title: 'The Blue Danube Waltz',
		artist: 'Johann Strauss'
	},

	{
		// https://musopen.org/music/43775-the-planets-op-32/
		src: 'https://learn.svelte.dev/assets/media/music/holst.mp3',
		title: 'Mars, the Bringer of War',
		artist: 'Gustav Holst'
	},

	{
		// https://musopen.org/music/8010-3-gymnopedies/
		src: 'https://learn.svelte.dev/assets/media/music/satie.mp3',
		title: 'Gymnopédie no. 1',
		artist: 'Erik Satie'
	},

	{
		// https://musopen.org/music/43683-requiem-in-d-minor-k-626/
		src: 'https://learn.svelte.dev/assets/media/music/mozart.mp3',
		title: 'Requiem in D minor, K. 626 - III. Sequence - Lacrymosa',
		artist: 'Wolfgang Amadeus Mozart'
	}
];

```


####### content/tutorial/02-advanced-svelte/05-bindings/03-media-elements/app-b/src/lib/AudioPlayer.svelte #######

```

<script>
	export let src;
	export let title;
	export let artist;

	let time = 0;
	let duration = 0;
	let paused = true;

	function format(time) {
		if (isNaN(time)) return '...';

		const minutes = Math.floor(time / 60);
		const seconds = Math.floor(time % 60);

		return `${minutes}:${seconds < 10 ? `0${seconds}` : seconds}`;
	}
</script>

<div class="player" class:paused>
	<audio
		{src}
		bind:currentTime={time}
		bind:duration
		bind:paused
		preload="metadata"
		on:ended={() => {
			time = 0;
		}}
	/>
	
	<button
		class="play"
		aria-label={paused ? 'play' : 'pause'}
		on:click={() => paused = !paused}
	/>

	<div class="info">
		<div class="description">
			<strong>{title}</strong> /
			<span>{artist}</span>
		</div>

		<div class="time">
			<span>{format(time)}</span>
			<div
				class="slider"
				on:pointerdown={e => {
					const div = e.currentTarget;
					
					function seek(e) {
						const { left, width } = div.getBoundingClientRect();

						let p = (e.clientX - left) / width;
						if (p < 0) p = 0;
						if (p > 1) p = 1;
						
						time = p * duration;
					}

					seek(e);

					window.addEventListener('pointermove', seek);

					window.addEventListener('pointerup', () => {
						window.removeEventListener('pointermove', seek);
					}, {
						once: true
					});
				}}
			>
				<div class="progress" style="--progress: {time / duration}%" />
			</div>
			<span>{duration ? format(duration) : '--:--'}</span>
		</div>
	</div>
</div>

<style>
	.player {
		display: grid;
		grid-template-columns: 2.5em 1fr;
		align-items: center;
		gap: 1em;
		padding: 0.5em 1em 0.5em 0.5em;
		border-radius: 2em;
		background: var(--bg-1);
		transition: filter 0.2s;
		color: var(--fg-3);
		user-select: none;
	}

	.player:not(.paused) {
		color: var(--fg-1);
		filter: drop-shadow(0.5em 0.5em 1em rgba(0,0,0,0.1));
	}
	
	button {
		width: 100%;
		aspect-ratio: 1;
		background-repeat: no-repeat;
		background-position: 50% 50%;
		border-radius: 50%;
	}
	
	[aria-label="pause"] {
		background-image: url(./pause.svg);
	}

	[aria-label="play"] {
		background-image: url(./play.svg);
	}

	.info {
		overflow: hidden;
	}

	.description {
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
		line-height: 1.2;
	}

	.time {
		display: flex;
		align-items: center;
		gap: 0.5em;
	}

	.time span {
		font-size: 0.7em;
	}

	.slider {
		flex: 1;
		height: 0.5em;
		background: var(--bg-2);
		border-radius: 0.5em;
		overflow: hidden;
	}

	.progress {
		width: calc(100 * var(--progress));
		height: 100%;
		background: var(--bg-3);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/05-bindings/03-media-elements/README.md #######

---
title: Media elements
---

You can bind to properties of `<audio>` and `<video>` elements, making it easy to (for example) build custom player UI, like `AudioPlayer.svelte`.

First, add the `<audio>` element along with its bindings (we'll use the shorthand form for `src`, `duration` and `paused`):

```svelte
/// file: AudioPlayer.svelte
<div class="player" class:paused>
+++	<audio
		{src}
		bind:currentTime={time}
		bind:duration
		bind:paused
	/>+++

	<button
		class="play"
		aria-label={paused ? 'play' : 'pause'}
	/>
```

Next, add an event handler to the `<button>` that toggles `paused`:

```svelte
/// file: AudioPlayer.svelte
<button
	class="play"
	aria-label={paused ? 'play' : 'pause'}
	+++on:click={() => paused = !paused}+++
/>
```

Our audio player now has basic functionality. Let's add the ability to seek to a specific part of a track by dragging the slider. Inside the slider's `pointerdown` handler there's a `seek` function, where we can update `time`:

```js
/// file: AudioPlayer.svelte
function seek(e) {
	const { left, width } = div.getBoundingClientRect();

	let p = (e.clientX - left) / width;
	if (p < 0) p = 0;
	if (p > 1) p = 1;

	+++time = p * duration;+++
}
```

When the track ends, be kind — rewind:

```svelte
/// file: AudioPlayer.svelte
<audio
	{src}
	bind:currentTime={time}
	bind:duration
	bind:paused
+++	on:ended={() => {
		time = 0;
	}}+++
/>
```

The complete set of bindings for `<audio>` and `<video>` is as follows — seven _readonly_ bindings...

- `duration` (readonly) — the total duration, in seconds
- `buffered` (readonly) — an array of `{start, end}` objects
- `seekable` (readonly) — ditto
- `played` (readonly) — ditto
- `seeking` (readonly) — boolean
- `ended` (readonly) — boolean
- `readyState` (readonly) — number between (and including) 0 and 4

...and five _two-way_ bindings:

- `currentTime` — the current position of the playhead, in seconds
- `playbackRate` — speed up or slow down (`1` is 'normal')
- `paused` — this one should be self-explanatory
- `volume` — a value between 0 and 1
- `muted` — a boolean value where true is muted

Videos additionally have readonly `videoWidth` and `videoHeight` bindings.

####### content/tutorial/02-advanced-svelte/05-bindings/04-dimensions/app-a/src/lib/App.svelte #######

```

<script>
	let w;
	let h;
	let size = 42;
	let text = 'edit this text';
</script>

<label>
	<input type="range" bind:value={size} min="10" max="100" />
	font size ({size}px)
</label>

<div>
	<span style="font-size: {size}px" contenteditable>{text}</span>
	<span class="size">{w} x {h}px</span>
</div>

<style>
	div {
		position: relative;
		display: inline-block;
		padding: 0.5rem;
		background: hsla(15, 100%, 50%, 0.1);
		border: 1px solid hsl(15, 100%, 50%);
	}

	.size {
		position: absolute;
		right: -1px;
		bottom: -1.4em;
		line-height: 1;
		background: hsl(15, 100%, 50%);
		color: white;
		padding: 0.2em 0.5em;
		white-space: pre;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/05-bindings/04-dimensions/app-b/src/lib/App.svelte #######

```

<script>
	let w;
	let h;
	let size = 42;
	let text = 'edit this text';
</script>

<label>
	<input type="range" bind:value={size} min="10" max="100" />
	font size ({size}px)
</label>

<div bind:clientWidth={w} bind:clientHeight={h}>
	<span style="font-size: {size}px" contenteditable>{text}</span>
	<span class="size">{w} x {h}px</span>
</div>

<style>
	div {
		position: relative;
		display: inline-block;
		padding: 0.5rem;
		background: hsla(15, 100%, 50%, 0.1);
		border: 1px solid hsl(15, 100%, 50%);
	}

	.size {
		position: absolute;
		right: -1px;
		bottom: -1.4em;
		line-height: 1;
		background: hsl(15, 100%, 50%);
		color: white;
		padding: 0.2em 0.5em;
		white-space: pre;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/05-bindings/04-dimensions/README.md #######

---
title: Dimensions
---

Every block-level element has `clientWidth`, `clientHeight`, `offsetWidth` and `offsetHeight` bindings:

```svelte
/// file: App.svelte
<div +++bind:clientWidth={w} bind:clientHeight={h}+++>
	<span style="font-size: {size}px" contenteditable>{text}</span>
	<span class="size">{w} x {h}px</span>
</div>
```

These bindings are readonly — changing the values of `w` and `h` won't have any effect on the element.

> Elements are measured using a technique similar to [this one](http://www.backalleycoder.com/2013/03/18/cross-browser-event-based-element-resize-detection/). There is some overhead involved, so it's not recommended to use this for large numbers of elements.
>
> `display: inline` elements cannot be measured with this approach; nor can elements that can't contain other elements (such as `<canvas>`). In these cases you will need to measure a wrapper element instead.

####### content/tutorial/02-advanced-svelte/05-bindings/05-bind-this/app-a/src/lib/App.svelte #######

```

<script>
	import { onMount } from 'svelte';
	import { paint } from './gradient.js';

	onMount(() => {
		const canvas = document.querySelector('canvas')
		const context = canvas.getContext('2d');

		let frame = requestAnimationFrame(function loop(t) {
			frame = requestAnimationFrame(loop);
			paint(context, t);
		});

		return () => {
			cancelAnimationFrame(frame);
		};
	});
</script>

<canvas
	width={32}
	height={32}
/>

<style>
	canvas {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		background-color: #666;
		mask: url(./svelte-logo-mask.svg) 50% 50% no-repeat;
		mask-size: 60vmin;
		-webkit-mask: url(./svelte-logo-mask.svg) 50% 50% no-repeat;
		-webkit-mask-size: 60vmin;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/05-bindings/05-bind-this/app-a/src/lib/gradient.js #######

```

export function paint(context, t) {
	const { width, height } = context.canvas;
	const imageData = context.getImageData(0, 0, width, height);

	for (let p = 0; p < imageData.data.length; p += 4) {
		const i = p / 4;
		const x = i % width;
		const y = (i / width) >>> 0;

		const red = 64 + (128 * x) / width + 64 * Math.sin(t / 1000);
		const green = 64 + (128 * y) / height + 64 * Math.cos(t / 1000);
		const blue = 128;

		imageData.data[p + 0] = red;
		imageData.data[p + 1] = green;
		imageData.data[p + 2] = blue;
		imageData.data[p + 3] = 255;
	}

	context.putImageData(imageData, 0, 0);
}
```


####### content/tutorial/02-advanced-svelte/05-bindings/05-bind-this/app-b/src/lib/App.svelte #######

```

<script>
	import { onMount } from 'svelte';
	import { paint } from './gradient.js';

	let canvas;

	onMount(() => {
		const context = canvas.getContext('2d');

		let frame = requestAnimationFrame(function loop(t) {
			frame = requestAnimationFrame(loop);
			paint(context, t);
		});

		return () => {
			cancelAnimationFrame(frame);
		};
	});
</script>

<canvas
	bind:this={canvas}
	width={32}
	height={32}
/>

<style>
	canvas {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		background-color: #666;
		mask: url(./svelte-logo-mask.svg) 50% 50% no-repeat;
		mask-size: 60vmin;
		-webkit-mask: url(./svelte-logo-mask.svg) 50% 50% no-repeat;
		-webkit-mask-size: 60vmin;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/05-bindings/05-bind-this/README.md #######

---
title: This
---

In a [previous exercise](onmount), we learned how to use the `onMount` lifecycle function to paint to a canvas.

But the example is buggy — it's using `document.querySelector('canvas')`, which will always return the first `<canvas>` found on the page, which might not be the one belonging to our component.

Instead, we can use the readonly `this` binding to get a reference to the element:

```js
/// file: App.svelte
+++let canvas;+++

onMount(() => {
	---const canvas = document.querySelector('canvas')---
	const context = canvas.getContext('2d');

	let frame = requestAnimationFrame(function loop(t) {
		frame = requestAnimationFrame(loop);
		paint(context, t);
	});

	return () => {
		cancelAnimationFrame(frame);
	};
});
```

```svelte
/// file: App.svelte
<canvas
	+++bind:this={canvas}+++
	width={32}
	height={32}
></canvas>
```

Note that the value of `canvas` will be `undefined` until the component has mounted.

####### content/tutorial/02-advanced-svelte/05-bindings/06-component-bindings/app-a/src/lib/App.svelte #######

```

<script>
	import Keypad from './Keypad.svelte';

	let pin;
	$: view = pin
		? pin.replace(/\d(?!$)/g, '•')
		: 'enter your pin';

	function handleSubmit() {
		alert(`submitted ${pin}`);
	}
</script>

<h1 style="opacity: {pin ? 1 : 0.4}">
	{view}
</h1>

<Keypad
	on:submit={handleSubmit}
/>

```


####### content/tutorial/02-advanced-svelte/05-bindings/06-component-bindings/app-a/src/lib/Keypad.svelte #######

```

<script>
	import { createEventDispatcher } from 'svelte';

	export let value = '';

	const dispatch = createEventDispatcher();

	const select = (num) => () => (value += num);
	const clear = () => (value = '');
	const submit = () => dispatch('submit');
</script>

<div class="keypad">
	<button on:click={select(1)}>1</button>
	<button on:click={select(2)}>2</button>
	<button on:click={select(3)}>3</button>
	<button on:click={select(4)}>4</button>
	<button on:click={select(5)}>5</button>
	<button on:click={select(6)}>6</button>
	<button on:click={select(7)}>7</button>
	<button on:click={select(8)}>8</button>
	<button on:click={select(9)}>9</button>

	<button disabled={!value} on:click={clear}
		>clear</button
	>
	<button on:click={select(0)}>0</button>
	<button disabled={!value} on:click={submit}
		>submit</button
	>
</div>

<style>
	.keypad {
		display: grid;
		grid-template-columns: repeat(3, 5em);
		grid-template-rows: repeat(4, 3em);
		grid-gap: 0.5em;
	}

	button {
		margin: 0;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/05-bindings/06-component-bindings/app-b/src/lib/App.svelte #######

```

<script>
	import Keypad from './Keypad.svelte';

	let pin;
	$: view = pin
		? pin.replace(/\d(?!$)/g, '•')
		: 'enter your pin';

	function handleSubmit() {
		alert(`submitted ${pin}`);
	}
</script>

<h1 style="opacity: {pin ? 1 : 0.4}">
	{view}
</h1>

<Keypad
	bind:value={pin}
	on:submit={handleSubmit}
/>

```


####### content/tutorial/02-advanced-svelte/05-bindings/06-component-bindings/README.md #######

---
title: Component bindings
---

Just as you can bind to properties of DOM elements, you can bind to component props. For example, we can bind to the `value` prop of this `<Keypad>` component as though it were a form element:

```svelte
/// file: App.svelte
<Keypad
	+++bind:value={pin}+++
	on:submit={handleSubmit}
/>
```

Now, when the user interacts with the keypad, the value of `pin` in the parent component is immediately updated.

> Use component bindings sparingly. It can be difficult to track the flow of data around your application if you have too many of them, especially if there is no 'single source of truth'.

####### content/tutorial/02-advanced-svelte/05-bindings/07-component-this/app-a/src/lib/actions.js #######

```

export function trapFocus(node) {
	const previous = document.activeElement;

	function focusable() {
		return Array.from(node.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'));
	}

	function handleKeydown(event) {
		if (event.key !== 'Tab') return;

		const current = document.activeElement;

		const elements = focusable();
		const first = elements.at(0);
		const last = elements.at(-1)

		if (event.shiftKey && current === first) {
			last.focus();
			event.preventDefault();
		}

		if (!event.shiftKey && current === last) {
			first.focus();
			event.preventDefault();
		}
	}

	focusable()[0]?.focus();

	node.addEventListener('keydown', handleKeydown);

	return {
		destroy() {
			node.removeEventListener('keydown', handleKeydown);
			previous?.focus();
		}
	};
}

```


####### content/tutorial/02-advanced-svelte/05-bindings/07-component-this/app-a/src/lib/App.svelte #######

```

<script>
	import Canvas from './Canvas.svelte';
	import { trapFocus } from './actions.js';

	const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet', 'white', 'black'];
	let selected = colors[0];
	let size = 10;

	let showMenu = true;
</script>

<div class="container">
	<Canvas color={selected} size={size} />

	{#if showMenu}
		<div
			class="modal-background"
			on:click|self={() => showMenu = false}
			on:keydown={(e) => {
				if (e.key === 'Escape') showMenu = false;
			}}
		>
			<div class="menu" use:trapFocus>
				<div class="colors">
					{#each colors as color}
						<button
							class="color"
							aria-label={color}
							aria-current={selected === color}
							style="--color: {color}"
							on:click={() => {
								selected = color;
							}}
						/>
					{/each}
				</div>

				<label>
					small
					<input type="range" bind:value={size} min="1" max="50" />
					large
				</label>
			</div>
		</div>
	{/if}

	<div class="controls">
		<button class="show-menu" on:click={() => showMenu = !showMenu}>
			{showMenu ? 'close' : 'menu'}
		</button>
	</div>
</div>

<style>
	.container {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
	}

	.controls {
		position: absolute;
		left: 0;
		top: 0;
		padding: 1em;
	}

	.show-menu {
		width: 5em;
	}

	.modal-background {
		position: fixed;
		display: flex;
		justify-content: center;
		align-items: center;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		backdrop-filter: blur(20px);
	}

	.menu {
		position: relative;
		background: var(--bg-2);
		width: calc(100% - 2em);
		max-width: 28em;
		padding: 1em 1em 0.5em 1em;
		border-radius: 1em;
		box-sizing: border-box;
		user-select: none;
	}

	.colors {
		display: grid;
		align-items: center;
		grid-template-columns: repeat(9, 1fr);
		grid-gap: 0.5em;
	}

	.color {
		aspect-ratio: 1;
		border-radius: 50%;
		background: var(--color, #fff);
		transform: none;
		filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.2));
		transition: all 0.1s;
	}

	.color[aria-current="true"] {
		transform: translate(1px, 1px);
		filter: none;
		box-shadow: inset 3px 3px 4px rgba(0,0,0,0.2);
	}

	.menu label {
		display: flex;
		width: 100%;
		margin: 1em 0 0 0;
	}

	.menu input {
		flex: 1;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/05-bindings/07-component-this/app-a/src/lib/Canvas.svelte #######

```

<script>
	import { onMount } from "svelte";

	export let color;
	export let size;

	let canvas;
	let context;
	let previous;

	function get_coords(e) {
		const { clientX, clientY } = e;
		const { left, top } = canvas.getBoundingClientRect();
		const x = clientX - left;
		const y = clientY - top;
		return { x, y };
	}

	onMount(() => {
		context = canvas.getContext('2d');

		function resize() {
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;
		}

		window.addEventListener('resize', resize);
		resize();

		return () => {
			window.removeEventListener('resize', resize);
		};
	});
</script>



<canvas
	bind:this={canvas}
	on:pointerdown={(e) => {
		const coords = get_coords(e);
		context.fillStyle = color;
		context.beginPath();
		context.arc(coords.x, coords.y, size / 2, 0, 2 * Math.PI);
		context.fill();

		previous = coords;
	}}
	on:pointerleave={() => {
		previous = null;
	}}
	on:pointermove={(e) => {
		const coords = get_coords(e);

		if (e.buttons === 1) {
			e.preventDefault();

			context.strokeStyle = color;
			context.lineWidth = size;
			context.lineCap = 'round';
			context.beginPath();
			context.moveTo(previous.x, previous.y);
			context.lineTo(coords.x, coords.y);
			context.stroke();
		}

		previous = coords;
	}}
/>

{#if previous}
	<div
		class="preview"
		style="--color: {color}; --size: {size}px; --x: {previous.x}px; --y: {previous.y}px" 
	/>
{/if}

<style>
	canvas {
		position: absolute;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
	}

	.preview {
		position: absolute;
		left: var(--x);
		top: var(--y);
		width: var(--size);
		height: var(--size);
		transform: translate(-50%, -50%);
		background: var(--color);
		border-radius: 50%;
		opacity: 0.5;
		pointer-events: none;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/05-bindings/07-component-this/app-b/src/lib/App.svelte #######

```

<script>
	import Canvas from './Canvas.svelte';
	import { trapFocus } from './actions.js';

	const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet', 'white', 'black'];
	let selected = colors[0];
	let size = 10;

	let showMenu = true;

	let canvas;
</script>

<div class="container">
	<Canvas bind:this={canvas} color={selected} size={size} />

	{#if showMenu}
		<div
			class="modal-background"
			on:click|self={() => showMenu = false}
			on:keydown={(e) => {
				if (e.key === 'Escape') showMenu = false;
			}}
		>
			<div class="menu" use:trapFocus>
				<div class="colors">
					{#each colors as color}
						<button
							class="color"
							aria-label={color}
							aria-current={selected === color}
							style="--color: {color}"
							on:click={() => {
								selected = color;
							}}
						/>
					{/each}
				</div>

				<label>
					small
					<input type="range" bind:value={size} min="1" max="50" />
					large
				</label>
			</div>
		</div>
	{/if}

	<div class="controls">
		<button class="show-menu" on:click={() => showMenu = !showMenu}>
			{showMenu ? 'close' : 'menu'}
		</button>

		<button on:click={() => canvas.clear()}>
			clear
		</button>
	</div>
</div>

<style>
	.container {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
	}

	.controls {
		position: absolute;
		left: 0;
		top: 0;
		padding: 1em;
	}

	.show-menu {
		width: 5em;
	}

	.modal-background {
		position: fixed;
		display: flex;
		justify-content: center;
		align-items: center;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		backdrop-filter: blur(20px);
	}

	.menu {
		position: relative;
		background: var(--bg-2);
		width: calc(100% - 2em);
		max-width: 28em;
		padding: 1em 1em 0.5em 1em;
		border-radius: 1em;
		box-sizing: border-box;
		user-select: none;
	}

	.colors {
		display: grid;
		align-items: center;
		grid-template-columns: repeat(9, 1fr);
		grid-gap: 0.5em;
	}

	.color {
		aspect-ratio: 1;
		border-radius: 50%;
		background: var(--color, #fff);
		transform: none;
		filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.2));
		transition: all 0.1s;
	}

	.color[aria-current="true"] {
		transform: translate(1px, 1px);
		filter: none;
		box-shadow: inset 3px 3px 4px rgba(0,0,0,0.2);
	}

	.menu label {
		display: flex;
		width: 100%;
		margin: 1em 0 0 0;
	}

	.menu input {
		flex: 1;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/05-bindings/07-component-this/app-b/src/lib/Canvas.svelte #######

```

<script>
	import { onMount } from "svelte";

	export let color;
	export let size;

	export function clear() {
		context.clearRect(0, 0, canvas.width, canvas.height);
	}

	let canvas;
	let context;
	let previous;

	function get_coords(e) {
		const { clientX, clientY } = e;
		const { left, top } = canvas.getBoundingClientRect();
		const x = clientX - left;
		const y = clientY - top;
		return { x, y };
	}

	onMount(() => {
		context = canvas.getContext('2d');

		function resize() {
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;
		}

		window.addEventListener('resize', resize);
		resize();

		return () => {
			window.removeEventListener('resize', resize);
		};
	});
</script>



<canvas
	bind:this={canvas}
	on:pointerdown={(e) => {
		const coords = get_coords(e);
		context.fillStyle = color;
		context.beginPath();
		context.arc(coords.x, coords.y, size / 2, 0, 2 * Math.PI);
		context.fill();

		previous = coords;
	}}
	on:pointerleave={() => {
		previous = null;
	}}
	on:pointermove={(e) => {
		const coords = get_coords(e);

		if (e.buttons === 1) {
			e.preventDefault();

			context.strokeStyle = color;
			context.lineWidth = size;
			context.lineCap = 'round';
			context.beginPath();
			context.moveTo(previous.x, previous.y);
			context.lineTo(coords.x, coords.y);
			context.stroke();
		}

		previous = coords;
	}}
/>

{#if previous}
	<div
		class="preview"
		style="--color: {color}; --size: {size}px; --x: {previous.x}px; --y: {previous.y}px" 
	/>
{/if}

<style>
	canvas {
		position: absolute;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
	}

	.preview {
		position: absolute;
		left: var(--x);
		top: var(--y);
		width: var(--size);
		height: var(--size);
		transform: translate(-50%, -50%);
		background: var(--color);
		border-radius: 50%;
		opacity: 0.5;
		pointer-events: none;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/05-bindings/07-component-this/README.md #######

---
title: Binding to component instances
---

Just as you can bind to DOM elements, you can bind to component instances themselves with `bind:this`.

This is useful in the rare cases that you need to interact with a component programmatically (rather than by providing it with updated props). Revisiting our canvas app from [a few exercises ago](actions), it would be nice to add a button to clear the screen.

First, let's export a function from `Canvas.svelte`:

```svelte
/// file: Canvas.svelte
export let color;
export let size;

+++export function clear() {
	context.clearRect(0, 0, canvas.width, canvas.height);
}+++
```

Then, create a reference to the component instance:

```svelte
/// file: App.svelte
<script>
	import Canvas from './Canvas.svelte';
	import { trapFocus } from './actions.js';

	const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet', 'white', 'black'];
	let selected = colors[0];
	let size = 10;

	let showMenu = true;
	+++let canvas;+++
</script>

<div class="container">
	<Canvas +++bind:this={canvas}+++ color={selected} size={size} />
```

Finally, add a button that calls the `clear` function:

```svelte
/// file: App.svelte
<div class="controls">
	<button class="show-menu" on:click={() => showMenu = !showMenu}>
		{showMenu ? 'close' : 'menu'}
	</button>

+++	<button on:click={() => canvas.clear()}>
		clear
	</button>+++
</div>
```
####### content/tutorial/02-advanced-svelte/05-bindings/meta.json #######

```

{
	"title": "Advanced bindings",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/06-classes-and-styles/01-classes/app-a/src/lib/App.svelte #######

```

<script>
	let flipped = false;
</script>

<div class="container">
	Flip the card
	<button
		class="card"
		on:click={() => flipped = !flipped}
	>
		<div class="front">
			<span class="symbol">♠</span>
		</div>
		<div class="back">
			<div class="pattern"></div>
		</div>
	</button>
</div>

<style>
	.container {
		display: flex;
		flex-direction: column;
		gap: 1em;
		height: 100%;
		align-items: center;
		justify-content: center;
		perspective: 100vh;
	}

	.card {
		position: relative;
		aspect-ratio: 2.5 / 3.5;
		font-size: min(1vh, 0.25rem);
		height: 80em;
		background: var(--bg-1);
		border-radius: 2em;
		transform: rotateY(180deg);
		transition: transform 0.4s;
		transform-style: preserve-3d;
		padding: 0;
		user-select: none;
		cursor: pointer;
	}

	.card.flipped {
		transform: rotateY(0);
	}

	.front, .back {
		display: flex;
		align-items: center;
		justify-content: center;
		position: absolute;
		width: 100%;
		height: 100%;
		left: 0;
		top: 0;
		backface-visibility: hidden;
		border-radius: 2em;
		border: 1px solid var(--fg-2);
		box-sizing: border-box;
		padding: 2em;
	}

	.front {
		background: url(./svelte-logo.svg) no-repeat 5em 5em, url(./svelte-logo.svg) no-repeat calc(100% - 5em) calc(100% - 5em);
		background-size: 8em 8em, 8em 8em;
	}

	.back {
		transform: rotateY(180deg);
	}

	.symbol {
		font-size: 30em;
		color: var(--fg-1);
	}

	.pattern {
		width: 100%;
		height: 100%;
		background-color: var(--bg-2);
		/* pattern from https://projects.verou.me/css3patterns/#marrakesh */
		background-image:
		radial-gradient(var(--bg-3) 0.9em, transparent 1em),
		repeating-radial-gradient(var(--bg-3) 0, var(--bg-3) 0.4em, transparent 0.5em, transparent 2em, var(--bg-3) 2.1em, var(--bg-3) 2.5em, transparent 2.6em, transparent 5em);
		background-size: 3em 3em, 9em 9em;
		background-position: 0 0;
		border-radius: 1em;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/06-classes-and-styles/01-classes/app-b/src/lib/App.svelte #######

```

<script>
	let flipped = false;
</script>

<div class="container">
	Flip the card
	<button
		class="card"
		class:flipped={flipped}
		on:click={() => flipped = !flipped}
	>
		<div class="front">
			<span class="symbol">♠</span>
		</div>
		<div class="back">
			<div class="pattern"></div>
		</div>
	</button>
</div>

<style>
	.container {
		display: flex;
		flex-direction: column;
		gap: 1em;
		height: 100%;
		align-items: center;
		justify-content: center;
		perspective: 100vh;
	}

	.card {
		position: relative;
		aspect-ratio: 2.5 / 3.5;
		font-size: min(1vh, 0.25rem);
		height: 80em;
		background: var(--bg-1);
		border-radius: 2em;
		transform: rotateY(180deg);
		transition: transform 0.4s;
		transform-style: preserve-3d;
		padding: 0;
		user-select: none;
		cursor: pointer;
	}

	.card.flipped {
		transform: rotateY(0);
	}

	.front, .back {
		display: flex;
		align-items: center;
		justify-content: center;
		position: absolute;
		width: 100%;
		height: 100%;
		left: 0;
		top: 0;
		backface-visibility: hidden;
		border-radius: 2em;
		border: 1px solid var(--fg-2);
		box-sizing: border-box;
		padding: 2em;
	}

	.front {
		background: url(./svelte-logo.svg) no-repeat 5em 5em, url(./svelte-logo.svg) no-repeat calc(100% - 5em) calc(100% - 5em);
		background-size: 8em 8em, 8em 8em;
	}

	.back {
		transform: rotateY(180deg);
	}

	.symbol {
		font-size: 30em;
		color: var(--fg-1);
	}

	.pattern {
		width: 100%;
		height: 100%;
		background-color: var(--bg-2);
		/* pattern from https://projects.verou.me/css3patterns/#marrakesh */
		background-image:
		radial-gradient(var(--bg-3) 0.9em, transparent 1em),
		repeating-radial-gradient(var(--bg-3) 0, var(--bg-3) 0.4em, transparent 0.5em, transparent 2em, var(--bg-3) 2.1em, var(--bg-3) 2.5em, transparent 2.6em, transparent 5em);
		background-size: 3em 3em, 9em 9em;
		background-position: 0 0;
		border-radius: 1em;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/06-classes-and-styles/01-classes/README.md #######

---
title: The class directive
---

Like any other attribute, you can specify classes with a JavaScript attribute. Here, we could add a `flipped` class to the card:

```svelte
/// file: App.svelte
<button
	class="card +++{flipped ? 'flipped' : ''}+++"
	on:click={() => flipped = !flipped}
>
```

This works as expected — if you click on the card now, it'll flip.

We can make it nicer though. Adding or removing a class based on some condition is such a common pattern in UI development that Svelte includes a special directive to simplify it:

```svelte
/// file: App.svelte
<button
	class="card"
	+++class:flipped={flipped}+++
	on:click={() => flipped = !flipped}
>
```

This directive means 'add the `flipped` class whenever `flipped` is truthy'.
####### content/tutorial/02-advanced-svelte/06-classes-and-styles/02-class-shorthand/app-b/src/lib/App.svelte #######

```

<script>
	let flipped = false;
</script>

<div class="container">
	Flip the card
	<button
		class="card"
		class:flipped
		on:click={() => flipped = !flipped}
	>
		<div class="front">
			<span class="symbol">♠</span>
		</div>
		<div class="back">
			<div class="pattern"></div>
		</div>
	</button>
</div>

<style>
	.container {
		display: flex;
		flex-direction: column;
		gap: 1em;
		height: 100%;
		align-items: center;
		justify-content: center;
		perspective: 100vh;
	}

	.card {
		position: relative;
		aspect-ratio: 2.5 / 3.5;
		font-size: min(1vh, 0.25rem);
		height: 80em;
		background: var(--bg-1);
		border-radius: 2em;
		transform: rotateY(180deg);
		transition: transform 0.4s;
		transform-style: preserve-3d;
		padding: 0;
		user-select: none;
		cursor: pointer;
	}

	.card.flipped {
		transform: rotateY(0);
	}

	.front, .back {
		display: flex;
		align-items: center;
		justify-content: center;
		position: absolute;
		width: 100%;
		height: 100%;
		left: 0;
		top: 0;
		backface-visibility: hidden;
		border-radius: 2em;
		border: 1px solid var(--fg-2);
		box-sizing: border-box;
		padding: 2em;
	}

	.front {
		background: url(./svelte-logo.svg) no-repeat 5em 5em, url(./svelte-logo.svg) no-repeat calc(100% - 5em) calc(100% - 5em);
		background-size: 8em 8em, 8em 8em;
	}

	.back {
		transform: rotateY(180deg);
	}

	.symbol {
		font-size: 30em;
		color: var(--fg-1);
	}

	.pattern {
		width: 100%;
		height: 100%;
		background-color: var(--bg-2);
		/* pattern from https://projects.verou.me/css3patterns/#marrakesh */
		background-image:
		radial-gradient(var(--bg-3) 0.9em, transparent 1em),
		repeating-radial-gradient(var(--bg-3) 0, var(--bg-3) 0.4em, transparent 0.5em, transparent 2em, var(--bg-3) 2.1em, var(--bg-3) 2.5em, transparent 2.6em, transparent 5em);
		background-size: 3em 3em, 9em 9em;
		background-position: 0 0;
		border-radius: 1em;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/06-classes-and-styles/02-class-shorthand/README.md #######

---
title: Shorthand class directive
---

Often, the name of the class will be the same as the name of the value it depends on:

```svelte
/// no-file
<button
	class="card"
	class:flipped={flipped}
	on:click={() => flipped = !flipped}
>
```

In those cases we can use a shorthand form:

```svelte
/// file: App.svelte
<button
	class="card"
	+++class:flipped+++
	on:click={() => flipped = !flipped}
>
```

####### content/tutorial/02-advanced-svelte/06-classes-and-styles/03-styles/app-b/src/lib/App.svelte #######

```

<script>
	let flipped = false;
</script>

<div class="container">
	Flip the card
	<button
		class="card"
		style:transform={flipped ? 'rotateY(0)' : ''}
		style:--bg-1="palegoldenrod"
		style:--bg-2="black"
		style:--bg-3="goldenrod"
		on:click={() => flipped = !flipped}
	>
		<div class="front">
			<span class="symbol">♠</span>
		</div>
		<div class="back">
			<div class="pattern"></div>
		</div>
	</button>
</div>

<style>
	.container {
		display: flex;
		flex-direction: column;
		gap: 1em;
		height: 100%;
		align-items: center;
		justify-content: center;
		perspective: 100vh;
	}

	.card {
		position: relative;
		aspect-ratio: 2.5 / 3.5;
		font-size: min(1vh, 0.25rem);
		height: 80em;
		background: var(--bg-1);
		border-radius: 2em;
		transform: rotateY(180deg);
		transition: transform 0.4s;
		transform-style: preserve-3d;
		padding: 0;
		user-select: none;
		cursor: pointer;
	}

	.card.flipped {
		transform: rotateY(0);
	}

	.front, .back {
		display: flex;
		align-items: center;
		justify-content: center;
		position: absolute;
		width: 100%;
		height: 100%;
		left: 0;
		top: 0;
		backface-visibility: hidden;
		border-radius: 2em;
		border: 1px solid var(--fg-2);
		box-sizing: border-box;
		padding: 2em;
	}

	.front {
		background: url(./svelte-logo.svg) no-repeat 5em 5em, url(./svelte-logo.svg) no-repeat calc(100% - 5em) calc(100% - 5em);
		background-size: 8em 8em, 8em 8em;
	}

	.back {
		transform: rotateY(180deg);
	}

	.symbol {
		font-size: 30em;
		color: var(--fg-1);
	}

	.pattern {
		width: 100%;
		height: 100%;
		background-color: var(--bg-2);
		/* pattern from https://projects.verou.me/css3patterns/#marrakesh */
		background-image:
		radial-gradient(var(--bg-3) 0.9em, transparent 1em),
		repeating-radial-gradient(var(--bg-3) 0, var(--bg-3) 0.4em, transparent 0.5em, transparent 2em, var(--bg-3) 2.1em, var(--bg-3) 2.5em, transparent 2.6em, transparent 5em);
		background-size: 3em 3em, 9em 9em;
		background-position: 0 0;
		border-radius: 1em;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/06-classes-and-styles/03-styles/README.md #######

---
title: The style directive
---

As with `class`, you can write your inline `style` attributes literally, because Svelte is really just HTML with fancy bits:

```svelte
/// file: App.svelte
<button
	class="card"
	+++style="transform: {flipped ? 'rotateY(0)' : ''}; --bg-1: palegoldenrod; --bg-2: black; --bg-3: goldenrod"+++
	on:click={() => flipped = !flipped}
>
```

When you have a lot of styles, it can start to look a bit wacky. We can tidy things up by using the `style:` directive:

```svelte
/// file: App.svelte
<button
	class="card"
+++	style:transform={flipped ? 'rotateY(0)' : ''}
	style:--bg-1="palegoldenrod"
	style:--bg-2="black"
	style:--bg-3="goldenrod"+++
	on:click={() => flipped = !flipped}
>
```
####### content/tutorial/02-advanced-svelte/06-classes-and-styles/04-component-styles/app-a/src/lib/App.svelte #######

```

<script>
	import Box from './Box.svelte';
</script>

<div class="boxes">
	<Box />
	<Box />
	<Box />
</div>
```


####### content/tutorial/02-advanced-svelte/06-classes-and-styles/04-component-styles/app-a/src/lib/Box.svelte #######

```

<div class="box" />

<style>
	.box {
		width: 5em;
		height: 5em;
		border-radius: 0.5em;
		margin: 0 0 1em 0;
		background-color: #ddd;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/06-classes-and-styles/04-component-styles/app-b/src/lib/App.svelte #######

```

<script>
	import Box from './Box.svelte';
</script>

<div class="boxes">
	<Box --color="red" />
	<Box --color="green" />
	<Box --color="blue" />
</div>
```


####### content/tutorial/02-advanced-svelte/06-classes-and-styles/04-component-styles/app-b/src/lib/Box.svelte #######

```

<div class="box" />

<style>
	.box {
		width: 5em;
		height: 5em;
		border-radius: 0.5em;
		margin: 0 0 1em 0;
		background-color: var(--color, #ddd);
	}
</style>

```


####### content/tutorial/02-advanced-svelte/06-classes-and-styles/04-component-styles/README.md #######

---
title: Component styles
---

Often, you need to influence the styles inside a child component. Perhaps we want to make these boxes red, green and blue.

One way to do this is with the `:global` CSS modifier, which allows you to indiscriminately target elements inside other components:

```svelte
/// file: App.svelte
<style>
	.boxes :global(.box:nth-child(1)) {
		background-color: red;
	}

	.boxes :global(.box:nth-child(2)) {
		background-color: green;
	}

	.boxes :global(.box:nth-child(3)) {
		background-color: blue;
	}
</style>
```

But there are lots of reasons _not_ to do that. For one thing, it's extremely verbose. For another, it's brittle — any changes to the implementation details of `Box.svelte` could break the selector.

Most of all though, it's rude. Components should be able to decide for themselves which styles can be controlled from 'outside', in the same way they decide which variables are exposed as props. `:global` should be used as an escape hatch — a last resort.

Inside `Box.svelte`, change `background-color` so that it is determined by a [CSS custom property](https://developer.mozilla.org/en-US/docs/Web/CSS/--*):

```svelte
/// file: Box.svelte
<style>
	.box {
		width: 5em;
		height: 5em;
		border-radius: 0.5em;
		margin: 0 0 1em 0;
		background-color: +++var(--color, #ddd)+++;
	}
</style>
```

Any parent element (such as `<div class="boxes">`) can set the value of `--color`, but we can also set it on individual components:

```svelte
/// file: App.svelte
<div class="boxes">
	<Box +++--color="red"+++ />
	<Box +++--color="green"+++ />
	<Box +++--color="blue"+++ />
</div>
```

The values can be dynamic, like any other attribute.

This feature works by wrapping each component in a `<div style="display: contents">`, where needed, and applying the custom properties to it.

####### content/tutorial/02-advanced-svelte/06-classes-and-styles/meta.json #######

```

{
	"title": "Classes and styles",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/07-composition/01-slots/app-a/src/lib/App.svelte #######

```

<script>
	import Card from './Card.svelte';
</script>

<main>
	<Card>
		<!-- content goes here -->
	</Card>
</main>

<style>
	main {
		display: grid;
		place-items: center;
		height: 100%;
		background: url(./wood.svg);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/07-composition/01-slots/app-a/src/lib/Card.svelte #######

```

<div class="card">
	<!-- slot goes here -->
</div>

<style>
	@font-face {
		src: url('/Garamond Classico SC Regular.woff2') format('woff2');
		font-family: 'Silian Rail';
		font-style: normal;
		font-weight: 400;
	}

	.card {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		font-size: min(2vw, 3.5vh, 1.5rem);
		font-family: 'Silian Rail';
		width: 24em;
		aspect-ratio: 3.5 / 2.0;
		background: url(./paper.svg) no-repeat 50% 50%;
		background-size: cover;
		border-radius: 2px;
		filter: drop-shadow(0.1em 0.1em 0.1em rgba(0, 0, 0, 0.2));
		padding: 1.5em 1em 1em 1em;
		font-variant: small-caps;
		text-shadow: -1px -1px 2px rgba(0, 0, 0, 0.2), 1px 1px 2px white;
		color: hsl(50, 20%, 35%);
		line-height: 1.2;
	}

	header, footer {
		width: 100%;
		display: flex;
		flex: 1;
	}

	header {
		justify-content: space-between;
	}

	footer {
		font-size: 0.7em;
		justify-content: center;
		align-items: end;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/07-composition/01-slots/app-b/src/lib/App.svelte #######

```

<script>
	import Card from './Card.svelte';
</script>

<main>
	<Card>
		<span>Patrick BATEMAN</span>
		<span>Vice President</span>
	</Card>
</main>

<style>
	main {
		display: grid;
		place-items: center;
		height: 100%;
		background: url(./wood.svg);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/07-composition/01-slots/app-b/src/lib/Card.svelte #######

```

<div class="card">
	<slot />
</div>

<style>
	@font-face {
		src: url('/Garamond Classico SC Regular.woff2') format('woff2');
		font-family: 'Silian Rail';
		font-style: normal;
		font-weight: 400;
	}

	.card {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		font-size: min(2vw, 3.5vh, 1.5rem);
		font-family: 'Silian Rail';
		width: 24em;
		aspect-ratio: 3.5 / 2.0;
		background: url(./paper.svg) no-repeat 50% 50%;
		background-size: cover;
		border-radius: 2px;
		filter: drop-shadow(0.1em 0.1em 0.1em rgba(0, 0, 0, 0.2));
		padding: 1.5em 1em 1em 1em;
		font-variant: small-caps;
		text-shadow: -1px -1px 2px rgba(0, 0, 0, 0.2), 1px 1px 2px white;
		color: hsl(50, 20%, 35%);
		line-height: 1.2;
	}

	header, footer {
		width: 100%;
		display: flex;
		flex: 1;
	}

	header {
		justify-content: space-between;
	}

	footer {
		font-size: 0.7em;
		justify-content: center;
		align-items: end;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/07-composition/01-slots/README.md #######

---
title: Slots
---

Just like elements can have children...

```html
/// no-file
<div>
	<p>I'm a child of the div</p>
</div>
```

...so can components. Before a component can accept children, though, it needs to know where to put them. We do this with the `<slot>` element. Put this inside `Card.svelte`:

```svelte
/// file: Card.svelte
<div class="card">
	+++<slot />+++
</div>
```

You can now put things on the card:

```svelte
/// file: App.svelte
<Card>
	+++<span>Patrick BATEMAN</span>+++
	+++<span>Vice President</span>+++
</Card>
```

####### content/tutorial/02-advanced-svelte/07-composition/02-named-slots/app-a/src/lib/App.svelte #######

```

<script>
	import Card from './Card.svelte';
</script>

<main>
	<Card>
		<span>Patrick BATEMAN</span>
		<span>Vice President</span>

		<span slot="telephone">212 555 6342</span>

		<span slot="company">
			Pierce &amp; Pierce
			<small>Mergers and Aquisitions</small>
		</span>
		
		<span slot="address">358 Exchange Place, New York, N.Y. 100099 fax 212 555 6390 telex 10 4534</span>
	</Card>
</main>

<style>
	main {
		display: grid;
		place-items: center;
		height: 100%;
		background: url(./wood.svg);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/07-composition/02-named-slots/app-a/src/lib/Card.svelte #######

```

<div class="card">
	<slot />
</div>

<style>
	@font-face {
		src: url('/Garamond Classico SC Regular.woff2') format('woff2');
		font-family: 'Silian Rail';
		font-style: normal;
		font-weight: 400;
	}

	.card {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		font-size: min(2vw, 3.5vh, 1.5rem);
		font-family: 'Silian Rail';
		width: 24em;
		aspect-ratio: 3.5 / 2.0;
		background: url(./paper.svg) no-repeat 50% 50%;
		background-size: cover;
		border-radius: 2px;
		filter: drop-shadow(0.1em 0.1em 0.1em rgba(0, 0, 0, 0.2));
		padding: 1.5em 1em 1em 1em;
		font-variant: small-caps;
		text-shadow: -1px -1px 2px rgba(0, 0, 0, 0.2), 1px 1px 2px white;
		color: hsl(50, 20%, 35%);
		line-height: 1.2;
	}

	header, footer {
		width: 100%;
		display: flex;
		flex: 1;
	}

	header {
		justify-content: space-between;
	}

	footer {
		font-size: 0.7em;
		justify-content: center;
		align-items: end;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/07-composition/02-named-slots/app-b/src/lib/App.svelte #######

```

<script>
	import Card from './Card.svelte';
</script>

<main>
	<Card>
		<span>Patrick BATEMAN</span>
		<span>Vice President</span>

		<span slot="telephone">212 555 6342</span>

		<span slot="company">
			Pierce &amp; Pierce
			<small>Mergers and Aquisitions</small>
		</span>
		
		<span slot="address">358 Exchange Place, New York, N.Y. 100099 fax 212 555 6390 telex 10 4534</span>
	</Card>
</main>

<style>
	main {
		display: grid;
		place-items: center;
		height: 100%;
		background: url(./wood.svg);
	}

	small {
		display: block;
		font-size: 0.6em;
		text-align: right;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/07-composition/02-named-slots/app-b/src/lib/Card.svelte #######

```

<div class="card">
	<header>
		<slot name="telephone" />
		<slot name="company" />
	</header>

	<slot />
		
	<footer>
		<slot name="address" />
	</footer>
</div>

<style>
	@font-face {
		src: url('/Garamond Classico SC Regular.woff2') format('woff2');
		font-family: 'Silian Rail';
		font-style: normal;
		font-weight: 400;
	}

	.card {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		font-size: min(2vw, 3.5vh, 1.5rem);
		font-family: 'Silian Rail';
		width: 24em;
		aspect-ratio: 3.5 / 2.0;
		background: url(./paper.svg) no-repeat 50% 50%;
		background-size: cover;
		border-radius: 2px;
		filter: drop-shadow(0.1em 0.1em 0.1em rgba(0, 0, 0, 0.2));
		padding: 1.5em 1em 1em 1em;
		font-variant: small-caps;
		text-shadow: -1px -1px 2px rgba(0, 0, 0, 0.2), 1px 1px 2px white;
		color: hsl(50, 20%, 35%);
		line-height: 1.2;
	}

	header, footer {
		width: 100%;
		display: flex;
		flex: 1;
	}

	header {
		justify-content: space-between;
	}

	footer {
		font-size: 0.7em;
		justify-content: center;
		align-items: end;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/07-composition/02-named-slots/README.md #######

---
title: Named slots
---

The previous example contained a _default slot_, which renders the direct children of a component. Sometimes you will need more control over placement. In those cases, we can use _named slots_.

Inside `App.svelte`, we're rendering a `<Card>` component that contains `<span slot="telephone">` and others for `company` and `address`. Let's add the corresponding named slots in `Card.svelte`:

```svelte
/// file: Card.svelte
<div class="card">
+++	<header>
		<slot name="telephone" />
		<slot name="company" />
	</header>+++

	<slot />
		
+++	<footer>
		<slot name="address" />
	</footer>+++
</div>
```

We need to add some styles to the `<small>` element in `App.svelte` so that it occupies its own line. The contents of `<Card>` inherit styles from `Card.svelte`, such as `font-family` (the lettering is something called ['Silian Rail'](https://www.youtube.com/watch?v=aZVkW9p-cCU)), but normal scoping rules apply — we need to add the styles to `App.svelte` because that's where the element is:

```svelte
/// file: App.svelte
<style>
	main {
		display: grid;
		place-items: center;
		height: 100%;
		background: url(./wood.svg);
	}

+++	small {
		display: block;
		font-size: 0.6em;
		text-align: right;
	}+++
</style>
```

Alternatively, we could use the `:global` modifier inside `Card.svelte` to target all `small` elements inside `.card`:

```svelte
/// file: Card.svelte
<style>
	/* ... */ 

	+++.card :global(small) {
		display: block;
		font-size: 0.6em;
		text-align: right;
	}+++
</style>
```
####### content/tutorial/02-advanced-svelte/07-composition/03-slot-fallbacks/app-a/src/lib/App.svelte #######

```

<script>
	import Card from './Card.svelte';
</script>

<main>
	<Card>
		<span>Patrick BATEMAN</span>
		<span>Vice President</span>

		<span slot="telephone">212 555 6342</span>

		<span slot="company">
			Pierce &amp; Pierce
			<small>Mergers and Aquisitions</small>
		</span>
		
		<span slot="address">358 Exchange Place, New York, N.Y. 100099 fax 212 555 6390 telex 10 4534</span>
	</Card>

	<Card />
</main>

<style>
	main {
		display: flex;
		flex-direction: column;
		justify-content: center;
		gap: 2em;
		grid-template-rows: 1fr 1fr;
		place-items: center;
		height: 100%;
		background: url(./wood.svg);
	}

	small {
		display: block;
		font-size: 0.6em;
		text-align: right;
	}

	@media (min-aspect-ratio: 3.5 / 2.0) {
		main {
			flex-direction: row;
		}
	}
</style>
```


####### content/tutorial/02-advanced-svelte/07-composition/03-slot-fallbacks/app-a/src/lib/Card.svelte #######

```

<div class="card">
	<header>
		<slot name="telephone" />
		<slot name="company" />
	</header>

	<slot />
		
	<footer>
		<slot name="address" />
	</footer>
</div>

<style>
	@font-face {
		src: url('/Garamond Classico SC Regular.woff2') format('woff2');
		font-family: 'Silian Rail';
		font-style: normal;
		font-weight: 400;
	}

	.card {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		font-size: min(2vw, 3.5vh, 1.5rem);
		font-family: 'Silian Rail';
		width: 24em;
		aspect-ratio: 3.5 / 2.0;
		background: url(./paper.svg) no-repeat 50% 50%;
		background-size: cover;
		border-radius: 2px;
		filter: drop-shadow(0.1em 0.1em 0.1em rgba(0, 0, 0, 0.2));
		padding: 1.5em 1em 1em 1em;
		font-variant: small-caps;
		text-shadow: -1px -1px 2px rgba(0, 0, 0, 0.2), 1px 1px 2px white;
		color: hsl(50, 20%, 35%);
		line-height: 1.2;
	}

	header, footer {
		width: 100%;
		display: flex;
		flex: 1;
	}

	header {
		justify-content: space-between;
	}

	footer {
		font-size: 0.7em;
		justify-content: center;
		align-items: end;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/07-composition/03-slot-fallbacks/app-b/src/lib/Card.svelte #######

```

<div class="card">
	<header>
		<slot name="telephone">
			<i>(telephone)</i>
		</slot>
		
		<slot name="company">
			<i>(company name)</i>
		</slot>
	</header>

	<slot>
		<i>(name)</i>
	</slot>
		
	<footer>
		<slot name="address">
			<i>(address)</i>
		</slot>
	</footer>
</div>

<style>
	@font-face {
		src: url('/Garamond Classico SC Regular.woff2') format('woff2');
		font-family: 'Silian Rail';
		font-style: normal;
		font-weight: 400;
	}

	.card {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		font-size: min(2vw, 3.5vh, 1.5rem);
		font-family: 'Silian Rail';
		width: 24em;
		aspect-ratio: 3.5 / 2.0;
		background: url(./paper.svg) no-repeat 50% 50%;
		background-size: cover;
		border-radius: 2px;
		filter: drop-shadow(0.1em 0.1em 0.1em rgba(0, 0, 0, 0.2));
		padding: 1.5em 1em 1em 1em;
		font-variant: small-caps;
		text-shadow: -1px -1px 2px rgba(0, 0, 0, 0.2), 1px 1px 2px white;
		color: hsl(50, 20%, 35%);
		line-height: 1.2;
	}

	header, footer {
		width: 100%;
		display: flex;
		flex: 1;
	}

	header {
		justify-content: space-between;
	}

	footer {
		font-size: 0.7em;
		justify-content: center;
		align-items: end;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/07-composition/03-slot-fallbacks/README.md #######

---
title: Slot fallbacks
---

A component can specify _fallbacks_ for any slots that are left empty, by putting content inside the `<slot>` element:

```svelte
/// file: Card.svelte
<div class="card">
	<header>
		<slot name="telephone">
			+++<i>(telephone)</i>+++
		</slot>
		
		<slot name="company">
			+++<i>(company name)</i>+++
		</slot>
	</header>

	<slot>
		+++<i>(name)</i>+++
	</slot>
		
	<footer>
		<slot name="address">
			+++<i>(address)</i>+++
		</slot>
	</footer>
</div>
```
####### content/tutorial/02-advanced-svelte/07-composition/04-slot-props/app-a/src/lib/App.svelte #######

```

<script>
	import FilterableList from './FilterableList.svelte';
	import { colors } from './colors.js';

	let row = colors[0];
</script>

<FilterableList
	data={colors}
	field="name"
>
	<header slot="header" class="row">
		<span class="color" />
		<span class="name">name</span>
		<span class="hex">hex</span>
		<span class="rgb">rgb</span>
		<span class="hsl">hsl</span>
	</header>

	<div class="row">
		<span class="color" style="background-color: {row.hex}" />
		<span class="name">{row.name}</span>
		<span class="hex">{row.hex}</span>
		<span class="rgb">{row.rgb}</span>
		<span class="hsl">{row.hsl}</span>
	</div>
</FilterableList>

<style>
	.row {
		display: grid;
		align-items: center;
		grid-template-columns: 2em 4fr 3fr;
		gap: 1em;
		padding: 0.1em;
		background: var(--bg-1);
		border-radius: 0.2em;
	}

	header {
		font-weight: bold;
	}

	.row:not(header):hover {
		background: var(--bg-2);
	}

	.color {
		aspect-ratio: 1;
		height: 100%;
		border-radius: 0.1em;
	}

	.rgb, .hsl {
		display: none;
	}

	@media (min-width: 40rem) {
		.row {
			grid-template-columns: 2em 4fr 3fr 3fr;
		}

		.rgb {
			display: block;
		}
	}

	@media (min-width: 60rem) {
		.row {
			grid-template-columns: 2em 4fr 3fr 3fr 3fr;
		}

		.hsl {
			display: block;
		}
	}
</style>
```


####### content/tutorial/02-advanced-svelte/07-composition/04-slot-props/app-a/src/lib/colors.js #######

```

const data = [
	{ hex: '#f0f8ff', name: 'AliceBlue' },
	{ hex: '#faebd7', name: 'AntiqueWhite' },
	{ hex: '#00ffff', name: 'Aqua' },
	{ hex: '#7fffd4', name: 'Aquamarine' },
	{ hex: '#f0ffff', name: 'Azure' },
	{ hex: '#f5f5dc', name: 'Beige' },
	{ hex: '#ffe4c4', name: 'Bisque' },
	{ hex: '#000000', name: 'Black' },
	{ hex: '#ffebcd', name: 'BlanchedAlmond' },
	{ hex: '#0000ff', name: 'Blue' },
	{ hex: '#8a2be2', name: 'BlueViolet' },
	{ hex: '#a52a2a', name: 'Brown' },
	{ hex: '#deb887', name: 'BurlyWood' },
	{ hex: '#5f9ea0', name: 'CadetBlue' },
	{ hex: '#7fff00', name: 'Chartreuse' },
	{ hex: '#d2691e', name: 'Chocolate' },
	{ hex: '#ff7f50', name: 'Coral' },
	{ hex: '#6495ed', name: 'CornflowerBlue' },
	{ hex: '#fff8dc', name: 'Cornsilk' },
	{ hex: '#dc143c', name: 'Crimson' },
	{ hex: '#00ffff', name: 'Cyan' },
	{ hex: '#00008b', name: 'DarkBlue' },
	{ hex: '#008b8b', name: 'DarkCyan' },
	{ hex: '#b8860b', name: 'DarkGoldenRod' },
	{ hex: '#a9a9a9', name: 'DarkGray' },
	{ hex: '#a9a9a9', name: 'DarkGrey' },
	{ hex: '#006400', name: 'DarkGreen' },
	{ hex: '#bdb76b', name: 'DarkKhaki' },
	{ hex: '#8b008b', name: 'DarkMagenta' },
	{ hex: '#556b2f', name: 'DarkOliveGreen' },
	{ hex: '#ff8c00', name: 'DarkOrange' },
	{ hex: '#9932cc', name: 'DarkOrchid' },
	{ hex: '#8b0000', name: 'DarkRed' },
	{ hex: '#e9967a', name: 'DarkSalmon' },
	{ hex: '#8fbc8f', name: 'DarkSeaGreen' },
	{ hex: '#483d8b', name: 'DarkSlateBlue' },
	{ hex: '#2f4f4f', name: 'DarkSlateGray' },
	{ hex: '#2f4f4f', name: 'DarkSlateGrey' },
	{ hex: '#00ced1', name: 'DarkTurquoise' },
	{ hex: '#9400d3', name: 'DarkViolet' },
	{ hex: '#ff1493', name: 'DeepPink' },
	{ hex: '#00bfff', name: 'DeepSkyBlue' },
	{ hex: '#696969', name: 'DimGray' },
	{ hex: '#696969', name: 'DimGrey' },
	{ hex: '#1e90ff', name: 'DodgerBlue' },
	{ hex: '#b22222', name: 'FireBrick' },
	{ hex: '#fffaf0', name: 'FloralWhite' },
	{ hex: '#228b22', name: 'ForestGreen' },
	{ hex: '#ff00ff', name: 'Fuchsia' },
	{ hex: '#dcdcdc', name: 'Gainsboro' },
	{ hex: '#f8f8ff', name: 'GhostWhite' },
	{ hex: '#ffd700', name: 'Gold' },
	{ hex: '#daa520', name: 'GoldenRod' },
	{ hex: '#808080', name: 'Gray' },
	{ hex: '#808080', name: 'Grey' },
	{ hex: '#008000', name: 'Green' },
	{ hex: '#adff2f', name: 'GreenYellow' },
	{ hex: '#f0fff0', name: 'HoneyDew' },
	{ hex: '#ff69b4', name: 'HotPink' },
	{ hex: '#cd5c5c', name: 'IndianRed' },
	{ hex: '#4b0082', name: 'Indigo' },
	{ hex: '#fffff0', name: 'Ivory' },
	{ hex: '#f0e68c', name: 'Khaki' },
	{ hex: '#e6e6fa', name: 'Lavender' },
	{ hex: '#fff0f5', name: 'LavenderBlush' },
	{ hex: '#7cfc00', name: 'LawnGreen' },
	{ hex: '#fffacd', name: 'LemonChiffon' },
	{ hex: '#add8e6', name: 'LightBlue' },
	{ hex: '#f08080', name: 'LightCoral' },
	{ hex: '#e0ffff', name: 'LightCyan' },
	{ hex: '#fafad2', name: 'LightGoldenRodYellow' },
	{ hex: '#d3d3d3', name: 'LightGray' },
	{ hex: '#d3d3d3', name: 'LightGrey' },
	{ hex: '#90ee90', name: 'LightGreen' },
	{ hex: '#ffb6c1', name: 'LightPink' },
	{ hex: '#ffa07a', name: 'LightSalmon' },
	{ hex: '#20b2aa', name: 'LightSeaGreen' },
	{ hex: '#87cefa', name: 'LightSkyBlue' },
	{ hex: '#778899', name: 'LightSlateGray' },
	{ hex: '#778899', name: 'LightSlateGrey' },
	{ hex: '#b0c4de', name: 'LightSteelBlue' },
	{ hex: '#ffffe0', name: 'LightYellow' },
	{ hex: '#00ff00', name: 'Lime' },
	{ hex: '#32cd32', name: 'LimeGreen' },
	{ hex: '#faf0e6', name: 'Linen' },
	{ hex: '#ff00ff', name: 'Magenta' },
	{ hex: '#800000', name: 'Maroon' },
	{ hex: '#66cdaa', name: 'MediumAquaMarine' },
	{ hex: '#0000cd', name: 'MediumBlue' },
	{ hex: '#ba55d3', name: 'MediumOrchid' },
	{ hex: '#9370db', name: 'MediumPurple' },
	{ hex: '#3cb371', name: 'MediumSeaGreen' },
	{ hex: '#7b68ee', name: 'MediumSlateBlue' },
	{ hex: '#00fa9a', name: 'MediumSpringGreen' },
	{ hex: '#48d1cc', name: 'MediumTurquoise' },
	{ hex: '#c71585', name: 'MediumVioletRed' },
	{ hex: '#191970', name: 'MidnightBlue' },
	{ hex: '#f5fffa', name: 'MintCream' },
	{ hex: '#ffe4e1', name: 'MistyRose' },
	{ hex: '#ffe4b5', name: 'Moccasin' },
	{ hex: '#ffdead', name: 'NavajoWhite' },
	{ hex: '#000080', name: 'Navy' },
	{ hex: '#fdf5e6', name: 'OldLace' },
	{ hex: '#808000', name: 'Olive' },
	{ hex: '#6b8e23', name: 'OliveDrab' },
	{ hex: '#ffa500', name: 'Orange' },
	{ hex: '#ff4500', name: 'OrangeRed' },
	{ hex: '#da70d6', name: 'Orchid' },
	{ hex: '#eee8aa', name: 'PaleGoldenRod' },
	{ hex: '#98fb98', name: 'PaleGreen' },
	{ hex: '#afeeee', name: 'PaleTurquoise' },
	{ hex: '#db7093', name: 'PaleVioletRed' },
	{ hex: '#ffefd5', name: 'PapayaWhip' },
	{ hex: '#ffdab9', name: 'PeachPuff' },
	{ hex: '#cd853f', name: 'Peru' },
	{ hex: '#ffc0cb', name: 'Pink' },
	{ hex: '#dda0dd', name: 'Plum' },
	{ hex: '#b0e0e6', name: 'PowderBlue' },
	{ hex: '#800080', name: 'Purple' },
	{ hex: '#663399', name: 'RebeccaPurple' },
	{ hex: '#ff0000', name: 'Red' },
	{ hex: '#bc8f8f', name: 'RosyBrown' },
	{ hex: '#4169e1', name: 'RoyalBlue' },
	{ hex: '#8b4513', name: 'SaddleBrown' },
	{ hex: '#fa8072', name: 'Salmon' },
	{ hex: '#f4a460', name: 'SandyBrown' },
	{ hex: '#2e8b57', name: 'SeaGreen' },
	{ hex: '#fff5ee', name: 'SeaShell' },
	{ hex: '#a0522d', name: 'Sienna' },
	{ hex: '#c0c0c0', name: 'Silver' },
	{ hex: '#87ceeb', name: 'SkyBlue' },
	{ hex: '#6a5acd', name: 'SlateBlue' },
	{ hex: '#708090', name: 'SlateGray' },
	{ hex: '#708090', name: 'SlateGrey' },
	{ hex: '#fffafa', name: 'Snow' },
	{ hex: '#00ff7f', name: 'SpringGreen' },
	{ hex: '#4682b4', name: 'SteelBlue' },
	{ hex: '#d2b48c', name: 'Tan' },
	{ hex: '#008080', name: 'Teal' },
	{ hex: '#d8bfd8', name: 'Thistle' },
	{ hex: '#ff6347', name: 'Tomato' },
	{ hex: '#40e0d0', name: 'Turquoise' },
	{ hex: '#ee82ee', name: 'Violet' },
	{ hex: '#f5deb3', name: 'Wheat' },
	{ hex: '#ffffff', name: 'White' },
	{ hex: '#f5f5f5', name: 'WhiteSmoke' },
	{ hex: '#ffff00', name: 'Yellow' },
	{ hex: '#9acd32', name: 'YellowGreen' }
];

export const colors = data.map(({ hex, name }) => {
	// calculate rgb
	let r = parseInt(hex.slice(1, 3), 16);
	let g = parseInt(hex.slice(3, 5), 16);
	let b = parseInt(hex.slice(5, 7), 16);

	const rgb = `rgb(${r}, ${g}, ${b})`;

	// calculate hsl
	r /= 255;
	g /= 255;
	b /= 255;

	const max = Math.max(r, g, b);
	const min = Math.min(r, g, b);

	let h = 0;
	let s = 0;
	const l = (max + min) / 2;

	if (max > min) {
		const d = max - min;
		s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

		switch (max) {
			case r: h = (g - b) / d + (g < b ? 6 : 0); break;
			case g: h = (b - r) / d + 2; break;
			case b: h = (r - g) / d + 4; break;
		}

		h /= 6;
	}

	const hsl = `hsl(${Math.round(h * 360)}, ${Math.round(s * 100)}%, ${Math.round(l * 100)}%)`;

	return {
		name,
		hex,
		rgb,
		hsl
	};
});
```


####### content/tutorial/02-advanced-svelte/07-composition/04-slot-props/app-a/src/lib/FilterableList.svelte #######

```

<script>
	export let data;
	export let field;

	let search = '';

	$: regex = search ? new RegExp(search, 'i') : null;
	$: matches = (item) => regex ? regex.test(item[field]) : true;
</script>

<div class="list">
	<label>
		Filter: <input bind:value={search} />
	</label>

	<div class="header">
		<slot name="header"/>
	</div>
	
	<div class="content">
		{#each data.filter(matches) as item}
			<slot />
		{/each}
	</div>
</div>

<style>
	.list {
		display: flex;
		flex-direction: column;
		height: 100%;
	}

	.header {
		border-top: 1px solid var(--bg-2);
		padding: 0.2em 0;
	}

	.content {
		flex: 1;
		overflow: auto;
		padding-top: 0.5em;
		border-top: 1px solid var(--bg-2);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/07-composition/04-slot-props/app-b/src/lib/App.svelte #######

```

<script>
	import FilterableList from './FilterableList.svelte';
	import { colors } from './colors.js';
</script>

<FilterableList
	data={colors}
	field="name"
	let:item={row}
>
	<header slot="header" class="row">
		<span class="color" />
		<span class="name">name</span>
		<span class="hex">hex</span>
		<span class="rgb">rgb</span>
		<span class="hsl">hsl</span>
	</header>

	<div class="row">
		<span class="color" style="background-color: {row.hex}" />
		<span class="name">{row.name}</span>
		<span class="hex">{row.hex}</span>
		<span class="rgb">{row.rgb}</span>
		<span class="hsl">{row.hsl}</span>
	</div>
</FilterableList>

<style>
	.row {
		display: grid;
		align-items: center;
		grid-template-columns: 2em 4fr 3fr;
		gap: 1em;
		padding: 0.1em;
		background: var(--bg-1);
		border-radius: 0.2em;
	}

	header {
		font-weight: bold;
	}

	.row:not(header):hover {
		background: var(--bg-2);
	}

	.row:hover {
		background: var(--bg-2);
	}

	.color {
		aspect-ratio: 1;
		height: 100%;
		border-radius: 0.1em;
	}

	.rgb, .hsl {
		display: none;
	}

	@media (min-width: 40rem) {
		.row {
			grid-template-columns: 2em 4fr 3fr 3fr;
		}

		.rgb {
			display: block;
		}
	}

	@media (min-width: 60rem) {
		.row {
			grid-template-columns: 2em 4fr 3fr 3fr 3fr;
		}

		.hsl {
			display: block;
		}
	}
</style>
```


####### content/tutorial/02-advanced-svelte/07-composition/04-slot-props/app-b/src/lib/FilterableList.svelte #######

```

<script>
	export let data;
	export let field;

	let search = '';

	$: regex = search ? new RegExp(search, 'i') : null;
	$: matches = (item) => regex ? regex.test(item[field]) : true;
</script>

<div class="list">
	<label>
		Filter: <input bind:value={search} />
	</label>

	<div class="header">
		<slot name="header"/>
	</div>
	
	<div class="content">
		{#each data.filter(matches) as item}
			<slot {item} />
		{/each}
	</div>
</div>

<style>
	.list {
		display: flex;
		flex-direction: column;
		height: 100%;
	}

	.header {
		border-top: 1px solid var(--bg-2);
		padding: 0.2em 0;
	}

	.content {
		flex: 1;
		overflow: auto;
		padding-top: 0.5em;
		border-top: 1px solid var(--bg-2);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/07-composition/04-slot-props/README.md #######

---
title: Slot props
---

Components can pass data _back_ to their slotted content via _slot props_. In this app, we have a list of named CSS colours. Typing into the `<input>` will filter the list.

Right now every row is showing `AliceBlue`, and as lovely a colour as it is, that's not what we want.

Open `FilterableList.svelte`. The `<slot>` is being rendered for each filtered item in the list. Pass the data into the slot:

```svelte
/// file: FilterableList.svelte
<div class="content">
	{#each data.filter(matches) as item}
		<slot +++{item}+++ />
	{/each}
</div>
```

(As in other contexts, `{item}` is shorthand for `item={item}`.)

Then, on the other side, expose the data to the slotted content with the `let:` directive:

```svelte
/// file: App.svelte
<FilterableList
	data={colors}
	field="name"
	+++let:item={row}+++
>
	<div class="row">
		<span class="color" style="background-color: {row.hex}" />
		<span class="name">{row.name}</span>
		<span class="hex">{row.hex}</span>
		<span class="rgb">{row.rgb}</span>
		<span class="hsl">{row.hsl}</span>
	</div>
</FilterableList>
```

Finally, get rid of the placeholder variable, which we no longer need:

```svelte
/// file: App.svelte
<script>
	import FilterableList from './FilterableList.svelte';
	import { colors } from './colors.js';

	---let row = colors[0];---
</script>
```

> Named slots can also have props; use the `let` directive on an element with a `slot="..."` attribute, instead of on the component itself.

####### content/tutorial/02-advanced-svelte/07-composition/05-optional-slots/app-b/src/lib/App.svelte #######

```

<script>
	import FilterableList from './FilterableList.svelte';
	import { colors } from './colors.js';
</script>

<FilterableList
	data={colors}
	field="name"
	let:item={row}
>
	<div class="row">
		<span class="color" style="background-color: {row.hex}" />
		<span class="name">{row.name}</span>
		<span class="hex">{row.hex}</span>
		<span class="rgb">{row.rgb}</span>
		<span class="hsl">{row.hsl}</span>
	</div>
</FilterableList>

<style>
	.row {
		display: grid;
		align-items: center;
		grid-template-columns: 2em 4fr 3fr;
		gap: 1em;
		padding: 0.1em;
		background: var(--bg-1);
		border-radius: 0.2em;
	}

	header {
		font-weight: bold;
	}

	.row:not(header):hover {
		background: var(--bg-2);
	}

	.row:hover {
		background: var(--bg-2);
	}

	.color {
		aspect-ratio: 1;
		height: 100%;
		border-radius: 0.1em;
	}

	.rgb, .hsl {
		display: none;
	}

	@media (min-width: 40rem) {
		.row {
			grid-template-columns: 2em 4fr 3fr 3fr;
		}

		.rgb {
			display: block;
		}
	}

	@media (min-width: 60rem) {
		.row {
			grid-template-columns: 2em 4fr 3fr 3fr 3fr;
		}

		.hsl {
			display: block;
		}
	}
</style>
```


####### content/tutorial/02-advanced-svelte/07-composition/05-optional-slots/app-b/src/lib/FilterableList.svelte #######

```

<script>
	export let data;
	export let field;

	let search = '';

	$: regex = search ? new RegExp(search, 'i') : null;
	$: matches = (item) => regex ? regex.test(item[field]) : true;
</script>

<div class="list">
	<label>
		Filter: <input bind:value={search} />
	</label>

	{#if $$slots.header}
		<div class="header">
			<slot name="header"/>
		</div>
	{/if}
	
	<div class="content">
		{#each data.filter(matches) as item}
			<slot {item} />
		{/each}
	</div>
</div>

<style>
	.list {
		display: flex;
		flex-direction: column;
		height: 100%;
	}

	.header {
		border-top: 1px solid var(--bg-2);
		padding: 0.2em 0;
	}

	.content {
		flex: 1;
		overflow: auto;
		padding-top: 0.5em;
		border-top: 1px solid var(--bg-2);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/07-composition/05-optional-slots/README.md #######

---
title: Checking for slot content
---

In some cases, you may want to control parts of your component based on whether slotted content was passed in. For example, if we remove the `<header>` from `App.svelte`...

```svelte
/// file: App.svelte
---<header slot="header" class="row">
	<span class="color" />
	<span class="name">name</span>
	<span class="hex">hex</span>
	<span class="rgb">rgb</span>
	<span class="hsl">hsl</span>
</header>---

<div class="row">
	<span class="color" style="background-color: {row.hex}" />
	<span class="name">{row.name}</span>
	<span class="hex">{row.hex}</span>
	<span class="rgb">{row.rgb}</span>
	<span class="hsl">{row.hsl}</span>
</div>
```

...we're left with an ugly double border because `FilterableList.svelte` is still rendering the `<div class="header">`.

We can fix that by using the special `$$slots` variable in `FilterableList.svelte`:

```svelte
/// file: FilterableList.svelte
+++{#if $$slots.header}+++
	<div class="header">
		<slot name="header"/>
	</div>
+++{/if}+++
```

####### content/tutorial/02-advanced-svelte/07-composition/meta.json #######

```

{
	"title": "Component composition",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/08-context/01-context-api/app-a/src/lib/App.svelte #######

```

<script>
	import Canvas from './Canvas.svelte';
	import Square from './Square.svelte';

	// we use a seeded random number generator to get consistent jitter
	let seed = 1;

	function random() {
		seed *= 16807;
		seed %= 2147483647;
		return (seed - 1) / 2147483646;
	}

	function jitter(amount) {
		return amount * (random() - 0.5);
	}
</script>

<div class="container">
	<Canvas width={800} height={1200}>
		{#each Array(12) as _, c}
			{#each Array(22) as _, r}
				<Square
					x={180 + c * 40}
					y={180 + r * 40}
					size={40}
				/>
			{/each}
		{/each}
	</Canvas>
</div>

<style>
	.container {
		height: 100%;
		aspect-ratio: 2 / 3;
		margin: 0 auto;
		background: rgb(224, 219, 213);
		filter: drop-shadow(0.5em 0.5em 1em rgba(0, 0, 0, 0.1));
	}
</style>
```


####### content/tutorial/02-advanced-svelte/08-context/01-context-api/app-a/src/lib/Canvas.svelte #######

```

<script>
	import { afterUpdate, onMount, tick } from 'svelte';

	export let width = 100;
	export let height = 100;

	let canvas, ctx;
	let items = new Set();
	let scheduled = false;

	onMount(() => {
		ctx = canvas.getContext('2d');
	});

	function addItem(fn) {
		onMount(() => {
			items.add(fn);
			return () => items.delete(fn);
		});
		
		afterUpdate(async () => {
			if (scheduled) return;
			
			scheduled = true;
			await tick();
			scheduled = false;

			draw();
		});
	}

	function draw() {
		ctx.clearRect(0, 0, width, height);
		items.forEach(fn => fn(ctx));
	}
</script>

<canvas bind:this={canvas} {width} {height}>
	<slot />
</canvas>

<style>
	canvas {
		width: 100%;
		height: 100%;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/08-context/01-context-api/app-a/src/lib/Square.svelte #######

```

<script>
	export let x;
	export let y;
	export let size;
	export let rotate;

	function draw(ctx) {
		ctx.save();

		ctx.translate(x, y);
		ctx.rotate(rotate);

		ctx.strokeStyle = 'black';
		ctx.strokeRect(-size / 2, -size / 2, size, size);

		ctx.restore();
	}
</script>
```


####### content/tutorial/02-advanced-svelte/08-context/01-context-api/app-b/src/lib/App.svelte #######

```

<script>
	import Canvas from './Canvas.svelte';
	import Square from './Square.svelte';

	// we use a seeded random number generator to get consistent jitter
	let seed = 1;

	function random() {
		seed *= 16807;
		seed %= 2147483647;
		return (seed - 1) / 2147483646;
	}

	function jitter(amount) {
		return amount * (random() - 0.5);
	}
</script>

<div class="container">
	<Canvas width={800} height={1200}>
		{#each Array(12) as _, c}
			{#each Array(22) as _, r}
				<Square
					x={180 + c * 40 + jitter(r * 2)}
					y={180 + r * 40 + jitter(r * 2)}
					size={40}
					rotate={jitter(r * 0.05)}
				/>
			{/each}
		{/each}
	</Canvas>
</div>

<style>
	.container {
		height: 100%;
		aspect-ratio: 2 / 3;
		margin: 0 auto;
		background: rgb(224, 219, 213);
		filter: drop-shadow(0.5em 0.5em 1em rgba(0, 0, 0, 0.1));
	}
</style>
```


####### content/tutorial/02-advanced-svelte/08-context/01-context-api/app-b/src/lib/Canvas.svelte #######

```

<script>
	import { setContext, afterUpdate, onMount, tick } from 'svelte';

	export let width = 100;
	export let height = 100;

	let canvas, ctx;
	let items = new Set();
	let scheduled = false;

	onMount(() => {
		ctx = canvas.getContext('2d');
	});

	setContext('canvas', {
		addItem
	});

	function addItem(fn) {
		onMount(() => {
			items.add(fn);
			return () => items.delete(fn);
		});
		
		afterUpdate(async () => {
			if (scheduled) return;
			
			scheduled = true;
			await tick();
			scheduled = false;

			draw();
		});
	}

	function draw() {
		ctx.clearRect(0, 0, width, height);
		items.forEach(fn => fn(ctx));
	}
</script>

<canvas bind:this={canvas} {width} {height}>
	<slot />
</canvas>

<style>
	canvas {
		width: 100%;
		height: 100%;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/08-context/01-context-api/app-b/src/lib/Square.svelte #######

```

<script>
	import { getContext } from 'svelte';

	export let x;
	export let y;
	export let size;
	export let rotate;

	getContext('canvas').addItem(draw);

	function draw(ctx) {
		ctx.save();

		ctx.translate(x, y);
		ctx.rotate(rotate);

		ctx.strokeStyle = 'black';
		ctx.strokeRect(-size / 2, -size / 2, size, size);

		ctx.restore();
	}
</script>
```


####### content/tutorial/02-advanced-svelte/08-context/01-context-api/README.md #######

---
title: setContext and getContext
---

The context API provides a mechanism for components to 'talk' to each other without passing around data and functions as props, or dispatching lots of events. It's an advanced feature, but a useful one. In this exercise, we're going to recreate [Schotter](https://collections.vam.ac.uk/item/O221321/schotter-print-nees-georg/) by George Nees — one of the pioneers of generative art — using the context API.

Inside `Canvas.svelte`, there's an `addItem` function that adds an item to the canvas. We can make it available to components inside `<Canvas>`, like `<Square>`, with `setContext`:

```svelte
/// file: Canvas.svelte
<script>
	import { +++setContext+++, afterUpdate, onMount, tick } from 'svelte';

	// ...

	onMount(() => {
		ctx = canvas.getContext('2d');
	});

+++	setContext('canvas', {
		addItem
	});+++

	function addItem(fn) {...}

	function draw() {...}
</script>
```

Inside child components, we can now get the context with, well, `getContext`:

```svelte
/// file: Square.svelte
<script>
	+++import { getContext } from 'svelte';+++

	export let x;
	export let y;
	export let size;
	export let rotate;

	+++getContext('canvas').addItem(draw);+++

	function draw(ctx) {...}
</script>
```

So far, so... boring. Let's add some randomness to the grid:

```svelte
/// file: App.svelte
<div class="container">
	<Canvas width={800} height={1200}>
		{#each Array(12) as _, c}
			{#each Array(22) as _, r}
				<Square
					x={180 + c * 40+++ + jitter(r * 2)+++}
					y={180 + r * 40+++ + jitter(r * 2)+++}
					size={40}
					+++rotate={jitter(r * 0.05)}+++
				/>
			{/each}
		{/each}
	</Canvas>
</div>
```

Like [lifecycle functions](/tutorial/onmount), `setContext` and `getContext` must be called during component initialisation. (The context key (`'canvas'` in this case) can be anything you like, including non-strings, which is useful for controlling who can access the context.)

Your context object can include anything, including stores. This allows you to pass values that change over time to child components:

```js
/// no-file
// in a parent component
import { setContext } from 'svelte';
import { writable } from 'svelte/store';

setContext('my-context', {
	count: writable(0)
});
```
```js
/// no-file
// in a child component
import { getContext } from 'svelte';

const { count } = getContext('my-context');

$: console.log({ count: $count });
```

####### content/tutorial/02-advanced-svelte/08-context/meta.json #######

```

{
	"title": "Context API",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/app-a/src/lib/App.svelte #######

```

<script>
	import Folder from './Folder.svelte';
	import { files } from './data.js';
</script>

<Folder name="Home" {files} expanded />

```


####### content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/app-a/src/lib/data.js #######

```

export const files = [
    {
        name: 'Important work stuff',
        files: [{ name: 'quarterly-results.xlsx' }]
    },
    {
        name: 'Animal GIFs',
        files: [
            {
                name: 'Dogs',
                files: [
                    { name: 'treadmill.gif' },
                    { name: 'rope-jumping.gif' }
                ]
            },
            {
                name: 'Goats',
                files: [
                    { name: 'parkour.gif' },
                    { name: 'rampage.gif' }
                ]
            },
            { name: 'cat-roomba.gif' },
            { name: 'duck-shuffle.gif' },
            { name: 'monkey-on-a-pig.gif' }
        ]
    },
    { name: 'README.md' }
];
```


####### content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/app-a/src/lib/File.svelte #######

```

<script>
	export let name;
	$: type = name.slice(name.lastIndexOf('.') + 1);
</script>

<span
	style="background-image: url(/tutorial/icons/{type}.svg)"
	>{name}</span
>

<style>
	span {
		padding: 0 0 0 1.5em;
		background: 0 0.1em no-repeat;
		background-size: 1em 1em;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/app-a/src/lib/Folder.svelte #######

```

<script>
	import File from './File.svelte';

	export let expanded = false;
	export let name;
	export let files;

	function toggle() {
		expanded = !expanded;
	}
</script>

<button class:expanded on:click={toggle}>{name}</button>

{#if expanded}
	<ul>
		{#each files as file}
			<li>
				{#if file.files}
					<span>TODO subfolders</span>
				{:else}
					<File {...file} />
				{/if}
			</li>
		{/each}
	</ul>
{/if}

<style>
	button {
		padding: 0 0 0 1.5em;
		background: url(/tutorial/icons/folder.svg) 0 0.1em no-repeat;
		background-size: 1em 1em;
		color: var(--fg-1);
		font-weight: bold;
		cursor: pointer;
		border: none;
		margin: 0;
	}

	.expanded {
		background-image: url(/tutorial/icons/folder-open.svg);
	}

	ul {
		padding: 0.2em 0 0 0.5em;
		margin: 0 0 0 0.5em;
		list-style: none;
		border-left: 1px solid rgba(128, 128, 128, 0.4);
	}

	li {
		padding: 0.2em 0;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/app-b/src/lib/Folder.svelte #######

```

<script>
	import File from './File.svelte';

	export let expanded = false;
	export let name;
	export let files;

	function toggle() {
		expanded = !expanded;
	}
</script>

<button class:expanded on:click={toggle}>{name}</button>

{#if expanded}
	<ul>
		{#each files as file}
			<li>
				{#if file.files}
					<svelte:self {...file} />
				{:else}
					<File {...file} />
				{/if}
			</li>
		{/each}
	</ul>
{/if}

<style>
	button {
		padding: 0 0 0 1.5em;
		background: url(/tutorial/icons/folder.svg) 0 0.1em no-repeat;
		background-size: 1em 1em;
		color: var(--fg-1);
		font-weight: bold;
		cursor: pointer;
		border: none;
		margin: 0;
	}

	.expanded {
		background-image: url(/tutorial/icons/folder-open.svg);
	}

	ul {
		padding: 0.2em 0 0 0.5em;
		margin: 0 0 0 0.5em;
		list-style: none;
		border-left: 1px solid rgba(128, 128, 128, 0.4);
	}

	li {
		padding: 0.2em 0;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/01-svelte-self/README.md #######

---
title: <svelte:self>
---

Svelte provides a variety of built-in elements. The first, `<svelte:self>`, allows a component to contain itself recursively.

It's useful for things like this folder tree view, where folders can contain _other_ folders. In `Folder.svelte` we want to be able to do this...

```svelte
/// file: Folder.svelte
{#if file.files}
	<Folder {...file}/>
{:else}
	<File {...file}/>
{/if}
```

...but that's impossible, because a module can't import itself. Instead, we use `<svelte:self>`:

```svelte
/// file: Folder.svelte
{#if file.files}
	+++<svelte:self {...file}/>+++
{:else}
	<File {...file}/>
{/if}
```

####### content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/app-a/src/lib/App.svelte #######

```

<script>
	import RedThing from './RedThing.svelte';
	import GreenThing from './GreenThing.svelte';
	import BlueThing from './BlueThing.svelte';

	const options = [
		{ color: 'red', component: RedThing },
		{ color: 'green', component: GreenThing },
		{ color: 'blue', component: BlueThing }
	];

	let selected = options[0];
</script>

<select bind:value={selected}>
	{#each options as option}
		<option value={option}>{option.color}</option>
	{/each}
</select>

{#if selected.color === 'red'}
	<RedThing />
{:else}
	<p>TODO others</p>
{/if}

```


####### content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/app-a/src/lib/BlueThing.svelte #######

```

<p>Blue thing</p>

<style>
	p {
		color: blue;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/app-a/src/lib/GreenThing.svelte #######

```

<p>Green thing</p>

<style>
	p {
		color: green;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/app-a/src/lib/RedThing.svelte #######

```

<p>Red thing</p>

<style>
	p {
		color: red;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/app-b/src/lib/App.svelte #######

```

<script>
	import RedThing from './RedThing.svelte';
	import GreenThing from './GreenThing.svelte';
	import BlueThing from './BlueThing.svelte';

	const options = [
		{ color: 'red', component: RedThing },
		{ color: 'green', component: GreenThing },
		{ color: 'blue', component: BlueThing }
	];

	let selected = options[0];
</script>

<select bind:value={selected}>
	{#each options as option}
		<option value={option}>{option.color}</option>
	{/each}
</select>

<svelte:component this={selected.component} />

```


####### content/tutorial/02-advanced-svelte/09-special-elements/02-svelte-component/README.md #######

---
title: <svelte:component>
---

A component can change its type altogether with `<svelte:component>`. In this exercise, we want to show `RedThing.svelte` if the `color` is `red`, `GreenThing.svelte` if it's `green`, and so on.

We _could_ do this with a sequence of `if` blocks...

```svelte
/// file: App.svelte
{#if selected.color === 'red'}
	<RedThing/>
{:else if selected.color === 'green'}
	<GreenThing/>
{:else if selected.color === 'blue'}
	<BlueThing/>
{/if}
```

...but it's a little cumbersome. Instead, we can create a single dynamic component:

```svelte
/// file: App.svelte
<select bind:value={selected}>
	{#each options as option}
		<option value={option}>{option.color}</option>
	{/each}
</select>

+++<svelte:component this={selected.component} />+++
```

The `this` value can be any component constructor, or a falsy value — if it's falsy, no component is rendered.

####### content/tutorial/02-advanced-svelte/09-special-elements/03-svelte-element/app-a/src/lib/App.svelte #######

```

<script>
	const options = ['h1', 'h2', 'h3', 'p', 'marquee'];
	let selected = options[0];
</script>

<select bind:value={selected}>
	{#each options as option}
		<option value={option}>{option}</option>
	{/each}
</select>

{#if selected === 'h1'}
	<h1>I'm a <code>&lt;h1&gt;</code> element</h1>
{:else}
	<p>TODO others</p>
{/if}

```


####### content/tutorial/02-advanced-svelte/09-special-elements/03-svelte-element/app-b/src/lib/App.svelte #######

```

<script>
	const options = ['h1', 'h2', 'h3', 'p', 'marquee'];
	let selected = options[0];
</script>

<select bind:value={selected}>
	{#each options as option}
		<option value={option}>{option}</option>
	{/each}
</select>

<svelte:element this={selected}>
	I'm a <code>&lt;{selected}&gt;</code> element
</svelte:element>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/03-svelte-element/README.md #######

---
title: <svelte:element>
---

Similarly, we don't always know in advance what kind of DOM element to render. `<svelte:element>` comes in handy here. As with the [previous exercise](svelte-component), we can replace a long sequence of `if` blocks with a single dynamic element:

```svelte
/// file: App.svelte
<select bind:value={selected}>
	{#each options as option}
		<option value={option}>{option}</option>
	{/each}
</select>

+++<svelte:element this={selected}>
	I'm a <code>&lt;{selected}&gt;</code> element
</svelte:element>+++
```

The `this` value can be any string, or a falsy value — if it's falsy, no element is rendered.
####### content/tutorial/02-advanced-svelte/09-special-elements/04-svelte-window/app-a/src/lib/App.svelte #######

```

<script>
	let key;
	let keyCode;

	function handleKeydown(event) {
		key = event.key;
		keyCode = event.keyCode;
	}
</script>

<svelte:window />

<div style="text-align: center">
	{#if key}
		<kbd>{key === ' ' ? 'Space' : key}</kbd>
		<p>{keyCode}</p>
	{:else}
		<p>Focus this window and press any key</p>
	{/if}
</div>

<style>
	div {
		display: flex;
		height: 100%;
		align-items: center;
		justify-content: center;
		flex-direction: column;
	}

	kbd {
		border-radius: 4px;
		font-size: 6em;
		padding: 0.2em 0.5em;
		background-color: #eeeeee;
		border-top: 5px solid #f9f9f9;
		border-left: 5px solid #f9f9f9;
		border-right: 5px solid #aaaaaa;
		border-bottom: 5px solid #aaaaaa;
		color: #555;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/04-svelte-window/app-b/src/lib/App.svelte #######

```

<script>
	let key;
	let keyCode;

	function handleKeydown(event) {
		key = event.key;
		keyCode = event.keyCode;
	}
</script>

<svelte:window on:keydown={handleKeydown} />

<div style="text-align: center">
	{#if key}
		<kbd>{key === ' ' ? 'Space' : key}</kbd>
		<p>{keyCode}</p>
	{:else}
		<p>Focus this window and press any key</p>
	{/if}
</div>

<style>
	div {
		display: flex;
		height: 100%;
		align-items: center;
		justify-content: center;
		flex-direction: column;
	}

	kbd {
		border-radius: 4px;
		font-size: 6em;
		padding: 0.2em 0.5em;
		background-color: #eeeeee;
		border-top: 5px solid #f9f9f9;
		border-left: 5px solid #f9f9f9;
		border-right: 5px solid #aaaaaa;
		border-bottom: 5px solid #aaaaaa;
		color: #555;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/04-svelte-window/README.md #######

---
title: <svelte:window>
---

Just as you can add event listeners to any DOM element, you can add event listeners to the `window` object with `<svelte:window>`.

We've already got a `handleKeydown` function declared — now all we need to do is add a `keydown` listener:

```svelte
/// file: App.svelte
<svelte:window +++on:keydown={handleKeydown}+++ />
```

> As with DOM elements, you can add [event modifiers](/tutorial/event-modifiers) like `preventDefault`.

####### content/tutorial/02-advanced-svelte/09-special-elements/05-svelte-window-bindings/app-a/src/lib/App.svelte #######

```

<script>
	let y = 0;
</script>

<svelte:window />

<span>depth: {y}px</span>

<style>
	:global(body) {
		height: 400vw;
		background: url(./deepsea.webp);
		background-size: cover;
	}

	span {
		position: fixed;
		font-size: 2em;
		color: white;
		font-variant: tabular-nums;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/09-special-elements/05-svelte-window-bindings/app-b/src/lib/App.svelte #######

```

<script>
	let y = 0;
</script>

<svelte:window bind:scrollY={y} />

<span>depth: {y}px</span>

<style>
	:global(body) {
		height: 400vw;
		background: url(./deepsea.webp);
		background-size: cover;
	}

	span {
		position: fixed;
		font-size: 2em;
		color: white;
		font-variant: tabular-nums;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/09-special-elements/05-svelte-window-bindings/README.md #######

---
title: <svelte:window> bindings
---

We can also bind to certain properties of `window`, such as `scrollY`:

```svelte
/// file: App.svelte
<svelte:window +++bind:scrollY={y}+++ />
```

The list of properties you can bind to is as follows:

- `innerWidth`
- `innerHeight`
- `outerWidth`
- `outerHeight`
- `scrollX`
- `scrollY`
- `online` — an alias for `window.navigator.onLine`

All except `scrollX` and `scrollY` are readonly.

####### content/tutorial/02-advanced-svelte/09-special-elements/06-svelte-body/app-a/src/lib/App.svelte #######

```

<script>
	import kitten from './kitten.png';

	let hereKitty = false;
</script>

<svelte:body />

<!-- creative commons BY-NC http://www.pngall.com/kitten-png/download/7247 -->
<img
	class:curious={hereKitty}
	alt="Kitten wants to know what's going on"
	src={kitten}
/>

<style>
	img {
		position: absolute;
		left: 0;
		bottom: -60px;
		transform: translate(-80%, 0) rotate(-15deg);
		transform-origin: 100% 100%;
		transition: transform 0.4s;
	}

	.curious {
		transform: translate(-15%, 0) rotate(0deg);
	}

	:global(body) {
		overflow: hidden;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/06-svelte-body/app-b/src/lib/App.svelte #######

```

<script>
	import kitten from './kitten.png';

	let hereKitty = false;
</script>

<svelte:body
	on:mouseenter={() => hereKitty = true}
	on:mouseleave={() => hereKitty = false}
/>

<!-- creative commons BY-NC http://www.pngall.com/kitten-png/download/7247 -->
<img
	class:curious={hereKitty}
	alt="Kitten wants to know what's going on"
	src={kitten}
/>

<style>
	img {
		position: absolute;
		left: 0;
		bottom: -60px;
		transform: translate(-80%, 0) rotate(-15deg);
		transform-origin: 100% 100%;
		transition: transform 0.4s;
	}

	.curious {
		transform: translate(-15%, 0) rotate(0deg);
	}

	:global(body) {
		overflow: hidden;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/06-svelte-body/README.md #######

---
title: <svelte:body>
---

Similar to `<svelte:window>`, the `<svelte:body>` element allows you to listen for events that fire on `document.body`. This is useful with the `mouseenter` and `mouseleave` events, which don't fire on `window`.

Add these `mouseenter` and `mouseleave` handlers to the `<svelte:body>` tag...

```svelte
/// file: App.svelte
<svelte:body
	+++on:mouseenter={() => hereKitty = true}+++
	+++on:mouseleave={() => hereKitty = false}+++
/>
```

...and hover over the `<body>`.
####### content/tutorial/02-advanced-svelte/09-special-elements/07-svelte-document/app-a/src/lib/App.svelte #######

```

<script>
	let selection = '';

	const handleSelectionChange = (e) => selection = document.getSelection();
</script>

<svelte:document />

<h1>Select this text to fire events</h1>
<p>Selection: {selection}</p>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/07-svelte-document/app-b/src/lib/App.svelte #######

```

<script>
	let selection = '';

	const handleSelectionChange = (e) => selection = document.getSelection();
</script>

<svelte:document on:selectionchange={handleSelectionChange} />

<h1>Select this text to fire events</h1>
<p>Selection: {selection}</p>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/07-svelte-document/README.md #######

---
title: <svelte:document>
---

The `<svelte:document>` element allows you to listen for events that fire on `document`. This is useful with events like `selectionchange`, which doesn't fire on `window`.

Add the `selectionchange` handler to the `<svelte:document>` tag:

```svelte
/// file: App.svelte
<svelte:document +++on:selectionchange={handleSelectionChange}+++ />
```

> Avoid `mouseenter` and `mouseleave` handlers on this element, as these events are not fired on `document` in all browsers. Use `<svelte:body>` instead.

####### content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-a/src/lib/App.svelte #######

```

<script>
	const themes = ['margaritaville', 'retrowave', 'spaaaaace', 'halloween'];
	let selected = themes[0];
</script>

<h1>Welcome to my site!</h1>

<select bind:value={selected}>
	<option disabled>choose a theme</option>

	{#each themes as theme}
		<option>{theme}</option>
	{/each}
</select>
```


####### content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-a/static/stylesheets/halloween.css #######

```

@font-face {
	font-family: 'Schlop';
	src: url('./fonts/shlop.woff2') format('woff2');
}

body {
	display: flex; 
	flex-direction: column;
	align-items: center;
	justify-content: center;
	background: url(./halloween.webp) no-repeat 50% 50% fixed;
	background-size: cover;
}

h1 {
	font-size: min(8vw, 4rem);
	filter: drop-shadow(2px 2px 10px black);
	font-family: 'Schlop';
	background: linear-gradient(
		to bottom,
		hsl(0, 100%, 77%) 0%,
		hsl(0, 60%, 50%) 100%
	);
	-webkit-background-clip: text;
	-webkit-text-fill-color: transparent;
}

```


####### content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-a/static/stylesheets/margaritaville.css #######

```

@font-face {
	font-family: 'Casablanca Antique';
	src: url('./fonts/casablanca-antique.woff2') format('woff2');
}

body {
	display: flex; 
	flex-direction: column;
	align-items: center;
	justify-content: center;
	background: url(./margaritaville.webp) no-repeat 50% 50% fixed;
	background-size: cover;
}

h1 {
	font-size: min(8vw, 4rem);
	filter: drop-shadow(1px 1px 4px black) drop-shadow(1px 1px 20px black);
	font-family: 'Casablanca Antique';
	font-variant: small-caps;
	color: rgb(255, 226, 131);
}

```


####### content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-a/static/stylesheets/retrowave.css #######

```

@font-face {
	font-family: 'Road Rage';
	src: url('./fonts/road-rage.woff2') format('woff2');
}

body {
	display: flex; 
	flex-direction: column;
	align-items: center;
	justify-content: center;
	/* https://www.wallpaperflare.com/music-stars-background-80s-neon-80-s-synth-retrowave-wallpaper-bdlfo */
	background: url(./retrowave.webp) no-repeat 50% 50% fixed;
	background-size: cover;
}

h1 {
	font-size: min(8vw, 4rem);
	filter: drop-shadow(2px 2px 10px black);
	font-family: 'Road Rage';
	background: linear-gradient(
		to top,
		hsl(307, 74%, 63%) 1%, 0%,
		#0000 8%, 0%,
		hsl(317, 76%, 63%) 10%, 0%,
		#0000 16%, 0%,
		hsl(327, 78%, 63%) 19%, 0%,
		#0000 24%, 0%,
		hsl(337, 80%, 63%) 28%, 0%,
		#0000 32%, 0%,
		hsl(347, 82%, 63%) 37%, 0%,
		#0000 40%, 0%,
		hsl(357, 84%, 65%) 46%, 0%,
		#0000 48%, 0%,
		hsl(7, 86%, 65%) 55%, 0%,
		#0000 56%, 0%,
		hsl(17, 88%, 65%) 57%,
		hsl(40, 90%, 65%) 100%);
	-webkit-background-clip: text;
	-webkit-text-fill-color: transparent;
}

```


####### content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-a/static/stylesheets/spaaaaace.css #######

```

@font-face {
	font-family: 'Edge of the Galaxy';
	src: url('./fonts/edge-of-the-galaxy.woff2') format('woff2');
}

body {
	display: flex; 
	flex-direction: column;
	align-items: center;
	justify-content: center;
	/* https://www.wallpaperflare.com/outer-space-illustration-nebula-stars-green-galaxy-tylercreatesworlds-wallpaper-qws */
	background: url(./spaaaaace.webp) no-repeat 50% 50% fixed;
	background-size: cover;
}

h1 {
	font-size: min(8vw, 4rem);
	filter: drop-shadow(0px 0px 4px rgba(0, 0, 0, 0.5)) drop-shadow(2px 2px 10px rgb(100, 170, 150)) drop-shadow(2px 2px 30px white);
	font-family: 'Edge of the Galaxy';
	color: hsl(165, 100%, 95%);
}

```


####### content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/app-b/src/lib/App.svelte #######

```

<script>
	const themes = ['margaritaville', 'retrowave', 'spaaaaace', 'halloween'];
	let selected = themes[0];
</script>

<svelte:head>
	<link rel="stylesheet" href="/stylesheets/{selected}.css" />
</svelte:head>

<h1>Welcome to my site!</h1>

<select bind:value={selected}>
	<option disabled>choose a theme</option>

	{#each themes as theme}
		<option>{theme}</option>
	{/each}
</select>
```


####### content/tutorial/02-advanced-svelte/09-special-elements/08-svelte-head/README.md #######

---
title: <svelte:head>
---

The `<svelte:head>` element allows you to insert elements inside the `<head>` of your document. This is useful for things like `<title>` and `<meta>` tags, which are critical for good SEO.

Since those are quite hard to show in the context of this tutorial, we'll use it for a different purpose — loading stylesheets.

```svelte
/// file: App.svelte
<script>
	const themes = ['margaritaville', 'retrowave', 'spaaaaace', 'halloween'];
	let selected = themes[0];
</script>

+++<svelte:head>
	<link rel="stylesheet" href="/stylesheets/{selected}.css" />
</svelte:head>+++

<h1>Welcome to my site!</h1>
```

> In server-side rendering (SSR) mode, contents of `<svelte:head>` are returned separately from the rest of your HTML.

####### content/tutorial/02-advanced-svelte/09-special-elements/09-svelte-options/app-a/src/lib/App.svelte #######

```

<script>
	import Todo from './Todo.svelte';

	let todos = [
		{ id: 1, done: true, text: 'wash the car' },
		{ id: 2, done: false, text: 'take the dog for a walk' },
		{ id: 3, done: false, text: 'mow the lawn' }
	];

	function toggle(toggled) {
		todos = todos.map((todo) => {
			if (todo === toggled) {
				// return a new object
				return {
					id: todo.id,
					text: todo.text,
					done: !todo.done
				};
			}

			// return the same object
			return todo;
		});
	}
</script>

<div class="centered">
	<h1>todos</h1>

	<ul class="todos">
		{#each todos as todo (todo.id)}
			<Todo {todo} on:change={() => toggle(todo)} />
		{/each}
	</ul>
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/09-special-elements/09-svelte-options/app-a/src/lib/flash.js #######

```

export default function flash(element) {
	requestAnimationFrame(() => {
		element.style.transition = 'none';
		element.style.color = 'rgba(255,62,0,1)';
		element.style.backgroundColor = 'rgba(255,62,0,0.2)';

		setTimeout(() => {
			element.style.transition = 'color 1s, background 1s';
			element.style.color = '';
			element.style.backgroundColor = '';
		});
	});
}

```


####### content/tutorial/02-advanced-svelte/09-special-elements/09-svelte-options/app-a/src/lib/Todo.svelte #######

```

<script>
	import { afterUpdate } from 'svelte';
	import flash from './flash.js';

	export let todo;

	let element;

	afterUpdate(() => {
		flash(element);
	});
</script>

<!-- the text will flash red whenever
     the `todo` object changes -->
<li bind:this={element}>
	<label>
		<input type="checkbox" checked={todo.done} on:change />
		{todo.text}
	</label>
</li>
```


####### content/tutorial/02-advanced-svelte/09-special-elements/09-svelte-options/app-b/src/lib/Todo.svelte #######

```

<svelte:options immutable />

<script>
	import { afterUpdate } from 'svelte';
	import flash from './flash.js';

	export let todo;

	let element;

	afterUpdate(() => {
		flash(element);
	});
</script>

<!-- the text will flash red whenever
     the `todo` object changes -->
<li bind:this={element}>
	<label>
		<input type="checkbox" checked={todo.done} on:change />
		{todo.text}
	</label>
</li>
```


####### content/tutorial/02-advanced-svelte/09-special-elements/09-svelte-options/README.md #######

---
title: <svelte:options>
---

The `<svelte:options>` element allows you to specify compiler options.

We'll use the `immutable` option as an example. In this app, the `<Todo>` component flashes whenever it receives new data. Clicking on one of the items toggles its `done` state by creating an updated `todos` array. This causes the _other_ `<Todo>` items to flash, even though they don't end up making any changes to the DOM.

We can optimise this by telling the `<Todo>` component to expect _immutable_ data. This means that we're promising never to _mutate_ the `todo` prop, but will instead create new todo objects whenever things change.

Add this to the top of `Todo.svelte`:

```svelte
/// file: Todo.svelte
<svelte:options immutable={true} />
```

> You can shorten this to `<svelte:options immutable/>` if you prefer.

Now, when you toggle todos by clicking on them, only the updated component flashes.

The options that can be set here are:

- `immutable={true}` — you never use mutable data, so the compiler can do simple referential equality checks to determine if values have changed
- `immutable={false}` — the default. Svelte will be more conservative about whether or not mutable objects have changed
- `accessors={true}` — adds getters and setters for the component's props
- `accessors={false}` — the default
- `namespace="..."` — the namespace where this component will be used, most commonly `"svg"`
- `customElement="..."` — the name to use when compiling this component as a custom element

Consult the [API reference](https://svelte.dev/docs) for more information on these options.

####### content/tutorial/02-advanced-svelte/09-special-elements/10-svelte-fragment/app-a/src/lib/App.svelte #######

```

<script>
	import Board from './Board.svelte';
	import { getWinningLine } from './utils.js';

	let squares = Array(9).fill('');
	let next = 'x';

	$: winningLine = getWinningLine(squares);
</script>

<div class="container">
	<Board size={3}>
		<div slot="game">
			{#each squares as square, i}
				<button
					class="square"
					class:winning={winningLine?.includes(i)}
					disabled={square}
					on:click={() => {
						squares[i] = next;
						next = next === 'x' ? 'o' : 'x';
					}}
				>
					{square}
				</button>
			{/each}
		</div>

		<div slot="controls">
			<button on:click={() => {
				squares = Array(9).fill('');
				next = 'x';
			}}>
				Reset
			</button>
		</div>
	</Board>
</div>

<style>
	.container {
		display: flex;
		flex-direction: column;
		gap: 1em;
		align-items: center;
		justify-content: center;
		height: 100%;
		margin: 0 auto;
	}

	.square, .square:disabled {
		background: white;
		border-radius: 0;
		color: #222;
		opacity: 1;
		font-size: 2em;
		padding: 0;
	}

	.winning {
		font-weight: bold;
	}

	.container:has(.winning) .square:not(.winning) {
		color: #ccc;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/09-special-elements/10-svelte-fragment/app-a/src/lib/Board.svelte #######

```

<script>
	export let size;
</script>

<div class="board" style="--size: {size}">
	<slot name="game" />
</div>

<slot name="controls" />

<style>
	.board {
		display: grid;
		grid-template-columns: repeat(var(--size), 1fr);
		grid-template-rows: repeat(var(--size), 1fr);
		height: 100%;
		max-height: 20em;
		aspect-ratio: 1;
		background: black;
		gap: 1px;
		padding: 0.5em;
		border-radius: 0.2em;
		filter: drop-shadow(0.2em 0.2em 1em rgba(0,0,0,0.3));
	}
</style>
```


####### content/tutorial/02-advanced-svelte/09-special-elements/10-svelte-fragment/app-a/src/lib/utils.js #######

```

const lines = [
	[0, 1, 2],
	[3, 4, 5],
	[6, 7, 8],
	[0, 3, 6],
	[1, 4, 7],
	[2, 5, 8],
	[0, 4, 8],
	[2, 4, 6]
];

export function getWinningLine(squares) {
	for (const line of lines) {
		const [a, b, c] = line;
		if (squares[a] && squares[a] === squares[b] && squares[a] === squares[c]) {
			return line;
		}
	}
}
```


####### content/tutorial/02-advanced-svelte/09-special-elements/10-svelte-fragment/app-b/src/lib/App.svelte #######

```

<script>
	import Board from './Board.svelte';
	import { getWinningLine } from './utils.js';

	let squares = Array(9).fill('');
	let next = 'x';

	$: winningLine = getWinningLine(squares);
</script>

<div class="container">
	<Board size={3}>
		<svelte:fragment slot="game">
			{#each squares as square, i}
				<button
					class="square"
					class:winning={winningLine?.includes(i)}
					disabled={square}
					on:click={() => {
						squares[i] = next;
						next = next === 'x' ? 'o' : 'x';
					}}
				>
					{square}
				</button>
			{/each}
		</svelte:fragment>

		<div slot="controls">
			<button on:click={() => {
				squares = Array(9).fill('');
				next = 'x';
			}}>
				Reset
			</button>
		</div>
	</Board>
</div>

<style>
	.container {
		display: flex;
		flex-direction: column;
		gap: 1em;
		align-items: center;
		justify-content: center;
		height: 100%;
		margin: 0 auto;
	}

	.square, .square:disabled {
		background: white;
		border-radius: 0;
		color: #222;
		opacity: 1;
		font-size: 2em;
		padding: 0;
	}

	.winning {
		font-weight: bold;
	}

	.container:has(.winning) .square:not(.winning) {
		color: #ccc;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/09-special-elements/10-svelte-fragment/README.md #######

---
title: <svelte:fragment>
---

The `<svelte:fragment>` element allows you to place content in a named slot without wrapping it in a container DOM element.

In this exercise, we're making a Tic-Tac-Toe game. To form a grid, the `<button>` elements in `App.svelte` should be direct descendants of the `<div class="board">` element in `Board.svelte`.

At the moment, it's horribly broken, because they're children of `<div slot="game">` instead. Let's fix it:

```svelte
/// file: App.svelte
<+++svelte:fragment+++ slot="game">
	{#each squares as square, i}
		<button
			class="square"
			class:winning={winningLine?.includes(i)}
			disabled={square}
			on:click={() => {
				squares[i] = next;
				next = next === 'x' ? 'o' : 'x';
			}}
		>
			{square}
		</button>
	{/each}
</+++svelte:fragment+++>
```
####### content/tutorial/02-advanced-svelte/09-special-elements/meta.json #######

```

{
	"title": "Special elements",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/10-module-context/01-sharing-code/app-a/src/lib/App.svelte #######

```

<script>
	import AudioPlayer from './AudioPlayer.svelte';
	import { tracks } from './tracks.js';
</script>

<div class="centered">
	{#each tracks as track}
		<AudioPlayer {...track} />
	{/each}
</div>

<style>
	.centered {
		display: flex;
		flex-direction: column;
		height: 100%;
		justify-content: center;
		gap: 0.5em;
		max-width: 40em;
		margin: 0 auto;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/10-module-context/01-sharing-code/app-a/src/lib/AudioPlayer.svelte #######

```

<script>
	export let src;
	export let title;
	export let artist;

	let time = 0;
	let duration = 0;
	let paused = true;

	function format(time) {
		if (isNaN(time)) return '...';

		const minutes = Math.floor(time / 60);
		const seconds = Math.floor(time % 60);

		return `${minutes}:${seconds < 10 ? `0${seconds}` : seconds}`;
	}
</script>

<div class="player" class:paused>
	<audio
		src={src}
		bind:currentTime={time}
		bind:duration
		bind:paused
		on:ended={() => {
			time = 0;
		}}
	/>

	<button
		class="play"
		aria-label={paused ? 'play' : 'pause'}
		on:click={() => paused = !paused}
	/>

	<div class="info">
		<div class="description">
			<strong>{title}</strong> /
			<span>{artist}</span>
		</div>

		<div class="time">
			<span>{format(time)}</span>
			<div
				class="slider"
				on:pointerdown={e => {
					const div = e.currentTarget;

					function seek(e) {
						const { left, width } = div.getBoundingClientRect();

						let p = (e.clientX - left) / width;
						if (p < 0) p = 0;
						if (p > 1) p = 1;

						time = p * duration;
					}

					seek(e);

					window.addEventListener('pointermove', seek);

					window.addEventListener('pointerup', () => {
						window.removeEventListener('pointermove', seek);
					}, {
						once: true
					});
				}}
			>
				<div class="progress" style="--progress: {time / duration}%" />
			</div>
			<span>{duration ? format(duration) : '--:--'}</span>
		</div>
	</div>
</div>

<style>
	.player {
		display: grid;
		grid-template-columns: 2.5em 1fr;
		align-items: center;
		gap: 1em;
		padding: 0.5em 1em 0.5em 0.5em;
		border-radius: 2em;
		background: var(--bg-1);
		transition: filter 0.2s;
		color: var(--fg-3);
		user-select: none;
	}

	.player:not(.paused) {
		color: var(--fg-1);
		filter: drop-shadow(0.5em 0.5em 1em rgba(0,0,0,0.1));
	}

	button {
		width: 100%;
		aspect-ratio: 1;
		background-repeat: no-repeat;
		background-position: 50% 50%;
		border-radius: 50%;
	}

	[aria-label="pause"] {
		background-image: url(./pause.svg);
	}

	[aria-label="play"] {
		background-image: url(./play.svg);
	}

	.info {
		overflow: hidden;
	}

	.description {
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
		line-height: 1.2;
	}

	.time {
		display: flex;
		align-items: center;
		gap: 0.5em;
	}

	.time span {
		font-size: 0.7em;
	}

	.slider {
		flex: 1;
		height: 0.5em;
		background: var(--bg-2);
		border-radius: 0.5em;
		overflow: hidden;
	}

	.progress {
		width: calc(100 * var(--progress));
		height: 100%;
		background: var(--bg-3);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/10-module-context/01-sharing-code/app-a/src/lib/tracks.js #######

```

export const tracks = [
	{
		// https://musopen.org/music/9862-the-blue-danube-op-314/
		src: 'https://learn.svelte.dev/assets/media/music/strauss.mp3',
		title: 'The Blue Danube Waltz',
		artist: 'Johann Strauss'
	},

	{
		// https://musopen.org/music/43775-the-planets-op-32/
		src: 'https://learn.svelte.dev/assets/media/music/holst.mp3',
		title: 'Mars, the Bringer of War',
		artist: 'Gustav Holst'
	},

	{
		// https://musopen.org/music/8010-3-gymnopedies/
		src: 'https://learn.svelte.dev/assets/media/music/satie.mp3',
		title: 'Gymnopédie no. 1',
		artist: 'Erik Satie'
	},

	{
		// https://musopen.org/music/43683-requiem-in-d-minor-k-626/
		src: 'https://learn.svelte.dev/assets/media/music/mozart.mp3',
		title: 'Requiem in D minor, K. 626 - III. Sequence - Lacrymosa',
		artist: 'Wolfgang Amadeus Mozart'
	}
];

```


####### content/tutorial/02-advanced-svelte/10-module-context/01-sharing-code/app-b/src/lib/AudioPlayer.svelte #######

```

<script context="module">
	let current;
</script>

<script>
	export let src;
	export let title;
	export let artist;

	let time = 0;
	let duration = 0;
	let paused = true;

	function format(time) {
		if (isNaN(time)) return '...';

		const minutes = Math.floor(time / 60);
		const seconds = Math.floor(time % 60);

		return `${minutes}:${seconds < 10 ? `0${seconds}` : seconds}`;
	}
</script>

<div class="player" class:paused>
	<audio
		src={src}
		bind:currentTime={time}
		bind:duration
		bind:paused
		on:play={(e) => {
			const audio = e.currentTarget;

			if (audio !== current) {
				current?.pause();
				current = audio;
			}
		}}
		on:ended={() => {
			time = 0;
		}}
	/>

	<button
		class="play"
		aria-label={paused ? 'play' : 'pause'}
		on:click={() => paused = !paused}
	/>

	<div class="info">
		<div class="description">
			<strong>{title}</strong> /
			<span>{artist}</span>
		</div>

		<div class="time">
			<span>{format(time)}</span>
			<div
				class="slider"
				on:pointerdown={e => {
					const div = e.currentTarget;

					function seek(e) {
						const { left, width } = div.getBoundingClientRect();

						let p = (e.clientX - left) / width;
						if (p < 0) p = 0;
						if (p > 1) p = 1;

						time = p * duration;
					}

					seek(e);

					window.addEventListener('pointermove', seek);

					window.addEventListener('pointerup', () => {
						window.removeEventListener('pointermove', seek);
					}, {
						once: true
					});
				}}
			>
				<div class="progress" style="--progress: {time / duration}%" />
			</div>
			<span>{duration ? format(duration) : '--:--'}</span>
		</div>
	</div>
</div>

<style>
	.player {
		display: grid;
		grid-template-columns: 2.5em 1fr;
		align-items: center;
		gap: 1em;
		padding: 0.5em 1em 0.5em 0.5em;
		border-radius: 2em;
		background: var(--bg-1);
		transition: filter 0.2s;
		color: var(--fg-3);
		user-select: none;
	}

	.player:not(.paused) {
		color: var(--fg-1);
		filter: drop-shadow(0.5em 0.5em 1em rgba(0,0,0,0.1));
	}

	button {
		width: 100%;
		aspect-ratio: 1;
		background-repeat: no-repeat;
		background-position: 50% 50%;
		border-radius: 50%;
	}

	[aria-label="pause"] {
		background-image: url(./pause.svg);
	}

	[aria-label="play"] {
		background-image: url(./play.svg);
	}

	.info {
		overflow: hidden;
	}

	.description {
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
		line-height: 1.2;
	}

	.time {
		display: flex;
		align-items: center;
		gap: 0.5em;
	}

	.time span {
		font-size: 0.7em;
	}

	.slider {
		flex: 1;
		height: 0.5em;
		background: var(--bg-2);
		border-radius: 0.5em;
		overflow: hidden;
	}

	.progress {
		width: calc(100 * var(--progress));
		height: 100%;
		background: var(--bg-3);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/10-module-context/01-sharing-code/README.md #######

---
title: Sharing code
---

In all the examples we've seen so far, the `<script>` block contains code that runs when each component instance is initialised. For the vast majority of components, that's all you'll ever need.

Very occasionally, you'll need to run some code outside of an individual component instance. For example: returning to our custom audio player from a [previous exercise](media-elements), you can play all four tracks simultaneously. It would be better if playing one stopped all the others.

We can do that by declaring a `<script context="module">` block. Code contained inside it will run once, when the module first evaluates, rather than when a component is instantiated. Place this at the top of `AudioPlayer.svelte` (note that this is a _separate_ script tag):

```svelte
/// file: AudioPlayer.svelte
+++<script context="module">
	let current;
</script>+++
```

It's now possible for the components to 'talk' to each other without any state management:

```svelte
/// file: AudioPlayer.svelte
<audio
	src={src}
	bind:currentTime={time}
	bind:duration
	bind:paused
+++	on:play={(e) => {
		const audio = e.currentTarget;

		if (audio !== current) {
			current?.pause();
			current = audio;
		}
	}}+++
	on:ended={() => {
		time = 0;
	}}
/>
```

####### content/tutorial/02-advanced-svelte/10-module-context/02-module-exports/app-b/src/lib/App.svelte #######

```

<script>
	import AudioPlayer, { stopAll } from './AudioPlayer.svelte';
	import { tracks } from './tracks.js';
</script>

<div class="centered">
	{#each tracks as track}
		<AudioPlayer {...track} />
	{/each}

	<button on:click={stopAll}>
		stop all
	</button>
</div>

<style>
	.centered {
		display: flex;
		flex-direction: column;
		height: 100%;
		justify-content: center;
		gap: 0.5em;
		max-width: 40em;
		margin: 0 auto;
	}
</style>
```


####### content/tutorial/02-advanced-svelte/10-module-context/02-module-exports/app-b/src/lib/AudioPlayer.svelte #######

```

<script context="module">
	let current;

	export function stopAll() {
		current?.pause();
	}
</script>

<script>
	export let src;
	export let title;
	export let artist;

	let time = 0;
	let duration = 0;
	let paused = true;

	function format(time) {
		if (isNaN(time)) return '...';

		const minutes = Math.floor(time / 60);
		const seconds = Math.floor(time % 60);

		return `${minutes}:${seconds < 10 ? `0${seconds}` : seconds}`;
	}
</script>

<div class="player" class:paused>
	<audio
		src={src}
		bind:currentTime={time}
		bind:duration
		bind:paused
		on:play={(e) => {
			const audio = e.currentTarget;

			if (audio !== current) {
				current?.pause();
				current = audio;
			}
		}}
		on:ended={() => {
			time = 0;
		}}
	/>

	<button
		class="play"
		aria-label={paused ? 'play' : 'pause'}
		on:click={() => paused = !paused}
	/>

	<div class="info">
		<div class="description">
			<strong>{title}</strong> /
			<span>{artist}</span>
		</div>

		<div class="time">
			<span>{format(time)}</span>
			<div
				class="slider"
				on:pointerdown={e => {
					const div = e.currentTarget;

					function seek(e) {
						const { left, width } = div.getBoundingClientRect();

						let p = (e.clientX - left) / width;
						if (p < 0) p = 0;
						if (p > 1) p = 1;

						time = p * duration;
					}

					seek(e);

					window.addEventListener('pointermove', seek);

					window.addEventListener('pointerup', () => {
						window.removeEventListener('pointermove', seek);
					}, {
						once: true
					});
				}}
			>
				<div class="progress" style="--progress: {time / duration}%" />
			</div>
			<span>{duration ? format(duration) : '--:--'}</span>
		</div>
	</div>
</div>

<style>
	.player {
		display: grid;
		grid-template-columns: 2.5em 1fr;
		align-items: center;
		gap: 1em;
		padding: 0.5em 1em 0.5em 0.5em;
		border-radius: 2em;
		background: var(--bg-1);
		transition: filter 0.2s;
		color: var(--fg-3);
		user-select: none;
	}

	.player:not(.paused) {
		color: var(--fg-1);
		filter: drop-shadow(0.5em 0.5em 1em rgba(0,0,0,0.1));
	}

	button {
		width: 100%;
		aspect-ratio: 1;
		background-repeat: no-repeat;
		background-position: 50% 50%;
		border-radius: 50%;
	}

	[aria-label="pause"] {
		background-image: url(./pause.svg);
	}

	[aria-label="play"] {
		background-image: url(./play.svg);
	}

	.info {
		overflow: hidden;
	}

	.description {
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
		line-height: 1.2;
	}

	.time {
		display: flex;
		align-items: center;
		gap: 0.5em;
	}

	.time span {
		font-size: 0.7em;
	}

	.slider {
		flex: 1;
		height: 0.5em;
		background: var(--bg-2);
		border-radius: 0.5em;
		overflow: hidden;
	}

	.progress {
		width: calc(100 * var(--progress));
		height: 100%;
		background: var(--bg-3);
	}
</style>
```


####### content/tutorial/02-advanced-svelte/10-module-context/02-module-exports/README.md #######

---
title: Exports
---

Anything exported from a `context="module"` script block becomes an export from the module itself. Let's export a `stopAll` function:

```svelte
/// file: AudioPlayer.svelte
<script context="module">
	let current;

+++	export function stopAll() {
		current?.pause();
	}+++
</script>
```

We can now import `stopAll` in `App.svelte`...

```svelte
/// file: App.svelte
<script>
	import AudioPlayer, +++{ stopAll }+++ from './AudioPlayer.svelte';
	import { tracks } from './tracks.js';
</script>
```

...and use it in an event handler:

```svelte
/// file: App.svelte
<div class="centered">
	{#each tracks as track}
		<AudioPlayer {...track} />
	{/each}

+++	<button on:click={stopAll}>
		stop all
	</button>+++
</div>
```

> You can't have a default export, because the component _is_ the default export.

####### content/tutorial/02-advanced-svelte/10-module-context/meta.json #######

```

{
	"title": "Module context",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/11-misc/01-debug/app-a/src/lib/App.svelte #######

```

<script>
	let user = {
		firstname: 'Ada',
		lastname: 'Lovelace'
	};
</script>

<label>
	<input bind:value={user.firstname} />
	first name
</label>

<label>
	<input bind:value={user.lastname} />
	last name
</label>

{(console.log(user), '')}

<h1>Hello {user.firstname}!</h1>

```


####### content/tutorial/02-advanced-svelte/11-misc/01-debug/app-b/src/lib/App.svelte #######

```

<script>
	let user = {
		firstname: 'Ada',
		lastname: 'Lovelace'
	};
</script>

<label>
	<input bind:value={user.firstname} />
	first name
</label>

<label>
	<input bind:value={user.lastname} />
	last name
</label>

{@debug user}

<h1>Hello {user.firstname}!</h1>

```


####### content/tutorial/02-advanced-svelte/11-misc/01-debug/README.md #######

---
title: The @debug tag
---

Occasionally, it's useful to inspect a piece of data as it flows through your app.

One approach is to use `console.log(...)` inside your markup. If you want to pause execution, though, you can use the `{@debug ...}` tag with a comma-separated list of values you want to inspect:

```svelte
/// file: App.svelte
{@debug user}

<h1>Hello {user.firstname}!</h1>
```

If you now open your devtools and start interacting with the `<input>` elements, you'll trigger the debugger as the value of `user` changes. (Note that the call stack and local variables will be hidden in this tutorial, because of iframe security restrictions.)

####### content/tutorial/02-advanced-svelte/11-misc/meta.json #######

```

{
	"title": "Miscellaneous",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/12-next-steps/01-congratulations/app-a/src/lib/App.svelte #######

```

<script>
	import { onMount } from 'svelte';

	let characters = ['🥳', '🎉', '✨'];

	let confetti = new Array(100)
		.fill()
		.map((_, i) => {
			return {
				character:
					characters[i % characters.length],
				x: Math.random() * 100,
				y: -20 - Math.random() * 100,
				r: 0.1 + Math.random() * 1
			};
		})
		.sort((a, b) => a.r - b.r);

	onMount(() => {
		let frame;

		function loop() {
			frame = requestAnimationFrame(loop);

			confetti = confetti.map((emoji) => {
				emoji.y += 0.3 * emoji.r;
				if (emoji.y > 120) emoji.y = -20;
				return emoji;
			});
		}

		loop();

		return () => cancelAnimationFrame(frame);
	});
</script>

{#each confetti as c}
	<span
		style="left: {c.x}%; top: {c.y}%; transform: scale({c.r})"
		>{c.character}</span
	>
{/each}

<style>
	:global(body) {
		overflow: hidden;
	}

	span {
		position: absolute;
		font-size: 5vw;
		user-select: none;
	}
</style>

```


####### content/tutorial/02-advanced-svelte/12-next-steps/01-congratulations/README.md #######

---
title: Congratulations!
---

You've now finished the Svelte tutorial and are ready to start building.

The next two parts of the tutorial will focus on SvelteKit, a full-fledged framework for creating apps of all shapes and sizes. 

If you're suffering from information overload and aren't ready to go through the SvelteKit tutorial yet, don't worry! You can use your existing Svelte knowledge without learning all of SvelteKit. Just run this in your terminal and follow the prompts...

```bash
/// no-file
npm create svelte@latest
```

...and start editing `src/routes/+page.svelte`. When you're ready, click the link below to continue your journey.

####### content/tutorial/02-advanced-svelte/12-next-steps/meta.json #######

```

{
	"title": "Next steps",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/02-advanced-svelte/common/src/routes/+error.svelte #######

```

<script>
	import { page } from '$app/stores';
</script>

{#if $page.status === 404}
	<h1>Not found</h1>
	<p><a href="/">Go to /</a></p>
{:else}
	<p>
		Server-side rendering failed with HTTP status
		code
		<a
			target="_blank"
			href="https://http.dog/{$page.status}"
			>{$page.status}</a
		>
	</p>

	<pre>{$page.error?.stack || ''}</pre>
{/if}

<style>
	h1 {
		font-weight: 200;
		font-size: 2rem;
		margin: 0 0 0.5em 0;
	}

	pre {
		font-family: Menlo, Monaco, monospace;
		font-size: 13px;
		background: hsl(0, 100%, 95%);
		padding: 1rem;
		overflow-x: auto;
		border-radius: 5px;
		color: hsl(0, 100%, 30%);
	}
</style>

```


####### content/tutorial/02-advanced-svelte/common/src/routes/+layout.js #######

```

export const ssr = false;

```


####### content/tutorial/02-advanced-svelte/common/src/routes/+page.svelte #######

```

<script>
	import App from '$lib/App.svelte';
</script>

<App />

```


####### content/tutorial/02-advanced-svelte/meta.json #######

```

{
	"title": "Advanced Svelte",
	"scope": {
		"prefix": "/src/lib/",
		"name": "src"
	},
	"focus": "/src/lib/App.svelte"
}

```


####### content/tutorial/03-sveltekit/01-concepts/01-introducing-sveltekit/app-a/src/routes/+page.svelte #######

```

<h1>Welcome to SvelteKit</h1>

```


####### content/tutorial/03-sveltekit/01-concepts/01-introducing-sveltekit/README.md #######

---
title: What is SvelteKit?
---

Whereas Svelte is a _component framework_, SvelteKit is an _app framework_ (or 'metaframework', depending on who you ask) that solves the tricky problems of building something production-ready:

- Routing
- Server-side rendering
- Data fetching
- Service workers
- TypeScript integration
- Prerendering
- Single-page apps
- Library packaging
- Optimised production builds
- Deploying to different hosting providers
- ...and so on

SvelteKit apps are server-rendered by default (like traditional 'multi-page apps' or MPAs) for excellent first load performance and SEO characteristics, but can then transition to client-side navigation (like modern 'single-page apps' or SPAs) to avoid jankily reloading everything (including things like third-party analytics code) when the user navigates. They can run anywhere JavaScript runs, though — as we'll see — your users may not need to run any JavaScript at all.

If that sounds complicated, worry not: SvelteKit is the framework that grows with you! Start simple and add new features as you need them.

## Project structure

On the right, in the file tree viewer, you'll see a handful of files that SvelteKit expects to find in a project.

`package.json` will be familiar if you've worked with Node.js before. It lists the project's dependencies — including `svelte` and `@sveltejs/kit` — and a variety of `scripts` for interacting with the SvelteKit CLI. (We're currently running `npm run dev` in the bottom window.)

> Note that it also specifies `"type": "module"`, which means that `.js` files are treated as native JavaScript modules by default, rather than the legacy CommonJS format.

`svelte.config.js` contains your project configuration. We don't need to worry about this file for now, but if you're curious, [visit the documentation](https://kit.svelte.dev/docs/configuration).

`vite.config.js` contains the [Vite](https://vitejs.dev/) configuration. Because SvelteKit uses Vite, you can use [Vite features](https://vitejs.dev/guide/features.html) like hot module replacement, TypeScript support, static asset handling and so on.

`src` is where your app's source code goes. `src/app.html` is your page template (SvelteKit replaces the `%sveltekit.head%` and `%sveltekit.body%` as appropriate), and `src/routes` defines the [routes](/tutorial/pages) of your app.

Finally, `static` contains any assets (like a `favicon.png` or a `robots.txt`) that should be included when your app is deployed.
####### content/tutorial/03-sveltekit/01-concepts/meta.json #######

```

{
	"title": "Introduction"
}

```


####### content/tutorial/03-sveltekit/02-routing/01-pages/app-a/src/routes/+page.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/about">about</a>
</nav>

<h1>home</h1>
<p>this is the home page.</p>

```


####### content/tutorial/03-sveltekit/02-routing/01-pages/app-b/src/routes/about/+page.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/about">about</a>
</nav>

<h1>about</h1>
<p>this is the about page.</p>

```


####### content/tutorial/03-sveltekit/02-routing/01-pages/README.md #######

---
title: Pages
---

SvelteKit uses filesystem-based routing, which means that the _routes_ of your app — in other words, what the app should do when a user navigates to a particular URL — are defined by the directories in your codebase.

Every `+page.svelte` file inside `src/routes` creates a page in your app. In this app we currently have one page — `src/routes/+page.svelte`, which maps to `/`. If we navigate to `/about`, we'll see a 404 Not Found error.

Let's fix that. Add a second page, `src/routes/about/+page.svelte`, copy the contents of `src/routes/+page.svelte`, and update it:

```svelte
/// file: src/routes/about/+page.svelte
<nav>
	<a href="/">home</a>
	<a href="/about">about</a>
</nav>

<h1>+++about+++</h1>
<p>this is the +++about+++ page.</p>
```

We can now navigate between `/` and `/about`.

> Unlike traditional multi-page apps, navigating to `/about` and back updates the contents of the current page, like a single-page app. This gives us the best of both worlds — fast server-rendered startup, then instant navigation. (This behaviour can be [configured](https://kit.svelte.dev/docs/page-options).)

####### content/tutorial/03-sveltekit/02-routing/02-layouts/app-b/src/routes/about/+page.svelte #######

```

<h1>about</h1>
<p>this is the about page.</p>

```


####### content/tutorial/03-sveltekit/02-routing/02-layouts/app-b/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/about">about</a>
</nav>

<slot />

```


####### content/tutorial/03-sveltekit/02-routing/02-layouts/app-b/src/routes/+page.svelte #######

```

<h1>home</h1>
<p>this is the home page.</p>

```


####### content/tutorial/03-sveltekit/02-routing/02-layouts/README.md #######

---
title: Layouts
---

Different routes of your app will often share common UI. Instead of repeating it in each `+page.svelte` component, we can use a `+layout.svelte` component that applies to all routes in the same directory.

In this app we have two routes, `src/routes/+page.svelte` and `src/routes/about/+page.svelte`, that contain the same navigation UI. Let's create a new file, `src/routes/+layout.svelte`...

```
src/routes/
├ about/
│ └ +page.svelte
+++├ +layout.svelte+++
└ +page.svelte
```

...and move the duplicated content from the `+page.svelte` files into the new `+layout.svelte` file. The `<slot />` element is where the page content will be rendered:

```svelte
/// file: src/routes/+layout.svelte
<nav>
	<a href="/">home</a>
	<a href="/about">about</a>
</nav>

<slot />
```

A `+layout.svelte` file applies to every child route, including the sibling `+page.svelte` (if it exists). You can nest layouts to arbitrary depth.

####### content/tutorial/03-sveltekit/02-routing/03-params/app-a/src/routes/blog/+page.svelte #######

```

<h1>blog</h1>

<ul>
	<li><a href="/blog/one">one</a></li>
	<li><a href="/blog/two">two</a></li>
	<li><a href="/blog/three">three</a></li>
</ul>

```


####### content/tutorial/03-sveltekit/02-routing/03-params/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/blog">blog</a>
</nav>

<slot />

```


####### content/tutorial/03-sveltekit/02-routing/03-params/app-a/src/routes/+page.svelte #######

```

<p>home</p>

```


####### content/tutorial/03-sveltekit/02-routing/03-params/app-b/src/routes/blog/[slug]/+page.svelte #######

```

<h1>blog post</h1>

```


####### content/tutorial/03-sveltekit/02-routing/03-params/README.md #######

---
title: Route parameters
path: /blog
---

To create routes with dynamic parameters, use square brackets around a valid variable name. For example, a file like `src/routes/blog/[slug]/+page.svelte` will create a route that matches `/blog/one`, `/blog/two`, `/blog/three` and so on.

Let's create that file:

```svelte
/// file: src/routes/blog/[slug]/+page.svelte
<h1>blog post</h1>
```

We can now navigate from the `/blog` page to individual blog posts. In the next chapter, we'll see how to load their content.

> Multiple route parameters can appear _within_ one URL segment, as long as they are separated by at least one static character: `foo/[bar]x[baz]` is a valid route where `[bar]` and `[baz]` are dynamic parameters.

####### content/tutorial/03-sveltekit/02-routing/meta.json #######

```

{
	"title": "Routing"
}

```


####### content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/blog/data.js #######

```

export const posts = [
	{
		slug: 'welcome',
		title: 'Welcome to the Aperture Science computer-aided enrichment center',
		content:
			'<p>We hope your brief detention in the relaxation vault has been a pleasant one.</p><p>Your specimen has been processed and we are now ready to begin the test proper.</p>'
	},

	{
		slug: 'safety',
		title: 'Safety notice',
		content:
			'<p>While safety is one of many Enrichment Center Goals, the Aperture Science High Energy Pellet, seen to the left of the chamber, can and has caused permanent disabilities, such as vaporization. Please be careful.</p>'
	},

	{
		slug: 'cake',
		title: 'This was a triumph',
		content: "<p>I'm making a note here: HUGE SUCCESS.</p>"
	}
];

```


####### content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/blog/+page.svelte #######

```

<h1>blog</h1>

<ul>
	<li><a href="/blog/one">one</a></li>
	<li><a href="/blog/two">two</a></li>
	<li><a href="/blog/three">three</a></li>
</ul>

```


####### content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/blog/[slug]/+layout.svelte #######

```

<script>
	export let data;
</script>

<div class="layout">
	<main>
		<slot />
	</main>
</div>

<style>
	@media (min-width: 640px) {
		.layout {
			display: grid;
			gap: 2em;
			grid-template-columns: 1fr 16em;
		}
	}
</style>

```


####### content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/blog/[slug]/+page.svelte #######

```

<h1>blog post</h1>

```


####### content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/blog">blog</a>
</nav>

<slot />

```


####### content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-a/src/routes/+page.svelte #######

```

<p>home</p>

```


####### content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-b/src/routes/blog/+page.server.js #######

```

import { posts } from './data.js';

export function load() {
	return {
		summaries: posts.map((post) => ({
			slug: post.slug,
			title: post.title
		}))
	};
}

```


####### content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-b/src/routes/blog/+page.svelte #######

```

<script>
	export let data;
</script>

<h1>blog</h1>

<ul>
	{#each data.summaries as { slug, title }}
		<li><a href="/blog/{slug}">{title}</a></li>
	{/each}
</ul>

```


####### content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-b/src/routes/blog/[slug]/+page.server.js #######

```

import { error } from '@sveltejs/kit';
import { posts } from '../data.js';

export function load({ params }) {
	const post = posts.find((post) => post.slug === params.slug);

	if (!post) throw error(404);

	return {
		post
	};
}

```


####### content/tutorial/03-sveltekit/03-loading-data/01-page-data/app-b/src/routes/blog/[slug]/+page.svelte #######

```

<script>
	export let data;
</script>

<h1>{data.post.title}</h1>
<div>{@html data.post.content}</div>

```


####### content/tutorial/03-sveltekit/03-loading-data/01-page-data/README.md #######

---
title: Page data
path: /blog
---

At its core, SvelteKit's job boils down to three things:

1. **Routing** — figure out which route matches an incoming request
2. **Loading** — get the data needed by the route
3. **Rendering** — generate some HTML (on the server) or update the DOM (in the browser)

We've seen how routing and rendering work. Let's talk about the middle part — loading.

Every page of your app can declare a `load` function in a `+page.server.js` file alongside the `+page.svelte` file. As the file name suggests, this module only ever runs on the server, including for client-side navigations. Let's add a `src/routes/blog/+page.server.js` file so that we can replace the hard-coded links in `src/routes/blog/+page.svelte` with actual blog post data:

```js
/// file: src/routes/blog/+page.server.js
import { posts } from './data.js';

export function load() {
	return {
		summaries: posts.map((post) => ({
			slug: post.slug,
			title: post.title
		}))
	};
}
```

> For the sake of the tutorial, we're importing data from `src/routes/blog/data.js`. In a real app, you'd be more likely to load the data from a database or a CMS, but for now we'll do it like this.

We can access this data in `src/routes/blog/+page.svelte` via the `data` prop:

```svelte
/// file: src/routes/blog/+page.svelte
+++<script>
	export let data;
</script>+++

<h1>blog</h1>

<ul>
---	<li><a href="/blog/one">one</a></li>
	<li><a href="/blog/two">two</a></li>
	<li><a href="/blog/three">three</a></li>---
+++	{#each data.summaries as { slug, title }}
		<li><a href="/blog/{slug}">{title}</a></li>
	{/each}+++
</ul>
```

Now, let's do the same for the post page:

```js
/// file: src/routes/blog/[slug]/+page.server.js
import { posts } from '../data.js';

export function load({ params }) {
	const post = posts.find((post) => post.slug === params.slug);

	return {
		post
	};
}
```

```svelte
/// file: src/routes/blog/[slug]/+page.svelte
+++<script>
	export let data;
</script>+++

---<h1>blog post</h1>---
+++<h1>{data.post.title}</h1>
<div>{@html data.post.content}</div>+++
```

There's one last detail we need to take care of — the user might visit an invalid pathname like `/blog/nope`, in which case we'd like to respond with a 404 page:

```js
/// file: src/routes/blog/[slug]/+page.server.js
+++import { error } from '@sveltejs/kit';+++
import { posts } from '../data.js';

export function load({ params }) {
	const post = posts.find((post) => post.slug === params.slug);

	+++if (!post) throw error(404);+++

	return {
		post
	};
}
```

We'll learn more about error handling in later chapters.

####### content/tutorial/03-sveltekit/03-loading-data/02-layout-data/app-b/src/routes/blog/+layout.server.js #######

```

import { posts } from './data.js';

export function load() {
	return {
		summaries: posts.map((post) => ({
			slug: post.slug,
			title: post.title
		}))
	};
}

```


####### content/tutorial/03-sveltekit/03-loading-data/02-layout-data/app-b/src/routes/blog/+page.server.js #######

```

__delete;

```


####### content/tutorial/03-sveltekit/03-loading-data/02-layout-data/app-b/src/routes/blog/[slug]/+layout.svelte #######

```

<script>
	export let data;
</script>

<div class="layout">
	<main>
		<slot />
	</main>

	<aside>
		<h2>More posts</h2>
		<ul>
			{#each data.summaries as { slug, title }}
				<li>
					<a href="/blog/{slug}">{title}</a>
				</li>
			{/each}
		</ul>
	</aside>
</div>

<style>
	@media (min-width: 640px) {
		.layout {
			display: grid;
			gap: 2em;
			grid-template-columns: 1fr 16em;
		}
	}
</style>

```


####### content/tutorial/03-sveltekit/03-loading-data/02-layout-data/README.md #######

---
title: Layout data
path: /blog
---

Just as `+layout.svelte` files create UI for every child route, `+layout.server.js` files load data for every child route.

Suppose we'd like to add a 'more posts' sidebar to our blog post page. We _could_ return `summaries` from the `load` function in `src/routes/blog/[slug]/+page.server.js`, like we do in `src/routes/blog/+page.server.js`, but that would be repetitive.

Instead, let's rename `src/routes/blog/+page.server.js` to `src/routes/blog/+layout.server.js`. Notice that the `/blog` route continues to work — `data.summaries` is still available to the page.

Now, add a sidebar in the layout for the post page:

```svelte
/// file: src/routes/blog/[slug]/+layout.svelte
<script>
	export let data;
</script>

<div class="layout">
	<main>
		<slot />
	</main>

+++	<aside>
		<h2>More posts</h2>
		<ul>
			{#each data.summaries as { slug, title }}
				<li>
					<a href="/blog/{slug}">{title}</a>
				</li>
			{/each}
		</ul>
	</aside>+++
</div>

<style>
	@media (min-width: 640px) {
		.layout {
			display: grid;
			gap: 2em;
			grid-template-columns: 1fr 16em;
		}
	}
</style>
```

The layout (and any page below it) inherits `data.summaries` from the parent `+layout.server.js`.

When we navigate from one post to another, we only need to load the data for the post itself — the layout data is still valid. See the documentation on [invalidation](https://kit.svelte.dev/docs/load#rerunning-load-functions) to learn more.

####### content/tutorial/03-sveltekit/03-loading-data/meta.json #######

```

{
	"title": "Loading data"
}

```


####### content/tutorial/03-sveltekit/04-headers-and-cookies/01-headers/app-a/src/routes/+page.server.js #######

```

export function load() {
	// set headers
}

```


####### content/tutorial/03-sveltekit/04-headers-and-cookies/01-headers/app-a/src/routes/+page.svelte #######

```

<h1>hello world</h1>
```


####### content/tutorial/03-sveltekit/04-headers-and-cookies/01-headers/app-b/src/routes/+page.server.js #######

```

export function load({ setHeaders }) {
	setHeaders({
		'Content-Type': 'text/plain'
	});
}

```


####### content/tutorial/03-sveltekit/04-headers-and-cookies/01-headers/README.md #######

---
title: Setting headers
---

Inside a `load` function (as well as in [form actions](the-form-element), [hooks](handle) and [API routes](get-handlers), which we'll learn about later) you have access to a `setHeaders` function, which — unsurprisingly — can be used to set headers on the response.

Most commonly, you'd use it to customise caching behaviour with the [`Cache-Control`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control) response header, but for the sake of this tutorial we'll do something less advisable and more dramatic:

```js
/// file: src/routes/+page.server.js
export function load(+++{ setHeaders }+++) {
+++	setHeaders({
		'Content-Type': 'text/plain'
	});+++
}
```

(You may need to reload the iframe to see the effect.)

####### content/tutorial/03-sveltekit/04-headers-and-cookies/02-cookies/app-a/src/routes/+page.server.js #######

```

export function load() {
	const visited = 'false';

	return {
		visited: visited === 'true'
	};
}

```


####### content/tutorial/03-sveltekit/04-headers-and-cookies/02-cookies/app-a/src/routes/+page.svelte #######

```

<script>
	export let data;
</script>

<h1>Hello {data.visited ? 'friend' : 'stranger'}!</h1>
```


####### content/tutorial/03-sveltekit/04-headers-and-cookies/02-cookies/app-b/src/routes/+page.server.js #######

```

export function load({ cookies }) {
	const visited = cookies.get('visited');

	cookies.set('visited', 'true', { path: '/' });

	return {
		visited
	};
}

```


####### content/tutorial/03-sveltekit/04-headers-and-cookies/02-cookies/README.md #######

---
title: Reading and writing cookies
---

The [`setHeaders`](headers) function can't be used with the `Set-Cookie` header. Instead, you should use the `cookies` API.

In your `load` functions, you can read a cookie with `cookies.get(name, options)`:

```js
/// file: src/routes/+page.server.js
export function load(+++{ cookies }+++) {
	+++const visited = cookies.get('visited');+++

	return {
		visited: visited === 'true'
	};
}
```

To set a cookie, use `cookies.set(name, value, options)`. It's strongly recommended that you explicitly configure the `path` when setting a cookie, since browsers' default behaviour — somewhat uselessly — is to set the cookie on the parent of the current path.

```js
/// file: src/routes/+page.server.js
export function load({ cookies }) {
	const visited = cookies.get('visited');

	+++cookies.set('visited', 'true', { path: '/' });+++

	return {
		visited: visited === 'true'
	};
}
```

Now, if you reload the iframe, `Hello stranger!` becomes `Hello friend!`.

Calling `cookies.set(name, ...)` causes a `Set-Cookie` header to be written, but it _also_ updates the internal map of cookies, meaning any subsequent calls to `cookies.get(name)` during the same request will return the updated value. Under the hood, the `cookies` API uses the popular `cookie` package — the options passed to `cookies.get` and `cookies.set` correspond to the `parse` and `serialize` options from the `cookie` [documentation](https://github.com/jshttp/cookie#api). SvelteKit sets the following defaults to make your cookies more secure:

```js
/// no-file
{
	httpOnly: true,
	secure: true,
	sameSite: 'lax'
}
```

####### content/tutorial/03-sveltekit/04-headers-and-cookies/meta.json #######

```

{
	"title": "Headers and cookies"
}
```


####### content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-a/src/lib/message.js #######

```

export const message = 'hello from $lib/message';
```


####### content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-a/src/routes/a/deeply/nested/route/+page.svelte #######

```

<script>
	import { message } from '../../../../../../lib/message.js';
</script>

<h1>a deeply nested route</h1>
<p>{message}</p>
```


####### content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/a/deeply/nested/route">a deeply nested route</a>
</nav>

<slot />
```


####### content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-a/src/routes/+page.svelte #######

```

<script>
	import { message } from '../lib/message.js';
</script>

<h1>home</h1>
<p>{message}</p>
```


####### content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-b/src/routes/a/deeply/nested/route/+page.svelte #######

```

<script>
	import { message } from '$lib/message.js';
</script>

<h1>a deeply nested route</h1>
<p>{message}</p>
```


####### content/tutorial/03-sveltekit/05-shared-modules/01-lib/app-b/src/routes/+page.svelte #######

```

<script>
	import { message } from '$lib/message.js';
</script>

<h1>home</h1>
<p>{message}</p>
```


####### content/tutorial/03-sveltekit/05-shared-modules/01-lib/README.md #######

---
title: The $lib alias
---

Because SvelteKit uses directory-based routing, it's easy to place modules and components alongside the routes that use them. A good rule of thumb is 'put code close to where it's used'. 

Sometimes, code is used in multiple places. When this happens, it's useful to have a place to put them that can be accessed by all routes without needing to prefix imports with `../../../../`. In SvelteKit, that place is the `src/lib` directory. Anything inside this directory can be accessed by any module in `src` via the `$lib` alias.

Both `+page.svelte` files in this exercise import `src/lib/message.js`. But if you navigate to `/a/deeply/nested/route`, the app breaks, because we got the prefix wrong. Update it to use `$lib/message.js` instead:

```svelte
/// file: src/routes/a/deeply/nested/route/+page.svelte
<script>
	import { message } from +++'$lib/message.js'+++;
</script>

<h1>a deeply nested route</h1>
<p>{message}</p>
```

Do the same for `src/routes/+page.svelte`:

```svelte
/// file: src/routes/+page.svelte
<script>
	import { message } from +++'$lib/message.js'+++;
</script>

<h1>home</h1>
<p>{message}</p>
```

####### content/tutorial/03-sveltekit/05-shared-modules/meta.json #######

```

{
	"title": "Shared modules"
}
```


####### content/tutorial/03-sveltekit/06-forms/01-the-form-element/app-a/src/lib/server/database.js #######

```

// In a real app, this data would live in a database,
// rather than in memory. But for now, we cheat.
const db = new Map();

export function getTodos(userid) {
	if (!db.get(userid)) {
		db.set(userid, [{
			id: crypto.randomUUID(),
			description: 'Learn SvelteKit',
			done: false
		}]);
	}

	return db.get(userid);
}

export function createTodo(userid, description) {
	const todos = db.get(userid);

	todos.push({
		id: crypto.randomUUID(),
		description,
		done: false
	});
}

export function deleteTodo(userid, todoid) {
	const todos = db.get(userid);
	const index = todos.findIndex((todo) => todo.id === todoid);

	if (index !== -1) {
		todos.splice(index, 1);
	}
}

```


####### content/tutorial/03-sveltekit/06-forms/01-the-form-element/app-a/src/routes/+page.server.js #######

```

import * as db from '$lib/server/database.js';

export function load({ cookies }) {
	let id = cookies.get('userid');

	if (!id) {
		id = crypto.randomUUID();
		cookies.set('userid', id, { path: '/' });
	}

	return {
		todos: db.getTodos(id)
	};
}

```


####### content/tutorial/03-sveltekit/06-forms/01-the-form-element/app-a/src/routes/+page.svelte #######

```

<script>
	export let data;
</script>

<div class="centered">
	<h1>todos</h1>

	<ul class="todos">
		{#each data.todos as todo (todo.id)}
			<li>
				{todo.description}
			</li>
		{/each}
	</ul>
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	label {
		width: 100%;
	}

	input {
		flex: 1;
	}

	span {
		flex: 1;
	}

	button {
		border: none;
		background: url(./remove.svg) no-repeat 50% 50%;
		background-size: 1rem 1rem;
		cursor: pointer;
		height: 100%;
		aspect-ratio: 1;
		opacity: 0.5;
		transition: opacity 0.2s;
	}

	button:hover {
		opacity: 1;
	}

	.saving {
		opacity: 0.5;
	}
</style>

```


####### content/tutorial/03-sveltekit/06-forms/01-the-form-element/app-b/src/routes/+page.server.js #######

```

import * as db from '$lib/server/database.js';

export function load({ cookies }) {
	let id = cookies.get('userid');

	if (!id) {
		id = crypto.randomUUID();
		cookies.set('userid', id, { path: '/' });
	}

	return {
		todos: db.getTodos(id)
	};
}

export const actions = {
	default: async ({ cookies, request }) => {
		const data = await request.formData();
		db.createTodo(cookies.get('userid'), data.get('description'));
	}
};

```


####### content/tutorial/03-sveltekit/06-forms/01-the-form-element/app-b/src/routes/+page.svelte #######

```

<script>
	export let data;
</script>

<div class="centered">
	<h1>todos</h1>

	<form method="POST">
		<label>
			add a todo:
			<input
				name="description"
				autocomplete="off"
			/>
		</label>
	</form>

	<ul class="todos">
		{#each data.todos as todo (todo.id)}
			<li>
				{todo.description}
			</li>
		{/each}
	</ul>
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	label {
		width: 100%;
	}

	input {
		flex: 1;
	}

	span {
		flex: 1;
	}

	button {
		border: none;
		background: url(./remove.svg) no-repeat 50% 50%;
		background-size: 1rem 1rem;
		cursor: pointer;
		height: 100%;
		aspect-ratio: 1;
		opacity: 0.5;
		transition: opacity 0.2s;
	}

	button:hover {
		opacity: 1;
	}

	.saving {
		opacity: 0.5;
	}
</style>

```


####### content/tutorial/03-sveltekit/06-forms/01-the-form-element/README.md #######

---
title: The <form> element
---

In the chapter on [loading data](page-data), we saw how to get data from the server to the browser. Sometimes you need to send data in the opposite direction, and that's where `<form>` — the web platform's way of submitting data — comes in.

Let's build a todo app. We've already got an in-memory database set up in `src/lib/server/database.js`, and our `load` function in `src/routes/+page.server.js` uses the [`cookies`](https://kit.svelte.dev/docs/load#cookies) API so that we can have a per-user todo list, but we need to add a `<form>` to create new todos:

```svelte
/// file: src/routes/+page.svelte
<h1>todos</h1>

+++<form method="POST">
	<label>
		add a todo:
		<input
			name="description"
			autocomplete="off"
		/>
	</label>
</form>+++

<ul class="todos">
```

If we type something into the `<input>` and hit Enter, the browser makes a POST request (because of the `method="POST"` attribute) to the current page. But that results in an error, because we haven't created a server-side _action_ to handle the POST request. Let's do that now:

```js
/// file: src/routes/+page.server.js
import * as db from '$lib/server/database.js';

export function load({ cookies }) {
	// ...
}

+++export const actions = {
	default: async ({ cookies, request }) => {
		const data = await request.formData();
		db.createTodo(cookies.get('userid'), data.get('description'));
	}
};+++
```

The `request` is a standard [Request](https://developer.mozilla.org/en-US/docs/Web/API/Request) object; `await request.formData()` returns a [`FormData`](https://developer.mozilla.org/en-US/docs/Web/API/FormData) instance.

When we hit Enter, the database is updated and the page reloads with the new data.

Notice that we haven't had to write any `fetch` code or anything like that — data updates automatically. And because we're using a `<form>` element, this app would work even if JavaScript was disabled or unavailable.

####### content/tutorial/03-sveltekit/06-forms/02-named-form-actions/app-b/src/routes/+page.server.js #######

```

import * as db from '$lib/server/database.js';

export function load({ cookies }) {
	let id = cookies.get('userid');

	if (!id) {
		id = crypto.randomUUID();
		cookies.set('userid', id, { path: '/' });
	}

	return {
		todos: db.getTodos(id)
	};
}

export const actions = {
	create: async ({ cookies, request }) => {
		const data = await request.formData();
		db.createTodo(cookies.get('userid'), data.get('description'));
	},

	delete: async ({ cookies, request }) => {
		const data = await request.formData();
		db.deleteTodo(cookies.get('userid'), data.get('id'));
	}
};

```


####### content/tutorial/03-sveltekit/06-forms/02-named-form-actions/app-b/src/routes/+page.svelte #######

```

<script>
	export let data;
</script>

<div class="centered">
	<h1>todos</h1>

	<form method="POST" action="?/create">
		<label>
			add a todo:
			<input
				name="description"
				autocomplete="off"
			/>
		</label>
	</form>

	<ul class="todos">
		{#each data.todos as todo (todo.id)}
			<li>
				<form method="POST" action="?/delete">
					<input type="hidden" name="id" value={todo.id} />
					<span>{todo.description}</span>
					<button aria-label="Mark as complete" />
				</form>
			</li>
		{/each}
	</ul>
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	label {
		width: 100%;
	}

	input {
		flex: 1;
	}

	span {
		flex: 1;
	}

	button {
		border: none;
		background: url(./remove.svg) no-repeat 50% 50%;
		background-size: 1rem 1rem;
		cursor: pointer;
		height: 100%;
		aspect-ratio: 1;
		opacity: 0.5;
		transition: opacity 0.2s;
	}

	button:hover {
		opacity: 1;
	}

	.saving {
		opacity: 0.5;
	}
</style>

```


####### content/tutorial/03-sveltekit/06-forms/02-named-form-actions/README.md #######

---
title: Named form actions
---

A page that only has a single action is, in practice, quite rare. Most of the time you'll need to have multiple actions on a page. In this app, creating a todo isn't enough — we'd like to delete them once they're complete.

Begin by replacing our `default` action with named `create` and `delete` actions:

```js
/// file: src/routes/+page.server.js
export const actions = {
	+++create+++: async ({ cookies, request }) => {
		const data = await request.formData();
		db.createTodo(cookies.get('userid'), data.get('description'));
	}+++,+++

+++	delete: async ({ cookies, request }) => {
		const data = await request.formData();
		db.deleteTodo(cookies.get('userid'), data.get('id'));
	}+++
};
```

> Default actions cannot coexist with named actions.

The `<form>` element has an optional `action` attribute, which is similar to an `<a>` element's `href` attribute. Update the existing form so that it points to the new `create` action:

```svelte
/// file: src/routes/+page.svelte
<form method="POST" +++action="?/create"+++>
	<label>
		add a todo:
		<input
			name="description"
			autocomplete="off"
		/>
	</label>
</form>
```

> The `action` attribute can be any URL — if the action was defined on another page, you might have something like `/todos?/create`. Since the action is on _this_ page, we can omit the pathname altogether, hence the leading `?` character.

Next, we want to create a form for each todo, complete with a hidden `<input>` that uniquely identifies it:

```svelte
/// file: src/routes/+page.svelte
<ul class="todos">
	{#each data.todos as todo (todo.id)}
		<li>
+++			<form method="POST" action="?/delete">
				<input type="hidden" name="id" value={todo.id} />
				<span>{todo.description}</span>
				<button aria-label="Mark as complete" />
			</form>+++
		</li>
	{/each}
</ul>
```

####### content/tutorial/03-sveltekit/06-forms/03-form-validation/app-b/src/lib/server/database.js #######

```

// In a real app, this data would live in a database,
// rather than in memory. But for now, we cheat.
const db = new Map();

export function getTodos(userid) {
	if (!db.get(userid)) {
		db.set(userid, [{
			id: crypto.randomUUID(),
			description: 'Learn SvelteKit',
			done: false
		}]);
	}

	return db.get(userid);
}

export function createTodo(userid, description) {
	if (description === '') {
		throw new Error('todo must have a description');
	}

	const todos = db.get(userid);

	if (todos.find((todo) => todo.description === description)) {
		throw new Error('todos must be unique');
	}

	todos.push({
		id: crypto.randomUUID(),
		description,
		done: false
	});
}

export function deleteTodo(userid, todoid) {
	const todos = db.get(userid);
	const index = todos.findIndex((todo) => todo.id === todoid);

	if (index !== -1) {
		todos.splice(index, 1);
	}
}

```


####### content/tutorial/03-sveltekit/06-forms/03-form-validation/app-b/src/routes/+page.server.js #######

```

import { fail } from '@sveltejs/kit';
import * as db from '$lib/server/database.js';

export function load({ cookies }) {
	let id = cookies.get('userid');

	if (!id) {
		id = crypto.randomUUID();
		cookies.set('userid', id, { path: '/' });
	}

	return {
		todos: db.getTodos(id)
	};
}

export const actions = {
	create: async ({ cookies, request }) => {
		const data = await request.formData();

		try {
			db.createTodo(cookies.get('userid'), data.get('description'));
		} catch (error) {
			return fail(422, {
				description: data.get('description'),
				error: error.message
			});
		}
	},

	delete: async ({ cookies, request }) => {
		const data = await request.formData();
		db.deleteTodo(cookies.get('userid'), data.get('id'));
	}
};

```


####### content/tutorial/03-sveltekit/06-forms/03-form-validation/app-b/src/routes/+page.svelte #######

```

<script>
	export let data;
	export let form;
</script>

<div class="centered">
	<h1>todos</h1>

	{#if form?.error}
		<p class="error">{form.error}</p>
	{/if}

	<form method="POST" action="?/create">
		<label>
			add a todo:
			<input
				name="description"
				value={form?.description ?? ''}
				autocomplete="off"
				required
			/>
		</label>
	</form>

	<ul class="todos">
		{#each data.todos as todo (todo.id)}
			<li>
				<form method="POST" action="?/delete">
					<input type="hidden" name="id" value={todo.id} />
					<span>{todo.description}</span>
					<button aria-label="Mark as complete" />
				</form>
			</li>
		{/each}
	</ul>
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	label {
		width: 100%;
	}

	input {
		flex: 1;
	}

	span {
		flex: 1;
	}

	button {
		border: none;
		background: url(./remove.svg) no-repeat 50% 50%;
		background-size: 1rem 1rem;
		cursor: pointer;
		height: 100%;
		aspect-ratio: 1;
		opacity: 0.5;
		transition: opacity 0.2s;
	}

	button:hover {
		opacity: 1;
	}

	.saving {
		opacity: 0.5;
	}
</style>

```


####### content/tutorial/03-sveltekit/06-forms/03-form-validation/README.md #######

---
title: Validation
---

Users are a mischievous bunch, who will submit all kinds of nonsensical data if given the chance. To prevent them from causing chaos, it's important to validate form data.

The first line of defense is the browser's [built-in form validation](https://developer.mozilla.org/en-US/docs/Learn/Forms/Form_validation#using_built-in_form_validation), which makes it easy to, for example, mark an `<input>` as required:

```svelte
/// file: src/routes/+page.svelte
<form method="POST" action="?/create">
	<label>
		add a todo
		<input
			name="description"
			autocomplete="off"
			+++required+++
		/>
	</label>
</form>
```

Try hitting Enter while the `<input>` is empty.

This kind of validation is helpful, but insufficient. Some validation rules (e.g. uniqueness) can't be expressed using `<input>` attributes, and in any case, if the user is an elite hacker they might simply delete the attributes using the browser's devtools. To guard against these sorts of shenanigans, you should always use server-side validation.

In `src/lib/server/database.js`, validate that the description exists and is unique:

```js
/// file: src/lib/server/database.js
export function createTodo(userid, description) {
+++	if (description === '') {
		throw new Error('todo must have a description');
	}+++

	const todos = db.get(userid);

+++	if (todos.find((todo) => todo.description === description)) {
		throw new Error('todos must be unique');
	}+++

	todos.push({
		id: crypto.randomUUID(),
		description,
		done: false
	});
}
```

Try submitting a duplicate todo. Yikes! SvelteKit takes us to an unfriendly-looking error page. On the server, we see a 'todos must be unique' error, but SvelteKit hides unexpected error messages from users because they often contain sensitive data.

It would be much better to stay on the same page and provide an indication of what went wrong so that the user can fix it. To do this, we can use the `fail` function to return data from the action along with an appropriate HTTP status code:

```js
/// file: src/routes/+page.server.js
+++import { fail } from '@sveltejs/kit';+++
import * as db from '$lib/server/database.js';

export function load({ cookies }) {...}

export const actions = {
	create: async ({ cookies, request }) => {
		const data = await request.formData();

+++		try {+++
			db.createTodo(cookies.get('userid'), data.get('description'));
+++		} catch (error) {
			return fail(422, {
				description: data.get('description'),
				error: error.message
			});
		}+++
	}
```

In `src/routes/+page.svelte`, we can access the returned value via the `form` prop, which is only ever populated after a form submission:

```svelte
/// file: src/routes/+page.svelte
<script>
	export let data;
	+++export let form;+++
</script>

<div class="centered">
	<h1>todos</h1>
	
	+++{#if form?.error}
		<p class="error">{form.error}</p>
	{/if}+++
	
	<form method="POST" action="?/create">
		<label>
			add a todo:
			<input
				name="description"
				+++value={form?.description ?? ''}+++
				autocomplete="off"
				required
			/>
		</label>
	</form>
```

> You can also return data from an action _without_ wrapping it in `fail` — for example to show a 'success!' message when data was saved — and it will be available via the `form` prop.

####### content/tutorial/03-sveltekit/06-forms/04-progressive-enhancement/app-b/src/routes/+page.svelte #######

```

<script>
	import { fly, slide } from 'svelte/transition';
	import { enhance } from '$app/forms';

	export let data;
	export let form;
</script>

<div class="centered">
	<h1>todos</h1>

	{#if form?.error}
		<p class="error">{form.error}</p>
	{/if}

	<form method="POST" action="?/create" use:enhance>
		<label>
			add a todo:
			<input
				name="description"
				value={form?.description ?? ''}
				autocomplete="off"
				required
			/>
		</label>
	</form>

	<ul class="todos">
		{#each data.todos as todo (todo.id)}
			<li in:fly={{ y: 20 }} out:slide>
				<form method="POST" action="?/delete" use:enhance>
					<input type="hidden" name="id" value={todo.id} />
					<span>{todo.description}</span>
					<button aria-label="Mark as complete" />
				</form>
			</li>
		{/each}
	</ul>
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	label {
		width: 100%;
	}

	input {
		flex: 1;
	}

	span {
		flex: 1;
	}

	button {
		border: none;
		background: url(./remove.svg) no-repeat 50% 50%;
		background-size: 1rem 1rem;
		cursor: pointer;
		height: 100%;
		aspect-ratio: 1;
		opacity: 0.5;
		transition: opacity 0.2s;
	}

	button:hover {
		opacity: 1;
	}

	.saving {
		opacity: 0.5;
	}
</style>

```


####### content/tutorial/03-sveltekit/06-forms/04-progressive-enhancement/README.md #######

---
title: Progressive enhancement
---

Because we're using `<form>`, our app works even if the user doesn't have JavaScript ([which happens more often than you probably think](https://kryogenix.org/code/browser/everyonehasjs.html)). That's great, because it means our app is resilient.

Most of the time, users _do_ have JavaScript. In those cases, we can _progressively enhance_ the experience, the same way SvelteKit progressively enhances `<a>` elements by using client-side routing.

Import the `enhance` function from `$app/forms`...

```svelte
/// file: src/routes/+page.svelte
<script>
	+++import { enhance } from '$app/forms';+++

	export let data;
	export let form;
</script>
```

...and add the `use:enhance` directive to the `<form>` elements:

```svelte
/// file: src/routes/+page.svelte
<form method="POST" action="?/create" +++use:enhance+++>
```

```svelte
/// file: src/routes/+page.svelte
<form method="POST" action="?/delete" +++use:enhance+++>
```

And that's all it takes! Now, when JavaScript is enabled, `use:enhance` will emulate the browser-native behaviour except for the full-page reloads. It will:

- update the `form` prop
- invalidate all data on a successful response, causing `load` functions to re-run
- navigate to the new page on a redirect response
- render the nearest error page if an error occurs

Now that we're updating the page rather than reloading it, we can get fancy with things like transitions:

```svelte
/// file: src/routes/+page.svelte
<script>
	+++import { fly, slide } from 'svelte/transition';+++
	import { enhance } from '$app/forms';

	export let data;
	export let form;
</script>
```

```svelte
/// file: src/routes/+page.svelte
<li +++in:fly={{ y: 20 }} out:slide+++>...</li>
```

####### content/tutorial/03-sveltekit/06-forms/05-customizing-use-enhance/app-b/src/routes/+page.server.js #######

```

import { fail } from '@sveltejs/kit';
import * as db from '$lib/server/database.js';

export function load({ cookies }) {
	let id = cookies.get('userid');

	if (!id) {
		id = crypto.randomUUID();
		cookies.set('userid', id, { path: '/' });
	}

	return {
		todos: db.getTodos(id)
	};
}

export const actions = {
	create: async ({ cookies, request }) => {
		await new Promise((fulfil) => setTimeout(fulfil, 1000));

		const data = await request.formData();

		try {
			db.createTodo(cookies.get('userid'), data.get('description'));
		} catch (error) {
			return fail(422, {
				description: data.get('description'),
				error: error.message
			});
		}
	},

	delete: async ({ cookies, request }) => {
		await new Promise((fulfil) => setTimeout(fulfil, 1000));

		const data = await request.formData();
		db.deleteTodo(cookies.get('userid'), data.get('id'));
	}
};

```


####### content/tutorial/03-sveltekit/06-forms/05-customizing-use-enhance/app-b/src/routes/+page.svelte #######

```

<script>
	import { fly, slide } from 'svelte/transition';
	import { enhance } from '$app/forms';

	export let data;
	export let form;

	let creating = false;
	let deleting = [];
</script>

<div class="centered">
	<h1>todos</h1>

	{#if form?.error}
		<p class="error">{form.error}</p>
	{/if}

	<form
		method="POST"
		action="?/create"
		use:enhance={() => {
			creating = true;

			return async ({ update }) => {
				await update();
				creating = false;
			};
		}}
	>
		<label>
			add a todo:
			<input
				disabled={creating}
				name="description"
				value={form?.description ?? ''}
				autocomplete="off"
				required
			/>
		</label>
	</form>

	<ul class="todos">
		{#each data.todos.filter((todo) => !deleting.includes(todo.id)) as todo (todo.id)}
			<li in:fly={{ y: 20 }} out:slide>
				<form
					method="POST"
					action="?/delete"
					use:enhance={() => {
						deleting = [...deleting, todo.id];
						return async ({ update }) => {
							await update();
							deleting = deleting.filter((id) => id !== todo.id);
						};
					}}
				>
					<input type="hidden" name="id" value={todo.id} />
					<span>{todo.description}</span>
					<button aria-label="Mark as complete" />
				</form>
			</li>
		{/each}
	</ul>

	{#if creating}
		<span class="saving">saving...</span>
	{/if}
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	label {
		width: 100%;
	}

	input {
		flex: 1;
	}

	span {
		flex: 1;
	}

	button {
		border: none;
		background: url(./remove.svg) no-repeat 50% 50%;
		background-size: 1rem 1rem;
		cursor: pointer;
		height: 100%;
		aspect-ratio: 1;
		opacity: 0.5;
		transition: opacity 0.2s;
	}

	button:hover {
		opacity: 1;
	}

	.saving {
		opacity: 0.5;
	}
</style>

```


####### content/tutorial/03-sveltekit/06-forms/05-customizing-use-enhance/README.md #######

---
title: Customizing use:enhance
---

With `use:enhance`, we can go further than just emulating the browser's native behaviour. By providing a callback, we can add things like **pending states** and **optimistic UI**. Let's simulate a slow network by adding an artificial delay to our two actions:

```js
/// file: src/routes/+page.server.js
export const actions = {
	create: async ({ cookies, request }) => {
		+++await new Promise((fulfil) => setTimeout(fulfil, 1000));+++
		...
	},

	delete: async ({ cookies, request }) => {
		+++await new Promise((fulfil) => setTimeout(fulfil, 1000));+++
		...
	}
};
```

When we create or delete items, it now takes a full second before the UI updates, leaving the user wondering if they messed up somehow. To solve that, add some local state...

```svelte
/// file: src/routes/+page.svelte
<script>
	import { fly, slide } from 'svelte/transition';
	import { enhance } from '$app/forms';

	export let data;
	export let form;

+++	let creating = false;
	let deleting = [];+++
</script>
```

...and toggle `creating` inside the first `use:enhance`:

```svelte
/// file: src/routes/+page.svelte
<form
	method="POST"
	action="?/create"
+++	use:enhance={() => {
		creating = true;

		return async ({ update }) => {
			await update();
			creating = false;
		};
	}}+++
>
	<label>
		add a todo:
		<input
			+++disabled={creating}+++
			name="description"
			value={form?.description ?? ''}
			autocomplete="off"
			required
		/>
	</label>
</form>
```

We can then show a message while we're saving data:

```svelte
/// file: src/routes/+page.svelte
<ul class="todos">
	<!-- ... -->
</ul>

+++{#if creating}
	<span class="saving">saving...</span>
{/if}+++
```

In the case of deletions, we don't really need to wait for the server to validate anything — we can just update the UI immediately:

```svelte
/// file: src/routes/+page.svelte
<ul class="todos">
	{#each +++data.todos.filter((todo) => !deleting.includes(todo.id))+++ as todo (todo.id)}
		<li in:fly={{ y: 20 }} out:slide>
			<form
				method="POST"
				action="?/delete"
				+++use:enhance={() => {
					deleting = [...deleting, todo.id];
					return async ({ update }) => {
						await update();
						deleting = deleting.filter((id) => id !== todo.id);
					};
				}}+++
			>
				<input type="hidden" name="id" value={todo.id} />
				<button aria-label="Mark as complete">✔</button>

				{todo.description}
			</form>
		</li>
	{/each}
</ul>
```

> `use:enhance` is very customizable — you can `cancel()` submissions, handle redirects, control whether the form is reset, and so on. [See the docs](https://kit.svelte.dev/docs/modules#$app-forms-enhance) for full details.

####### content/tutorial/03-sveltekit/06-forms/meta.json #######

```

{
	"title": "Forms"
}

```


####### content/tutorial/03-sveltekit/07-api-routes/01-get-handlers/app-a/src/routes/+page.svelte #######

```

<script>
	/** @type {number} */
	let number;

	async function roll() {
		const response = await fetch('/roll');
		number = await response.json();
	}
</script>

<button on:click={roll}>Roll the dice</button>

{#if number !== undefined}
	<p>You rolled a {number}</p>
{/if}

```


####### content/tutorial/03-sveltekit/07-api-routes/01-get-handlers/app-b/src/routes/roll/+server.js #######

```

import { json } from '@sveltejs/kit';

export function GET() {
	const number = Math.floor(Math.random() * 6) + 1;

	return json(number);
}

```


####### content/tutorial/03-sveltekit/07-api-routes/01-get-handlers/README.md #######

---
title: GET handlers
---

SvelteKit allows you to create more than just pages. We can also create _API routes_ by adding a `+server.js` file that exports functions corresponding to HTTP methods: `GET`, `PUT`, `POST`, `PATCH` and `DELETE`.

This app fetches data from a `/roll` API route when you click the button. Create that route by adding a `src/routes/roll/+server.js` file:

```js
/// file: src/routes/roll/+server.js
export function GET() {
	const number = Math.floor(Math.random() * 6) + 1;

	return new Response(number, {
		headers: {
			'Content-Type': 'application/json'
		}
	});
}
```

Clicking the button now works.

Request handlers must return a [Response](https://developer.mozilla.org/en-US/docs/Web/API/Response/Response) object. Since it's common to return JSON from an API route, SvelteKit provides a convenience function for generating these responses:

```js
/// file: src/routes/roll/+server.js
+++import { json } from '@sveltejs/kit';+++

export function GET() {
	const number = Math.floor(Math.random() * 6) + 1;

---	return new Response(number, {
		headers: {
			'Content-Type': 'application/json'
		}
	});---
+++	return json(number);+++
}
```

####### content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/app-a/src/lib/server/database.js #######

```

const database = new Map();

export function getTodos(userid) {
	if (!database.has(userid)) {
		createTodo({ userid, description: 'Learn about API routes' });
	}

	return Array.from(database.get(userid).values());
}

export function createTodo({ userid, description }) {
	if (!database.has(userid)) {
		database.set(userid, new Map());
	}

	const todos = database.get(userid);

	const id = crypto.randomUUID();

	todos.set(id, {
		id,
		description,
		done: false
	});

	return {
		id
	};
}

export function toggleTodo({ userid, id, done }) {
	const todos = database.get(userid);
	todos.get(id).done = done;
}

export function deleteTodo({ userid, id }) {
	const todos = database.get(userid);
	todos.delete(id);
}

```


####### content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/app-a/src/routes/+page.server.js #######

```

import * as database from '$lib/server/database.js';

export function load({ cookies }) {
	let userid = cookies.get('userid');

	if (!userid) {
		userid = crypto.randomUUID();
		cookies.set('userid', userid, { path: '/' });
	}

	return {
		todos: database.getTodos(userid)
	};
}

```


####### content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/app-a/src/routes/+page.svelte #######

```

<script>
	export let data;
</script>

<div class="centered">
	<h1>todos</h1>

	<label>
		add a todo:
		<input
			type="text"
			autocomplete="off"
			on:keydown={async (e) => {
				if (e.key !== 'Enter') return;

				const input = e.currentTarget;
				const description = input.value;
				
				// TODO handle submit

				input.value = '';
			}}
		/>
	</label>

	<ul class="todos">
		{#each data.todos as todo (todo.id)}
			<li>
				<label>
					<input
						type="checkbox"
						checked={todo.done}
						on:change={async (e) => {
							const done = e.currentTarget.checked;

							// TODO handle change
						}}
					/>
					<span>{todo.description}</span>
					<button
						aria-label="Mark as complete"
						on:click={async (e) => {
							// TODO handle delete
						}}
					/>
				</label>
			</li>
		{/each}
	</ul>
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	label {
		display: flex;
		width: 100%;
	}

	input[type="text"] {
		flex: 1;
	}

	span {
		flex: 1;
	}

	button {
		border: none;
		background: url(./remove.svg) no-repeat 50% 50%;
		background-size: 1rem 1rem;
		cursor: pointer;
		height: 100%;
		aspect-ratio: 1;
		opacity: 0.5;
		transition: opacity 0.2s;
	}

	button:hover {
		opacity: 1;
	}
</style>
	
```


####### content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/app-b/src/routes/+page.svelte #######

```

<script>
	export let data;
</script>

<div class="centered">
	<h1>todos</h1>

	<label>
		add a todo:
		<input
			type="text"
			autocomplete="off"
			on:keydown={async (e) => {
				if (e.key !== 'Enter') return;

				const input = e.currentTarget;
				const description = input.value;
				
				const response = await fetch('/todo', {
					method: 'POST',
					body: JSON.stringify({ description }),
					headers: {
						'Content-Type': 'application/json'
					}
				});

				const { id } = await response.json();

				data.todos = [...data.todos, {
					id,
					description
				}];

				input.value = '';
			}}
		/>
	</label>

	<ul class="todos">
		{#each data.todos as todo (todo.id)}
			<li>
				<label>
					<input
						type="checkbox"
						checked={todo.done}
						on:change={async (e) => {
							const done = e.currentTarget.checked;

							// TODO handle change
						}}
					/>
					<span>{todo.description}</span>
					<button
						aria-label="Mark as complete"
						on:click={async (e) => {
							// TODO handle delete
						}}
					/>
				</label>
			</li>
		{/each}
	</ul>
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	label {
		display: flex;
		width: 100%;
	}

	input[type="text"] {
		flex: 1;
	}

	span {
		flex: 1;
	}

	button {
		border: none;
		background: url(./remove.svg) no-repeat 50% 50%;
		background-size: 1rem 1rem;
		cursor: pointer;
		height: 100%;
		aspect-ratio: 1;
		opacity: 0.5;
		transition: opacity 0.2s;
	}

	button:hover {
		opacity: 1;
	}
</style>
	
```


####### content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/app-b/src/routes/todo/+server.js #######

```

import { json } from '@sveltejs/kit';
import * as database from '$lib/server/database.js';

export async function POST({ request, cookies }) {
	const { description } = await request.json();

	const userid = cookies.get('userid');
	const { id } = await database.createTodo({ userid, description });

	return json({ id }, { status: 201 });
}

```


####### content/tutorial/03-sveltekit/07-api-routes/02-post-handlers/README.md #######

---
title: POST handlers
---

You can also add handlers that mutate data, such as `POST`. In most cases, you should use [form actions](the-form-element) instead — you'll end up writing less code, and it'll work without JavaScript, making it more resilient.

Inside the `keydown` event handler of the 'add a todo' `<input>`, let's post some data to the server:

```svelte
/// file: src/routes/+page.svelte
<input
	type="text"
	autocomplete="off"
	on:keydown={async (e) => {
		if (e.key !== 'Enter') return;

		const input = e.currentTarget;
		const description = input.value;

+++		const response = await fetch('/todo', {
			method: 'POST',
			body: JSON.stringify({ description }),
			headers: {
				'Content-Type': 'application/json'
			}
		});+++

		input.value = '';
	}}
/>
```

Here, we're posting some JSON to the `/todo` API route — using a `userid` from the user's cookies — and receiving the `id` of the newly created todo in response.

Create the `/todo` route by adding a `src/routes/todo/+server.js` file with a `POST` handler that calls `createTodo` in `src/lib/server/database.js`:

```js
/// file: src/routes/todo/+server.js
import { json } from '@sveltejs/kit';
import * as database from '$lib/server/database.js';

export async function POST({ request, cookies }) {
	const { description } = await request.json();

	const userid = cookies.get('userid');
	const { id } = await database.createTodo({ userid, description });

	return json({ id }, { status: 201 });
}
```

As with `load` functions and form actions, the `request` is a standard [Request](https://developer.mozilla.org/en-US/docs/Web/API/Request) object; `await request.json()` returns the data that we posted from the event handler.

We're returning a response with a [201 Created](https://http.dog/201) status and the `id` of the newly generated todo in our database. Back in the event handler, we can use this to update the page:

```svelte
/// file: src/routes/+page.svelte
<input
	type="text"
	autocomplete="off"
	on:keydown={async (e) => {
		if (e.key !== 'Enter') return;

		const input = e.currentTarget;
		const description = input.value;

		const response = await fetch('/todo', {
			method: 'POST',
			body: JSON.stringify({ description }),
			headers: {
				'Content-Type': 'application/json'
			}
		});

+++		const { id } = await response.json();

		data.todos = [...data.todos, {
			id,
			description
		}];+++

		input.value = '';
	}}
/>
```

> You should only mutate `data` in such a way that you'd get the same result by reloading the page.

####### content/tutorial/03-sveltekit/07-api-routes/03-other-handlers/app-b/src/routes/+page.svelte #######

```

<script>
	export let data;
</script>

<div class="centered">
	<h1>todos</h1>

	<label>
		add a todo:
		<input
			type="text"
			autocomplete="off"
			on:keydown={async (e) => {
				if (e.key !== 'Enter') return;

				const input = e.currentTarget;
				const description = input.value;
				
				const response = await fetch('/todo', {
					method: 'POST',
					body: JSON.stringify({ description }),
					headers: {
						'Content-Type': 'application/json'
					}
				});

				const { id } = await response.json();

				data.todos = [...data.todos, {
					id,
					description
				}];

				input.value = '';
			}}
		/>
	</label>

	<ul class="todos">
		{#each data.todos as todo (todo.id)}
			<li>
				<label>
					<input
						type="checkbox"
						checked={todo.done}
						on:change={async (e) => {
							const done = e.currentTarget.checked;

							await fetch(`/todo/${todo.id}`, {
								method: 'PUT',
								body: JSON.stringify({ done }),
								headers: {
									'Content-Type': 'application/json'
								}
							});
						}}
					/>
					<span>{todo.description}</span>
					<button
						aria-label="Mark as complete"
						on:click={async (e) => {
							await fetch(`/todo/${todo.id}`, {
								method: 'DELETE'
							});

							data.todos = data.todos.filter((t) => t !== todo);
						}}
					/>
				</label>
			</li>
		{/each}
	</ul>
</div>

<style>
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	label {
		display: flex;
		width: 100%;
	}

	input[type="text"] {
		flex: 1;
	}

	span {
		flex: 1;
	}

	button {
		border: none;
		background: url(./remove.svg) no-repeat 50% 50%;
		background-size: 1rem 1rem;
		cursor: pointer;
		height: 100%;
		aspect-ratio: 1;
		opacity: 0.5;
		transition: opacity 0.2s;
	}

	button:hover {
		opacity: 1;
	}
</style>
	
```


####### content/tutorial/03-sveltekit/07-api-routes/03-other-handlers/app-b/src/routes/todo/[id]/+server.js #######

```

import * as database from '$lib/server/database.js';

export async function PUT({ params, request, cookies }) {
	const { done } = await request.json();
	const userid = cookies.get('userid');

	await database.toggleTodo({ userid, id: params.id, done });
	return new Response(null, { status: 204 });
}

export async function DELETE({ params, cookies }) {
	const userid = cookies.get('userid');

	await database.deleteTodo({ userid, id: params.id });
	return new Response(null, { status: 204 });
}

```


####### content/tutorial/03-sveltekit/07-api-routes/03-other-handlers/README.md #######

---
title: Other handlers
---

Similarly, we can add handlers for other HTTP verbs. Add a `/todo/[id]` route by creating a `src/routes/todo/[id]/+server.js` file with `PUT` and `DELETE` handlers for toggling and removing todos, using the `toggleTodo` and `deleteTodo` functions in `src/lib/server/database.js`:

```js
/// file: src/routes/todo/[id]/+server.js
import * as database from '$lib/server/database.js';

export async function PUT({ params, request, cookies }) {
	const { done } = await request.json();
	const userid = cookies.get('userid');

	await database.toggleTodo({ userid, id: params.id, done });
	return new Response(null, { status: 204 });
}

export async function DELETE({ params, cookies }) {
	const userid = cookies.get('userid');

	await database.deleteTodo({ userid, id: params.id });
	return new Response(null, { status: 204 });
}
```

Since we don't need to return any actual data to the browser, we're returning an empty [Response](https://developer.mozilla.org/en-US/docs/Web/API/Response) with a [204 No Content](https://http.dog/204) status.

We can now interact with this endpoint inside our event handlers:

```svelte
/// file: src/routes/+page.svelte
<label>
	<input
		type="checkbox"
		checked={todo.done}
		on:change={async (e) => {
			const done = e.currentTarget.checked;

+++			await fetch(`/todo/${todo.id}`, {
				method: 'PUT',
				body: JSON.stringify({ done }),
				headers: {
					'Content-Type': 'application/json'
				}
			});+++
		}}
	/>
	<span>{todo.description}</span>
	<button
		aria-label="Mark as complete"
		on:click={async (e) => {
+++			await fetch(`/todo/${todo.id}`, {
				method: 'DELETE'
			});

			data.todos = data.todos.filter((t) => t !== todo);+++
		}}
	/>
</label>
```

####### content/tutorial/03-sveltekit/07-api-routes/meta.json #######

```

{
	"title": "API routes"
}

```


####### content/tutorial/03-sveltekit/08-stores/01-page-store/app-a/src/routes/about/+page.svelte #######

```

<h1>about</h1>
<p>this is the about page.</p>

```


####### content/tutorial/03-sveltekit/08-stores/01-page-store/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">
		home
	</a>

	<a href="/about">
		about
	</a>
</nav>

<slot />

```


####### content/tutorial/03-sveltekit/08-stores/01-page-store/app-a/src/routes/+page.svelte #######

```

<h1>home</h1>
<p>this is the home page.</p>

```


####### content/tutorial/03-sveltekit/08-stores/01-page-store/app-b/src/routes/+layout.svelte #######

```

<script>
	import { page } from '$app/stores';
</script>

<nav>
	<a href="/" aria-current={$page.url.pathname === '/'}>
		home
	</a>

	<a href="/about" aria-current={$page.url.pathname === '/about'}>
		about
	</a>
</nav>

<slot />

```


####### content/tutorial/03-sveltekit/08-stores/01-page-store/README.md #######

---
title: page
---

As we learned [earlier](writable-stores), Svelte stores are a place to put data that doesn't belong to an individual component.

SvelteKit makes three readonly stores available via the `$app/stores` module — `page`, `navigating` and `updated`. The one you'll use most often is [`page`](https://kit.svelte.dev/docs/types#public-types-page), which provides information about the current page:

* `url` — the [URL](https://developer.mozilla.org/en-US/docs/Web/API/URL) of the current page
* `params` — the current page's [parameters](params)
* `route` — an object with an `id` property representing the current route
* `status` — the HTTP status code of the current page
* `error` — the error object of the current page, if any (you'll learn more about error handling in [later](error-basics) [exercises](handleerror))
* `data` — the data for the current page, combining the return values of all `load` functions
* `form` — the data returned from a [form action](the-form-element)

As with any other store, you can reference its value in a component by prefixing its name with the `$` symbol. For example, we can access the current pathname as `$page.url.pathname`:

```svelte
/// file: src/routes/+layout.svelte
+++<script>
	import { page } from '$app/stores';
</script>+++

<nav>
	<a href="/" +++aria-current={$page.url.pathname === '/'}+++>
		home
	</a>

	<a href="/about" +++aria-current={$page.url.pathname === '/about'}+++>
		about
	</a>
</nav>

<slot />
```

####### content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-a/src/routes/about/+page.server.js #######

```

export async function load() {
	return new Promise((fulfil) => {
		setTimeout(fulfil, 1000);
	});
}
```


####### content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-a/src/routes/about/+page.svelte #######

```

<h1>about</h1>
<p>this is the about page.</p>

```


####### content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-a/src/routes/+layout.svelte #######

```

<script>
	import { page } from '$app/stores';
</script>

<nav>
	<a href="/" aria-current={$page.url.pathname === '/'}>
		home
	</a>

	<a href="/about" aria-current={$page.url.pathname === '/about'}>
		about
	</a>
</nav>

<slot />

```


####### content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-a/src/routes/+page.server.js #######

```

export async function load() {
	return new Promise((fulfil) => {
		setTimeout(fulfil, 1000);
	});
}
```


####### content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-a/src/routes/+page.svelte #######

```

<h1>home</h1>
<p>this is the home page.</p>

```


####### content/tutorial/03-sveltekit/08-stores/02-navigating-store/app-b/src/routes/+layout.svelte #######

```

<script>
	import { page, navigating } from '$app/stores';
</script>

<nav>
	<a href="/" aria-current={$page.url.pathname === '/'}>
		home
	</a>

	<a href="/about" aria-current={$page.url.pathname === '/about'}>
		about
	</a>

	{#if $navigating}
		navigating to {$navigating.to.url.pathname}
	{/if}
</nav>

<slot />

```


####### content/tutorial/03-sveltekit/08-stores/02-navigating-store/README.md #######

---
title: navigating
---

The `navigating` store represents the current navigation. When a navigation starts — because of a link click, or a back/forward navigation, or a programmatic `goto` — the value of `navigating` will become an object with the following properties:

- `from` and `to` — objects with `params`, `route` and `url` properties
- `type` — the type of navigation, e.g. `link`, `popstate` or `goto`

> For complete type information visit the [`Navigation`](https://kit.svelte.dev/docs/types#public-types-navigation) documentation.

It can be used to show a loading indicator for long-running navigations. In this exercise, `src/routes/+page.server.js` and `src/routes/about/+page.server.js` both have an artificial delay. Inside `src/routes/+layout.svelte`, import the `navigating` store and add a message to the nav bar:

```svelte
/// file: src/routes/+layout.svelte
<script>
	import { page, +++navigating+++ } from '$app/stores';
</script>

<nav>
	<a href="/" aria-current={$page.url.pathname === '/'}>
		home
	</a>

	<a href="/about" aria-current={$page.url.pathname === '/about'}>
		about
	</a>

+++	{#if $navigating}
		navigating to {$navigating.to.url.pathname}
	{/if}+++
</nav>

<slot />
```

####### content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/src/routes/about/+page.server.js #######

```

export async function load() {
	return new Promise((fulfil) => {
		setTimeout(fulfil, 1000);
	});
}
```


####### content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/src/routes/about/+page.svelte #######

```

<h1>about</h1>
<p>this is the about page.</p>

```


####### content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/src/routes/+layout.svelte #######

```

<script>
	import { page, navigating } from '$app/stores';
</script>

<nav>
	<a href="/" aria-current={$page.url.pathname === '/'}>
		home
	</a>

	<a href="/about" aria-current={$page.url.pathname === '/about'}>
		about
	</a>

	{#if $navigating}
		navigating to {$navigating.to.url.pathname}
	{/if}
</nav>

<slot />

<div class="toast">
	<p>
		A new version of the app is available

		<button on:click={() => location.reload()}>
			reload the page
		</button>
	</p>
</div>

<style>
	.toast {
		position: fixed;
		left: 0;
		bottom: 0;
		width: 100%;
		padding: 1rem;
		display: flex;
		justify-content: center;
		gap: 1rem;
	}

	.toast p {
		display: flex;
		align-items: center;
		gap: 1rem;
		background: var(--bg-2);
		padding: 0.5rem 0.5rem 0.5rem 1rem;
		border-radius: 4px;
	}
</style>


```


####### content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/src/routes/+page.server.js #######

```

export async function load() {
	return new Promise((fulfil) => {
		setTimeout(fulfil, 1000);
	});
}
```


####### content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/src/routes/+page.svelte #######

```

<h1>home</h1>
<p>this is the home page.</p>

```


####### content/tutorial/03-sveltekit/08-stores/03-updated-store/app-a/svelte.config.js #######

```

export default {
	kit: {
		version: {
			// ideally, this should be something deterministic
			// like the output of `git rev-parse HEAD`
			name: Date.now().toString(),

			// if undefined, no polling will occur
			pollInterval: 5000
		}
	}
};
```


####### content/tutorial/03-sveltekit/08-stores/03-updated-store/app-b/src/routes/+layout.svelte #######

```

<script>
	import { page, navigating, updated } from '$app/stores';
</script>

<nav>
	<a href="/" aria-current={$page.url.pathname === '/'}>
		home
	</a>

	<a href="/about" aria-current={$page.url.pathname === '/about'}>
		about
	</a>

	{#if $navigating}
		navigating to {$navigating.to.url.pathname}
	{/if}
</nav>

<slot />

{#if $updated}
	<div class="toast">
		<p>
			A new version of the app is available

			<button on:click={() => location.reload()}>
				reload the page
			</button>
		</p>
	</div>
{/if}

<style>
	.toast {
		position: fixed;
		left: 0;
		bottom: 0;
		width: 100%;
		padding: 1rem;
		display: flex;
		justify-content: center;
		gap: 1rem;
	}

	.toast p {
		display: flex;
		align-items: center;
		gap: 1rem;
		background: var(--bg-2);
		padding: 0.5rem 0.5rem 0.5rem 1rem;
		border-radius: 4px;
	}
</style>


```


####### content/tutorial/03-sveltekit/08-stores/03-updated-store/README.md #######

---
title: updated
---

The `updated` store contains `true` or `false` depending on whether a new version of the app has been deployed since the page was first opened. For this to work, your `svelte.config.js` must specify `kit.version.pollInterval`.

```svelte
/// file: src/routes/+layout.svelte
<script>
	import { page, navigating, +++updated+++ } from '$app/stores';
</script>
```

Version changes only happen in production, not during development. For that reason, `$updated` will always be `false` in this tutorial.

You can manually check for new versions, regardless of `pollInterval`, by calling `updated.check()`.

```svelte
/// file: src/routes/+layout.svelte

+++{#if $updated}+++
	<div class="toast">
		<p>
			A new version of the app is available

			<button on:click={() => location.reload()}>
				reload the page
			</button>
		</p>
	</div>
+++{/if}+++
```

####### content/tutorial/03-sveltekit/08-stores/meta.json #######

```

{
	"title": "Stores"
}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/emojis.js #######

```

export const emojis = {
	// TODO add the rest!
	420: '🫠',
	500: '💥'
};
```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/expected/+page.server.js #######

```

import { error } from '@sveltejs/kit';

export function load() {
	throw error(420, 'Enhance your calm');
}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/expected/+page.svelte #######

```

<h1>This page will never be rendered</h1>

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/expected">page with expected error</a>
	<a href="/unexpected">page with unexpected error</a>
</nav>

<slot />

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/+page.svelte #######

```

<h1>home</h1>

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/unexpected/+page.server.js #######

```

export function load() {
	throw new Error('Kaboom!');
}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/app-a/src/routes/unexpected/+page.svelte #######

```

<h1>This page will never be rendered</h1>

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/01-error-basics/README.md #######

---
title: Basics
---

There are two types of errors in SvelteKit — _expected_ errors and _unexpected_ errors.

An expected error is one that was created with the [`error`](https://kit.svelte.dev/docs/modules#sveltejs-kit-error) helper from `@sveltejs/kit`, as in `src/routes/expected/+page.server.js`:

```js
/// file: src/routes/expected/+page.server.js
import { error } from '@sveltejs/kit';

export function load() {
	throw error(420, 'Enhance your calm');
}
```

Any other error — such as the one in `src/routes/unexpected/+page.server.js` — is treated as unexpected:

```js
/// file: src/routes/unexpected/+page.server.js
export function load() {
	throw new Error('Kaboom!');
}
```

When you throw an expected error, you're telling SvelteKit 'don't worry, I know what I'm doing here'. An unexpected error, by contrast, is assumed to be a bug in your app. When an unexpected error is thrown, its message and stack trace will be logged to the console.

> In a later chapter we'll learn about how to add custom error handling using the `handleError` hook.

If you click the links in this app, you'll notice an important difference: the expected error message is shown to the user, whereas the unexpected error message is redacted and replaced with a generic 'Internal Error' message and a 500 status code. That's because error messages can contain sensitive data.

####### content/tutorial/03-sveltekit/09-errors-and-redirects/02-error-pages/app-b/src/routes/+error.svelte #######

```

<script>
	import { page } from '$app/stores';
	import { emojis } from './emojis.js';
</script>

<h1>{$page.status} {$page.error.message}</h1>
<span style="font-size: 10em">
	{emojis[$page.status] ?? emojis[500]}
</span>

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/02-error-pages/app-b/src/routes/expected/+error.svelte #######

```

<h1>this error was expected</h1>

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/02-error-pages/README.md #######

---
title: Error pages
---

When something goes wrong inside a `load` function, SvelteKit renders an error page.

The default error page is somewhat bland. We can customize it by creating a `src/routes/+error.svelte` component:

```svelte
/// file: src/routes/+error.svelte
<script>
	import { page } from '$app/stores';
	import { emojis } from './emojis.js';
</script>

<h1>{$page.status} {$page.error.message}</h1>
<span style="font-size: 10em">
	{emojis[$page.status] ?? emojis[500]}
</span>
```

Notice that the `+error.svelte` component is rendered inside the root `+layout.svelte`. We can create more granular `+error.svelte` boundaries:

```svelte
/// file: src/routes/expected/+error.svelte
<h1>this error was expected</h1>
```

This component will be rendered for `/expected`, while the root `src/routes/+error.svelte` page will be rendered for any other errors that occur.

####### content/tutorial/03-sveltekit/09-errors-and-redirects/03-fallback-errors/app-b/src/error.html #######

```

<h1>Game over</h1>
<p>Code %sveltekit.status%</p>
<p>%sveltekit.error.message%</p>
```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/03-fallback-errors/app-b/src/routes/+layout.server.js #######

```

export function load() {
	throw new Error('yikes');
}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/03-fallback-errors/README.md #######

---
title: Fallback errors
---

If things go _really_ wrong — an error occurs while loading the root layout data, or while rendering the error page — SvelteKit will fall back to a static error page.

Add a new `src/routes/+layout.server.js` file to see this in action:

```js
/// file: src/routes/+layout.server.js
export function load() {
	throw new Error('yikes');
}
```

You can customise the fallback error page. Create a `src/error.html` file:

```html
/// file: src/error.html
<h1>Game over</h1>
<p>Code %sveltekit.status%</p>
<p>%sveltekit.error.message%</p>
```

This file can include the following:

- `%sveltekit.status%` — the HTTP status code
- `%sveltekit.error.message%` — the error message

####### content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/app-a/src/routes/a/+page.svelte #######

```

<h1>a</h1>

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/app-a/src/routes/b/+page.svelte #######

```

<h1>b</h1>

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/a">a</a>
	<a href="/b">b</a>
</nav>

<slot />

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/app-a/src/routes/+page.svelte #######

```

<p>home</p>

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/app-b/src/routes/a/+page.server.js #######

```

import { redirect } from '@sveltejs/kit';

export function load() {
	throw redirect(307, '/b');
}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/04-redirects/README.md #######

---
title: Redirects
---

We can also use the `throw` mechanism to redirect from one page to another.

Create a new `load` function in `src/routes/a/+page.server.js`:

```js
/// file: src/routes/a/+page.server.js
import { redirect } from '@sveltejs/kit';

export function load() {
	throw redirect(307, '/b');
}
```

Navigating to `/a` will now take us straight to `/b`.

You can `throw redirect(...)` inside `load` functions, form actions, API routes and the `handle` hook, which we'll discuss in a later chapter.

The most common status codes you'll use:

- `303` — for form actions, following a successful submission
- `307` — for temporary redirects
- `308` — for permanent redirects

####### content/tutorial/03-sveltekit/09-errors-and-redirects/meta.json #######

```

{
	"title": "Errors and redirects"
}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/hooks.client.js #######

```

export function handleError() {
	return { message: 'Internal Error' }; // the default implementation of this hook
}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/hooks.server.js #######

```

export function handleError() {
	return { message: 'Internal Error' }; // the default implementation of this hook
}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/routes/about/+page.server.js #######

```

export function load() {
	throw new Error(
		'Something went terribly wrong loading the about page'
	);
}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/routes/about/+page.svelte #######

```

<p>
	This is the best about page of all time. Sad
	that you'll never see it because of the error.
</p>

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/routes/+error.svelte #######

```

<script>
	let online =
		typeof navigator !== 'undefined' ? navigator.onLine : true;
</script>

{#if !online}
	<h1>you're offline</h1>
{:else}
	<h1>oops!</h1>
	<p>Something went wrong</p>
{/if}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/about">about</a>
</nav>

<slot />

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-a/src/routes/+page.svelte #######

```

<p>Welcome</p>

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-b/src/hooks.client.js #######

```

export function handleError({ error }) {
	return { message: error instanceof Error ? error.message : 'Internal Error' };
}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-b/src/hooks.server.js #######

```

export function handleError({ error }) {
	return { message: error instanceof Error ? error.message : 'Internal Error' };
}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/app-b/src/routes/+error.svelte #######

```

<script>
	import { page } from '$app/stores';

	let online =
		typeof navigator !== 'undefined' ? navigator.onLine : true;
</script>

{#if $page.status === 404}
	<h1>Not found</h1>
{:else if !online}
	<h1>You're offline</h1>
{:else}
	<h1>Oops!</h1>
	<p>{$page.error.message}</p>
{/if}

```


####### content/tutorial/03-sveltekit/09-errors-and-redirects/xx-custom-error-messages/README.md #######

---
title: Customizing the error message
---

The error page in the previous exercise is rather static. Maybe you want to show the error message so you can help people turning up in your support channels faster.

For this, SvelteKit provides you with `$page.error` and `$page.status`, which contain information about the error and the status code. Let's add it to `+error.svelte`:

```svelte
/// file: src/routes/+error.svelte
<script>
	+++import { page } from '$app/stores';+++

	let online = typeof navigator !== 'undefined'
		? navigator.onLine
		: true;
</script>

+++{#if $page.status === 404}
	<h1>Not found</h1>
{:else +++if !online}
	<h1>You're offline</h1>
{:else}
	<h1>Oops!</h1>
	---<p>Something went wrong</p>---
	+++<p>{$page.error.message}</p>+++
{/if}
```

That's better, but `$page.error.message` always contains "Internal Error" - how so? This is because SvelteKit plays it safe and prevents you from accidentally showing sensitive information as part of the error message.

To customize it, implement the `handleError` hook in `hooks.server.js` and `hooks.client.js` which run when an unexpected error is thrown during data loads on the server or client respectively.

```js
// hooks.server.js
export function handleError(+++{ error }+++) {
    ---return { message: 'Internal Error' }; // the default implementation of this hook---
    +++return { message: error instanceof Error ? error.message : 'Internal Error' };+++
}
```

```js
// hooks.client.js
export function handleError(+++{ error }+++) {
    ---return { message: 'Internal Error' }; // the default implementation of this hook---
    +++return { message: error instanceof Error ? error.message : 'Internal Error' };+++
}
```

You could also call your error reporting service in these hooks.

Note that you can return more than an error message if you like. Whatever object shape you return will be available in `$page.error`, the only requirement is a `message` property. You can read more about this (and how to make it type-safe!) in the [error docs](https://kit.svelte.dev/docs/errors).

> When handling errors, be careful to not assume it's an `Error` object, anything could be thrown. Also make sure not to expose senstive data by forwarding too much information

####### content/tutorial/03-sveltekit/meta.json #######

```

{
	"title": "Basic SvelteKit",
	"scope": {
		"prefix": "/",
		"name": "project"
	},
	"focus": "/src/routes/+page.svelte"
}

```


####### content/tutorial/04-advanced-sveltekit/01-hooks/01-handle/app-a/src/hooks.server.js #######

```

export async function handle({ event, resolve }) {
	return await resolve(event);
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/01-handle/app-a/src/routes/+page.svelte #######

```

<h1>hello world</h1>
<a href="/ping">ping</a>
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/01-handle/app-b/src/hooks.server.js #######

```

export async function handle({ event, resolve }) {
	if (event.url.pathname === '/ping') {
		return new Response('pong');
	}
	
	return await resolve(event, {
		transformPageChunk: ({ html }) => html.replace(
			'<body',
			'<body style="color: hotpink"'
		)
	});
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/01-handle/README.md #######

---
title: handle
---

SvelteKit provides several _hooks_ — ways to intercept and override the framework's default behaviour.

The most elementary hook is `handle`, which lives in `src/hooks.server.js`. It receives an `event` object along with a `resolve` function, and returns a [`Response`](https://developer.mozilla.org/en-US/docs/Web/API/Response).

`resolve` is where the magic happens: SvelteKit matches the incoming request URL to a route of your app, imports the relevant code (`+page.server.js` and `+page.svelte` files and so on), loads the data needed by the route, and generates the response.

The default `handle` hook looks like this:

```js
/// file: src/hooks.server.js
export async function handle({ event, resolve }) {
	return await resolve(event);
}
```

For pages (as opposed to [API routes](get-handlers)), you can modify the generated HTML with `transformPageChunk`:

```js
/// file: src/hooks.server.js
export async function handle({ event, resolve }) {
	return await resolve(event, {
+++		transformPageChunk: ({ html }) => html.replace(
			'<body',
			'<body style="color: hotpink"'
		)+++
	});
}
```

You can also create entirely new routes:

```js
/// file: src/hooks.server.js
export async function handle({ event, resolve }) {
+++	if (event.url.pathname === '/ping') {
		return new Response('pong');
	}+++

	return await resolve(event, {
		transformPageChunk: ({ html }) => html.replace(
			'<body',
			'<body style="color: hotpink"'
		)
	});
}
```
####### content/tutorial/04-advanced-sveltekit/01-hooks/02-event/app-a/src/hooks.server.js #######

```

export async function handle({ event, resolve }) {
	return await resolve(event);
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/02-event/app-a/src/routes/+page.server.js #######

```

export function load() {
	return {
		message: `the answer is ???`
	};
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/02-event/app-a/src/routes/+page.svelte #######

```

<script>
	export let data;
</script>

<h1>{data.message}</h1>
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/02-event/app-b/src/hooks.server.js #######

```

export async function handle({ event, resolve }) {
	event.locals.answer = 42;
	return await resolve(event);
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/02-event/app-b/src/routes/+page.server.js #######

```

export function load(event) {
	return {
		message: `the answer is ${event.locals.answer}`
	};
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/02-event/README.md #######

---
title: The RequestEvent object
---

The `event` object passed into `handle` is the same object — an instance of a [`RequestEvent`](https://kit.svelte.dev/docs/types#public-types-requestevent) — that is passed into [API routes](get-handlers) in `+server.js` files, [form actions](the-form-element) in `+page.server.js` files, and `load` functions in `+page.server.js` and `+layout.server.js`.

It contains a number of useful properties and methods, some of which we've already encountered:

* `cookies` — the [cookies API](cookies)
* `fetch` — the standard [Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API), with additional powers
* `getClientAddress()` — a function to get the client's IP address
* `isDataRequest` — `true` if the browser is requesting data for a page during client-side navigation, `false` if a page/route is being requested directly
* `locals` — a place to put arbitrary data
* `params` — the route parameters
* `request` — the [Request](https://developer.mozilla.org/en-US/docs/Web/API/Request) object
* `route` — an object with an `id` property representing the route that was matched
* `setHeaders(...)` — a function for [setting HTTP headers](headers) on the response
* `url` — a [URL](https://developer.mozilla.org/en-US/docs/Web/API/URL) object representing the current request

A useful pattern is to add some data to `event.locals` in `handle` so that it can be read in subsequent `load` functions:

```js
/// file: src/hooks.server.js
export async function handle({ event, resolve }) {
	+++event.locals.answer = 42;+++
	return await resolve(event);
}
```

```js
/// file: src/routes/+page.server.js
export function load(+++event+++) {
	return {
		message: `the answer is ${+++event.locals.answer+++}`
	};
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-a/src/hooks.server.js #######

```

export async function handleFetch({ event, request, fetch }) {
	return await fetch(request);
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-a/src/routes/a/+server.js #######

```

export function GET() {
	return new Response('hello from a');
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-a/src/routes/b/+server.js #######

```

export function GET() {
	return new Response('hello from b');
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-a/src/routes/+page.server.js #######

```

export async function load({ fetch }) {
	const response = await fetch('/a');

	return {
		message: await response.text()
	};
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-a/src/routes/+page.svelte #######

```

<script>
	export let data;
</script>

<h1>{data.message}</h1>
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/app-b/src/hooks.server.js #######

```

export async function handleFetch({ event, request, fetch }) {
	const url = new URL(request.url);
	if (url.pathname === '/a') {
		return await fetch('/b');
	}

	return await fetch(request);
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/03-handlefetch/README.md #######

---
title: handleFetch
---

The `event` object has a `fetch` method that behaves like the standard [Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API), but with superpowers:

- it can be used to make credentialed requests on the server, as it inherits the `cookie` and `authorization` headers from the incoming request
- it can make relative requests on the server (ordinarily, `fetch` requires a URL with an origin when used in a server context)
- internal requests (e.g. for `+server.js` routes) go directly to the handler function when running on the server, without the overhead of an HTTP call

Its behaviour can be modified with the `handleFetch` hook, which by default looks like this:

```js
/// file: src/hooks.server.js
export async function handleFetch({ event, request, fetch }) {
	return await fetch(request);
}
```

For example, we could respond to requests for `src/routes/a/+server.js` with responses from `src/routes/b/+server.js` instead:

```js
/// file: src/hooks.server.js
export async function handleFetch({ event, request, fetch }) {
+++	const url = new URL(request.url);
	if (url.pathname === '/a') {
		return await fetch('/b');
	}+++

	return await fetch(request);
}
```

Later, when we cover [universal `load` functions](universal-load-functions), we'll see that `event.fetch` can also be called from the browser. In that scenario, `handleFetch` is useful if you have requests to a public URL like `https://api.yourapp.com` from the browser, that should be redirected to an internal URL (bypassing whatever proxies and load balancers sit between the API server and the public internet) when running on the server.
####### content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/hooks.server.js #######

```

export function handleError({ event, error }) {
	console.error(error.stack);
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/the-good-place">the good place</a>
	<a href="/the-bad-place">the bad place</a>
</nav>

<slot />
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/routes/+page.svelte #######

```

<h1>home</h1>
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/routes/the-bad-place/+page.server.js #######

```

export function load() {
	throw new Error('this is the bad place!');
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/routes/the-bad-place/+page.svelte #######

```

<h1>you are in the bad place</h1>
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-a/src/routes/the-good-place/+page.svelte #######

```

<h1>you are in the good place</h1>
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-b/src/hooks.server.js #######

```

export function handleError({ event, error }) {
	console.error(error.stack);

	return {
		message: 'everything is fine',
		code: 'JEREMYBEARIMY'
	};
}
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/app-b/src/routes/+error.svelte #######

```

<script>
	import { page } from '$app/stores';
</script>

<h1>{$page.status}</h1>
<p>{$page.error.message}</p>
<p>error code: {$page.error.code}</p>
```


####### content/tutorial/04-advanced-sveltekit/01-hooks/04-handleerror/README.md #######

---
title: handleError
---

The `handleError` hook lets you intercept unexpected errors and trigger some behaviour, like pinging a Slack channel or sending data to an error logging service.

As you'll recall from an [earlier exercise](error-basics), an error is _unexpected_ if it wasn't created with the `error` helper from `@sveltejs/kit`. It generally means something in your app needs fixing. The default behaviour is to log the error:

```js
/// file: src/hooks.server.js
export function handleError({ event, error }) {
	console.error(error.stack);
}
```

If you navigate to `/the-bad-place`, you'll see this in action — the error page is shown, and if you open the terminal (using the button to the right of the URL bar), you'll see the message from `src/routes/the-bad-place/+page.server.js`.

Notice that we're _not_ showing the error message to the user. That's because error messages can include sensitive information that at best will confuse your users, and at worst could benefit evildoers. Instead, the error object available to your application — represented as `$page.error` in your `+error.svelte` pages, or `%sveltekit.error%` in your `src/error.html` fallback — is just this:

```js
/// no-file
{
	message: 'Internal Error' // or 'Not Found' for a 404
}
```

In some situations you may want to customise this object. To do so, you can return an object from `handleError`:

```js
/// file: src/hooks.server.js
export function handleError({ event, error }) {
	console.error(error.stack);

	return {
		message: 'everything is fine',
		code: 'JEREMYBEARIMY'
	};
}
```

You can now reference properties other than `message` in a custom error page. Create `src/routes/+error.svelte`:

```svelte
/// file: src/routes/+error.svelte
<script>
	import { page } from '$app/stores';
</script>

<h1>{$page.status}</h1>
<p>{$page.error.message}</p>
<p>error code: {$page.error.code}</p>
```

####### content/tutorial/04-advanced-sveltekit/01-hooks/meta.json #######

```

{
	"title": "Hooks"
}

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/01-page-options/app-a/src/routes/+page.svelte #######

```

<h2>Page options</h2>

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/01-page-options/README.md #######

---
title: Basics
---

In the chapter on [loading data](/tutorial/page-data), we saw how you can export `load` functions from `+page.js`, `+page.server.js`, `+layout.js` and `+layout.server.js` files. We can also export various **page options** from these modules:

- `ssr` — whether or not pages should be server-rendered
- `csr` — whether to load the SvelteKit client
- `prerender` — whether to prerender pages at build time, instead of per-request
- `trailingSlash` — whether to strip, add, or ignore trailing slashes in URLs

In the following exercises, we'll learn about each of these in turn.

Page options can apply to individual pages (if exported from `+page.js` or `+page.server.js`), or groups of pages (if exported from `+layout.js` or `+layout.server.js`). To define an option for the whole app, export it from the root layout. Child layouts and pages override values set in parent layouts, so — for example — you can enable prerendering for your entire app then disable it for pages that need to be dynamically rendered.

You can mix and match these options in different areas of your app — you could prerender your marketing pages, dynamically server-render your data-driven pages, and treat your admin pages as a client-rendered SPA. This makes SvelteKit very versatile.

####### content/tutorial/04-advanced-sveltekit/02-page-options/02-ssr/app-a/src/routes/+page.svelte #######

```

<h1>{window.innerWidth}x{window.innerHeight}</h1>

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/02-ssr/app-b/src/routes/+page.server.js #######

```

export const ssr = false;

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/02-ssr/README.md #######

---
title: ssr
---

Server-side rendering (SSR) is the process of generating HTML on the server, and is what SvelteKit does by default. It's important for performance and [resilience](https://kryogenix.org/code/browser/everyonehasjs.html), and is very beneficial for search engine optimization (SEO) — while some search engines can index content that is rendered in the browser with JavaScript, it happens less frequently and reliably.

That said, some components _can't_ be rendered on the server, perhaps because they expect to be able to access browser globals like `window` immediately. If you can, you should change those components so that they _can_ render on the server, but if you can't then you can disable SSR:

```js
/// file: src/routes/+page.server.js
export const ssr = false;
```

> Setting `ssr` to `false` inside your root `+layout.server.js` effectively turns your entire app into a single-page app (SPA).

####### content/tutorial/04-advanced-sveltekit/02-page-options/03-csr/app-a/src/routes/+page.svelte #######

```

<script>
	import { browser } from '$app/environment';

	let count = 0;

	function increment() {
		count += 1;
	}
</script>

<h1>Rendered {browser ? 'in the browser' : 'on the server'}</h1>

<button on:click={increment}>
	Clicks: {count}
</button>

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/03-csr/app-b/src/routes/+page.server.js #######

```

export const csr = false;

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/03-csr/README.md #######

---
title: csr
---

Client-side rendering is what makes the page interactive — such as incrementing the counter when you click the button in this app — and enables SvelteKit to update the page upon navigation without a full-page reload.

As with `ssr`, you can disable client-side rendering altogether:

```js
/// file: src/routes/+page.server.js
export const csr = false;
```

This means that no JavaScript is served to the client, but it also means that your components are no longer interactive. It can be a useful way to check whether or not your application is usable for people who — for whatever reason — cannot use JavaScript.

####### content/tutorial/04-advanced-sveltekit/02-page-options/04-prerender/app-a/src/routes/+page.svelte #######

```

<h1>Prerendering</h1>

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/04-prerender/app-b/src/routes/+page.server.js #######

```

export const prerender = true;

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/04-prerender/README.md #######

---
title: prerender
---

Prerendering means generating HTML for a page once, at build time, rather than dynamically for each request.

The advantage is that serving static data is extremely cheap and performant, allowing you to easily serve large numbers of users without worrying about cache-control headers (which are easy to get wrong).

The tradeoff is that the build process takes longer, and prerendered content can only be updated by building and deploying a new version of the application.

To prerender a page, set `prerender` to `true`:

```js
/// file: src/routes/+page.server.js
export const prerender = true;
```

Here in the tutorial, this won't have any observable effect, since the application is running in `dev` mode.

Not all pages can be prerendered. The basic rule is this: for content to be prerenderable, any two users hitting it directly must get the same content from the server, and the page must not contain form actions. Pages with dynamic route parameters can be prerendered as long as they are specified in the [`prerender.entries`](https://kit.svelte.dev/docs/configuration#prerender) configuration or can be reached by following links from pages that _are_ in `prerender.entries`.

> Setting `prerender` to `true` inside your root `+layout.server.js` effectively turns SvelteKit into a static site generator (SSG).

####### content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-a/src/routes/always/+page.svelte #######

```

<h1>always</h1>

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-a/src/routes/ignore/+page.svelte #######

```

<h1>ignore</h1>

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/always">/always</a>
	<a href="/always/">/always/</a>
	<a href="/ignore">/ignore</a>
	<a href="/ignore/">/ignore/</a>
	<a href="/never">/never</a>
	<a href="/never/">/never/</a>
</nav>

<slot />

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-a/src/routes/never/+page.svelte #######

```

<h1>never</h1>

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-a/src/routes/+page.svelte #######

```

<h1>trailingSlash</h1>

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-b/src/routes/always/+page.server.js #######

```

export const trailingSlash = 'always';

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/app-b/src/routes/ignore/+page.server.js #######

```

export const trailingSlash = 'ignore';

```


####### content/tutorial/04-advanced-sveltekit/02-page-options/05-trailingslash/README.md #######

---
title: trailingSlash
---

Two URLs like `/foo` and `/foo/` might look the same, but they're actually different. A relative URL like `./bar` will resolve to `/bar` in the first case and `/foo/bar` in the second, and search engines will treat them as separate entries, harming your SEO.

In short, being loosey-goosey about trailing slashes is a bad idea. By default, SvelteKit strips trailing slashes, meaning that a request for `/foo/` will result in a redirect to `/foo`.

If you instead want to ensure that a trailing slash is always present, you can specify the `trailingSlash` option accordingly:

```js
/// file: src/routes/always/+page.server.js
export const trailingSlash = 'always';
```

To accommodate both cases (this is not recommended!), use `'ignore'`:

```js
/// file: src/routes/ignore/+page.server.js
export const trailingSlash = 'ignore';
```

The default value is `'never'`.

Whether or not trailing slashes are applied affects prerendering. A URL like `/always/` will be saved to disk as `always/index.html` whereas a URL like `/never` will be saved as `never.html`.

####### content/tutorial/04-advanced-sveltekit/02-page-options/meta.json #######

```

{
	"title": "Page options"
}

```


####### content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/+layout.svelte #######

```

<script>
	import { navigating } from '$app/stores';

	let previous;
	let start;
	let end;

	$: if ($navigating) {
		start = Date.now();
		end = null;
		previous = $navigating;
	} else {
		end = Date.now();
	}
</script>

<nav>
	<a href="/">home</a>
	<a href="/slow-a">slow-a</a>
	<a href="/slow-b">slow-b</a>
</nav>

<slot />

{#if previous && end}
	<p>navigated from {previous.from.url.pathname} to {previous.to.url.pathname} in <strong>{end - start}ms</strong></p>
{/if}
```


####### content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/+page.svelte #######

```

<h1>home</h1>
```


####### content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/slow-a/+page.server.js #######

```

export async function load() {
	await new Promise((fulfil) => {
		setTimeout(fulfil, 1000);
	});
}
```


####### content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/slow-a/+page.svelte #######

```

<h1>slow (a)</h1>
```


####### content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/slow-b/+page.server.js #######

```

export async function load() {
	await new Promise((fulfil) => {
		setTimeout(fulfil, 1000);
	});
}
```


####### content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-a/src/routes/slow-b/+page.svelte #######

```

<h1>slow (b)</h1>
```


####### content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/app-b/src/routes/+layout.svelte #######

```

<script>
	import { navigating } from '$app/stores';

	let previous;
	let start;
	let end;

	$: if ($navigating) {
		start = Date.now();
		end = null;
		previous = $navigating;
	} else {
		end = Date.now();
	}
</script>

<nav>
	<a href="/">home</a>
	<a href="/slow-a" data-sveltekit-preload-data>slow-a</a>
	<a href="/slow-b">slow-b</a>
</nav>

<slot />

{#if previous && end}
<p>navigated from {previous.from.url.pathname} to {previous.to.url.pathname} in <strong>{end - start}ms</strong></p>
{/if}
```


####### content/tutorial/04-advanced-sveltekit/03-link-options/01-preload/README.md #######

---
title: Preloading
---

In this exercise, the `/slow-a` and `/slow-b` routes both have artificial delays in their `load` functions, meaning it takes a long time to navigate to them.

You can't always make your data load more quickly — sometimes it's out of your control — but SvelteKit can speed up navigations by _anticipating_ them. When an `<a>` element has a `data-sveltekit-preload-data` attribute, SvelteKit will begin the navigation as soon as the user hovers over the link (on desktop) or taps it (on mobile). Try adding it to the first link:

```svelte
/// file: src/routes/+layout.svelte
<nav>
	<a href="/">home</a>
	<a href="/slow-a" +++data-sveltekit-preload-data+++>slow-a</a>
	<a href="/slow-b">slow-b</a>
</nav>
```

Navigating to `/slow-a` will now be noticeably faster. Starting navigation on hover or tap (rather than waiting for a `click` event to be registered) might not sound like it makes much difference, but in practice it typically saves 200ms or more. That's enough to be the difference between sluggish and snappy.

You can put the attribute on individual links, or on any element that _contains_ links. The default project template includes the attribute on the `<body>` element:

```html
/// no-file
<body data-sveltekit-preload-data>
	%sveltekit.body%
</body>
```

You can customise the behaviour further by specifying one of the following values for the attribute:

- `"hover"` (default, falls back to `"tap"` on mobile)
- `"tap"` — only begin preloading on tap
- `"off"` — disable preloading

Using `data-sveltekit-preload-data` may sometimes result in false positives - i.e. loading data in anticipation of a navigation that doesn't then happen — which might be undesirable. As an alternative, `data-sveltekit-preload-code` allows you to preload the JavaScript needed by a given route without eagerly loading its data. This attribute can have the following values:

- `"eager"` — preload everything on the page following a navigation
- `"viewport"` — preload everything as it appears in the viewport
- `"hover"` (default) as above
- `"tap"` — as above
- `"off"` — as above

You can also initiate preloading programmatically with `preloadCode` and `preloadData` imported from `$app/navigation`:

```js
/// no-file
import { preloadCode, preloadData } from '$app/navigation';

// preload the code and data needed to navigate to /foo
preloadData('/foo');

// preload the code needed to navigate to /bar, but not the data
preloadCode('/bar');
```
####### content/tutorial/04-advanced-sveltekit/03-link-options/02-reload/app-a/src/routes/about/+page.svelte #######

```

<h1>about</h1>
<p>this is the about page.</p>

```


####### content/tutorial/04-advanced-sveltekit/03-link-options/02-reload/app-a/src/routes/+layout.svelte #######

```

<script>
	import { onMount } from 'svelte';

	let seconds = 0;

	onMount(() => {
		const interval = setInterval(() => {
			seconds += 1;
		}, 1000);

		return () => {
			clearInterval(interval);
		};
	});
</script>

<nav>
	<a href="/">home</a>
	<a href="/about">about</a>
</nav>

<slot />

<p>the page has been open for {seconds} seconds</p>

```


####### content/tutorial/04-advanced-sveltekit/03-link-options/02-reload/app-a/src/routes/+page.svelte #######

```

<h1>home</h1>
<p>this is the home page.</p>

```


####### content/tutorial/04-advanced-sveltekit/03-link-options/02-reload/app-b/src/routes/+layout.svelte #######

```

<script>
	import { onMount } from 'svelte';

	let seconds = 0;

	onMount(() => {
		const interval = setInterval(() => {
			seconds += 1;
		}, 1000);

		return () => {
			clearInterval(interval);
		};
	});
</script>

<nav data-sveltekit-reload>
	<a href="/">home</a>
	<a href="/about">about</a>
</nav>

<slot />

<p>the page has been open for {seconds} seconds</p>

```


####### content/tutorial/04-advanced-sveltekit/03-link-options/02-reload/README.md #######

---
title: Reloading the page
---

Ordinarily, SvelteKit will navigate between pages without refreshing the page. In this exercise, if we navigate between `/` and `/about`, the timer keeps on ticking.

In rare cases, you might want to disable this behaviour. You can do so by adding the `data-sveltekit-reload` attribute on an individual link, or any element that contains links:

```svelte
/// file: src/routes/+layout.svelte
<nav +++data-sveltekit-reload+++>
	<a href="/">home</a>
	<a href="/about">about</a>
</nav>
```

For more information on available link options and their values, consult the [link options documentation](https://kit.svelte.dev/docs/link-options).
####### content/tutorial/04-advanced-sveltekit/03-link-options/meta.json #######

```

{
	"title": "Link options"
}
```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-a/src/routes/[lang]/+page.server.js #######

```

const greetings = {
	en: 'hello!',
	de: 'hallo!',
	fr: 'bonjour!'
};

export function load({ params }) {
	return {
		greeting: greetings[params.lang]
	};
}

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-a/src/routes/[lang]/+page.svelte #######

```

<script>
	export let data;
</script>

<h1>{data.greeting}</h1>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">default</a>
	<a href="/en">english</a>
	<a href="/de">german</a>
	<a href="/fr">french</a>
</nav>

<slot />

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-a/src/routes/+page.svelte #######

```

<h1>hello!</h1>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-b/src/routes/[lang]/__delete #######

```


```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-b/src/routes/[[lang]]/+page.server.js #######

```

const greetings = {
	en: 'hello!',
	de: 'hallo!',
	fr: 'bonjour!'
};

export function load({ params }) {
	return {
		greeting: greetings[params.lang ?? 'en']
	};
}

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-b/src/routes/[[lang]]/+page.svelte #######

```

<script>
	export let data;
</script>

<h1>{data.greeting}</h1>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/app-b/src/routes/+page.svelte #######

```

__delete;

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/01-optional-params/README.md #######

---
title: Optional parameters
---

In the first chapter on [routing](/tutorial/pages), we learned how to create routes with [dynamic parameters](/tutorial/params).

Sometimes it's helpful to make a parameter optional. A classic example is when you use the pathname to determine the locale — `/fr/...`, `/de/...` and so on — but you also want to have a default locale.

To do that, we use double brackets. Rename the `[lang]` directory to `[[lang]]`.

The app now fails to build, because `src/routes/+page.svelte` and `src/routes/[[lang]]/+page.svelte` would both match `/`. Delete `src/routes/+page.svelte`. (You may need to reload the app to recover from the error page).

Lastly, edit `src/routes/[[lang]]/+page.server.js` to specify the default locale:

```js
/// file: src/routes/[[lang]]/+page.server.js
const greetings = {
	en: 'hello!',
	de: 'hallo!',
	fr: 'bonjour!'
};

export function load({ params }) {
	return {
		greeting: greetings[params.lang +++?? 'en'+++]
	};
}
```

####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/02-rest-params/app-a/src/routes/+page.svelte #######

```

__delete
```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/02-rest-params/app-a/src/routes/[path]/+page.svelte #######

```

<script>
	import { page } from '$app/stores';

	let words = ['how', 'deep', 'does', 'the', 'rabbit', 'hole', 'go'];

	$: depth = $page.params.path.split('/').filter(Boolean).length;
	$: next = depth === words.length ? '/' : `/${words.slice(0, depth + 1).join('/')}`;
</script>

<div class="flex">
	{#each words.slice(0, depth) as word}
		<p>{word}</p>
	{/each}

	<p><a href={next}>{words[depth] ?? '?'}</a></p>
</div>

<style>
	.flex {
		display: flex;
		height: 100%;
		flex-direction: column;
		align-items: center;
		justify-content: center;
	}

	p {
		margin: 0.5rem 0;
		line-height: 1;
	}

	a {
		display: flex;
		width: 100%;
		height: 100%;
		align-items: center;
		justify-content: center;
		font-size: 4rem;
	}
</style>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/02-rest-params/app-b/src/routes/[path]/__delete #######

```


```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/02-rest-params/app-b/src/routes/[...path]/+page.svelte #######

```

<script>
	import { page } from '$app/stores';

	let words = ['how', 'deep', 'does', 'the', 'rabbit', 'hole', 'go'];

	$: depth = $page.params.path.split('/').filter(Boolean).length;
	$: next = depth === words.length ? '/' : `/${words.slice(0, depth + 1).join('/')}`;
</script>

<div class="flex">
	{#each words.slice(0, depth) as word}
		<p>{word}</p>
	{/each}

	<p><a href={next}>{words[depth] ?? '?'}</a></p>
</div>

<style>
	.flex {
		display: flex;
		height: 100%;
		flex-direction: column;
		align-items: center;
		justify-content: center;
	}

	p {
		margin: 0.5rem 0;
		line-height: 1;
	}

	a {
		display: flex;
		width: 100%;
		height: 100%;
		align-items: center;
		justify-content: center;
		font-size: 4rem;
	}
</style>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/02-rest-params/README.md #######

---
title: Rest parameters
path: /how
focus: /src/routes/[path]/+page.svelte
---

To match an unknown number of path segments, use a `[...rest]` parameter, so named for its resemblance to [rest parameters in JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters).

Rename `src/routes/[path]` to `src/routes/[...path]`. The route now matches any path.

> Other, more specific routes will be tested first, making rest parameters useful as 'catch-all' routes. For example, if you needed a custom 404 page for pages inside `/categories/...`, you could add these files:
>
> ```diff
> src/routes/
> ├ categories/
> │ ├ animal/
> │ ├ mineral/
> │ ├ vegetable/
> +│ ├ [...catchall]/
> +│ │ ├ +error.svelte
> +│ │ └ +page.server.js
> ```
>
> Inside the `+page.server.js` file, `throw error(404)` inside `load`.

Rest parameters do _not_ need to go at the end — a route like `/items/[...path]/edit` or `/items/[...path].json` is totally valid.
####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-a/src/routes/colors/[color]/+page.svelte #######

```

<script>
	import { page } from '$app/stores';
</script>

<div class="color" style="--color: #{$page.params.color}">
	<span>#{$page.params.color}</span>
</div>

<style>
	.color {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		display: flex;
		align-items: center;
		justify-content: center;
		background-color: var(--color);
		transition: background-color 0.2s;
	}

	span {
		mix-blend-mode: soft-light;
		color: black;
		font-size: 4em;
	}
</style>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-a/src/routes/+layout.svelte #######

```

<script>
	const colors = ['ff3e00', '676779', '42b4ff', 'invalid'];
</script>

<nav>
	{#each colors as color}
		<a href="/colors/{color}" style="--color: #{color}">#{color}</a>
	{/each}
</nav>

<slot />

<style>
	a {
		display: flex;
		align-items: center;
		gap: 0.5rem;
	}

	a::before {
		content: '';
		width: 2em;
		height: 2em;
		background: var(--color);
	}
</style>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-a/src/routes/+page.svelte #######

```

<h1>color picker</h1>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-b/src/params/hex.js #######

```

export function match(value) {
	return /^[0-9a-f]{6}$/.test(value);
}

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-b/src/routes/colors/[color]/__delete #######

```


```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/app-b/src/routes/colors/[color=hex]/+page.svelte #######

```

<script>
	import { page } from '$app/stores';
</script>

<div class="color" style="--color: #{$page.params.color}">
	<span>#{$page.params.color}</span>
</div>

<style>
	.color {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		display: flex;
		align-items: center;
		justify-content: center;
		background-color: var(--color);
		transition: background-color 0.2s;
	}

	span {
		mix-blend-mode: soft-light;
		color: black;
		font-size: 4em;
	}
</style>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/03-param-matchers/README.md #######

---
title: Param matchers
path: /colors/ff3e00
---

To prevent the router from matching on invalid input, you can specify a _matcher_. For example, you might want a route like `/colors/[value]` to match hex values like `/colors/ff3e00` but not named colors like `/colors/octarine` or any other arbitrary input.

First, create a new file called `src/params/hex.js` and export a `match` function from it:

```js
/// file: src/params/hex.js
export function match(value) {
	return /^[0-9a-f]{6}$/.test(value);
}
```

Then, to use the new matcher, rename `src/routes/colors/[color]` to `src/routes/colors/[color=hex]`.

Now, whenever someone navigates to that route, SvelteKit will verify that `color` is a valid `hex` value. If not, SvelteKit will try to match other routes, before eventually returning a 404.

> Matchers run both on the server and in the browser.

####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/about/+page.svelte #######

```

<h1>about</h1>

<p>this is the about page.</p>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/account/+page.svelte #######

```

<h1>account</h1>

<p>this is the account page</p>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/app/+page.svelte #######

```

<h1>app</h1>

<p>this is the app</p>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/about">about</a>
	<a href="/account">account</a>
	<a href="/app">app</a>
</nav>

<slot />

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/login/+page.server.js #######

```

import { redirect } from '@sveltejs/kit';

export const actions = {
	default: ({ cookies, url }) => {
		cookies.set('logged_in', 'true', { path: '/' });
		throw redirect(303, url.searchParams.get('redirectTo') ?? '/');
	}
};

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/login/+page.svelte #######

```

<h1>log in</h1>

<form method="POST">
	<button>log in</button>
</form>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/logout/+page.server.js #######

```

import { redirect } from '@sveltejs/kit';

export const actions = {
	default: ({ cookies }) => {
		cookies.delete('logged_in', { path: '/' });
		throw redirect(303, '/');
	}
};

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-a/src/routes/+page.svelte #######

```

<h1>home</h1>

<p>this is the home page.</p>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/account/__delete #######

```

<h1>account</h1>

<p>this is the account page</p>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/app/__delete #######

```

<h1>account</h1>

<p>this is the account page</p>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/(authed)/account/+page.svelte #######

```

<h1>account</h1>

<p>this is the account page</p>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/(authed)/app/+page.svelte #######

```

<h1>app</h1>

<p>this is the app</p>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/(authed)/+layout.server.js #######

```

import { redirect } from '@sveltejs/kit';

export function load({ cookies, url }) {
	if (!cookies.get('logged_in')) {
		throw redirect(303, `/login?redirectTo=${url.pathname}`);
	}
}

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/app-b/src/routes/(authed)/+layout.svelte #######

```

<slot />

<form method="POST" action="/logout">
	<button>log out</button>
</form>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/04-route-groups/README.md #######

---
title: Route groups
---

As we saw in the [routing introduction](/tutorial/layouts), layouts are a way to share UI and data loading logic between different routes.

Sometimes it's useful to use layouts without affecting the route — for example, you might need your `/app` and `/account` routes to be behind authentication, while your `/about` page is open to the world. We can do this with a _route group_, which is a directory in parentheses.

Create an `(authed)` group by renaming `account` to `(authed)/account` then renaming `app` to `(authed)/app`.

Now we can control access to these routes by creating `src/routes/(authed)/+layout.server.js`:

```js
/// file: src/routes/(authed)/+layout.server.js
import { redirect } from '@sveltejs/kit';

export function load({ cookies, url }) {
	if (!cookies.get('logged_in')) {
		throw redirect(303, `/login?redirectTo=${url.pathname}`);
	}
}
```

If you try to visit these pages, you'll be redirected to the `/login` route, which has a form action in `src/routes/login/+page.server.js` that sets the `logged_in` cookie.

We can also add some UI to these two routes by adding a `src/routes/(authed)/+layout.svelte` file:

```svelte
/// file: src/routes/(authed)/+layout.svelte
<slot />

<form method="POST" action="/logout">
	<button>log out</button>
</form>
```

####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/b/c/+layout.svelte #######

```

<div class="layout" data-name="c">
	<slot />
</div>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/b/c/+page.svelte #######

```

<h1>c</h1>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/b/+layout.svelte #######

```

<div class="layout" data-name="b">
	<slot />
</div>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/b/+page.svelte #######

```

<h1>b</h1>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/+layout.svelte #######

```

<div class="layout" data-name="a">
	<slot />
</div>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/a/+page.svelte #######

```

<h1>a</h1>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/">home</a>
	<a href="/a">a</a>
	<a href="/a/b">a/b</a>
	<a href="/a/b/c">a/b/c</a>
</nav>

<div class="layout" data-name="root">
	<slot />
</div>

<style>
	:global(.layout) {
		position: relative;
		border: 1px solid #999;
		padding: 1em;
		margin: 1em 0 0 0;
		border-radius: 4px;
	}

	:global(.layout::before) {
		position: absolute;
		content: attr(data-name) ' layout';
		left: 1em;
		top: -1em;
		background-color: white;
		color: #222;
		padding: 0.5em;
		line-height: 1;
	}

	@media (prefers-color-scheme: dark) {
		:global(.layout::before) {
			background: #2e2e2e;
			color: #e6e6e6;
		}
	}
</style>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-a/src/routes/+page.svelte #######

```

<h1>home</h1>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-b/src/routes/a/b/c/+page.svelte #######

```

__delete;

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/app-b/src/routes/a/b/c/+page@.svelte #######

```

<h1>c</h1>

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/meta.json #######

```

{
    "editing_constraints": {
        "create": ["/src/routes/a/b/c/+page@b.svelte", "/src/routes/a/b/c/+page@a.svelte"] 
    }
}

```


####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/05-breaking-out-of-layouts/README.md #######

---
title: Breaking out of layouts
---

Ordinarily, a page inherits every layout above it, meaning that `src/routes/a/b/c/+page.svelte` inherits four layouts:

- `src/routes/+layout.svelte`
- `src/routes/a/+layout.svelte`
- `src/routes/a/b/+layout.svelte`
- `src/routes/a/b/c/+layout.svelte`

Occasionally, it's useful to break out of the current layout hierarchy. We can do that by adding the `@` sign followed by the name of the parent segment to 'reset' to — for example `+page@b.svelte` would put `/a/b/c` inside `src/routes/a/b/+layout.svelte`, while `+page@a.svelte` would put it inside `src/routes/a/+layout.svelte`.

Let's reset it all the way to the root layout, by renaming it to `+page@.svelte`.

> The root layout applies to every page of your app, you cannot break out of it.

####### content/tutorial/04-advanced-sveltekit/04-advanced-routing/meta.json #######

```

{
	"title": "Advanced routing"
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/blue/blue.svelte #######

```

<marquee>hello from blue.svelte</marquee>
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/blue/+page.server.js #######

```

import component from './blue.svelte';

export function load() {
	return {
		color: 'blue',
		component
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/blue/+page.svelte #######

```

<h1>blue</h1>
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/green/green.svelte #######

```

<marquee>hello from green.svelte</marquee>
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/green/+page.server.js #######

```

import component from './green.svelte';

export function load() {
	return {
		color: 'green',
		component
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/green/+page.svelte #######

```

<h1>green</h1>
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/+layout.svelte #######

```

<script>
	import { page } from '$app/stores';
</script>

<nav
	class:has-color={!!$page.data.color}
	style:background={$page.data.color ?? 'var(--bg-2)'}
>
	<a href="/">home</a>
	<a href="/red">red</a>
	<a href="/green">green</a>
	<a href="/blue">blue</a>
</nav>

<slot />

<style>
	nav.has-color,
	nav.has-color a {
		color: white;
	}
</style>
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/+page.svelte #######

```

<h1>pick a colour</h1>
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/red/+page.server.js #######

```

import component from './red.svelte';

export function load() {
	return {
		color: 'red',
		component
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/red/+page.svelte #######

```

<h1>red</h1>
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-a/src/routes/red/red.svelte #######

```

<marquee>hello from red.svelte</marquee>
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/blue/+page.js #######

```

import component from './blue.svelte';

export function load() {
	return {
		color: 'blue',
		component
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/blue/+page.server.js #######

```

__delete
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/green/+page.js #######

```

import component from './green.svelte';

export function load() {
	return {
		color: 'green',
		component
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/green/+page.server.js #######

```

__delete
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/+layout.svelte #######

```

<script>
	import { page } from '$app/stores';
</script>

<nav
	class:has-color={!!$page.data.color}
	style:background={$page.data.color ?? 'var(--bg-2)'}
>
	<a href="/">home</a>
	<a href="/red">red</a>
	<a href="/green">green</a>
	<a href="/blue">blue</a>

	{#if $page.data.component}
		<svelte:component this={$page.data.component} />
	{/if}
</nav>

<slot />

<style>
	nav.has-color,
	nav.has-color a {
		color: white;
	}
</style>
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/red/+page.js #######

```

import component from './red.svelte';

export function load() {
	return {
		color: 'red',
		component
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/app-b/src/routes/red/+page.server.js #######

```

__delete
```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/01-universal-load-functions/README.md #######

---
title: Universal load functions
---

In the [previous section on loading](page-data) we loaded data from the server using `+page.server.js` and `+layout.server.js` files. This is very convenient if you need to do things like getting data directly from a database, or reading cookies.

Sometimes it doesn't make sense to load data from the server when doing a client-side navigation. For example:

- You're loading data from an external API
- You want to use in-memory data if it's available
- You want to delay navigation until an image has been preloaded, to avoid pop-in
- You need to return something from `load` that can't be serialized (SvelteKit uses [devalue](https://github.com/Rich-Harris/devalue) to turn server data into JSON), such as a component or a store

In this exercise, we're dealing with the latter case. The server `load` functions in `src/routes/red/+page.server.js`, `src/routes/green/+page.server.js` and `src/routes/blue/+page.server.js` return a `component` constructor, which can't be serialized like data. If you navigate to `/red`, `/green` or `/blue`, you'll see a 'Data returned from `load` ... is not serializable' error in the terminal.

To turn the server `load` functions into universal `load` functions, rename each `+page.server.js` file to `+page.js`. Now, the functions will run on the server during server-side rendering, but will also run in the browser when the app hydrates or the user performs a client-side navigation.

We can now use the `component` returned from these `load` functions like any other value, including in `src/routes/+layout.svelte`:

```svelte
/// file: src/routes/+layout.svelte
<nav
	class:has-color={!!$page.data.color}
	style:background={$page.data.color ?? 'var(--bg-2)'}
>
	<a href="/">home</a>
	<a href="/red">red</a>
	<a href="/green">green</a>
	<a href="/blue">blue</a>

+++	{#if $page.data.component}
		<svelte:component this={$page.data.component} />
	{/if}+++
</nav>
```

Read the [documentation](https://kit.svelte.dev/docs/load#universal-vs-server) to learn more about the distinction between server `load` functions and universal `load` functions, and when to use which.

####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-a/src/routes/BoringComponent.svelte #######

```

<script>
	export let message;
</script>

<h1>{message}</h1>

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-a/src/routes/CoolComponent.svelte #######

```

<script>
	export let message;
</script>

<marquee>
	<h1>{message}</h1>
</marquee>

<style>
	marquee {
		font-family: 'Comic Sans MS';
		color: #e60073;
	}
</style>

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-a/src/routes/+page.js #######

```

export async function load() {
	const module = false
		? await import('./CoolComponent.svelte')
		: await import('./BoringComponent.svelte');

	return {
		component: module.default,
		message: 'TODO add a message'
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-a/src/routes/+page.server.js #######

```

export async function load() {
	return {
		message: 'this data came from the server',
		cool: true
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-a/src/routes/+page.svelte #######

```

<script>
	export let data;
</script>

<svelte:component this={data.component} message={data.message} />

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/app-b/src/routes/+page.js #######

```

export async function load({ data }) {
	const module = data.cool
		? await import('./CoolComponent.svelte')
		: await import('./BoringComponent.svelte');

	return {
		component: module.default,
		message: data.message
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/02-using-both-load-functions/README.md #######

---
title: Using both load functions
---

Occasionally, you might need to use a server load function and a universal load function together. For example, you might need to return data from the server, but also return a value that can't be serialized as server data.

In this example we want to return a different component from `load` depending on whether the data we got from `src/routes/+page.server.js` is `cool` or not.

We can access server data in `src/routes/+page.js` via the `data` property:

```js
/// file: src/routes/+page.js
export async function load(+++{ data }+++) {
	const module = +++data.cool+++
		? await import('./CoolComponent.svelte')
		: await import('./BoringComponent.svelte');

	return {
		component: module.default,
		message: +++data.message+++
	};
}
```

> Note that the data isn't merged — we must explicitly return `message` from the universal `load` function.

####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-a/src/routes/+layout.server.js #######

```

export async function load() {
	return {};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-a/src/routes/+page.svelte #######

```

<p>if a = 1 and b = a + 1, what is a + b?</p>
<a href="/sum">show answer</a>

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-a/src/routes/sum/+layout.js #######

```

export async function load() {
	return {};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-a/src/routes/sum/+page.js #######

```

export async function load() {
	return {};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-a/src/routes/sum/+page.svelte #######

```

<script>
	export let data;
</script>

<p>{data.a} + {data.b} = {data.c}</p>
<p><a href="/">home</a></p>

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-b/src/routes/+layout.server.js #######

```

export async function load() {
	return { a: 1 };
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-b/src/routes/sum/+layout.js #######

```

export async function load({ parent }) {
	const { a } = await parent();
	return { b: a + 1 };
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/app-b/src/routes/sum/+page.js #######

```

export async function load({ parent }) {
	const { a, b } = await parent();
	return { c: a + b };
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/03-await-parent/README.md #######

---
title: Using parent data
---

As we saw in the introduction to [layout data](/tutorial/layout-data), `+page.svelte` and `+layout.svelte` components have access to everything returned from their parent `load` functions.

Occasionally it's useful for the `load` functions themselves to access data from their parents. This can be done with `await parent()`.

To show how it works, we'll sum two numbers that come from different `load` functions. First, return some data from `src/routes/+layout.server.js`:

```js
/// file: src/routes/+layout.server.js
export function load() {
	return { +++a: 1+++ };
}
```

Then, get that data in `src/routes/sum/+layout.js`:

```js
/// file: src/routes/sum/+layout.js
export async function load(+++{ parent }+++) {
	+++const { a } = await parent();+++
	return { +++b: a + 1+++ };
}
```

> Notice that a [universal](/tutorial/universal-load-functions) `load` function can get data from a parent _server_ `load` function. The reverse is not true — a server load function can only get parent data from another server load function.

Finally, in `src/routes/sum/+page.js`, get parent data from both `load` functions:

```js
/// file: src/routes/sum/+page.js
export async function load(+++{ parent }+++) {
	+++const { a, b } = await parent();+++
	return { +++c: a + b+++ };
}
```

> Take care not to introduce waterfalls when using `await parent()`. If you can `fetch` other data that is not dependent on parent data, do that first.

####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-a/src/routes/api/now/+server.js #######

```

import { json } from '@sveltejs/kit';

export function GET() {
	return json(Date.now());
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-a/src/routes/+layout.js #######

```

export async function load({ fetch }) {
	const response = await fetch('/api/now');
	const now = await response.json();

	return {
		now
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-a/src/routes/+layout.svelte #######

```

<nav>
	<a href="/America/New_York">New York</a>
	<a href="/America/Sao_Paulo">São Paulo</a>
	<a href="/Europe/London">London</a>
	<a href="/Europe/Paris">Paris</a>
	<a href="/Africa/Cairo">Cairo</a>
	<a href="/Asia/Shanghai">Shanghai</a>
	<a href="/Asia/Tokyo">Tokyo</a>
	<a href="/Australia/Sydney">Sydney</a>
	<a href="/America/Los_Angeles">Los Angeles</a>
</nav>

<slot />

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-a/src/routes/[...timezone]/+page.js #######

```

export function load({ params }) {
	return {
		timezone: params.timezone
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-a/src/routes/[...timezone]/+page.svelte #######

```

<script>
	export let data;
</script>

<h1>
	{new Intl.DateTimeFormat([], {
		timeStyle: 'full',
		timeZone: data.timezone
	}).format(new Date(data.now))}
</h1>

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/app-b/src/routes/[...timezone]/+page.svelte #######

```

<script>
	import { onMount } from 'svelte';
	import { invalidate } from '$app/navigation';

	export let data;

	onMount(() => {
		const interval = setInterval(() => {
			invalidate('/api/now');
		}, 1000);

		return () => {
			clearInterval(interval);
		};
	});
</script>

<h1>
	{new Intl.DateTimeFormat([], {
		timeStyle: 'full',
		timeZone: data.timezone
	}).format(new Date(data.now))}
</h1>

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/04-invalidation/README.md #######

---
title: Invalidation
path: /Europe/London
---

When the user navigates from one page to another, SvelteKit calls your `load` functions, but only if it thinks something has changed.

In this example, navigating between timezones causes the `load` function in `src/routes/[...timezone]/+page.js` to re-run because `params.timezone` is invalid. But the `load` function in `src/routes/+layout.js` does _not_ re-run, because as far as SvelteKit is concerned it wasn't invalidated by the navigation.

We can fix that by manually invalidating it using the [`invalidate(...)`](https://kit.svelte.dev/docs/modules#$app-navigation-invalidate) function, which takes a URL and re-runs any `load` functions that depend on it. Because the `load` function in `src/routes/+layout.js` calls `fetch('/api/now')`, it depends on `/api/now`.

In `src/routes/[...timezone]/+page.svelte`, add an `onMount` callback that calls `invalidate('/api/now')` once a second:

```svelte
/// file: src/routes/[...timezone]/+page.svelte
<script>
	+++import { onMount } from 'svelte';+++
	+++import { invalidate } from '$app/navigation';+++

	export let data;

+++	onMount(() => {
		const interval = setInterval(() => {
			invalidate('/api/now');
		}, 1000);

		return () => {
			clearInterval(interval);
		};
	});+++
</script>

<h1>
	{new Intl.DateTimeFormat([], {
		timeStyle: 'full',
		timeZone: data.timezone
	}).format(new Date(data.now))}
</h1>
```

> You can also pass a function to `invalidate`, in case you want to invalidate based on a pattern and not specific URLs

####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/05-custom-dependencies/app-b/src/routes/+layout.js #######

```

export async function load({ depends }) {
	depends('data:now');

	return {
		now: Date.now()
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/05-custom-dependencies/app-b/src/routes/[...timezone]/+page.svelte #######

```

<script>
	import { onMount } from 'svelte';
	import { invalidate } from '$app/navigation';

	export let data;

	onMount(() => {
		const interval = setInterval(() => {
			invalidate('data:now');
		}, 1000);

		return () => {
			clearInterval(interval);
		};
	});
</script>

<h1>
	{new Intl.DateTimeFormat([], {
		timeStyle: 'full',
		timeZone: data.timezone
	}).format(new Date(data.now))}
</h1>

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/05-custom-dependencies/README.md #######

---
title: Custom dependencies
path: /Europe/London
---

Calling `fetch(url)` inside a `load` function registers `url` as a dependency. Sometimes it's not appropriate to use `fetch`, in which case you can specify a dependency manually with the [`depends(url)`](https://kit.svelte.dev/docs/load#invalidation-manual-invalidation) function.

Since any string that begins with an `[a-z]+:` pattern is a valid URL, we can create custom invalidation keys like `data:now`.

Update `src/routes/+layout.js` to return a value directly rather than making a `fetch` call, and add the `depends`:

```js
/// file: src/routes/+layout.js
export async function load({ +++depends+++ }) {
	+++depends('data:now');+++

	return {
		now: +++Date.now()+++
	};
}
```

Now, update the `invalidate` call in `src/routes/[...timezone]/+page.svelte`:

```svelte
/// file: src/routes/[...timezone]/+page.svelte
<script>
	import { onMount } from 'svelte';
	import { invalidate } from '$app/navigation';

	export let data;

	onMount(() => {
		const interval = setInterval(() => {
			invalidate(+++'data:now'+++);
		}, 1000);

		return () => {
			clearInterval(interval);
		};
	});
</script>
```

####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/06-invalidate-all/app-b/src/routes/+layout.js #######

```

export async function load() {
	return {
		now: Date.now()
	};
}

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/06-invalidate-all/app-b/src/routes/[...timezone]/+page.svelte #######

```

<script>
	import { onMount } from 'svelte';
	import { invalidateAll } from '$app/navigation';

	export let data;

	onMount(() => {
		const interval = setInterval(() => {
			invalidateAll();
		}, 1000);

		return () => {
			clearInterval(interval);
		};
	});
</script>

<h1>
	{new Intl.DateTimeFormat([], {
		timeStyle: 'full',
		timeZone: data.timezone
	}).format(new Date(data.now))}
</h1>

```


####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/06-invalidate-all/README.md #######

---
title: invalidateAll
path: /Europe/London
---

Finally, there's the nuclear option — `invalidateAll()`. This will indiscriminately re-run all `load` functions for the current page, regardless of what they depend on.

Update `src/routes/[...timezone]/+page.svelte` from the previous exercise:

```svelte
/// file: src/routes/[...timezone]/+page.svelte
<script>
	import { onMount } from 'svelte';
	import { +++invalidateAll+++ } from '$app/navigation';

	export let data;

	onMount(() => {
		const interval = setInterval(() => {
			+++invalidateAll();+++
		}, 1000);

		return () => {
			clearInterval(interval);
		};
	});
</script>
```

The `depends` call in `src/routes/+layout.js` is no longer necessary:

```js
/// file: src/routes/+layout.js
export async function load(---{ depends }---) {
	---depends('data:now');---

	return {
		now: Date.now()
	};
}
```

> `invalidate(() => true)` and `invalidateAll` are _not_ the same. `invalidateAll` also re-runs `load` functions without any `url` dependencies, which `invalidate(() => true)` does not.

####### content/tutorial/04-advanced-sveltekit/05-advanced-loading/meta.json #######

```

{
	"title": "Advanced loading"
}

```


####### content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/app-a/src/routes/+page.server.js #######

```

import { redirect, fail } from '@sveltejs/kit';

export function load({ cookies }) {
	if (cookies.get('allowed')) {
		throw redirect(307, '/welcome');
	}
}

export const actions = {
	default: async ({ request, cookies }) => {
		const data = await request.formData();

		if (data.get('passphrase') === 'TODO') {
			cookies.set('allowed', 'true', {
				path: '/'
			});

			throw redirect(303, '/welcome');
		}

		return fail(403, {
			incorrect: true
		});
	}
};

```


####### content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/app-a/src/routes/+page.svelte #######

```

<script>
	export let form;
</script>

<form method="POST">
	<label>
		enter the passphrase
		<input name="passphrase" autocomplete="off" />
	</label>
</form>

{#if form?.incorrect}
	<p class="error">wrong passphrase!</p>
{/if}

<style>
	.error {
		color: red;
	}
</style>

```


####### content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/app-a/src/routes/welcome/+page.server.js #######

```

import { redirect } from '@sveltejs/kit';
import { error } from '@sveltejs/kit';

export function load({ cookies }) {
	if (!cookies.get('allowed')) {
		throw error(403, 'Forbidden');
	}
}

export const actions = {
	default: ({ cookies }) => {
		cookies.delete('allowed', { path: '/' });
		throw redirect(303, '/');
	}
};

```


####### content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/app-a/src/routes/welcome/+page.svelte #######

```

<h1>welcome!</h1>

<form method="POST">
	<button>log out</button>
</form>

```


####### content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/app-b/src/routes/+page.server.js #######

```

import { redirect, fail } from '@sveltejs/kit';
import { PASSPHRASE } from '$env/static/private';

export function load({ cookies }) {
	if (cookies.get('allowed')) {
		throw redirect(307, '/welcome');
	}
}

export const actions = {
	default: async ({ request, cookies }) => {
		const data = await request.formData();

		if (data.get('passphrase') === PASSPHRASE) {
			cookies.set('allowed', 'true', {
				path: '/'
			});

			throw redirect(303, '/welcome');
		}

		return fail(403, {
			incorrect: true
		});
	}
};

```


####### content/tutorial/04-advanced-sveltekit/06-environment-variables/01-env-static-private/README.md #######

---
title: $env/static/private
---

Environment variables — like API keys and database credentials — can be added to a `.env` file, and they will be made available to your application.

> You can also use `.env.local` or `.env.[mode]` files — see the [Vite documentation](https://vitejs.dev/guide/env-and-mode.html#env-files) for more information. Make sure you add any files containing sensitive information to your `.gitignore` file!
>
> Environment variables in `process.env` are also available via `$env/static/private`.

In this exercise, we want to allow the user to enter the website if they know the correct passphrase, using an environment variable.

First, in `.env`, add a new environment variable:

```env
/// file: .env
PASSPHRASE=+++"open sesame"+++
```

Open `src/routes/+page.server.js`. Import `PASSPHRASE` from `$env/static/private` and use it inside the [form action](/tutorial/the-form-element):

```js
/// file: src/routes/+page.server.js
import { redirect, fail } from '@sveltejs/kit';
+++import { PASSPHRASE } from '$env/static/private';+++

export function load({ cookies }) {
	if (cookies.get('allowed')) {
		throw redirect(307, '/welcome');
	}
}

export const actions = {
	default: async ({ request, cookies }) => {
		const data = await request.formData();

		if (data.get('passphrase') === +++PASSPHRASE+++) {
			cookies.set('allowed', 'true', {
				path: '/'
			});

			throw redirect(303, '/welcome');
		}

		return fail(403, {
			incorrect: true
		});
	}
};
```

The website is now accessible to anyone who knows the correct passphrase.

## Keeping secrets

It's important that sensitive data doesn't accidentally end up being sent to the browser, where it could easily be stolen by hackers and scoundrels.

SvelteKit makes it easy to prevent this from happening. Notice what happens if we try to import `PASSPHRASE` into `src/routes/+page.svelte`:

```svelte
/// file: src/routes/+page.svelte
<script>
	+++import { PASSPHRASE } from '$env/static/private';+++
	export let form;
</script>
```

An error overlay pops up, telling us that `$env/static/private` cannot be imported into client-side code. It can only be imported into server modules:

- `+page.server.js`
- `+layout.server.js`
- `+server.js`
- any modules ending with `.server.js`
- any modules inside `src/lib/server`

In turn, these modules can only be imported by _other_ server modules.

## Static vs dynamic

The `static` in `$env/static/private` indicates that these values are known at build time, and can be _statically replaced_. This enables useful optimisations:

```js
/// no-file
import { FEATURE_FLAG_X } from '$env/static/private';

if (FEATURE_FLAG_X === 'enabled') {
	// code in here will be removed from the build output
	// if FEATURE_FLAG_X is not enabled
}
```

In some cases you might need to refer to environment variables that are _dynamic_ — in other words, not known until we run the app. We'll cover this case in the next exercise.

####### content/tutorial/04-advanced-sveltekit/06-environment-variables/02-env-dynamic-private/app-b/src/routes/+page.server.js #######

```

import { redirect, fail } from '@sveltejs/kit';
import { env } from '$env/dynamic/private';

export function load({ cookies }) {
	if (cookies.get('allowed')) {
		throw redirect(307, '/welcome');
	}
}

export const actions = {
	default: async ({ request, cookies }) => {
		const data = await request.formData();

		if (data.get('passphrase') === env.PASSPHRASE) {
			cookies.set('allowed', 'true', {
				path: '/'
			});

			throw redirect(303, '/welcome');
		}

		return fail(403, {
			incorrect: true
		});
	}
};

```


####### content/tutorial/04-advanced-sveltekit/06-environment-variables/02-env-dynamic-private/README.md #######

---
title: $env/dynamic/private
---

If you need to read the values of environment variables when the app runs, as opposed to when the app is built, you can use `$env/dynamic/private` instead of `$env/static/private`:

```js
/// file: src/routes/+page.server.js
import { redirect, fail } from '@sveltejs/kit';
import { +++env+++ } from '$env/+++dynamic+++/private';

export function load({ cookies }) {
	if (cookies.get('allowed')) {
		throw redirect(307, '/welcome');
	}
}

export const actions = {
	default: async ({ request, cookies }) => {
		const data = await request.formData();

		if (data.get('passphrase') === +++env.+++PASSPHRASE) {
			cookies.set('allowed', 'true', {
				path: '/'
			});

			throw redirect(303, '/welcome');
		}

		return fail(403, {
			incorrect: true
		});
	}
};

```

####### content/tutorial/04-advanced-sveltekit/06-environment-variables/03-env-static-public/app-a/src/routes/+page.svelte #######

```

<script>
	const PUBLIC_THEME_BACKGROUND = 'white';
	const PUBLIC_THEME_FOREGROUND = 'black';
</script>

<main
	style:background={PUBLIC_THEME_BACKGROUND}
	style:color={PUBLIC_THEME_FOREGROUND}
>
	{PUBLIC_THEME_FOREGROUND} on {PUBLIC_THEME_BACKGROUND}
</main>

<style>
	main {
		position: fixed;
		display: flex;
		align-items: center;
		justify-content: center;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		font-size: 10vmin;
	}
</style>

```


####### content/tutorial/04-advanced-sveltekit/06-environment-variables/03-env-static-public/app-b/src/routes/+page.svelte #######

```

<script>
	import {
		PUBLIC_THEME_BACKGROUND,
		PUBLIC_THEME_FOREGROUND
	} from '$env/static/public';
</script>

<main
	style:background={PUBLIC_THEME_BACKGROUND}
	style:color={PUBLIC_THEME_FOREGROUND}
>
	{PUBLIC_THEME_FOREGROUND} on {PUBLIC_THEME_BACKGROUND}
</main>

<style>
	main {
		position: fixed;
		display: flex;
		align-items: center;
		justify-content: center;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		font-size: 10vmin;
	}
</style>

```


####### content/tutorial/04-advanced-sveltekit/06-environment-variables/03-env-static-public/README.md #######

---
title: $env/static/public
---

Some environment variables _can_ be safely exposed to the browser. These are distinguished from private environment variables with a `PUBLIC_` prefix.

Add values to the two public environment variables in `.env`:

```env
/// file: .env
PUBLIC_THEME_BACKGROUND=+++"steelblue"+++
PUBLIC_THEME_FOREGROUND=+++"bisque"+++
```

Then, import them into `src/routes/+page.svelte`:

```svelte
/// file: src/routes/+page.svelte
<script>
---	const PUBLIC_THEME_BACKGROUND = 'white';
	const PUBLIC_THEME_FOREGROUND = 'black';---
+++	import {
		PUBLIC_THEME_BACKGROUND,
		PUBLIC_THEME_FOREGROUND
	} from '$env/static/public';+++
</script>
```

####### content/tutorial/04-advanced-sveltekit/06-environment-variables/04-env-dynamic-public/app-b/src/routes/+page.svelte #######

```

<script>
	import { env } from '$env/dynamic/public';
</script>

<main
	style:background={env.PUBLIC_THEME_BACKGROUND}
	style:color={env.PUBLIC_THEME_FOREGROUND}
>
	{env.PUBLIC_THEME_FOREGROUND} on {env.PUBLIC_THEME_BACKGROUND}
</main>

<style>
	main {
		position: fixed;
		display: flex;
		align-items: center;
		justify-content: center;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		font-size: 10vmin;
	}
</style>

```


####### content/tutorial/04-advanced-sveltekit/06-environment-variables/04-env-dynamic-public/README.md #######

---
title: $env/dynamic/public
---

As with [private environment variables](/tutorial/env-static-private), it's preferable to use static values if possible, but if necessary we can use dynamic values instead:

```svelte
/// file: src/routes/+page.svelte
<script>
	import { +++env+++ } from '$env/+++dynamic+++/public';
</script>

<main
	style:background={+++env.+++PUBLIC_THEME_BACKGROUND}
	style:color={+++env.+++PUBLIC_THEME_FOREGROUND}
>
	{+++env.+++PUBLIC_THEME_FOREGROUND} on {+++env.+++PUBLIC_THEME_BACKGROUND}
</main>
```

####### content/tutorial/04-advanced-sveltekit/06-environment-variables/meta.json #######

```

{
	"title": "Environment variables"
}

```


####### content/tutorial/04-advanced-sveltekit/07-conclusion/01-next-steps/app-a/src/routes/+page.svelte #######

```

<span>the end</span>

<style>
	span {
		width: 100%;
		height: 100%;
		display: flex;
		justify-content: center;
		align-items: center;
		font-size: 4em;
	}
</style>
```


####### content/tutorial/04-advanced-sveltekit/07-conclusion/01-next-steps/README.md #######

---
title: Next steps
---

Congratulations! If you've made it the entire way through this tutorial, you can now consider yourself a Svelte and SvelteKit expert.

You can start building apps on your own machine with the [`create-svelte`](https://www.npmjs.com/package/create-svelte) package:

```bash
/// no-file
npm create svelte@latest
```

Svelte and SvelteKit will continue to evolve, and so will this tutorial. Check back periodically for updates.

To keep up with developments in the Svelte world, join our Discord server at [svelte.dev/chat](https://svelte.dev/chat) and follow [Svelte Society](https://twitter.com/sveltesociety) on Twitter. We're so happy to welcome you to the Svelte community!

####### content/tutorial/04-advanced-sveltekit/07-conclusion/meta.json #######

```

{
	"title": "Conclusion"
}
```


####### content/tutorial/04-advanced-sveltekit/meta.json #######

```

{
	"title": "Advanced SvelteKit",
	"scope": {
		"prefix": "/",
		"name": "project"
	},
	"focus": "/src/routes/+page.svelte"
}

```


####### content/tutorial/common/package.json #######

```

{
	"name": "tutorial",
	"version": "0.0.1",
	"scripts": {
		"dev": "./node_modules/vite/bin/vite.js dev",
		"build": "./node_modules/vite/bin/vite.js build",
		"preview": "./node_modules/vite/bin/vite.js preview"
	},
	"devDependencies": {
		"@sveltejs/kit": "^1.20.4",
		"esbuild-wasm": "^0.18.9",
		"svelte": "^4.0.0",
		"vite": "^4.3.9"
	},
	"type": "module"
}

```


####### content/tutorial/common/package-lock.json #######

```

{
	"name": "tutorial",
	"version": "0.0.1",
	"lockfileVersion": 3,
	"requires": true,
	"packages": {
		"": {
			"name": "tutorial",
			"version": "0.0.1",
			"devDependencies": {
				"@sveltejs/kit": "^1.20.4",
				"esbuild-wasm": "^0.18.9",
				"svelte": "^4.0.0",
				"vite": "^4.3.9"
			}
		},
		"node_modules/@ampproject/remapping": {
			"version": "2.2.1",
			"resolved": "https://registry.npmjs.org/@ampproject/remapping/-/remapping-2.2.1.tgz",
			"integrity": "sha512-lFMjJTrFL3j7L9yBxwYfCq2k6qqwHyzuUl/XBnif78PWTJYyL/dfowQHWE3sp6U6ZzqWiiIZnpTMO96zhkjwtg==",
			"dev": true,
			"dependencies": {
				"@jridgewell/gen-mapping": "^0.3.0",
				"@jridgewell/trace-mapping": "^0.3.9"
			},
			"engines": {
				"node": ">=6.0.0"
			}
		},
		"node_modules/@esbuild/android-arm": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.17.16.tgz",
			"integrity": "sha512-baLqRpLe4JnKrUXLJChoTN0iXZH7El/mu58GE3WIA6/H834k0XWvLRmGLG8y8arTRS9hJJibPnF0tiGhmWeZgw==",
			"cpu": [
				"arm"
			],
			"dev": true,
			"optional": true,
			"os": [
				"android"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/android-arm64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.17.16.tgz",
			"integrity": "sha512-QX48qmsEZW+gcHgTmAj+x21mwTz8MlYQBnzF6861cNdQGvj2jzzFjqH0EBabrIa/WVZ2CHolwMoqxVryqKt8+Q==",
			"cpu": [
				"arm64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"android"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/android-x64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.17.16.tgz",
			"integrity": "sha512-G4wfHhrrz99XJgHnzFvB4UwwPxAWZaZBOFXh+JH1Duf1I4vIVfuYY9uVLpx4eiV2D/Jix8LJY+TAdZ3i40tDow==",
			"cpu": [
				"x64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"android"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/darwin-arm64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.17.16.tgz",
			"integrity": "sha512-/Ofw8UXZxuzTLsNFmz1+lmarQI6ztMZ9XktvXedTbt3SNWDn0+ODTwxExLYQ/Hod91EZB4vZPQJLoqLF0jvEzA==",
			"cpu": [
				"arm64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"darwin"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/darwin-x64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.17.16.tgz",
			"integrity": "sha512-SzBQtCV3Pdc9kyizh36Ol+dNVhkDyIrGb/JXZqFq8WL37LIyrXU0gUpADcNV311sCOhvY+f2ivMhb5Tuv8nMOQ==",
			"cpu": [
				"x64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"darwin"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/freebsd-arm64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.17.16.tgz",
			"integrity": "sha512-ZqftdfS1UlLiH1DnS2u3It7l4Bc3AskKeu+paJSfk7RNOMrOxmeFDhLTMQqMxycP1C3oj8vgkAT6xfAuq7ZPRA==",
			"cpu": [
				"arm64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"freebsd"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/freebsd-x64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.17.16.tgz",
			"integrity": "sha512-rHV6zNWW1tjgsu0dKQTX9L0ByiJHHLvQKrWtnz8r0YYJI27FU3Xu48gpK2IBj1uCSYhJ+pEk6Y0Um7U3rIvV8g==",
			"cpu": [
				"x64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"freebsd"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/linux-arm": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.17.16.tgz",
			"integrity": "sha512-n4O8oVxbn7nl4+m+ISb0a68/lcJClIbaGAoXwqeubj/D1/oMMuaAXmJVfFlRjJLu/ZvHkxoiFJnmbfp4n8cdSw==",
			"cpu": [
				"arm"
			],
			"dev": true,
			"optional": true,
			"os": [
				"linux"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/linux-arm64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.17.16.tgz",
			"integrity": "sha512-8yoZhGkU6aHu38WpaM4HrRLTFc7/VVD9Q2SvPcmIQIipQt2I/GMTZNdEHXoypbbGao5kggLcxg0iBKjo0SQYKA==",
			"cpu": [
				"arm64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"linux"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/linux-ia32": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.17.16.tgz",
			"integrity": "sha512-9ZBjlkdaVYxPNO8a7OmzDbOH9FMQ1a58j7Xb21UfRU29KcEEU3VTHk+Cvrft/BNv0gpWJMiiZ/f4w0TqSP0gLA==",
			"cpu": [
				"ia32"
			],
			"dev": true,
			"optional": true,
			"os": [
				"linux"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/linux-loong64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.17.16.tgz",
			"integrity": "sha512-TIZTRojVBBzdgChY3UOG7BlPhqJz08AL7jdgeeu+kiObWMFzGnQD7BgBBkWRwOtKR1i2TNlO7YK6m4zxVjjPRQ==",
			"cpu": [
				"loong64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"linux"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/linux-mips64el": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.17.16.tgz",
			"integrity": "sha512-UPeRuFKCCJYpBbIdczKyHLAIU31GEm0dZl1eMrdYeXDH+SJZh/i+2cAmD3A1Wip9pIc5Sc6Kc5cFUrPXtR0XHA==",
			"cpu": [
				"mips64el"
			],
			"dev": true,
			"optional": true,
			"os": [
				"linux"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/linux-ppc64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.17.16.tgz",
			"integrity": "sha512-io6yShgIEgVUhExJejJ21xvO5QtrbiSeI7vYUnr7l+v/O9t6IowyhdiYnyivX2X5ysOVHAuyHW+Wyi7DNhdw6Q==",
			"cpu": [
				"ppc64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"linux"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/linux-riscv64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.17.16.tgz",
			"integrity": "sha512-WhlGeAHNbSdG/I2gqX2RK2gfgSNwyJuCiFHMc8s3GNEMMHUI109+VMBfhVqRb0ZGzEeRiibi8dItR3ws3Lk+cA==",
			"cpu": [
				"riscv64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"linux"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/linux-s390x": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.17.16.tgz",
			"integrity": "sha512-gHRReYsJtViir63bXKoFaQ4pgTyah4ruiMRQ6im9YZuv+gp3UFJkNTY4sFA73YDynmXZA6hi45en4BGhNOJUsw==",
			"cpu": [
				"s390x"
			],
			"dev": true,
			"optional": true,
			"os": [
				"linux"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/linux-x64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.17.16.tgz",
			"integrity": "sha512-mfiiBkxEbUHvi+v0P+TS7UnA9TeGXR48aK4XHkTj0ZwOijxexgMF01UDFaBX7Q6CQsB0d+MFNv9IiXbIHTNd4g==",
			"cpu": [
				"x64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"linux"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/netbsd-x64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.17.16.tgz",
			"integrity": "sha512-n8zK1YRDGLRZfVcswcDMDM0j2xKYLNXqei217a4GyBxHIuPMGrrVuJ+Ijfpr0Kufcm7C1k/qaIrGy6eG7wvgmA==",
			"cpu": [
				"x64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"netbsd"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/openbsd-x64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.17.16.tgz",
			"integrity": "sha512-lEEfkfsUbo0xC47eSTBqsItXDSzwzwhKUSsVaVjVji07t8+6KA5INp2rN890dHZeueXJAI8q0tEIfbwVRYf6Ew==",
			"cpu": [
				"x64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"openbsd"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/sunos-x64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.17.16.tgz",
			"integrity": "sha512-jlRjsuvG1fgGwnE8Afs7xYDnGz0dBgTNZfgCK6TlvPH3Z13/P5pi6I57vyLE8qZYLrGVtwcm9UbUx1/mZ8Ukag==",
			"cpu": [
				"x64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"sunos"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/win32-arm64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.17.16.tgz",
			"integrity": "sha512-TzoU2qwVe2boOHl/3KNBUv2PNUc38U0TNnzqOAcgPiD/EZxT2s736xfC2dYQbszAwo4MKzzwBV0iHjhfjxMimg==",
			"cpu": [
				"arm64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"win32"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/win32-ia32": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.17.16.tgz",
			"integrity": "sha512-B8b7W+oo2yb/3xmwk9Vc99hC9bNolvqjaTZYEfMQhzdpBsjTvZBlXQ/teUE55Ww6sg//wlcDjOaqldOKyigWdA==",
			"cpu": [
				"ia32"
			],
			"dev": true,
			"optional": true,
			"os": [
				"win32"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@esbuild/win32-x64": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.17.16.tgz",
			"integrity": "sha512-xJ7OH/nanouJO9pf03YsL9NAFQBHd8AqfrQd7Pf5laGyyTt/gToul6QYOA/i5i/q8y9iaM5DQFNTgpi995VkOg==",
			"cpu": [
				"x64"
			],
			"dev": true,
			"optional": true,
			"os": [
				"win32"
			],
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/@jridgewell/gen-mapping": {
			"version": "0.3.3",
			"resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.3.tgz",
			"integrity": "sha512-HLhSWOLRi875zjjMG/r+Nv0oCW8umGb0BgEhyX3dDX3egwZtB8PqLnjz3yedt8R5StBrzcg4aBpnh8UA9D1BoQ==",
			"dev": true,
			"dependencies": {
				"@jridgewell/set-array": "^1.0.1",
				"@jridgewell/sourcemap-codec": "^1.4.10",
				"@jridgewell/trace-mapping": "^0.3.9"
			},
			"engines": {
				"node": ">=6.0.0"
			}
		},
		"node_modules/@jridgewell/resolve-uri": {
			"version": "3.1.0",
			"resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.0.tgz",
			"integrity": "sha512-F2msla3tad+Mfht5cJq7LSXcdudKTWCVYUgw6pLFOOHSTtZlj6SWNYAp+AhuqLmWdBO2X5hPrLcu8cVP8fy28w==",
			"dev": true,
			"engines": {
				"node": ">=6.0.0"
			}
		},
		"node_modules/@jridgewell/set-array": {
			"version": "1.1.2",
			"resolved": "https://registry.npmjs.org/@jridgewell/set-array/-/set-array-1.1.2.tgz",
			"integrity": "sha512-xnkseuNADM0gt2bs+BvhO0p78Mk762YnZdsuzFV018NoG1Sj1SCQvpSqa7XUaTam5vAGasABV9qXASMKnFMwMw==",
			"dev": true,
			"engines": {
				"node": ">=6.0.0"
			}
		},
		"node_modules/@jridgewell/sourcemap-codec": {
			"version": "1.4.15",
			"resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.4.15.tgz",
			"integrity": "sha512-eF2rxCRulEKXHTRiDrDy6erMYWqNw4LPdQ8UQA4huuxaQsVeRPFl2oM8oDGxMFhJUWZf9McpLtJasDDZb/Bpeg==",
			"dev": true
		},
		"node_modules/@jridgewell/trace-mapping": {
			"version": "0.3.18",
			"resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.18.tgz",
			"integrity": "sha512-w+niJYzMHdd7USdiH2U6869nqhD2nbfZXND5Yp93qIbEmnDNk7PD48o+YchRVpzMU7M6jVCbenTR7PA1FLQ9pA==",
			"dev": true,
			"dependencies": {
				"@jridgewell/resolve-uri": "3.1.0",
				"@jridgewell/sourcemap-codec": "1.4.14"
			}
		},
		"node_modules/@jridgewell/trace-mapping/node_modules/@jridgewell/sourcemap-codec": {
			"version": "1.4.14",
			"resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.4.14.tgz",
			"integrity": "sha512-XPSJHWmi394fuUuzDnGz1wiKqWfo1yXecHQMRf2l6hztTO+nPru658AyDngaBe7isIxEkRsPR3FZh+s7iVa4Uw==",
			"dev": true
		},
		"node_modules/@polka/url": {
			"version": "1.0.0-next.21",
			"resolved": "https://registry.npmjs.org/@polka/url/-/url-1.0.0-next.21.tgz",
			"integrity": "sha512-a5Sab1C4/icpTZVzZc5Ghpz88yQtGOyNqYXcZgOssB2uuAr+wF/MvN6bgtW32q7HHrvBki+BsZ0OuNv6EV3K9g==",
			"dev": true
		},
		"node_modules/@sveltejs/kit": {
			"version": "1.20.5",
			"resolved": "https://registry.npmjs.org/@sveltejs/kit/-/kit-1.20.5.tgz",
			"integrity": "sha512-8rJYZ2boRlO75lwpbpB+DlSzIwmTuamXTpVlDtw4dBk86o3UaDe/+Ro4xCsV/4FtTw2U8xPHyV83edAWbQHG0w==",
			"dev": true,
			"hasInstallScript": true,
			"dependencies": {
				"@sveltejs/vite-plugin-svelte": "^2.4.1",
				"@types/cookie": "^0.5.1",
				"cookie": "^0.5.0",
				"devalue": "^4.3.1",
				"esm-env": "^1.0.0",
				"kleur": "^4.1.5",
				"magic-string": "^0.30.0",
				"mime": "^3.0.0",
				"sade": "^1.8.1",
				"set-cookie-parser": "^2.6.0",
				"sirv": "^2.0.2",
				"undici": "~5.22.0"
			},
			"bin": {
				"svelte-kit": "svelte-kit.js"
			},
			"engines": {
				"node": "^16.14 || >=18"
			},
			"peerDependencies": {
				"svelte": "^3.54.0 || ^4.0.0-next.0",
				"vite": "^4.0.0"
			}
		},
		"node_modules/@sveltejs/vite-plugin-svelte": {
			"version": "2.4.2",
			"resolved": "https://registry.npmjs.org/@sveltejs/vite-plugin-svelte/-/vite-plugin-svelte-2.4.2.tgz",
			"integrity": "sha512-ePfcC48ftMKhkT0OFGdOyycYKnnkT6i/buzey+vHRTR/JpQvuPzzhf1PtKqCDQfJRgoPSN2vscXs6gLigx/zGw==",
			"dev": true,
			"dependencies": {
				"@sveltejs/vite-plugin-svelte-inspector": "^1.0.3",
				"debug": "^4.3.4",
				"deepmerge": "^4.3.1",
				"kleur": "^4.1.5",
				"magic-string": "^0.30.0",
				"svelte-hmr": "^0.15.2",
				"vitefu": "^0.2.4"
			},
			"engines": {
				"node": "^14.18.0 || >= 16"
			},
			"peerDependencies": {
				"svelte": "^3.54.0 || ^4.0.0",
				"vite": "^4.0.0"
			}
		},
		"node_modules/@sveltejs/vite-plugin-svelte-inspector": {
			"version": "1.0.3",
			"resolved": "https://registry.npmjs.org/@sveltejs/vite-plugin-svelte-inspector/-/vite-plugin-svelte-inspector-1.0.3.tgz",
			"integrity": "sha512-Khdl5jmmPN6SUsVuqSXatKpQTMIifoQPDanaxC84m9JxIibWvSABJyHpyys0Z+1yYrxY5TTEQm+6elh0XCMaOA==",
			"dev": true,
			"dependencies": {
				"debug": "^4.3.4"
			},
			"engines": {
				"node": "^14.18.0 || >= 16"
			},
			"peerDependencies": {
				"@sveltejs/vite-plugin-svelte": "^2.2.0",
				"svelte": "^3.54.0 || ^4.0.0",
				"vite": "^4.0.0"
			}
		},
		"node_modules/@types/cookie": {
			"version": "0.5.1",
			"resolved": "https://registry.npmjs.org/@types/cookie/-/cookie-0.5.1.tgz",
			"integrity": "sha512-COUnqfB2+ckwXXSFInsFdOAWQzCCx+a5hq2ruyj+Vjund94RJQd4LG2u9hnvJrTgunKAaax7ancBYlDrNYxA0g==",
			"dev": true
		},
		"node_modules/@types/estree": {
			"version": "1.0.1",
			"resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.1.tgz",
			"integrity": "sha512-LG4opVs2ANWZ1TJoKc937iMmNstM/d0ae1vNbnBvBhqCSezgVUOzcLCqbI5elV8Vy6WKwKjaqR+zO9VKirBBCA==",
			"dev": true
		},
		"node_modules/acorn": {
			"version": "8.9.0",
			"resolved": "https://registry.npmjs.org/acorn/-/acorn-8.9.0.tgz",
			"integrity": "sha512-jaVNAFBHNLXspO543WnNNPZFRtavh3skAkITqD0/2aeMkKZTN+254PyhwxFYrk3vQ1xfY+2wbesJMs/JC8/PwQ==",
			"dev": true,
			"bin": {
				"acorn": "bin/acorn"
			},
			"engines": {
				"node": ">=0.4.0"
			}
		},
		"node_modules/aria-query": {
			"version": "5.3.0",
			"resolved": "https://registry.npmjs.org/aria-query/-/aria-query-5.3.0.tgz",
			"integrity": "sha512-b0P0sZPKtyu8HkeRAfCq0IfURZK+SuwMjY1UXGBU27wpAiTwQAIlq56IbIO+ytk/JjS1fMR14ee5WBBfKi5J6A==",
			"dev": true,
			"dependencies": {
				"dequal": "^2.0.3"
			}
		},
		"node_modules/axobject-query": {
			"version": "3.2.1",
			"resolved": "https://registry.npmjs.org/axobject-query/-/axobject-query-3.2.1.tgz",
			"integrity": "sha512-jsyHu61e6N4Vbz/v18DHwWYKK0bSWLqn47eeDSKPB7m8tqMHF9YJ+mhIk2lVteyZrY8tnSj/jHOv4YiTCuCJgg==",
			"dev": true,
			"dependencies": {
				"dequal": "^2.0.3"
			}
		},
		"node_modules/busboy": {
			"version": "1.6.0",
			"resolved": "https://registry.npmjs.org/busboy/-/busboy-1.6.0.tgz",
			"integrity": "sha512-8SFQbg/0hQ9xy3UNTB0YEnsNBbWfhf7RtnzpL7TkBiTBRfrQ9Fxcnz7VJsleJpyp6rVLvXiuORqjlHi5q+PYuA==",
			"dev": true,
			"dependencies": {
				"streamsearch": "^1.1.0"
			},
			"engines": {
				"node": ">=10.16.0"
			}
		},
		"node_modules/code-red": {
			"version": "1.0.3",
			"resolved": "https://registry.npmjs.org/code-red/-/code-red-1.0.3.tgz",
			"integrity": "sha512-kVwJELqiILQyG5aeuyKFbdsI1fmQy1Cmf7dQ8eGmVuJoaRVdwey7WaMknr2ZFeVSYSKT0rExsa8EGw0aoI/1QQ==",
			"dev": true,
			"dependencies": {
				"@jridgewell/sourcemap-codec": "^1.4.14",
				"@types/estree": "^1.0.0",
				"acorn": "^8.8.2",
				"estree-walker": "^3.0.3",
				"periscopic": "^3.1.0"
			}
		},
		"node_modules/cookie": {
			"version": "0.5.0",
			"resolved": "https://registry.npmjs.org/cookie/-/cookie-0.5.0.tgz",
			"integrity": "sha512-YZ3GUyn/o8gfKJlnlX7g7xq4gyO6OSuhGPKaaGssGB2qgDUS0gPgtTvoyZLTt9Ab6dC4hfc9dV5arkvc/OCmrw==",
			"dev": true,
			"engines": {
				"node": ">= 0.6"
			}
		},
		"node_modules/css-tree": {
			"version": "2.3.1",
			"resolved": "https://registry.npmjs.org/css-tree/-/css-tree-2.3.1.tgz",
			"integrity": "sha512-6Fv1DV/TYw//QF5IzQdqsNDjx/wc8TrMBZsqjL9eW01tWb7R7k/mq+/VXfJCl7SoD5emsJop9cOByJZfs8hYIw==",
			"dev": true,
			"dependencies": {
				"mdn-data": "2.0.30",
				"source-map-js": "^1.0.1"
			},
			"engines": {
				"node": "^10 || ^12.20.0 || ^14.13.0 || >=15.0.0"
			}
		},
		"node_modules/debug": {
			"version": "4.3.4",
			"resolved": "https://registry.npmjs.org/debug/-/debug-4.3.4.tgz",
			"integrity": "sha512-PRWFHuSU3eDtQJPvnNY7Jcket1j0t5OuOsFzPPzsekD52Zl8qUfFIPEiswXqIvHWGVHOgX+7G/vCNNhehwxfkQ==",
			"dev": true,
			"dependencies": {
				"ms": "2.1.2"
			},
			"engines": {
				"node": ">=6.0"
			},
			"peerDependenciesMeta": {
				"supports-color": {
					"optional": true
				}
			}
		},
		"node_modules/deepmerge": {
			"version": "4.3.1",
			"resolved": "https://registry.npmjs.org/deepmerge/-/deepmerge-4.3.1.tgz",
			"integrity": "sha512-3sUqbMEc77XqpdNO7FRyRog+eW3ph+GYCbj+rK+uYyRMuwsVy0rMiVtPn+QJlKFvWP/1PYpapqYn0Me2knFn+A==",
			"dev": true,
			"engines": {
				"node": ">=0.10.0"
			}
		},
		"node_modules/dequal": {
			"version": "2.0.3",
			"resolved": "https://registry.npmjs.org/dequal/-/dequal-2.0.3.tgz",
			"integrity": "sha512-0je+qPKHEMohvfRTCEo3CrPG6cAzAYgmzKyxRiYSSDkS6eGJdyVJm7WaYA5ECaAD9wLB2T4EEeymA5aFVcYXCA==",
			"dev": true,
			"engines": {
				"node": ">=6"
			}
		},
		"node_modules/devalue": {
			"version": "4.3.2",
			"resolved": "https://registry.npmjs.org/devalue/-/devalue-4.3.2.tgz",
			"integrity": "sha512-KqFl6pOgOW+Y6wJgu80rHpo2/3H07vr8ntR9rkkFIRETewbf5GaYYcakYfiKz89K+sLsuPkQIZaXDMjUObZwWg==",
			"dev": true
		},
		"node_modules/esbuild": {
			"version": "0.17.16",
			"resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.17.16.tgz",
			"integrity": "sha512-aeSuUKr9aFVY9Dc8ETVELGgkj4urg5isYx8pLf4wlGgB0vTFjxJQdHnNH6Shmx4vYYrOTLCHtRI5i1XZ9l2Zcg==",
			"dev": true,
			"hasInstallScript": true,
			"bin": {
				"esbuild": "bin/esbuild"
			},
			"engines": {
				"node": ">=12"
			},
			"optionalDependencies": {
				"@esbuild/android-arm": "0.17.16",
				"@esbuild/android-arm64": "0.17.16",
				"@esbuild/android-x64": "0.17.16",
				"@esbuild/darwin-arm64": "0.17.16",
				"@esbuild/darwin-x64": "0.17.16",
				"@esbuild/freebsd-arm64": "0.17.16",
				"@esbuild/freebsd-x64": "0.17.16",
				"@esbuild/linux-arm": "0.17.16",
				"@esbuild/linux-arm64": "0.17.16",
				"@esbuild/linux-ia32": "0.17.16",
				"@esbuild/linux-loong64": "0.17.16",
				"@esbuild/linux-mips64el": "0.17.16",
				"@esbuild/linux-ppc64": "0.17.16",
				"@esbuild/linux-riscv64": "0.17.16",
				"@esbuild/linux-s390x": "0.17.16",
				"@esbuild/linux-x64": "0.17.16",
				"@esbuild/netbsd-x64": "0.17.16",
				"@esbuild/openbsd-x64": "0.17.16",
				"@esbuild/sunos-x64": "0.17.16",
				"@esbuild/win32-arm64": "0.17.16",
				"@esbuild/win32-ia32": "0.17.16",
				"@esbuild/win32-x64": "0.17.16"
			}
		},
		"node_modules/esbuild-wasm": {
			"version": "0.18.9",
			"resolved": "https://registry.npmjs.org/esbuild-wasm/-/esbuild-wasm-0.18.9.tgz",
			"integrity": "sha512-X1hn3PDhxc/lGY6LzxJWlre5WEklHLossTSCi8JmGY8pMb9TL9aZ2LxD5VKAiKUcQgaM45PEc7Kqz6cVf/giEQ==",
			"dev": true,
			"bin": {
				"esbuild": "bin/esbuild"
			},
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/esm-env": {
			"version": "1.0.0",
			"resolved": "https://registry.npmjs.org/esm-env/-/esm-env-1.0.0.tgz",
			"integrity": "sha512-Cf6VksWPsTuW01vU9Mk/3vRue91Zevka5SjyNf3nEpokFRuqt/KjUQoGAwq9qMmhpLTHmXzSIrFRw8zxWzmFBA==",
			"dev": true
		},
		"node_modules/estree-walker": {
			"version": "3.0.3",
			"resolved": "https://registry.npmjs.org/estree-walker/-/estree-walker-3.0.3.tgz",
			"integrity": "sha512-7RUKfXgSMMkzt6ZuXmqapOurLGPPfgj6l9uRZ7lRGolvk0y2yocc35LdcxKC5PQZdn2DMqioAQ2NoWcrTKmm6g==",
			"dev": true,
			"dependencies": {
				"@types/estree": "^1.0.0"
			}
		},
		"node_modules/fsevents": {
			"version": "2.3.2",
			"resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.2.tgz",
			"integrity": "sha512-xiqMQR4xAeHTuB9uWm+fFRcIOgKBMiOBP+eXiyT7jsgVCq1bkVygt00oASowB7EdtpOHaaPgKt812P9ab+DDKA==",
			"dev": true,
			"hasInstallScript": true,
			"optional": true,
			"os": [
				"darwin"
			],
			"engines": {
				"node": "^8.16.0 || ^10.6.0 || >=11.0.0"
			}
		},
		"node_modules/is-reference": {
			"version": "3.0.1",
			"resolved": "https://registry.npmjs.org/is-reference/-/is-reference-3.0.1.tgz",
			"integrity": "sha512-baJJdQLiYaJdvFbJqXrcGv3WU3QCzBlUcI5QhbesIm6/xPsvmO+2CDoi/GMOFBQEQm+PXkwOPrp9KK5ozZsp2w==",
			"dev": true,
			"dependencies": {
				"@types/estree": "*"
			}
		},
		"node_modules/kleur": {
			"version": "4.1.5",
			"resolved": "https://registry.npmjs.org/kleur/-/kleur-4.1.5.tgz",
			"integrity": "sha512-o+NO+8WrRiQEE4/7nwRJhN1HWpVmJm511pBHUxPLtp0BUISzlBplORYSmTclCnJvQq2tKu/sgl3xVpkc7ZWuQQ==",
			"dev": true,
			"engines": {
				"node": ">=6"
			}
		},
		"node_modules/locate-character": {
			"version": "3.0.0",
			"resolved": "https://registry.npmjs.org/locate-character/-/locate-character-3.0.0.tgz",
			"integrity": "sha512-SW13ws7BjaeJ6p7Q6CO2nchbYEc3X3J6WrmTTDto7yMPqVSZTUyY5Tjbid+Ab8gLnATtygYtiDIJGQRRn2ZOiA==",
			"dev": true
		},
		"node_modules/magic-string": {
			"version": "0.30.0",
			"resolved": "https://registry.npmjs.org/magic-string/-/magic-string-0.30.0.tgz",
			"integrity": "sha512-LA+31JYDJLs82r2ScLrlz1GjSgu66ZV518eyWT+S8VhyQn/JL0u9MeBOvQMGYiPk1DBiSN9DDMOcXvigJZaViQ==",
			"dev": true,
			"dependencies": {
				"@jridgewell/sourcemap-codec": "^1.4.13"
			},
			"engines": {
				"node": ">=12"
			}
		},
		"node_modules/mdn-data": {
			"version": "2.0.30",
			"resolved": "https://registry.npmjs.org/mdn-data/-/mdn-data-2.0.30.tgz",
			"integrity": "sha512-GaqWWShW4kv/G9IEucWScBx9G1/vsFZZJUO+tD26M8J8z3Kw5RDQjaoZe03YAClgeS/SWPOcb4nkFBTEi5DUEA==",
			"dev": true
		},
		"node_modules/mime": {
			"version": "3.0.0",
			"resolved": "https://registry.npmjs.org/mime/-/mime-3.0.0.tgz",
			"integrity": "sha512-jSCU7/VB1loIWBZe14aEYHU/+1UMEHoaO7qxCOVJOw9GgH72VAWppxNcjU+x9a2k3GSIBXNKxXQFqRvvZ7vr3A==",
			"dev": true,
			"bin": {
				"mime": "cli.js"
			},
			"engines": {
				"node": ">=10.0.0"
			}
		},
		"node_modules/mri": {
			"version": "1.2.0",
			"resolved": "https://registry.npmjs.org/mri/-/mri-1.2.0.tgz",
			"integrity": "sha512-tzzskb3bG8LvYGFF/mDTpq3jpI6Q9wc3LEmBaghu+DdCssd1FakN7Bc0hVNmEyGq1bq3RgfkCb3cmQLpNPOroA==",
			"dev": true,
			"engines": {
				"node": ">=4"
			}
		},
		"node_modules/mrmime": {
			"version": "1.0.1",
			"resolved": "https://registry.npmjs.org/mrmime/-/mrmime-1.0.1.tgz",
			"integrity": "sha512-hzzEagAgDyoU1Q6yg5uI+AorQgdvMCur3FcKf7NhMKWsaYg+RnbTyHRa/9IlLF9rf455MOCtcqqrQQ83pPP7Uw==",
			"dev": true,
			"engines": {
				"node": ">=10"
			}
		},
		"node_modules/ms": {
			"version": "2.1.2",
			"resolved": "https://registry.npmjs.org/ms/-/ms-2.1.2.tgz",
			"integrity": "sha512-sGkPx+VjMtmA6MX27oA4FBFELFCZZ4S4XqeGOXCv68tT+jb3vk/RyaKWP0PTKyWtmLSM0b+adUTEvbs1PEaH2w==",
			"dev": true
		},
		"node_modules/nanoid": {
			"version": "3.3.6",
			"resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.6.tgz",
			"integrity": "sha512-BGcqMMJuToF7i1rt+2PWSNVnWIkGCU78jBG3RxO/bZlnZPK2Cmi2QaffxGO/2RvWi9sL+FAiRiXMgsyxQ1DIDA==",
			"dev": true,
			"funding": [
				{
					"type": "github",
					"url": "https://github.com/sponsors/ai"
				}
			],
			"bin": {
				"nanoid": "bin/nanoid.cjs"
			},
			"engines": {
				"node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
			}
		},
		"node_modules/periscopic": {
			"version": "3.1.0",
			"resolved": "https://registry.npmjs.org/periscopic/-/periscopic-3.1.0.tgz",
			"integrity": "sha512-vKiQ8RRtkl9P+r/+oefh25C3fhybptkHKCZSPlcXiJux2tJF55GnEj3BVn4A5gKfq9NWWXXrxkHBwVPUfH0opw==",
			"dev": true,
			"dependencies": {
				"@types/estree": "^1.0.0",
				"estree-walker": "^3.0.0",
				"is-reference": "^3.0.0"
			}
		},
		"node_modules/picocolors": {
			"version": "1.0.0",
			"resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.0.0.tgz",
			"integrity": "sha512-1fygroTLlHu66zi26VoTDv8yRgm0Fccecssto+MhsZ0D/DGW2sm8E8AjW7NU5VVTRt5GxbeZ5qBuJr+HyLYkjQ==",
			"dev": true
		},
		"node_modules/postcss": {
			"version": "8.4.24",
			"resolved": "https://registry.npmjs.org/postcss/-/postcss-8.4.24.tgz",
			"integrity": "sha512-M0RzbcI0sO/XJNucsGjvWU9ERWxb/ytp1w6dKtxTKgixdtQDq4rmx/g8W1hnaheq9jgwL/oyEdH5Bc4WwJKMqg==",
			"dev": true,
			"funding": [
				{
					"type": "opencollective",
					"url": "https://opencollective.com/postcss/"
				},
				{
					"type": "tidelift",
					"url": "https://tidelift.com/funding/github/npm/postcss"
				},
				{
					"type": "github",
					"url": "https://github.com/sponsors/ai"
				}
			],
			"dependencies": {
				"nanoid": "^3.3.6",
				"picocolors": "^1.0.0",
				"source-map-js": "^1.0.2"
			},
			"engines": {
				"node": "^10 || ^12 || >=14"
			}
		},
		"node_modules/rollup": {
			"version": "3.25.2",
			"resolved": "https://registry.npmjs.org/rollup/-/rollup-3.25.2.tgz",
			"integrity": "sha512-VLnkxZMDr3jpxgtmS8pQZ0UvhslmF4ADq/9w4erkctbgjCqLW9oa89fJuXEs4ZmgyoF7Dm8rMDKSS5b5u2hHUg==",
			"dev": true,
			"bin": {
				"rollup": "dist/bin/rollup"
			},
			"engines": {
				"node": ">=14.18.0",
				"npm": ">=8.0.0"
			},
			"optionalDependencies": {
				"fsevents": "~2.3.2"
			}
		},
		"node_modules/sade": {
			"version": "1.8.1",
			"resolved": "https://registry.npmjs.org/sade/-/sade-1.8.1.tgz",
			"integrity": "sha512-xal3CZX1Xlo/k4ApwCFrHVACi9fBqJ7V+mwhBsuf/1IOKbBy098Fex+Wa/5QMubw09pSZ/u8EY8PWgevJsXp1A==",
			"dev": true,
			"dependencies": {
				"mri": "^1.1.0"
			},
			"engines": {
				"node": ">=6"
			}
		},
		"node_modules/set-cookie-parser": {
			"version": "2.6.0",
			"resolved": "https://registry.npmjs.org/set-cookie-parser/-/set-cookie-parser-2.6.0.tgz",
			"integrity": "sha512-RVnVQxTXuerk653XfuliOxBP81Sf0+qfQE73LIYKcyMYHG94AuH0kgrQpRDuTZnSmjpysHmzxJXKNfa6PjFhyQ==",
			"dev": true
		},
		"node_modules/sirv": {
			"version": "2.0.2",
			"resolved": "https://registry.npmjs.org/sirv/-/sirv-2.0.2.tgz",
			"integrity": "sha512-4Qog6aE29nIjAOKe/wowFTxOdmbEZKb+3tsLljaBRzJwtqto0BChD2zzH0LhgCSXiI+V7X+Y45v14wBZQ1TK3w==",
			"dev": true,
			"dependencies": {
				"@polka/url": "^1.0.0-next.20",
				"mrmime": "^1.0.0",
				"totalist": "^3.0.0"
			},
			"engines": {
				"node": ">= 10"
			}
		},
		"node_modules/source-map-js": {
			"version": "1.0.2",
			"resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.0.2.tgz",
			"integrity": "sha512-R0XvVJ9WusLiqTCEiGCmICCMplcCkIwwR11mOSD9CR5u+IXYdiseeEuXCVAjS54zqwkLcPNnmU4OeJ6tUrWhDw==",
			"dev": true,
			"engines": {
				"node": ">=0.10.0"
			}
		},
		"node_modules/streamsearch": {
			"version": "1.1.0",
			"resolved": "https://registry.npmjs.org/streamsearch/-/streamsearch-1.1.0.tgz",
			"integrity": "sha512-Mcc5wHehp9aXz1ax6bZUyY5afg9u2rv5cqQI3mRrYkGC8rW2hM02jWuwjtL++LS5qinSyhj2QfLyNsuc+VsExg==",
			"dev": true,
			"engines": {
				"node": ">=10.0.0"
			}
		},
		"node_modules/svelte": {
			"version": "4.0.0",
			"resolved": "https://registry.npmjs.org/svelte/-/svelte-4.0.0.tgz",
			"integrity": "sha512-+yCYu3AEUu9n91dnQNGIbnVp8EmNQtuF/YImW4+FTXRHard7NMo+yTsWzggPAbj3fUEJ1FBJLkql/jkp6YB5pg==",
			"dev": true,
			"dependencies": {
				"@ampproject/remapping": "^2.2.1",
				"@jridgewell/sourcemap-codec": "^1.4.15",
				"@jridgewell/trace-mapping": "^0.3.18",
				"acorn": "^8.8.2",
				"aria-query": "^5.2.1",
				"axobject-query": "^3.2.1",
				"code-red": "^1.0.3",
				"css-tree": "^2.3.1",
				"estree-walker": "^3.0.3",
				"is-reference": "^3.0.1",
				"locate-character": "^3.0.0",
				"magic-string": "^0.30.0",
				"periscopic": "^3.1.0"
			},
			"engines": {
				"node": ">=16"
			}
		},
		"node_modules/svelte-hmr": {
			"version": "0.15.2",
			"resolved": "https://registry.npmjs.org/svelte-hmr/-/svelte-hmr-0.15.2.tgz",
			"integrity": "sha512-q/bAruCvFLwvNbeE1x3n37TYFb3mTBJ6TrCq6p2CoFbSTNhDE9oAtEfpy+wmc9So8AG0Tja+X0/mJzX9tSfvIg==",
			"dev": true,
			"engines": {
				"node": "^12.20 || ^14.13.1 || >= 16"
			},
			"peerDependencies": {
				"svelte": "^3.19.0 || ^4.0.0-next.0"
			}
		},
		"node_modules/totalist": {
			"version": "3.0.1",
			"resolved": "https://registry.npmjs.org/totalist/-/totalist-3.0.1.tgz",
			"integrity": "sha512-sf4i37nQ2LBx4m3wB74y+ubopq6W/dIzXg0FDGjsYnZHVa1Da8FH853wlL2gtUhg+xJXjfk3kUZS3BRoQeoQBQ==",
			"dev": true,
			"engines": {
				"node": ">=6"
			}
		},
		"node_modules/undici": {
			"version": "5.22.1",
			"resolved": "https://registry.npmjs.org/undici/-/undici-5.22.1.tgz",
			"integrity": "sha512-Ji2IJhFXZY0x/0tVBXeQwgPlLWw13GVzpsWPQ3rV50IFMMof2I55PZZxtm4P6iNq+L5znYN9nSTAq0ZyE6lSJw==",
			"dev": true,
			"dependencies": {
				"busboy": "^1.6.0"
			},
			"engines": {
				"node": ">=14.0"
			}
		},
		"node_modules/vite": {
			"version": "4.3.9",
			"resolved": "https://registry.npmjs.org/vite/-/vite-4.3.9.tgz",
			"integrity": "sha512-qsTNZjO9NoJNW7KnOrgYwczm0WctJ8m/yqYAMAK9Lxt4SoySUfS5S8ia9K7JHpa3KEeMfyF8LoJ3c5NeBJy6pg==",
			"dev": true,
			"dependencies": {
				"esbuild": "^0.17.5",
				"postcss": "^8.4.23",
				"rollup": "^3.21.0"
			},
			"bin": {
				"vite": "bin/vite.js"
			},
			"engines": {
				"node": "^14.18.0 || >=16.0.0"
			},
			"optionalDependencies": {
				"fsevents": "~2.3.2"
			},
			"peerDependencies": {
				"@types/node": ">= 14",
				"less": "*",
				"sass": "*",
				"stylus": "*",
				"sugarss": "*",
				"terser": "^5.4.0"
			},
			"peerDependenciesMeta": {
				"@types/node": {
					"optional": true
				},
				"less": {
					"optional": true
				},
				"sass": {
					"optional": true
				},
				"stylus": {
					"optional": true
				},
				"sugarss": {
					"optional": true
				},
				"terser": {
					"optional": true
				}
			}
		},
		"node_modules/vitefu": {
			"version": "0.2.4",
			"resolved": "https://registry.npmjs.org/vitefu/-/vitefu-0.2.4.tgz",
			"integrity": "sha512-fanAXjSaf9xXtOOeno8wZXIhgia+CZury481LsDaV++lSvcU2R9Ch2bPh3PYFyoHW+w9LqAeYRISVQjUIew14g==",
			"dev": true,
			"peerDependencies": {
				"vite": "^3.0.0 || ^4.0.0"
			},
			"peerDependenciesMeta": {
				"vite": {
					"optional": true
				}
			}
		}
	}
}

```


####### content/tutorial/common/src/app.html #######

```

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="color-scheme" content="dark light" />
		%sveltekit.head%

		<style>
			body {
				--bg-1: hsl(0, 0%, 100%);
				--bg-2: hsl(206, 20%, 90%);
				--bg-3: hsl(206, 20%, 80%);
				--fg-1: hsl(0, 0%, 13%);
				--fg-2: hsl(0, 0%, 20%);
				--fg-2: hsl(0, 0%, 30%);
				--link: hsl(208, 77%, 47%);
				--link-hover: hsl(208, 77%, 55%);
				--link-active: hsl(208, 77%, 40%);
				--border-radius: 4px;
				--font: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell,
					'Open Sans', 'Helvetica Neue', sans-serif;
				--font-mono: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas,
					'DejaVu Sans Mono', monospace;
				background: var(--bg-1);
				color: var(--fg-1);
				font-family: var(--font);
				line-height: 1.5;
				margin: 1rem;
				height: calc(100vh - 2rem);
			}

			h1,
			h2,
			h3,
			h4,
			h5,
			h6 {
				font-weight: normal;
				font-variant-numeric: tabular-nums;
				line-height: 1.1;
			}

			:is(h1, h2, h3, h4, h5, h6, p) {
				margin: 1rem 0.1rem;
			}

			label {
				margin: 0.5rem 0.1rem;
			}

			:is(h1, h2, h3, h4, h5, h6, p, label):first-child {
				margin-top: 0;
			}

			:is(h1, h2, h3, h4, h5, h6, p, label):last-child {
				margin-bottom: 0;
			}

			a {
				color: var(--link);
			}

			a:hover {
				color: var(--link-hover);
			}

			a:active {
				color: var(--link-active);
			}

			label {
				display: flex;
				gap: 0.5rem;
				align-items: center;
			}

			label input {
				margin: 0;
			}

			button,
			input,
			select {
				font-family: inherit;
				font-size: inherit;
			}

			button {
				background: var(--link);
				color: var(--bg-1);
				padding: 0.5rem 1rem;
				border: none;
				border-radius: var(--border-radius);
			}

			button:hover {
				background: var(--link-hover);
			}

			button:active {
				background: var(--link-active);
			}

			:is(button, button:hover, button:active):disabled {
				background: var(--link);
				filter: grayscale(1);
				opacity: 0.4;
			}

			input,
			textarea,
			select {
				padding: 0.5rem;
				border: 1px solid var(--bg-2);
				border-radius: var(--border-radius);
				box-sizing: border-box;
			}

			input,
			textarea {
				background: var(--bg-1);
				color: inherit;
			}

			select:not([multiple]) {
				background: var(--bg-2);
			}

			textarea {
				font-family: var(--font-mono);
				font-size: 0.9rem;
			}

			form {
				display: flex;
				flex-direction: column;
				gap: 1rem;
				align-items: baseline;
			}

			ul:has(li):has(form) {
				list-style: none;
				padding: 0;
			}

			li form {
				flex-direction: row;
				gap: 0.5rem;
				margin: 0.5rem 0;
			}

			nav {
				position: relative;
				display: flex;
				gap: 1em;
				padding: 1em;
				background: var(--bg-2);
				z-index: 2;
				margin: 0 0 1em 0;
				border-radius: var(--border-radius);
			}

			nav a {
				text-decoration: none;
			}

			nav a[aria-current='true'] {
				border-bottom: 2px solid;
			}

			ul:has(form) {
				list-style: none;
				padding: 0;
			}

			progress {
				margin: 0.5rem 0;
			}

			progress:first-child {
				margin-top: 0;
			}

			progress:lsat-child {
				margin-bottom: 0;
			}

			.error {
				color: red;
			}

			code {
				background: var(--bg-2);
				font-family: var(--font-mono);
				font-size: 0.9em;
				padding: 0.15rem 0.3rem;
				border-radius: var(--border-radius);
			}

			ul.todos {
				padding: 0;
			}

			ul.todos li:not(:has(> form)),
			ul.todos li form {
				position: relative;
				display: flex;
				align-items: center;
				padding: 0.5em 0.5em 0.5em 1em;
				margin: 0 0 0.5em 0;
				gap: 0.5em;
				border-radius: 5px;
				user-select: none;
				background: var(--bg-1);
				filter: drop-shadow(2px 3px 6px rgba(0, 0, 0, 0.1));
				transition: filter 0.2s, opacity 0.2s;
			}

			ul.todos .done {
				filter: none;
				opacity: 0.4;
			}

			ul.todos button {
				border: none;
				background-color: transparent;
				background-repeat: no-repeat;
				background-position: 50% 50%;
				background-size: 1rem 1rem;
				cursor: pointer;
				width: 3em;
				height: 3em;
				margin: -0.5em -0.5em -0.5em 0;
				aspect-ratio: 1;
				opacity: 0.5;
				transition: opacity 0.2s;
			}

			ul.todos button:hover {
				opacity: 1;
			}

			body.dark {
				--bg-1: hsl(0, 0%, 18%);
				--bg-2: hsl(0, 0%, 30%);
				--bg-3: hsl(0, 0%, 40%);
				--fg-1: hsl(0, 0%, 90%);
				--fg-2: hsl(0, 0%, 70%);
				--fg-3: hsl(0, 0%, 60%);
				--link: hsl(206, 96%, 72%);
				--link-hover: hsl(206, 96%, 78%);
				--link-active: hsl(206, 96%, 64%);
			}
		</style>
	</head>
	<body>
		<div style="display: contents">%sveltekit.body%</div>

		<script>
			const theme = new URL(window.location).searchParams.get('theme');

			document.body.classList.remove('light', 'dark');
			document.body.classList.add(theme || 'light');
		</script>
	</body>
</html>

```


####### content/tutorial/common/src/__client.js #######

```

function post(data) {
	parent.postMessage(data, '*');
}

function update_path(path) {
	post({ type: 'path', path });
}

function ping() {
	post({ type: 'ping' });
}

function pause() {
	post({ type: 'ping-pause' });
}

// Hack into the alert that's used in some tutorials and send a message prior to the alert,
// else the parent thinks we lost contact and wrongfully reloads the page.
// The drawback is that alert is no longer blocking, but no tutorial relies on this.
const alert = window.alert;
window.alert = (message) => {
	pause();

	setTimeout(() => {
		alert(message);
	});
};

let can_focus = false;

window.addEventListener('pointerdown', (e) => can_focus = true);
window.addEventListener('pointerup', (e) => can_focus = false);
window.addEventListener('keydown', (e) => can_focus = true);
window.addEventListener('keyup', (e) => can_focus = false);

/**
 * The iframe sometimes takes focus control in ways we can't prevent
 * while the editor is focused. Refocus the editor in these cases.
 */
window.addEventListener('focusin', (e) => {
	// if focusin happened as a result of a mouse/keyboard event, allow it
	if (can_focus) return;

	// if `e.target` is the `<body>` and there's a `relatedTarget`,
	// assume the focusin was the result of a user navigation — allow it
	if (e.target.tagName === 'BODY' && e.relatedTarget) return;

	// otherwise, broadcast an event that causes the editor to reclaim focus
	post({ type: 'iframe_took_focus' });
});

let previous_href = location.href;

window.addEventListener('click', (e) => {
	let node = e.target;
	while (node) {
		if (node.nodeName === 'A') {
			const href = node.href;
			const url = new URL(href);

			if (url.origin !== location.origin) {
				e.preventDefault();
				window.open(url, '_blank');
			} else {
				if (location.href !== url.href) {
					previous_href = url.href;
					update_path(url.pathname + url.search + url.hash);
				}
			}
		}
		node = node.parent;
	}
});

window.addEventListener('visibilitychange', () => {
	if (document.visibilityState === 'visible') {
		ping();
	} else {
		pause();
	}
});

const url_observer = new MutationObserver(() => {
	if (location.href !== previous_href) {
		previous_href = location.href;
		update_path(location.pathname + location.search + location.hash);
	}
});

url_observer.observe(document, {
	subtree: true,
	childList: true,
	attributes: true
});

setInterval(ping, 100);
ping();

if (import.meta.hot) {
	import.meta.hot.on('vite:beforeUpdate', (event) => {
		post({ type: 'hmr', data: event.updates });
	});
}

```


####### content/tutorial/common/src/routes/+page.svelte #######

```


```


####### content/tutorial/common/static/tutorial/dark-theme.css #######

```

body {
	background-color: #333;
	color: whitesmoke;
	transition: all 0.5s;
}

```


####### content/tutorial/common/svelte.config.js #######

```

/** @type {import('@sveltejs/kit').Config} */
const config = {
	kit: {
		// For the tutorial, we need to disable CSRF protection.
		// Don't do this in your own apps unless you know what you're doing!
		// See https://kit.svelte.dev/docs/configuration#csrf for more info.
		csrf: false
	},

	vitePlugin: {
		// This enables compile-time warnings to be
		// visible in the learn.svelte.dev editor
		onwarn: (warning, defaultHandler) => {
			console.log('svelte:warnings:%s', JSON.stringify(warning));
			defaultHandler(warning);
		}
	}
};

export default config;

```


####### content/tutorial/common/vite.config.js #######

```

import { sveltekit } from '@sveltejs/kit/vite';
import { defineConfig } from 'vite';

export default defineConfig({
	plugins: [sveltekit()],

	// Normally this would be unnecessary, but we
	// need it for learn.svelte.dev
	server: {
		fs: {
			strict: false
		}
	}
});

```


####### jsconfig.json #######

```

{
	"extends": "./.svelte-kit/tsconfig.json",
	"compilerOptions": {
		"allowJs": true,
		"checkJs": true,
		"esModuleInterop": true,
		"forceConsistentCasingInFileNames": true,
		"lib": ["es2020", "DOM"],
		"moduleResolution": "bundler",
		"module": "es2022",
		"resolveJsonModule": true,
		"skipLibCheck": true,
		"sourceMap": true,
		"strict": true,
		"target": "es2022"
	}
}

```


####### LICENSE.md #######

MIT License

Copyright (c) 2023 [these people](https://github.com/sveltejs/learn.svelte.dev/graphs/contributors)

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

####### middleware.js #######

```

export const config = {
	matcher: ['/((?!assets\/).*)']
};

export default function middleware(_request, _event) {
	const response = new Response();

	response.headers.set('cross-origin-opener-policy', 'same-origin');
	response.headers.set('cross-origin-embedder-policy', 'require-corp');
	response.headers.set('cross-origin-resource-policy', 'cross-origin');
	response.headers.set('x-middleware-next', '1');

	return response;
}

```


####### package.json #######

```

{
	"name": "learn.svelte.dev",
	"version": "0.0.1",
	"private": true,
	"scripts": {
		"dev": "vite dev",
		"build": "node scripts/create-common-bundle && vite build",
		"preview": "vite preview",
		"test": "npm run build && playwright test",
		"check": "svelte-check --tsconfig ./jsconfig.json",
		"check:watch": "svelte-check --tsconfig ./jsconfig.json --watch",
		"lint": "prettier --ignore-path .gitignore --check --plugin-search-dir=. .",
		"format": "prettier --ignore-path .gitignore --write --plugin-search-dir=. ."
	},
	"devDependencies": {
		"@playwright/test": "^1.37.1",
		"@sveltejs/adapter-vercel": "3.0.3",
		"@sveltejs/kit": "^1.30.3",
		"@sveltejs/site-kit": "6.0.0-next.39",
		"@types/diff": "^5.0.3",
		"@types/prismjs": "^1.26.0",
		"@types/ws": "^8.5.5",
		"browserslist": "^4.21.10",
		"diff": "^5.1.0",
		"esbuild": "^0.19.2",
		"lightningcss": "^1.21.7",
		"prettier": "^3.0.3",
		"prettier-plugin-svelte": "^3.0.3",
		"shiki-twoslash": "^3.1.2",
		"svelte": "^4.2.0",
		"svelte-check": "^3.5.1",
		"tiny-glob": "^0.2.9",
		"typescript": "^5.3.3",
		"vite": "^4.5.2"
	},
	"type": "module",
	"dependencies": {
		"@codemirror/autocomplete": "^6.9.0",
		"@codemirror/commands": "^6.2.5",
		"@codemirror/lang-css": "^6.2.1",
		"@codemirror/lang-html": "^6.4.6",
		"@codemirror/lang-javascript": "^6.2.1",
		"@codemirror/language": "^6.9.0",
		"@codemirror/lint": "^6.4.1",
		"@codemirror/search": "^6.5.2",
		"@codemirror/state": "^6.2.1",
		"@codemirror/view": "^6.17.1",
		"@fontsource/roboto-mono": "^5.0.8",
		"@lezer/common": "^1.0.4",
		"@lezer/highlight": "^1.1.6",
		"@lezer/javascript": "^1.4.7",
		"@lezer/lr": "^1.3.10",
		"@replit/codemirror-lang-svelte": "^6.0.0",
		"@replit/codemirror-vim": "^6.0.14",
		"@rich_harris/svelte-split-pane": "^1.1.1",
		"@sveltejs/repl": "^0.6.0",
		"@webcontainer/api": "^1.1.5",
		"adm-zip": "^0.5.10",
		"ansi-to-html": "^0.7.2",
		"base64-js": "^1.5.1",
		"codemirror": "^6.0.1",
		"flexsearch": "^0.7.31",
		"marked": "^8.0.0",
		"port-authority": "^2.0.1",
		"prism-svelte": "^0.5.0",
		"prismjs": "^1.29.0",
		"ws": "^8.13.0",
		"yootils": "^0.3.1"
	},
	"packageManager": "pnpm@8.15.1"
}

```


####### playwright.config.ts #######

```

import type { PlaywrightTestConfig } from '@playwright/test';

const config: PlaywrightTestConfig = {
	webServer: {
		command: 'pnpm preview',
		port: 4173
	},
	timeout: 60000,
	use: {
		trace: {
			mode: 'retain-on-failure'
		}
	}
};

export default config;

```


####### pnpm-lock.yaml #######

```

lockfileVersion: '6.0'

settings:
  autoInstallPeers: true
  excludeLinksFromLockfile: false

dependencies:
  '@codemirror/autocomplete':
    specifier: ^6.9.0
    version: 6.12.0(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)
  '@codemirror/commands':
    specifier: ^6.2.5
    version: 6.3.3
  '@codemirror/lang-css':
    specifier: ^6.2.1
    version: 6.2.1(@codemirror/view@6.24.0)
  '@codemirror/lang-html':
    specifier: ^6.4.6
    version: 6.4.8
  '@codemirror/lang-javascript':
    specifier: ^6.2.1
    version: 6.2.1
  '@codemirror/language':
    specifier: ^6.9.0
    version: 6.10.1
  '@codemirror/lint':
    specifier: ^6.4.1
    version: 6.5.0
  '@codemirror/search':
    specifier: ^6.5.2
    version: 6.5.6
  '@codemirror/state':
    specifier: ^6.2.1
    version: 6.4.0
  '@codemirror/view':
    specifier: ^6.17.1
    version: 6.24.0
  '@fontsource/roboto-mono':
    specifier: ^5.0.8
    version: 5.0.16
  '@lezer/common':
    specifier: ^1.0.4
    version: 1.2.1
  '@lezer/highlight':
    specifier: ^1.1.6
    version: 1.2.0
  '@lezer/javascript':
    specifier: ^1.4.7
    version: 1.4.13
  '@lezer/lr':
    specifier: ^1.3.10
    version: 1.4.0
  '@replit/codemirror-lang-svelte':
    specifier: ^6.0.0
    version: 6.0.0(@codemirror/autocomplete@6.12.0)(@codemirror/lang-css@6.2.1)(@codemirror/lang-html@6.4.8)(@codemirror/lang-javascript@6.2.1)(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)(@lezer/highlight@1.2.0)(@lezer/javascript@1.4.13)(@lezer/lr@1.4.0)
  '@replit/codemirror-vim':
    specifier: ^6.0.14
    version: 6.1.0(@codemirror/commands@6.3.3)(@codemirror/language@6.10.1)(@codemirror/search@6.5.6)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)
  '@rich_harris/svelte-split-pane':
    specifier: ^1.1.1
    version: 1.1.1(svelte@4.2.10)
  '@sveltejs/repl':
    specifier: ^0.6.0
    version: 0.6.0(@codemirror/lang-html@6.4.8)(@codemirror/search@6.5.6)(@lezer/common@1.2.1)(@lezer/javascript@1.4.13)(@lezer/lr@1.4.0)(@sveltejs/kit@1.30.3)(svelte@4.2.10)
  '@webcontainer/api':
    specifier: ^1.1.5
    version: 1.1.9
  adm-zip:
    specifier: ^0.5.10
    version: 0.5.10
  ansi-to-html:
    specifier: ^0.7.2
    version: 0.7.2
  base64-js:
    specifier: ^1.5.1
    version: 1.5.1
  codemirror:
    specifier: ^6.0.1
    version: 6.0.1(@lezer/common@1.2.1)
  flexsearch:
    specifier: ^0.7.31
    version: 0.7.43
  marked:
    specifier: ^8.0.0
    version: 8.0.1
  port-authority:
    specifier: ^2.0.1
    version: 2.0.1
  prism-svelte:
    specifier: ^0.5.0
    version: 0.5.0
  prismjs:
    specifier: ^1.29.0
    version: 1.29.0
  ws:
    specifier: ^8.13.0
    version: 8.16.0
  yootils:
    specifier: ^0.3.1
    version: 0.3.1

devDependencies:
  '@playwright/test':
    specifier: ^1.37.1
    version: 1.41.2
  '@sveltejs/adapter-vercel':
    specifier: 3.0.3
    version: 3.0.3(@sveltejs/kit@1.30.3)
  '@sveltejs/kit':
    specifier: ^1.30.3
    version: 1.30.3(svelte@4.2.10)(vite@4.5.2)
  '@sveltejs/site-kit':
    specifier: 6.0.0-next.39
    version: 6.0.0-next.39(@sveltejs/kit@1.30.3)(svelte@4.2.10)
  '@types/diff':
    specifier: ^5.0.3
    version: 5.0.9
  '@types/prismjs':
    specifier: ^1.26.0
    version: 1.26.3
  '@types/ws':
    specifier: ^8.5.5
    version: 8.5.10
  browserslist:
    specifier: ^4.21.10
    version: 4.22.3
  diff:
    specifier: ^5.1.0
    version: 5.1.0
  esbuild:
    specifier: ^0.19.2
    version: 0.19.12
  lightningcss:
    specifier: ^1.21.7
    version: 1.23.0
  prettier:
    specifier: ^3.0.3
    version: 3.2.5
  prettier-plugin-svelte:
    specifier: ^3.0.3
    version: 3.1.2(prettier@3.2.5)(svelte@4.2.10)
  shiki-twoslash:
    specifier: ^3.1.2
    version: 3.1.2(typescript@5.3.3)
  svelte:
    specifier: ^4.2.0
    version: 4.2.10
  svelte-check:
    specifier: ^3.5.1
    version: 3.6.4(svelte@4.2.10)
  tiny-glob:
    specifier: ^0.2.9
    version: 0.2.9
  typescript:
    specifier: ^5.3.3
    version: 5.3.3
  vite:
    specifier: ^4.5.2
    version: 4.5.2(lightningcss@1.23.0)

packages:

  /@ampproject/remapping@2.2.1:
    resolution: {integrity: sha512-lFMjJTrFL3j7L9yBxwYfCq2k6qqwHyzuUl/XBnif78PWTJYyL/dfowQHWE3sp6U6ZzqWiiIZnpTMO96zhkjwtg==}
    engines: {node: '>=6.0.0'}
    dependencies:
      '@jridgewell/gen-mapping': 0.3.3
      '@jridgewell/trace-mapping': 0.3.22

  /@codemirror/autocomplete@6.12.0(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1):
    resolution: {integrity: sha512-r4IjdYFthwbCQyvqnSlx0WBHRHi8nBvU+WjJxFUij81qsBfhNudf/XKKmmC2j3m0LaOYUQTf3qiEK1J8lO1sdg==}
    peerDependencies:
      '@codemirror/language': ^6.0.0
      '@codemirror/state': ^6.0.0
      '@codemirror/view': ^6.0.0
      '@lezer/common': ^1.0.0
    dependencies:
      '@codemirror/language': 6.10.1
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
      '@lezer/common': 1.2.1
    dev: false

  /@codemirror/commands@6.3.3:
    resolution: {integrity: sha512-dO4hcF0fGT9tu1Pj1D2PvGvxjeGkbC6RGcZw6Qs74TH+Ed1gw98jmUgd2axWvIZEqTeTuFrg1lEB1KV6cK9h1A==}
    dependencies:
      '@codemirror/language': 6.10.1
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
      '@lezer/common': 1.2.1
    dev: false

  /@codemirror/lang-css@6.2.1(@codemirror/view@6.24.0):
    resolution: {integrity: sha512-/UNWDNV5Viwi/1lpr/dIXJNWiwDxpw13I4pTUAsNxZdg6E0mI2kTQb0P2iHczg1Tu+H4EBgJR+hYhKiHKko7qg==}
    dependencies:
      '@codemirror/autocomplete': 6.12.0(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)
      '@codemirror/language': 6.10.1
      '@codemirror/state': 6.4.0
      '@lezer/common': 1.2.1
      '@lezer/css': 1.1.7
    transitivePeerDependencies:
      - '@codemirror/view'
    dev: false

  /@codemirror/lang-html@6.4.8:
    resolution: {integrity: sha512-tE2YK7wDlb9ZpAH6mpTPiYm6rhfdQKVDa5r9IwIFlwwgvVaKsCfuKKZoJGWsmMZIf3FQAuJ5CHMPLymOtg1hXw==}
    dependencies:
      '@codemirror/autocomplete': 6.12.0(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)
      '@codemirror/lang-css': 6.2.1(@codemirror/view@6.24.0)
      '@codemirror/lang-javascript': 6.2.1
      '@codemirror/language': 6.10.1
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
      '@lezer/common': 1.2.1
      '@lezer/css': 1.1.7
      '@lezer/html': 1.3.8
    dev: false

  /@codemirror/lang-javascript@6.2.1:
    resolution: {integrity: sha512-jlFOXTejVyiQCW3EQwvKH0m99bUYIw40oPmFjSX2VS78yzfe0HELZ+NEo9Yfo1MkGRpGlj3Gnu4rdxV1EnAs5A==}
    dependencies:
      '@codemirror/autocomplete': 6.12.0(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)
      '@codemirror/language': 6.10.1
      '@codemirror/lint': 6.5.0
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
      '@lezer/common': 1.2.1
      '@lezer/javascript': 1.4.13
    dev: false

  /@codemirror/lang-json@6.0.1:
    resolution: {integrity: sha512-+T1flHdgpqDDlJZ2Lkil/rLiRy684WMLc74xUnjJH48GQdfJo/pudlTRreZmKwzP8/tGdKf83wlbAdOCzlJOGQ==}
    dependencies:
      '@codemirror/language': 6.10.1
      '@lezer/json': 1.0.2
    dev: false

  /@codemirror/lang-markdown@6.2.4:
    resolution: {integrity: sha512-UghkA1vSMs8bT7RSZM6vsIocigyah2bV00eRQuZy76401UmFZdsTsbQNBGdyxRQDOLeEvF5iFwap0BM8LKyd+g==}
    dependencies:
      '@codemirror/autocomplete': 6.12.0(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)
      '@codemirror/lang-html': 6.4.8
      '@codemirror/language': 6.10.1
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
      '@lezer/common': 1.2.1
      '@lezer/markdown': 1.2.0
    dev: false

  /@codemirror/language@6.10.1:
    resolution: {integrity: sha512-5GrXzrhq6k+gL5fjkAwt90nYDmjlzTIJV8THnxNFtNKWotMIlzzN+CpqxqwXOECnUdOndmSeWntVrVcv5axWRQ==}
    dependencies:
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
      '@lezer/common': 1.2.1
      '@lezer/highlight': 1.2.0
      '@lezer/lr': 1.4.0
      style-mod: 4.1.0
    dev: false

  /@codemirror/lint@6.5.0:
    resolution: {integrity: sha512-+5YyicIaaAZKU8K43IQi8TBy6mF6giGeWAH7N96Z5LC30Wm5JMjqxOYIE9mxwMG1NbhT2mA3l9hA4uuKUM3E5g==}
    dependencies:
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
      crelt: 1.0.6
    dev: false

  /@codemirror/search@6.5.6:
    resolution: {integrity: sha512-rpMgcsh7o0GuCDUXKPvww+muLA1pDJaFrpq/CCHtpQJYz8xopu4D1hPcKRoDD0YlF8gZaqTNIRa4VRBWyhyy7Q==}
    dependencies:
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
      crelt: 1.0.6
    dev: false

  /@codemirror/state@6.4.0:
    resolution: {integrity: sha512-hm8XshYj5Fo30Bb922QX9hXB/bxOAVH+qaqHBzw5TKa72vOeslyGwd4X8M0c1dJ9JqxlaMceOQ8RsL9tC7gU0A==}
    dev: false

  /@codemirror/view@6.24.0:
    resolution: {integrity: sha512-zK6m5pNkdhdJl8idPP1gA4N8JKTiSsOz8U/Iw+C1ChMwyLG7+MLiNXnH/wFuAk6KeGEe33/adOiAh5jMqee03w==}
    dependencies:
      '@codemirror/state': 6.4.0
      style-mod: 4.1.0
      w3c-keyname: 2.2.8
    dev: false

  /@esbuild/aix-ppc64@0.19.12:
    resolution: {integrity: sha512-bmoCYyWdEL3wDQIVbcyzRyeKLgk2WtWLTWz1ZIAZF/EGbNOwSA6ew3PftJ1PqMiOOGu0OyFMzG53L0zqIpPeNA==}
    engines: {node: '>=12'}
    cpu: [ppc64]
    os: [aix]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/android-arm64@0.18.20:
    resolution: {integrity: sha512-Nz4rJcchGDtENV0eMKUNa6L12zz2zBDXuhj/Vjh18zGqB44Bi7MBMSXjgunJgjRhCmKOjnPuZp4Mb6OKqtMHLQ==}
    engines: {node: '>=12'}
    cpu: [arm64]
    os: [android]
    requiresBuild: true
    optional: true

  /@esbuild/android-arm64@0.19.12:
    resolution: {integrity: sha512-P0UVNGIienjZv3f5zq0DP3Nt2IE/3plFzuaS96vihvD0Hd6H/q4WXUGpCxD/E8YrSXfNyRPbpTq+T8ZQioSuPA==}
    engines: {node: '>=12'}
    cpu: [arm64]
    os: [android]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/android-arm@0.18.20:
    resolution: {integrity: sha512-fyi7TDI/ijKKNZTUJAQqiG5T7YjJXgnzkURqmGj13C6dCqckZBLdl4h7bkhHt/t0WP+zO9/zwroDvANaOqO5Sw==}
    engines: {node: '>=12'}
    cpu: [arm]
    os: [android]
    requiresBuild: true
    optional: true

  /@esbuild/android-arm@0.19.12:
    resolution: {integrity: sha512-qg/Lj1mu3CdQlDEEiWrlC4eaPZ1KztwGJ9B6J+/6G+/4ewxJg7gqj8eVYWvao1bXrqGiW2rsBZFSX3q2lcW05w==}
    engines: {node: '>=12'}
    cpu: [arm]
    os: [android]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/android-x64@0.18.20:
    resolution: {integrity: sha512-8GDdlePJA8D6zlZYJV/jnrRAi6rOiNaCC/JclcXpB+KIuvfBN4owLtgzY2bsxnx666XjJx2kDPUmnTtR8qKQUg==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [android]
    requiresBuild: true
    optional: true

  /@esbuild/android-x64@0.19.12:
    resolution: {integrity: sha512-3k7ZoUW6Q6YqhdhIaq/WZ7HwBpnFBlW905Fa4s4qWJyiNOgT1dOqDiVAQFwBH7gBRZr17gLrlFCRzF6jFh7Kew==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [android]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/darwin-arm64@0.18.20:
    resolution: {integrity: sha512-bxRHW5kHU38zS2lPTPOyuyTm+S+eobPUnTNkdJEfAddYgEcll4xkT8DB9d2008DtTbl7uJag2HuE5NZAZgnNEA==}
    engines: {node: '>=12'}
    cpu: [arm64]
    os: [darwin]
    requiresBuild: true
    optional: true

  /@esbuild/darwin-arm64@0.19.12:
    resolution: {integrity: sha512-B6IeSgZgtEzGC42jsI+YYu9Z3HKRxp8ZT3cqhvliEHovq8HSX2YX8lNocDn79gCKJXOSaEot9MVYky7AKjCs8g==}
    engines: {node: '>=12'}
    cpu: [arm64]
    os: [darwin]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/darwin-x64@0.18.20:
    resolution: {integrity: sha512-pc5gxlMDxzm513qPGbCbDukOdsGtKhfxD1zJKXjCCcU7ju50O7MeAZ8c4krSJcOIJGFR+qx21yMMVYwiQvyTyQ==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [darwin]
    requiresBuild: true
    optional: true

  /@esbuild/darwin-x64@0.19.12:
    resolution: {integrity: sha512-hKoVkKzFiToTgn+41qGhsUJXFlIjxI/jSYeZf3ugemDYZldIXIxhvwN6erJGlX4t5h417iFuheZ7l+YVn05N3A==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [darwin]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/freebsd-arm64@0.18.20:
    resolution: {integrity: sha512-yqDQHy4QHevpMAaxhhIwYPMv1NECwOvIpGCZkECn8w2WFHXjEwrBn3CeNIYsibZ/iZEUemj++M26W3cNR5h+Tw==}
    engines: {node: '>=12'}
    cpu: [arm64]
    os: [freebsd]
    requiresBuild: true
    optional: true

  /@esbuild/freebsd-arm64@0.19.12:
    resolution: {integrity: sha512-4aRvFIXmwAcDBw9AueDQ2YnGmz5L6obe5kmPT8Vd+/+x/JMVKCgdcRwH6APrbpNXsPz+K653Qg8HB/oXvXVukA==}
    engines: {node: '>=12'}
    cpu: [arm64]
    os: [freebsd]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/freebsd-x64@0.18.20:
    resolution: {integrity: sha512-tgWRPPuQsd3RmBZwarGVHZQvtzfEBOreNuxEMKFcd5DaDn2PbBxfwLcj4+aenoh7ctXcbXmOQIn8HI6mCSw5MQ==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [freebsd]
    requiresBuild: true
    optional: true

  /@esbuild/freebsd-x64@0.19.12:
    resolution: {integrity: sha512-EYoXZ4d8xtBoVN7CEwWY2IN4ho76xjYXqSXMNccFSx2lgqOG/1TBPW0yPx1bJZk94qu3tX0fycJeeQsKovA8gg==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [freebsd]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/linux-arm64@0.18.20:
    resolution: {integrity: sha512-2YbscF+UL7SQAVIpnWvYwM+3LskyDmPhe31pE7/aoTMFKKzIc9lLbyGUpmmb8a8AixOL61sQ/mFh3jEjHYFvdA==}
    engines: {node: '>=12'}
    cpu: [arm64]
    os: [linux]
    requiresBuild: true
    optional: true

  /@esbuild/linux-arm64@0.19.12:
    resolution: {integrity: sha512-EoTjyYyLuVPfdPLsGVVVC8a0p1BFFvtpQDB/YLEhaXyf/5bczaGeN15QkR+O4S5LeJ92Tqotve7i1jn35qwvdA==}
    engines: {node: '>=12'}
    cpu: [arm64]
    os: [linux]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/linux-arm@0.18.20:
    resolution: {integrity: sha512-/5bHkMWnq1EgKr1V+Ybz3s1hWXok7mDFUMQ4cG10AfW3wL02PSZi5kFpYKrptDsgb2WAJIvRcDm+qIvXf/apvg==}
    engines: {node: '>=12'}
    cpu: [arm]
    os: [linux]
    requiresBuild: true
    optional: true

  /@esbuild/linux-arm@0.19.12:
    resolution: {integrity: sha512-J5jPms//KhSNv+LO1S1TX1UWp1ucM6N6XuL6ITdKWElCu8wXP72l9MM0zDTzzeikVyqFE6U8YAV9/tFyj0ti+w==}
    engines: {node: '>=12'}
    cpu: [arm]
    os: [linux]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/linux-ia32@0.18.20:
    resolution: {integrity: sha512-P4etWwq6IsReT0E1KHU40bOnzMHoH73aXp96Fs8TIT6z9Hu8G6+0SHSw9i2isWrD2nbx2qo5yUqACgdfVGx7TA==}
    engines: {node: '>=12'}
    cpu: [ia32]
    os: [linux]
    requiresBuild: true
    optional: true

  /@esbuild/linux-ia32@0.19.12:
    resolution: {integrity: sha512-Thsa42rrP1+UIGaWz47uydHSBOgTUnwBwNq59khgIwktK6x60Hivfbux9iNR0eHCHzOLjLMLfUMLCypBkZXMHA==}
    engines: {node: '>=12'}
    cpu: [ia32]
    os: [linux]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/linux-loong64@0.18.20:
    resolution: {integrity: sha512-nXW8nqBTrOpDLPgPY9uV+/1DjxoQ7DoB2N8eocyq8I9XuqJ7BiAMDMf9n1xZM9TgW0J8zrquIb/A7s3BJv7rjg==}
    engines: {node: '>=12'}
    cpu: [loong64]
    os: [linux]
    requiresBuild: true
    optional: true

  /@esbuild/linux-loong64@0.19.12:
    resolution: {integrity: sha512-LiXdXA0s3IqRRjm6rV6XaWATScKAXjI4R4LoDlvO7+yQqFdlr1Bax62sRwkVvRIrwXxvtYEHHI4dm50jAXkuAA==}
    engines: {node: '>=12'}
    cpu: [loong64]
    os: [linux]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/linux-mips64el@0.18.20:
    resolution: {integrity: sha512-d5NeaXZcHp8PzYy5VnXV3VSd2D328Zb+9dEq5HE6bw6+N86JVPExrA6O68OPwobntbNJ0pzCpUFZTo3w0GyetQ==}
    engines: {node: '>=12'}
    cpu: [mips64el]
    os: [linux]
    requiresBuild: true
    optional: true

  /@esbuild/linux-mips64el@0.19.12:
    resolution: {integrity: sha512-fEnAuj5VGTanfJ07ff0gOA6IPsvrVHLVb6Lyd1g2/ed67oU1eFzL0r9WL7ZzscD+/N6i3dWumGE1Un4f7Amf+w==}
    engines: {node: '>=12'}
    cpu: [mips64el]
    os: [linux]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/linux-ppc64@0.18.20:
    resolution: {integrity: sha512-WHPyeScRNcmANnLQkq6AfyXRFr5D6N2sKgkFo2FqguP44Nw2eyDlbTdZwd9GYk98DZG9QItIiTlFLHJHjxP3FA==}
    engines: {node: '>=12'}
    cpu: [ppc64]
    os: [linux]
    requiresBuild: true
    optional: true

  /@esbuild/linux-ppc64@0.19.12:
    resolution: {integrity: sha512-nYJA2/QPimDQOh1rKWedNOe3Gfc8PabU7HT3iXWtNUbRzXS9+vgB0Fjaqr//XNbd82mCxHzik2qotuI89cfixg==}
    engines: {node: '>=12'}
    cpu: [ppc64]
    os: [linux]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/linux-riscv64@0.18.20:
    resolution: {integrity: sha512-WSxo6h5ecI5XH34KC7w5veNnKkju3zBRLEQNY7mv5mtBmrP/MjNBCAlsM2u5hDBlS3NGcTQpoBvRzqBcRtpq1A==}
    engines: {node: '>=12'}
    cpu: [riscv64]
    os: [linux]
    requiresBuild: true
    optional: true

  /@esbuild/linux-riscv64@0.19.12:
    resolution: {integrity: sha512-2MueBrlPQCw5dVJJpQdUYgeqIzDQgw3QtiAHUC4RBz9FXPrskyyU3VI1hw7C0BSKB9OduwSJ79FTCqtGMWqJHg==}
    engines: {node: '>=12'}
    cpu: [riscv64]
    os: [linux]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/linux-s390x@0.18.20:
    resolution: {integrity: sha512-+8231GMs3mAEth6Ja1iK0a1sQ3ohfcpzpRLH8uuc5/KVDFneH6jtAJLFGafpzpMRO6DzJ6AvXKze9LfFMrIHVQ==}
    engines: {node: '>=12'}
    cpu: [s390x]
    os: [linux]
    requiresBuild: true
    optional: true

  /@esbuild/linux-s390x@0.19.12:
    resolution: {integrity: sha512-+Pil1Nv3Umes4m3AZKqA2anfhJiVmNCYkPchwFJNEJN5QxmTs1uzyy4TvmDrCRNT2ApwSari7ZIgrPeUx4UZDg==}
    engines: {node: '>=12'}
    cpu: [s390x]
    os: [linux]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/linux-x64@0.18.20:
    resolution: {integrity: sha512-UYqiqemphJcNsFEskc73jQ7B9jgwjWrSayxawS6UVFZGWrAAtkzjxSqnoclCXxWtfwLdzU+vTpcNYhpn43uP1w==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [linux]
    requiresBuild: true
    optional: true

  /@esbuild/linux-x64@0.19.12:
    resolution: {integrity: sha512-B71g1QpxfwBvNrfyJdVDexenDIt1CiDN1TIXLbhOw0KhJzE78KIFGX6OJ9MrtC0oOqMWf+0xop4qEU8JrJTwCg==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [linux]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/netbsd-x64@0.18.20:
    resolution: {integrity: sha512-iO1c++VP6xUBUmltHZoMtCUdPlnPGdBom6IrO4gyKPFFVBKioIImVooR5I83nTew5UOYrk3gIJhbZh8X44y06A==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [netbsd]
    requiresBuild: true
    optional: true

  /@esbuild/netbsd-x64@0.19.12:
    resolution: {integrity: sha512-3ltjQ7n1owJgFbuC61Oj++XhtzmymoCihNFgT84UAmJnxJfm4sYCiSLTXZtE00VWYpPMYc+ZQmB6xbSdVh0JWA==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [netbsd]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/openbsd-x64@0.18.20:
    resolution: {integrity: sha512-e5e4YSsuQfX4cxcygw/UCPIEP6wbIL+se3sxPdCiMbFLBWu0eiZOJ7WoD+ptCLrmjZBK1Wk7I6D/I3NglUGOxg==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [openbsd]
    requiresBuild: true
    optional: true

  /@esbuild/openbsd-x64@0.19.12:
    resolution: {integrity: sha512-RbrfTB9SWsr0kWmb9srfF+L933uMDdu9BIzdA7os2t0TXhCRjrQyCeOt6wVxr79CKD4c+p+YhCj31HBkYcXebw==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [openbsd]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/sunos-x64@0.18.20:
    resolution: {integrity: sha512-kDbFRFp0YpTQVVrqUd5FTYmWo45zGaXe0X8E1G/LKFC0v8x0vWrhOWSLITcCn63lmZIxfOMXtCfti/RxN/0wnQ==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [sunos]
    requiresBuild: true
    optional: true

  /@esbuild/sunos-x64@0.19.12:
    resolution: {integrity: sha512-HKjJwRrW8uWtCQnQOz9qcU3mUZhTUQvi56Q8DPTLLB+DawoiQdjsYq+j+D3s9I8VFtDr+F9CjgXKKC4ss89IeA==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [sunos]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/win32-arm64@0.18.20:
    resolution: {integrity: sha512-ddYFR6ItYgoaq4v4JmQQaAI5s7npztfV4Ag6NrhiaW0RrnOXqBkgwZLofVTlq1daVTQNhtI5oieTvkRPfZrePg==}
    engines: {node: '>=12'}
    cpu: [arm64]
    os: [win32]
    requiresBuild: true
    optional: true

  /@esbuild/win32-arm64@0.19.12:
    resolution: {integrity: sha512-URgtR1dJnmGvX864pn1B2YUYNzjmXkuJOIqG2HdU62MVS4EHpU2946OZoTMnRUHklGtJdJZ33QfzdjGACXhn1A==}
    engines: {node: '>=12'}
    cpu: [arm64]
    os: [win32]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/win32-ia32@0.18.20:
    resolution: {integrity: sha512-Wv7QBi3ID/rROT08SABTS7eV4hX26sVduqDOTe1MvGMjNd3EjOz4b7zeexIR62GTIEKrfJXKL9LFxTYgkyeu7g==}
    engines: {node: '>=12'}
    cpu: [ia32]
    os: [win32]
    requiresBuild: true
    optional: true

  /@esbuild/win32-ia32@0.19.12:
    resolution: {integrity: sha512-+ZOE6pUkMOJfmxmBZElNOx72NKpIa/HFOMGzu8fqzQJ5kgf6aTGrcJaFsNiVMH4JKpMipyK+7k0n2UXN7a8YKQ==}
    engines: {node: '>=12'}
    cpu: [ia32]
    os: [win32]
    requiresBuild: true
    dev: true
    optional: true

  /@esbuild/win32-x64@0.18.20:
    resolution: {integrity: sha512-kTdfRcSiDfQca/y9QIkng02avJ+NCaQvrMejlsB3RRv5sE9rRoeBPISaZpKxHELzRxZyLvNts1P27W3wV+8geQ==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [win32]
    requiresBuild: true
    optional: true

  /@esbuild/win32-x64@0.19.12:
    resolution: {integrity: sha512-T1QyPSDCyMXaO3pzBkF96E8xMkiRYbUEZADd29SyPGabqxMViNoii+NcK7eWJAEoU6RZyEm5lVSIjTmcdoB9HA==}
    engines: {node: '>=12'}
    cpu: [x64]
    os: [win32]
    requiresBuild: true
    dev: true
    optional: true

  /@fastify/busboy@2.1.0:
    resolution: {integrity: sha512-+KpH+QxZU7O4675t3mnkQKcZZg56u+K/Ct2K+N2AZYNVK8kyeo/bI18tI8aPm3tvNNRyTWfj6s5tnGNlcbQRsA==}
    engines: {node: '>=14'}

  /@fontsource/roboto-mono@5.0.16:
    resolution: {integrity: sha512-unZYfjXts55DQyODz0I9DzbSrS5DRKPNq9crJpNJe/Vy818bLnijprcJv3fvqwdDqTT0dRm2Fhk09QEIdtAc+Q==}
    dev: false

  /@jridgewell/gen-mapping@0.3.3:
    resolution: {integrity: sha512-HLhSWOLRi875zjjMG/r+Nv0oCW8umGb0BgEhyX3dDX3egwZtB8PqLnjz3yedt8R5StBrzcg4aBpnh8UA9D1BoQ==}
    engines: {node: '>=6.0.0'}
    dependencies:
      '@jridgewell/set-array': 1.1.2
      '@jridgewell/sourcemap-codec': 1.4.15
      '@jridgewell/trace-mapping': 0.3.22

  /@jridgewell/resolve-uri@3.1.1:
    resolution: {integrity: sha512-dSYZh7HhCDtCKm4QakX0xFpsRDqjjtZf/kjI/v3T3Nwt5r8/qz/M19F9ySyOqU94SXBmeG9ttTul+YnR4LOxFA==}
    engines: {node: '>=6.0.0'}

  /@jridgewell/set-array@1.1.2:
    resolution: {integrity: sha512-xnkseuNADM0gt2bs+BvhO0p78Mk762YnZdsuzFV018NoG1Sj1SCQvpSqa7XUaTam5vAGasABV9qXASMKnFMwMw==}
    engines: {node: '>=6.0.0'}

  /@jridgewell/sourcemap-codec@1.4.15:
    resolution: {integrity: sha512-eF2rxCRulEKXHTRiDrDy6erMYWqNw4LPdQ8UQA4huuxaQsVeRPFl2oM8oDGxMFhJUWZf9McpLtJasDDZb/Bpeg==}

  /@jridgewell/trace-mapping@0.3.22:
    resolution: {integrity: sha512-Wf963MzWtA2sjrNt+g18IAln9lKnlRp+K2eH4jjIoF1wYeq3aMREpG09xhlhdzS0EjwU7qmUJYangWa+151vZw==}
    dependencies:
      '@jridgewell/resolve-uri': 3.1.1
      '@jridgewell/sourcemap-codec': 1.4.15

  /@lezer/common@1.2.1:
    resolution: {integrity: sha512-yemX0ZD2xS/73llMZIK6KplkjIjf2EvAHcinDi/TfJ9hS25G0388+ClHt6/3but0oOxinTcQHJLDXh6w1crzFQ==}
    dev: false

  /@lezer/css@1.1.7:
    resolution: {integrity: sha512-7BlFFAKNn/b39jJLrhdLSX5A2k56GIJvyLqdmm7UU+7XvequY084iuKDMAEhAmAzHnwDE8FK4OQtsIUssW91tg==}
    dependencies:
      '@lezer/common': 1.2.1
      '@lezer/highlight': 1.2.0
      '@lezer/lr': 1.4.0
    dev: false

  /@lezer/highlight@1.2.0:
    resolution: {integrity: sha512-WrS5Mw51sGrpqjlh3d4/fOwpEV2Hd3YOkp9DBt4k8XZQcoTHZFB7sx030A6OcahF4J1nDQAa3jXlTVVYH50IFA==}
    dependencies:
      '@lezer/common': 1.2.1
    dev: false

  /@lezer/html@1.3.8:
    resolution: {integrity: sha512-EXseJ3pUzWxE6XQBQdqWHZqqlGQRSuNMBcLb6mZWS2J2v+QZhOObD+3ZIKIcm59ntTzyor4LqFTb72iJc3k23Q==}
    dependencies:
      '@lezer/common': 1.2.1
      '@lezer/highlight': 1.2.0
      '@lezer/lr': 1.4.0
    dev: false

  /@lezer/javascript@1.4.13:
    resolution: {integrity: sha512-5IBr8LIO3xJdJH1e9aj/ZNLE4LSbdsx25wFmGRAZsj2zSmwAYjx26JyU/BYOCpRQlu1jcv1z3vy4NB9+UkfRow==}
    dependencies:
      '@lezer/common': 1.2.1
      '@lezer/highlight': 1.2.0
      '@lezer/lr': 1.4.0
    dev: false

  /@lezer/json@1.0.2:
    resolution: {integrity: sha512-xHT2P4S5eeCYECyKNPhr4cbEL9tc8w83SPwRC373o9uEdrvGKTZoJVAGxpOsZckMlEh9W23Pc72ew918RWQOBQ==}
    dependencies:
      '@lezer/common': 1.2.1
      '@lezer/highlight': 1.2.0
      '@lezer/lr': 1.4.0
    dev: false

  /@lezer/lr@1.4.0:
    resolution: {integrity: sha512-Wst46p51km8gH0ZUmeNrtpRYmdlRHUpN1DQd3GFAyKANi8WVz8c2jHYTf1CVScFaCjQw1iO3ZZdqGDxQPRErTg==}
    dependencies:
      '@lezer/common': 1.2.1
    dev: false

  /@lezer/markdown@1.2.0:
    resolution: {integrity: sha512-d7MwsfAukZJo1GpPrcPGa3MxaFFOqNp0gbqF+3F7pTeNDOgeJN1muXzx1XXDPt+Ac+/voCzsH7qXqnn+xReG/g==}
    dependencies:
      '@lezer/common': 1.2.1
      '@lezer/highlight': 1.2.0
    dev: false

  /@mapbox/node-pre-gyp@1.0.11:
    resolution: {integrity: sha512-Yhlar6v9WQgUp/He7BdgzOz8lqMQ8sU+jkCq7Wx8Myc5YFJLbEe7lgui/V7G1qB1DJykHSGwreceSaD60Y0PUQ==}
    hasBin: true
    dependencies:
      detect-libc: 2.0.2
      https-proxy-agent: 5.0.1
      make-dir: 3.1.0
      node-fetch: 2.7.0
      nopt: 5.0.0
      npmlog: 5.0.1
      rimraf: 3.0.2
      semver: 7.6.0
      tar: 6.2.0
    transitivePeerDependencies:
      - encoding
      - supports-color
    dev: true

  /@neocodemirror/svelte@0.0.15(@codemirror/autocomplete@6.12.0)(@codemirror/commands@6.3.3)(@codemirror/language@6.10.1)(@codemirror/lint@6.5.0)(@codemirror/search@6.5.6)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0):
    resolution: {integrity: sha512-MCux+QCR40CboJu/TFwnqK7gYQ3fvtvHX8F/mk85DRH7vMoG3VDjJhqneAITX5IzohWKeP36hzcV+oHC2LYJqA==}
    peerDependencies:
      '@codemirror/autocomplete': ^6.7.1
      '@codemirror/commands': ^6.2.4
      '@codemirror/language': ^6.7.0
      '@codemirror/lint': ^6.2.1
      '@codemirror/search': ^6.4.0
      '@codemirror/state': ^6.2.0
      '@codemirror/view': ^6.12.0
    dependencies:
      '@codemirror/autocomplete': 6.12.0(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)
      '@codemirror/commands': 6.3.3
      '@codemirror/language': 6.10.1
      '@codemirror/lint': 6.5.0
      '@codemirror/search': 6.5.6
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
      csstype: 3.1.3
      nanostores: 0.8.1
    dev: false

  /@nodelib/fs.scandir@2.1.5:
    resolution: {integrity: sha512-vq24Bq3ym5HEQm2NKCr3yXDwjc7vTsEThRDnkp2DK9p1uqLR+DHurm/NOTo0KG7HYHU7eppKZj3MyqYuMBf62g==}
    engines: {node: '>= 8'}
    dependencies:
      '@nodelib/fs.stat': 2.0.5
      run-parallel: 1.2.0
    dev: true

  /@nodelib/fs.stat@2.0.5:
    resolution: {integrity: sha512-RkhPPp2zrqDAQA/2jNhnztcPAlv64XdhIp7a7454A5ovI7Bukxgt7MX7udwAu3zg1DcpPU0rz3VV1SeaqvY4+A==}
    engines: {node: '>= 8'}
    dev: true

  /@nodelib/fs.walk@1.2.8:
    resolution: {integrity: sha512-oGB+UxlgWcgQkgwo8GcEGwemoTFt3FIO9ababBmaGwXIoBKZ+GTy0pP185beGg7Llih/NSHSV2XAs1lnznocSg==}
    engines: {node: '>= 8'}
    dependencies:
      '@nodelib/fs.scandir': 2.1.5
      fastq: 1.17.1
    dev: true

  /@playwright/test@1.41.2:
    resolution: {integrity: sha512-qQB9h7KbibJzrDpkXkYvsmiDJK14FULCCZgEcoe2AvFAS64oCirWTwzTlAYEbKaRxWs5TFesE1Na6izMv3HfGg==}
    engines: {node: '>=16'}
    hasBin: true
    dependencies:
      playwright: 1.41.2
    dev: true

  /@polka/url@1.0.0-next.24:
    resolution: {integrity: sha512-2LuNTFBIO0m7kKIQvvPHN6UE63VjpmL9rnEEaOOaiSPbZK+zUOYIzBAWcED+3XYzhYsd/0mD57VdxAEqqV52CQ==}

  /@replit/codemirror-lang-svelte@6.0.0(@codemirror/autocomplete@6.12.0)(@codemirror/lang-css@6.2.1)(@codemirror/lang-html@6.4.8)(@codemirror/lang-javascript@6.2.1)(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)(@lezer/highlight@1.2.0)(@lezer/javascript@1.4.13)(@lezer/lr@1.4.0):
    resolution: {integrity: sha512-U2OqqgMM6jKelL0GNWbAmqlu1S078zZNoBqlJBW+retTc5M4Mha6/Y2cf4SVg6ddgloJvmcSpt4hHrVoM4ePRA==}
    peerDependencies:
      '@codemirror/autocomplete': ^6.0.0
      '@codemirror/lang-css': ^6.0.1
      '@codemirror/lang-html': ^6.2.0
      '@codemirror/lang-javascript': ^6.1.1
      '@codemirror/language': ^6.0.0
      '@codemirror/state': ^6.0.0
      '@codemirror/view': ^6.0.0
      '@lezer/common': ^1.0.0
      '@lezer/highlight': ^1.0.0
      '@lezer/javascript': ^1.2.0
      '@lezer/lr': ^1.0.0
    dependencies:
      '@codemirror/autocomplete': 6.12.0(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)
      '@codemirror/lang-css': 6.2.1(@codemirror/view@6.24.0)
      '@codemirror/lang-html': 6.4.8
      '@codemirror/lang-javascript': 6.2.1
      '@codemirror/language': 6.10.1
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
      '@lezer/common': 1.2.1
      '@lezer/highlight': 1.2.0
      '@lezer/javascript': 1.4.13
      '@lezer/lr': 1.4.0
    dev: false

  /@replit/codemirror-vim@6.1.0(@codemirror/commands@6.3.3)(@codemirror/language@6.10.1)(@codemirror/search@6.5.6)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0):
    resolution: {integrity: sha512-XATcrMBYphSgTTDHaL5cTdBKA+/kwg8x0kHpX9xFHkI8c2G9+nXdkIzFCtk76x1VDYQSlT6orNhudNt+9H9zOA==}
    peerDependencies:
      '@codemirror/commands': ^6.0.0
      '@codemirror/language': ^6.1.0
      '@codemirror/search': ^6.2.0
      '@codemirror/state': ^6.0.1
      '@codemirror/view': ^6.0.3
    dependencies:
      '@codemirror/commands': 6.3.3
      '@codemirror/language': 6.10.1
      '@codemirror/search': 6.5.6
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
    dev: false

  /@rich_harris/svelte-split-pane@1.1.1(svelte@4.2.10):
    resolution: {integrity: sha512-y2RRLyrN6DCeIgwA423aAIv/T5JqQeOl2XogBQ/21DvA2IF7oyrLUtXMxmQL2va2NFdeJO6MDx6nDX5X7kau7A==}
    peerDependencies:
      svelte: ^3.54.0
    dependencies:
      svelte: 4.2.10
    dev: false

  /@rollup/browser@3.29.4:
    resolution: {integrity: sha512-qkWkilNBn+90/9Xn2stuwFpXYhG/mZVPlDkTIPdQSEtJES0NS4o4atceEqeGeHOjQREY2jaIv7ld3IajA/Bmfw==}
    dev: false

  /@rollup/pluginutils@4.2.1:
    resolution: {integrity: sha512-iKnFXr7NkdZAIHiIWE+BX5ULi/ucVFYWD6TbAV+rZctiRTY2PL6tsIKhoIOaoskiWAkgu+VsbXgUVDNLHf+InQ==}
    engines: {node: '>= 8.0.0'}
    dependencies:
      estree-walker: 2.0.2
      picomatch: 2.3.1
    dev: true

  /@sveltejs/adapter-vercel@3.0.3(@sveltejs/kit@1.30.3):
    resolution: {integrity: sha512-0FQMjR6klW4627ewdclSr0lUe/DqiiyOaRTfgb5cXgNbVMsZMOA2fQ77TYQnJdvMfSEWe6y8uznV48XqKh9+vA==}
    peerDependencies:
      '@sveltejs/kit': ^1.5.0
    dependencies:
      '@sveltejs/kit': 1.30.3(svelte@4.2.10)(vite@4.5.2)
      '@vercel/nft': 0.23.1
      esbuild: 0.18.20
    transitivePeerDependencies:
      - encoding
      - supports-color
    dev: true

  /@sveltejs/kit@1.30.3(svelte@4.2.10)(vite@4.5.2):
    resolution: {integrity: sha512-0DzVXfU4h+tChFvoc8C61IqErCyskD4ydSIDjpKS2lYlEzIYrtYrY7juSqACFxqcvZAnOEXvSY+zZ8br0+ZMMg==}
    engines: {node: ^16.14 || >=18}
    hasBin: true
    requiresBuild: true
    peerDependencies:
      svelte: ^3.54.0 || ^4.0.0-next.0 || ^5.0.0-next.0
      vite: ^4.0.0
    dependencies:
      '@sveltejs/vite-plugin-svelte': 2.5.3(svelte@4.2.10)(vite@4.5.2)
      '@types/cookie': 0.5.4
      cookie: 0.5.0
      devalue: 4.3.2
      esm-env: 1.0.0
      kleur: 4.1.5
      magic-string: 0.30.7
      mrmime: 1.0.1
      sade: 1.8.1
      set-cookie-parser: 2.6.0
      sirv: 2.0.4
      svelte: 4.2.10
      tiny-glob: 0.2.9
      undici: 5.26.5
      vite: 4.5.2(lightningcss@1.23.0)
    transitivePeerDependencies:
      - supports-color

  /@sveltejs/repl@0.6.0(@codemirror/lang-html@6.4.8)(@codemirror/search@6.5.6)(@lezer/common@1.2.1)(@lezer/javascript@1.4.13)(@lezer/lr@1.4.0)(@sveltejs/kit@1.30.3)(svelte@4.2.10):
    resolution: {integrity: sha512-NADKN0NZhLlSatTSh5CCsdzgf2KHJFRef/8krA/TVWAWos5kSwmZ5fF0UImuqs61Pu/SiMXksaWNTGTiOtr4fQ==}
    peerDependencies:
      svelte: ^3.54.0 || ^4.0.0-next.0 || ^4.0.0
    dependencies:
      '@codemirror/autocomplete': 6.12.0(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)
      '@codemirror/commands': 6.3.3
      '@codemirror/lang-css': 6.2.1(@codemirror/view@6.24.0)
      '@codemirror/lang-javascript': 6.2.1
      '@codemirror/lang-json': 6.0.1
      '@codemirror/lang-markdown': 6.2.4
      '@codemirror/language': 6.10.1
      '@codemirror/lint': 6.5.0
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
      '@jridgewell/sourcemap-codec': 1.4.15
      '@lezer/highlight': 1.2.0
      '@neocodemirror/svelte': 0.0.15(@codemirror/autocomplete@6.12.0)(@codemirror/commands@6.3.3)(@codemirror/language@6.10.1)(@codemirror/lint@6.5.0)(@codemirror/search@6.5.6)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)
      '@replit/codemirror-lang-svelte': 6.0.0(@codemirror/autocomplete@6.12.0)(@codemirror/lang-css@6.2.1)(@codemirror/lang-html@6.4.8)(@codemirror/lang-javascript@6.2.1)(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)(@lezer/highlight@1.2.0)(@lezer/javascript@1.4.13)(@lezer/lr@1.4.0)
      '@replit/codemirror-vim': 6.1.0(@codemirror/commands@6.3.3)(@codemirror/language@6.10.1)(@codemirror/search@6.5.6)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)
      '@rich_harris/svelte-split-pane': 1.1.1(svelte@4.2.10)
      '@rollup/browser': 3.29.4
      '@sveltejs/site-kit': 5.2.2(@sveltejs/kit@1.30.3)(svelte@4.2.10)
      acorn: 8.11.3
      codemirror: 6.0.1(@lezer/common@1.2.1)
      esm-env: 1.0.0
      estree-walker: 3.0.3
      marked: 5.1.2
      resolve.exports: 2.0.2
      svelte: 4.2.10
      svelte-json-tree: 2.2.0(svelte@4.2.10)
    transitivePeerDependencies:
      - '@codemirror/lang-html'
      - '@codemirror/search'
      - '@lezer/common'
      - '@lezer/javascript'
      - '@lezer/lr'
      - '@sveltejs/kit'
    dev: false

  /@sveltejs/site-kit@5.2.2(@sveltejs/kit@1.30.3)(svelte@4.2.10):
    resolution: {integrity: sha512-XLLxVUV/dYytCsUeODAkjtzlaIBSn1kdcH5U36OuN7gMsPEHDy5L/dsWjf1/vDln3JStH5lqZPEN8Fovm33KhA==}
    peerDependencies:
      '@sveltejs/kit': ^1.0.0
      svelte: ^3.54.0
    dependencies:
      '@sveltejs/kit': 1.30.3(svelte@4.2.10)(vite@4.5.2)
      esm-env: 1.0.0
      svelte: 4.2.10
      svelte-local-storage-store: 0.4.0(svelte@4.2.10)
    dev: false

  /@sveltejs/site-kit@6.0.0-next.39(@sveltejs/kit@1.30.3)(svelte@4.2.10):
    resolution: {integrity: sha512-HARhb2WayjHL/3BFjffFO5cMJjbkPrN/01Tz8Oe3mZYmAUD4Cb3iUI34p415ASTIO6RAeDnClBZDwr2EsK6spg==}
    peerDependencies:
      '@sveltejs/kit': ^1.20.0
      svelte: ^4.0.0
    dependencies:
      '@sveltejs/kit': 1.30.3(svelte@4.2.10)(vite@4.5.2)
      esm-env: 1.0.0
      svelte: 4.2.10
      svelte-local-storage-store: 0.6.4(svelte@4.2.10)
    dev: true

  /@sveltejs/vite-plugin-svelte-inspector@1.0.4(@sveltejs/vite-plugin-svelte@2.5.3)(svelte@4.2.10)(vite@4.5.2):
    resolution: {integrity: sha512-zjiuZ3yydBtwpF3bj0kQNV0YXe+iKE545QGZVTaylW3eAzFr+pJ/cwK8lZEaRp4JtaJXhD5DyWAV4AxLh6DgaQ==}
    engines: {node: ^14.18.0 || >= 16}
    peerDependencies:
      '@sveltejs/vite-plugin-svelte': ^2.2.0
      svelte: ^3.54.0 || ^4.0.0
      vite: ^4.0.0
    dependencies:
      '@sveltejs/vite-plugin-svelte': 2.5.3(svelte@4.2.10)(vite@4.5.2)
      debug: 4.3.4
      svelte: 4.2.10
      vite: 4.5.2(lightningcss@1.23.0)
    transitivePeerDependencies:
      - supports-color

  /@sveltejs/vite-plugin-svelte@2.5.3(svelte@4.2.10)(vite@4.5.2):
    resolution: {integrity: sha512-erhNtXxE5/6xGZz/M9eXsmI7Pxa6MS7jyTy06zN3Ck++ldrppOnOlJwHHTsMC7DHDQdgUp4NAc4cDNQ9eGdB/w==}
    engines: {node: ^14.18.0 || >= 16}
    peerDependencies:
      svelte: ^3.54.0 || ^4.0.0 || ^5.0.0-next.0
      vite: ^4.0.0
    dependencies:
      '@sveltejs/vite-plugin-svelte-inspector': 1.0.4(@sveltejs/vite-plugin-svelte@2.5.3)(svelte@4.2.10)(vite@4.5.2)
      debug: 4.3.4
      deepmerge: 4.3.1
      kleur: 4.1.5
      magic-string: 0.30.7
      svelte: 4.2.10
      svelte-hmr: 0.15.3(svelte@4.2.10)
      vite: 4.5.2(lightningcss@1.23.0)
      vitefu: 0.2.5(vite@4.5.2)
    transitivePeerDependencies:
      - supports-color

  /@types/cookie@0.5.4:
    resolution: {integrity: sha512-7z/eR6O859gyWIAjuvBWFzNURmf2oPBmJlfVWkwehU5nzIyjwBsTh7WMmEEV4JFnHuQ3ex4oyTvfKzcyJVDBNA==}

  /@types/diff@5.0.9:
    resolution: {integrity: sha512-RWVEhh/zGXpAVF/ZChwNnv7r4rvqzJ7lYNSmZSVTxjV0PBLf6Qu7RNg+SUtkpzxmiNkjCx0Xn2tPp7FIkshJwQ==}
    dev: true

  /@types/estree@1.0.5:
    resolution: {integrity: sha512-/kYRxGDLWzHOB7q+wtSUQlFrtcdUccpfy+X+9iMBpHK8QLLhx2wIPYuS5DYtR9Wa/YlZAbIovy7qVdB1Aq6Lyw==}

  /@types/node@20.11.17:
    resolution: {integrity: sha512-QmgQZGWu1Yw9TDyAP9ZzpFJKynYNeOvwMJmaxABfieQoVoiVOS6MN1WSpqpRcbeA5+RW82kraAVxCCJg+780Qw==}
    dependencies:
      undici-types: 5.26.5
    dev: true

  /@types/prismjs@1.26.3:
    resolution: {integrity: sha512-A0D0aTXvjlqJ5ZILMz3rNfDBOx9hHxLZYv2by47Sm/pqW35zzjusrZTryatjN/Rf8Us2gZrJD+KeHbUSTux1Cw==}
    dev: true

  /@types/pug@2.0.10:
    resolution: {integrity: sha512-Sk/uYFOBAB7mb74XcpizmH0KOR2Pv3D2Hmrh1Dmy5BmK3MpdSa5kqZcg6EKBdklU0bFXX9gCfzvpnyUehrPIuA==}
    dev: true

  /@types/ws@8.5.10:
    resolution: {integrity: sha512-vmQSUcfalpIq0R9q7uTo2lXs6eGIpt9wtnLdMv9LVpIjCA/+ufZRozlVoVelIYixx1ugCBKDhn89vnsEGOCx9A==}
    dependencies:
      '@types/node': 20.11.17
    dev: true

  /@typescript/twoslash@3.1.0:
    resolution: {integrity: sha512-kTwMUQ8xtAZaC4wb2XuLkPqFVBj2dNBueMQ89NWEuw87k2nLBbuafeG5cob/QEr6YduxIdTVUjix0MtC7mPlmg==}
    dependencies:
      '@typescript/vfs': 1.3.5
      debug: 4.3.4
      lz-string: 1.5.0
    transitivePeerDependencies:
      - supports-color
    dev: true

  /@typescript/vfs@1.3.4:
    resolution: {integrity: sha512-RbyJiaAGQPIcAGWFa3jAXSuAexU4BFiDRF1g3hy7LmRqfNpYlTQWGXjcrOaVZjJ8YkkpuwG0FcsYvtWQpd9igQ==}
    dependencies:
      debug: 4.3.4
    transitivePeerDependencies:
      - supports-color
    dev: true

  /@typescript/vfs@1.3.5:
    resolution: {integrity: sha512-pI8Saqjupf9MfLw7w2+og+fmb0fZS0J6vsKXXrp4/PDXEFvntgzXmChCXC/KefZZS0YGS6AT8e0hGAJcTsdJlg==}
    dependencies:
      debug: 4.3.4
    transitivePeerDependencies:
      - supports-color
    dev: true

  /@vercel/nft@0.23.1:
    resolution: {integrity: sha512-NE0xSmGWVhgHF1OIoir71XAd0W0C1UE3nzFyhpFiMr3rVhetww7NvM1kc41trBsPG37Bh+dE5FYCTMzM/gBu0w==}
    engines: {node: '>=14'}
    hasBin: true
    dependencies:
      '@mapbox/node-pre-gyp': 1.0.11
      '@rollup/pluginutils': 4.2.1
      acorn: 8.11.3
      async-sema: 3.1.1
      bindings: 1.5.0
      estree-walker: 2.0.2
      glob: 7.2.3
      graceful-fs: 4.2.11
      micromatch: 4.0.5
      node-gyp-build: 4.8.0
      resolve-from: 5.0.0
    transitivePeerDependencies:
      - encoding
      - supports-color
    dev: true

  /@webcontainer/api@1.1.9:
    resolution: {integrity: sha512-Sp6PV0K9D/3f8fSbCubqhfmBFH8XbngZCBOCF+aExyGqnz2etmw+KYvbQ/JxYvYX5KPaSxM+asFQwoP2RHl5cg==}
    dev: false

  /abbrev@1.1.1:
    resolution: {integrity: sha512-nne9/IiQ/hzIhY6pdDnbBtz7DjPTKrY00P/zvPSm5pOFkl6xuGrGnXn/VtTNNfNtAfZ9/1RtehkszU9qcTii0Q==}
    dev: true

  /acorn@8.11.3:
    resolution: {integrity: sha512-Y9rRfJG5jcKOE0CLisYbojUjIrIEE7AGMzA/Sm4BslANhbS+cDMpgBdcPT91oJ7OuJ9hYJBx59RjbhxVnrF8Xg==}
    engines: {node: '>=0.4.0'}
    hasBin: true

  /adm-zip@0.5.10:
    resolution: {integrity: sha512-x0HvcHqVJNTPk/Bw8JbLWlWoo6Wwnsug0fnYYro1HBrjxZ3G7/AZk7Ahv8JwDe1uIcz8eBqvu86FuF1POiG7vQ==}
    engines: {node: '>=6.0'}
    dev: false

  /agent-base@6.0.2:
    resolution: {integrity: sha512-RZNwNclF7+MS/8bDg70amg32dyeZGZxiDuQmZxKLAlQjr3jGyLx+4Kkk58UO7D2QdgFIQCovuSuZESne6RG6XQ==}
    engines: {node: '>= 6.0.0'}
    dependencies:
      debug: 4.3.4
    transitivePeerDependencies:
      - supports-color
    dev: true

  /ansi-regex@5.0.1:
    resolution: {integrity: sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==}
    engines: {node: '>=8'}
    dev: true

  /ansi-to-html@0.7.2:
    resolution: {integrity: sha512-v6MqmEpNlxF+POuyhKkidusCHWWkaLcGRURzivcU3I9tv7k4JVhFcnukrM5Rlk2rUywdZuzYAZ+kbZqWCnfN3g==}
    engines: {node: '>=8.0.0'}
    hasBin: true
    dependencies:
      entities: 2.2.0
    dev: false

  /anymatch@3.1.3:
    resolution: {integrity: sha512-KMReFUr0B4t+D+OBkjR3KYqvocp2XaSzO55UcB6mgQMd3KbcE+mWTyvVV7D/zsdEbNnV6acZUutkiHQXvTr1Rw==}
    engines: {node: '>= 8'}
    dependencies:
      normalize-path: 3.0.0
      picomatch: 2.3.1
    dev: true

  /aproba@2.0.0:
    resolution: {integrity: sha512-lYe4Gx7QT+MKGbDsA+Z+he/Wtef0BiwDOlK/XkBrdfsh9J/jPPXbX0tE9x9cl27Tmu5gg3QUbUrQYa/y+KOHPQ==}
    dev: true

  /are-we-there-yet@2.0.0:
    resolution: {integrity: sha512-Ci/qENmwHnsYo9xKIcUJN5LeDKdJ6R1Z1j9V/J5wyq8nh/mYPEpIKJbBZXtZjG04HiK7zV/p6Vs9952MrMeUIw==}
    engines: {node: '>=10'}
    dependencies:
      delegates: 1.0.0
      readable-stream: 3.6.2
    dev: true

  /aria-query@5.3.0:
    resolution: {integrity: sha512-b0P0sZPKtyu8HkeRAfCq0IfURZK+SuwMjY1UXGBU27wpAiTwQAIlq56IbIO+ytk/JjS1fMR14ee5WBBfKi5J6A==}
    dependencies:
      dequal: 2.0.3

  /async-sema@3.1.1:
    resolution: {integrity: sha512-tLRNUXati5MFePdAk8dw7Qt7DpxPB60ofAgn8WRhW6a2rcimZnYBP9oxHiv0OHy+Wz7kPMG+t4LGdt31+4EmGg==}
    dev: true

  /axobject-query@4.0.0:
    resolution: {integrity: sha512-+60uv1hiVFhHZeO+Lz0RYzsVHy5Wr1ayX0mwda9KPDVLNJgZ1T9Ny7VmFbLDzxsH0D87I86vgj3gFrjTJUYznw==}
    dependencies:
      dequal: 2.0.3

  /balanced-match@1.0.2:
    resolution: {integrity: sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==}
    dev: true

  /base64-js@1.5.1:
    resolution: {integrity: sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==}
    dev: false

  /binary-extensions@2.2.0:
    resolution: {integrity: sha512-jDctJ/IVQbZoJykoeHbhXpOlNBqGNcwXJKJog42E5HDPUwQTSdjCHdihjj0DlnheQ7blbT6dHOafNAiS8ooQKA==}
    engines: {node: '>=8'}
    dev: true

  /bindings@1.5.0:
    resolution: {integrity: sha512-p2q/t/mhvuOj/UeLlV6566GD/guowlr0hHxClI0W9m7MWYkL1F0hLo+0Aexs9HSPCtR1SXQ0TD3MMKrXZajbiQ==}
    dependencies:
      file-uri-to-path: 1.0.0
    dev: true

  /brace-expansion@1.1.11:
    resolution: {integrity: sha512-iCuPHDFgrHX7H2vEI/5xpz07zSHB00TpugqhmYtVmMO6518mCuRMoOYFldEBl0g187ufozdaHgWKcYFb61qGiA==}
    dependencies:
      balanced-match: 1.0.2
      concat-map: 0.0.1
    dev: true

  /braces@3.0.2:
    resolution: {integrity: sha512-b8um+L1RzM3WDSzvhm6gIz1yfTbBt6YTlcEKAvsmqCZZFw46z626lVj9j1yEPW33H5H+lBQpZMP1k8l+78Ha0A==}
    engines: {node: '>=8'}
    dependencies:
      fill-range: 7.0.1
    dev: true

  /browserslist@4.22.3:
    resolution: {integrity: sha512-UAp55yfwNv0klWNapjs/ktHoguxuQNGnOzxYmfnXIS+8AsRDZkSDxg7R1AX3GKzn078SBI5dzwzj/Yx0Or0e3A==}
    engines: {node: ^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7}
    hasBin: true
    dependencies:
      caniuse-lite: 1.0.30001585
      electron-to-chromium: 1.4.664
      node-releases: 2.0.14
      update-browserslist-db: 1.0.13(browserslist@4.22.3)
    dev: true

  /buffer-crc32@0.2.13:
    resolution: {integrity: sha512-VO9Ht/+p3SN7SKWqcrgEzjGbRSJYTx+Q1pTQC0wrWqHx0vpJraQ6GtHx8tvcg1rlK1byhU5gccxgOgj7B0TDkQ==}
    dev: true

  /callsites@3.1.0:
    resolution: {integrity: sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ==}
    engines: {node: '>=6'}
    dev: true

  /caniuse-lite@1.0.30001585:
    resolution: {integrity: sha512-yr2BWR1yLXQ8fMpdS/4ZZXpseBgE7o4g41x3a6AJOqZuOi+iE/WdJYAuZ6Y95i4Ohd2Y+9MzIWRR+uGABH4s3Q==}
    dev: true

  /chokidar@3.6.0:
    resolution: {integrity: sha512-7VT13fmjotKpGipCW9JEQAusEPE+Ei8nl6/g4FBAmIm0GOOLMua9NDDo/DWp0ZAxCr3cPq5ZpBqmPAQgDda2Pw==}
    engines: {node: '>= 8.10.0'}
    dependencies:
      anymatch: 3.1.3
      braces: 3.0.2
      glob-parent: 5.1.2
      is-binary-path: 2.1.0
      is-glob: 4.0.3
      normalize-path: 3.0.0
      readdirp: 3.6.0
    optionalDependencies:
      fsevents: 2.3.3
    dev: true

  /chownr@2.0.0:
    resolution: {integrity: sha512-bIomtDF5KGpdogkLd9VspvFzk9KfpyyGlS8YFVZl7TGPBHL5snIOnxeshwVgPteQ9b4Eydl+pVbIyE1DcvCWgQ==}
    engines: {node: '>=10'}
    dev: true

  /code-red@1.0.4:
    resolution: {integrity: sha512-7qJWqItLA8/VPVlKJlFXU+NBlo/qyfs39aJcuMT/2ere32ZqvF5OSxgdM5xOfJJ7O429gg2HM47y8v9P+9wrNw==}
    dependencies:
      '@jridgewell/sourcemap-codec': 1.4.15
      '@types/estree': 1.0.5
      acorn: 8.11.3
      estree-walker: 3.0.3
      periscopic: 3.1.0

  /codemirror@6.0.1(@lezer/common@1.2.1):
    resolution: {integrity: sha512-J8j+nZ+CdWmIeFIGXEFbFPtpiYacFMDR8GlHK3IyHQJMCaVRfGx9NT+Hxivv1ckLWPvNdZqndbr/7lVhrf/Svg==}
    dependencies:
      '@codemirror/autocomplete': 6.12.0(@codemirror/language@6.10.1)(@codemirror/state@6.4.0)(@codemirror/view@6.24.0)(@lezer/common@1.2.1)
      '@codemirror/commands': 6.3.3
      '@codemirror/language': 6.10.1
      '@codemirror/lint': 6.5.0
      '@codemirror/search': 6.5.6
      '@codemirror/state': 6.4.0
      '@codemirror/view': 6.24.0
    transitivePeerDependencies:
      - '@lezer/common'
    dev: false

  /color-support@1.1.3:
    resolution: {integrity: sha512-qiBjkpbMLO/HL68y+lh4q0/O1MZFj2RX6X/KmMa3+gJD3z+WwI1ZzDHysvqHGS3mP6mznPckpXmw1nI9cJjyRg==}
    hasBin: true
    dev: true

  /concat-map@0.0.1:
    resolution: {integrity: sha1-2Klr13/Wjfd5OnMDajug1UBdR3s=}
    dev: true

  /console-control-strings@1.1.0:
    resolution: {integrity: sha512-ty/fTekppD2fIwRvnZAVdeOiGd1c7YXEixbgJTNzqcxJWKQnjJ/V1bNEEE6hygpM3WjwHFUVK6HTjWSzV4a8sQ==}
    dev: true

  /cookie@0.5.0:
    resolution: {integrity: sha512-YZ3GUyn/o8gfKJlnlX7g7xq4gyO6OSuhGPKaaGssGB2qgDUS0gPgtTvoyZLTt9Ab6dC4hfc9dV5arkvc/OCmrw==}
    engines: {node: '>= 0.6'}

  /crelt@1.0.6:
    resolution: {integrity: sha512-VQ2MBenTq1fWZUH9DJNGti7kKv6EeAuYr3cLwxUWhIu1baTaXh4Ib5W2CqHVqib4/MqbYGJqiL3Zb8GJZr3l4g==}
    dev: false

  /css-tree@2.3.1:
    resolution: {integrity: sha512-6Fv1DV/TYw//QF5IzQdqsNDjx/wc8TrMBZsqjL9eW01tWb7R7k/mq+/VXfJCl7SoD5emsJop9cOByJZfs8hYIw==}
    engines: {node: ^10 || ^12.20.0 || ^14.13.0 || >=15.0.0}
    dependencies:
      mdn-data: 2.0.30
      source-map-js: 1.0.2

  /csstype@3.1.3:
    resolution: {integrity: sha512-M1uQkMl8rQK/szD0LNhtqxIPLpimGm8sOBwU7lLnCpSbTyY3yeU1Vc7l4KT5zT4s/yOxHH5O7tIuuLOCnLADRw==}
    dev: false

  /debug@4.3.4:
    resolution: {integrity: sha512-PRWFHuSU3eDtQJPvnNY7Jcket1j0t5OuOsFzPPzsekD52Zl8qUfFIPEiswXqIvHWGVHOgX+7G/vCNNhehwxfkQ==}
    engines: {node: '>=6.0'}
    peerDependencies:
      supports-color: '*'
    peerDependenciesMeta:
      supports-color:
        optional: true
    dependencies:
      ms: 2.1.2

  /deepmerge@4.3.1:
    resolution: {integrity: sha512-3sUqbMEc77XqpdNO7FRyRog+eW3ph+GYCbj+rK+uYyRMuwsVy0rMiVtPn+QJlKFvWP/1PYpapqYn0Me2knFn+A==}
    engines: {node: '>=0.10.0'}

  /delegates@1.0.0:
    resolution: {integrity: sha512-bd2L678uiWATM6m5Z1VzNCErI3jiGzt6HGY8OVICs40JQq/HALfbyNJmp0UDakEY4pMMaN0Ly5om/B1VI/+xfQ==}
    dev: true

  /dequal@2.0.3:
    resolution: {integrity: sha512-0je+qPKHEMohvfRTCEo3CrPG6cAzAYgmzKyxRiYSSDkS6eGJdyVJm7WaYA5ECaAD9wLB2T4EEeymA5aFVcYXCA==}
    engines: {node: '>=6'}

  /detect-indent@6.1.0:
    resolution: {integrity: sha512-reYkTUJAZb9gUuZ2RvVCNhVHdg62RHnJ7WJl8ftMi4diZ6NWlciOzQN88pUhSELEwflJht4oQDv0F0BMlwaYtA==}
    engines: {node: '>=8'}
    dev: true

  /detect-libc@1.0.3:
    resolution: {integrity: sha512-pGjwhsmsp4kL2RTz08wcOlGN83otlqHeD/Z5T8GXZB+/YcpQ/dgo+lbU8ZsGxV0HIvqqxo9l7mqYwyYMD9bKDg==}
    engines: {node: '>=0.10'}
    hasBin: true

  /detect-libc@2.0.2:
    resolution: {integrity: sha512-UX6sGumvvqSaXgdKGUsgZWqcUyIXZ/vZTrlRT/iobiKhGL0zL4d3osHj3uqllWJK+i+sixDS/3COVEOFbupFyw==}
    engines: {node: '>=8'}
    dev: true

  /devalue@4.3.2:
    resolution: {integrity: sha512-KqFl6pOgOW+Y6wJgu80rHpo2/3H07vr8ntR9rkkFIRETewbf5GaYYcakYfiKz89K+sLsuPkQIZaXDMjUObZwWg==}

  /diff@5.1.0:
    resolution: {integrity: sha512-D+mk+qE8VC/PAUrlAU34N+VfXev0ghe5ywmpqrawphmVZc1bEfn56uo9qpyGp1p4xpzOHkSW4ztBd6L7Xx4ACw==}
    engines: {node: '>=0.3.1'}
    dev: true

  /electron-to-chromium@1.4.664:
    resolution: {integrity: sha512-k9VKKSkOSNPvSckZgDDl/IQx45E1quMjX8QfLzUsAs/zve8AyFDK+ByRynSP/OfEfryiKHpQeMf00z0leLCc3A==}
    dev: true

  /emoji-regex@8.0.0:
    resolution: {integrity: sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==}
    dev: true

  /entities@2.2.0:
    resolution: {integrity: sha512-p92if5Nz619I0w+akJrLZH0MX0Pb5DX39XOwQTtXSdQQOaYH03S1uIQp4mhOZtAXrxq4ViO67YTiLBo2638o9A==}
    dev: false

  /es6-promise@3.3.1:
    resolution: {integrity: sha512-SOp9Phqvqn7jtEUxPWdWfWoLmyt2VaJ6MpvP9Comy1MceMXqE6bxvaTu4iaxpYYPzhny28Lc+M87/c2cPK6lDg==}
    dev: true

  /esbuild@0.18.20:
    resolution: {integrity: sha512-ceqxoedUrcayh7Y7ZX6NdbbDzGROiyVBgC4PriJThBKSVPWnnFHZAkfI1lJT8QFkOwH4qOS2SJkS4wvpGl8BpA==}
    engines: {node: '>=12'}
    hasBin: true
    requiresBuild: true
    optionalDependencies:
      '@esbuild/android-arm': 0.18.20
      '@esbuild/android-arm64': 0.18.20
      '@esbuild/android-x64': 0.18.20
      '@esbuild/darwin-arm64': 0.18.20
      '@esbuild/darwin-x64': 0.18.20
      '@esbuild/freebsd-arm64': 0.18.20
      '@esbuild/freebsd-x64': 0.18.20
      '@esbuild/linux-arm': 0.18.20
      '@esbuild/linux-arm64': 0.18.20
      '@esbuild/linux-ia32': 0.18.20
      '@esbuild/linux-loong64': 0.18.20
      '@esbuild/linux-mips64el': 0.18.20
      '@esbuild/linux-ppc64': 0.18.20
      '@esbuild/linux-riscv64': 0.18.20
      '@esbuild/linux-s390x': 0.18.20
      '@esbuild/linux-x64': 0.18.20
      '@esbuild/netbsd-x64': 0.18.20
      '@esbuild/openbsd-x64': 0.18.20
      '@esbuild/sunos-x64': 0.18.20
      '@esbuild/win32-arm64': 0.18.20
      '@esbuild/win32-ia32': 0.18.20
      '@esbuild/win32-x64': 0.18.20

  /esbuild@0.19.12:
    resolution: {integrity: sha512-aARqgq8roFBj054KvQr5f1sFu0D65G+miZRCuJyJ0G13Zwx7vRar5Zhn2tkQNzIXcBrNVsv/8stehpj+GAjgbg==}
    engines: {node: '>=12'}
    hasBin: true
    requiresBuild: true
    optionalDependencies:
      '@esbuild/aix-ppc64': 0.19.12
      '@esbuild/android-arm': 0.19.12
      '@esbuild/android-arm64': 0.19.12
      '@esbuild/android-x64': 0.19.12
      '@esbuild/darwin-arm64': 0.19.12
      '@esbuild/darwin-x64': 0.19.12
      '@esbuild/freebsd-arm64': 0.19.12
      '@esbuild/freebsd-x64': 0.19.12
      '@esbuild/linux-arm': 0.19.12
      '@esbuild/linux-arm64': 0.19.12
      '@esbuild/linux-ia32': 0.19.12
      '@esbuild/linux-loong64': 0.19.12
      '@esbuild/linux-mips64el': 0.19.12
      '@esbuild/linux-ppc64': 0.19.12
      '@esbuild/linux-riscv64': 0.19.12
      '@esbuild/linux-s390x': 0.19.12
      '@esbuild/linux-x64': 0.19.12
      '@esbuild/netbsd-x64': 0.19.12
      '@esbuild/openbsd-x64': 0.19.12
      '@esbuild/sunos-x64': 0.19.12
      '@esbuild/win32-arm64': 0.19.12
      '@esbuild/win32-ia32': 0.19.12
      '@esbuild/win32-x64': 0.19.12
    dev: true

  /escalade@3.1.2:
    resolution: {integrity: sha512-ErCHMCae19vR8vQGe50xIsVomy19rg6gFu3+r3jkEO46suLMWBksvVyoGgQV+jOfl84ZSOSlmv6Gxa89PmTGmA==}
    engines: {node: '>=6'}
    dev: true

  /esm-env@1.0.0:
    resolution: {integrity: sha512-Cf6VksWPsTuW01vU9Mk/3vRue91Zevka5SjyNf3nEpokFRuqt/KjUQoGAwq9qMmhpLTHmXzSIrFRw8zxWzmFBA==}

  /estree-walker@2.0.2:
    resolution: {integrity: sha512-Rfkk/Mp/DL7JVje3u18FxFujQlTNR2q6QfMSMB7AvCBx91NGj/ba3kCfza0f6dVDbw7YlRf/nDrn7pQrCCyQ/w==}
    dev: true

  /estree-walker@3.0.3:
    resolution: {integrity: sha512-7RUKfXgSMMkzt6ZuXmqapOurLGPPfgj6l9uRZ7lRGolvk0y2yocc35LdcxKC5PQZdn2DMqioAQ2NoWcrTKmm6g==}
    dependencies:
      '@types/estree': 1.0.5

  /fast-glob@3.3.2:
    resolution: {integrity: sha512-oX2ruAFQwf/Orj8m737Y5adxDQO0LAB7/S5MnxCdTNDd4p6BsyIVsv9JQsATbTSq8KHRpLwIHbVlUNatxd+1Ow==}
    engines: {node: '>=8.6.0'}
    dependencies:
      '@nodelib/fs.stat': 2.0.5
      '@nodelib/fs.walk': 1.2.8
      glob-parent: 5.1.2
      merge2: 1.4.1
      micromatch: 4.0.5
    dev: true

  /fastq@1.17.1:
    resolution: {integrity: sha512-sRVD3lWVIXWg6By68ZN7vho9a1pQcN/WBFaAAsDDFzlJjvoGx0P8z7V1t72grFJfJhu3YPZBuu25f7Kaw2jN1w==}
    dependencies:
      reusify: 1.0.4
    dev: true

  /fenceparser@1.1.1:
    resolution: {integrity: sha512-VdkTsK7GWLT0VWMK5S5WTAPn61wJ98WPFwJiRHumhg4ESNUO/tnkU8bzzzc62o6Uk1SVhuZFLnakmDA4SGV7wA==}
    engines: {node: '>=12'}
    dev: true

  /file-uri-to-path@1.0.0:
    resolution: {integrity: sha512-0Zt+s3L7Vf1biwWZ29aARiVYLx7iMGnEUl9x33fbB/j3jR81u/O2LbqK+Bm1CDSNDKVtJ/YjwY7TUd5SkeLQLw==}
    dev: true

  /fill-range@7.0.1:
    resolution: {integrity: sha512-qOo9F+dMUmC2Lcb4BbVvnKJxTPjCm+RRpe4gDuGrzkL7mEVl/djYSu2OdQ2Pa302N4oqkSg9ir6jaLWJ2USVpQ==}
    engines: {node: '>=8'}
    dependencies:
      to-regex-range: 5.0.1
    dev: true

  /flexsearch@0.7.43:
    resolution: {integrity: sha512-c5o/+Um8aqCSOXGcZoqZOm+NqtVwNsvVpWv6lfmSclU954O3wvQKxxK8zj74fPaSJbXpSLTs4PRhh+wnoCXnKg==}
    dev: false

  /fs-minipass@2.1.0:
    resolution: {integrity: sha512-V/JgOLFCS+R6Vcq0slCuaeWEdNC3ouDlJMNIsacH2VtALiu9mV4LPrHc5cDl8k5aw6J8jwgWWpiTo5RYhmIzvg==}
    engines: {node: '>= 8'}
    dependencies:
      minipass: 3.3.6
    dev: true

  /fs.realpath@1.0.0:
    resolution: {integrity: sha512-OO0pH2lK6a0hZnAdau5ItzHPI6pUlvI7jMVnxUQRtw4owF2wk8lOSabtGDCTP4Ggrg2MbGnWO9X8K1t4+fGMDw==}
    dev: true

  /fsevents@2.3.2:
    resolution: {integrity: sha512-xiqMQR4xAeHTuB9uWm+fFRcIOgKBMiOBP+eXiyT7jsgVCq1bkVygt00oASowB7EdtpOHaaPgKt812P9ab+DDKA==}
    engines: {node: ^8.16.0 || ^10.6.0 || >=11.0.0}
    os: [darwin]
    requiresBuild: true
    dev: true
    optional: true

  /fsevents@2.3.3:
    resolution: {integrity: sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==}
    engines: {node: ^8.16.0 || ^10.6.0 || >=11.0.0}
    os: [darwin]
    requiresBuild: true
    optional: true

  /gauge@3.0.2:
    resolution: {integrity: sha512-+5J6MS/5XksCuXq++uFRsnUd7Ovu1XenbeuIuNRJxYWjgQbPuFhT14lAvsWfqfAmnwluf1OwMjz39HjfLPci0Q==}
    engines: {node: '>=10'}
    dependencies:
      aproba: 2.0.0
      color-support: 1.1.3
      console-control-strings: 1.1.0
      has-unicode: 2.0.1
      object-assign: 4.1.1
      signal-exit: 3.0.7
      string-width: 4.2.3
      strip-ansi: 6.0.1
      wide-align: 1.1.5
    dev: true

  /glob-parent@5.1.2:
    resolution: {integrity: sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==}
    engines: {node: '>= 6'}
    dependencies:
      is-glob: 4.0.3
    dev: true

  /glob@7.2.3:
    resolution: {integrity: sha512-nFR0zLpU2YCaRxwoCJvL6UvCH2JFyFVIvwTLsIf21AuHlMskA1hhTdk+LlYJtOlYt9v6dvszD2BGRqBL+iQK9Q==}
    dependencies:
      fs.realpath: 1.0.0
      inflight: 1.0.6
      inherits: 2.0.4
      minimatch: 3.1.2
      once: 1.4.0
      path-is-absolute: 1.0.1
    dev: true

  /globalyzer@0.1.0:
    resolution: {integrity: sha512-40oNTM9UfG6aBmuKxk/giHn5nQ8RVz/SS4Ir6zgzOv9/qC3kKZ9v4etGTcJbEl/NyVQH7FGU7d+X1egr57Md2Q==}

  /globrex@0.1.2:
    resolution: {integrity: sha512-uHJgbwAMwNFf5mLst7IWLNg14x1CkeqglJb/K3doi4dw6q2IvAAmM/Y81kevy83wP+Sst+nutFTYOGg3d1lsxg==}

  /graceful-fs@4.2.11:
    resolution: {integrity: sha512-RbJ5/jmFcNNCcDV5o9eTnBLJ/HszWV0P73bc+Ff4nS/rJj+YaS6IGyiOL0VoBYX+l1Wrl3k63h/KrH+nhJ0XvQ==}
    dev: true

  /has-unicode@2.0.1:
    resolution: {integrity: sha512-8Rf9Y83NBReMnx0gFzA8JImQACstCYWUplepDa9xprwwtmgEZUF0h/i5xSA625zB/I37EtrswSST6OXxwaaIJQ==}
    dev: true

  /https-proxy-agent@5.0.1:
    resolution: {integrity: sha512-dFcAjpTQFgoLMzC2VwU+C/CbS7uRL0lWmxDITmqm7C+7F0Odmj6s9l6alZc6AELXhrnggM2CeWSXHGOdX2YtwA==}
    engines: {node: '>= 6'}
    dependencies:
      agent-base: 6.0.2
      debug: 4.3.4
    transitivePeerDependencies:
      - supports-color
    dev: true

  /import-fresh@3.3.0:
    resolution: {integrity: sha512-veYYhQa+D1QBKznvhUHxb8faxlrwUnxseDAbAp457E0wLNio2bOSKnjYDhMj+YiAq61xrMGhQk9iXVk5FzgQMw==}
    engines: {node: '>=6'}
    dependencies:
      parent-module: 1.0.1
      resolve-from: 4.0.0
    dev: true

  /inflight@1.0.6:
    resolution: {integrity: sha512-k92I/b08q4wvFscXCLvqfsHCrjrF7yiXsQuIVvVE7N82W3+aqpzuUdBbfhWcy/FZR3/4IgflMgKLOsvPDrGCJA==}
    dependencies:
      once: 1.4.0
      wrappy: 1.0.2
    dev: true

  /inherits@2.0.4:
    resolution: {integrity: sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==}
    dev: true

  /is-binary-path@2.1.0:
    resolution: {integrity: sha512-ZMERYes6pDydyuGidse7OsHxtbI7WVeUEozgR/g7rd0xUimYNlvZRE/K2MgZTjWy725IfelLeVcEM97mmtRGXw==}
    engines: {node: '>=8'}
    dependencies:
      binary-extensions: 2.2.0
    dev: true

  /is-extglob@2.1.1:
    resolution: {integrity: sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==}
    engines: {node: '>=0.10.0'}
    dev: true

  /is-fullwidth-code-point@3.0.0:
    resolution: {integrity: sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==}
    engines: {node: '>=8'}
    dev: true

  /is-glob@4.0.3:
    resolution: {integrity: sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==}
    engines: {node: '>=0.10.0'}
    dependencies:
      is-extglob: 2.1.1
    dev: true

  /is-number@7.0.0:
    resolution: {integrity: sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==}
    engines: {node: '>=0.12.0'}
    dev: true

  /is-reference@3.0.2:
    resolution: {integrity: sha512-v3rht/LgVcsdZa3O2Nqs+NMowLOxeOm7Ay9+/ARQ2F+qEoANRcqrjAZKGN0v8ymUetZGgkp26LTnGT7H0Qo9Pg==}
    dependencies:
      '@types/estree': 1.0.5

  /jsonc-parser@3.2.1:
    resolution: {integrity: sha512-AilxAyFOAcK5wA1+LeaySVBrHsGQvUFCDWXKpZjzaL0PqW+xfBOttn8GNtWKFWqneyMZj41MWF9Kl6iPWLwgOA==}
    dev: true

  /kleur@4.1.5:
    resolution: {integrity: sha512-o+NO+8WrRiQEE4/7nwRJhN1HWpVmJm511pBHUxPLtp0BUISzlBplORYSmTclCnJvQq2tKu/sgl3xVpkc7ZWuQQ==}
    engines: {node: '>=6'}

  /lightningcss-darwin-arm64@1.23.0:
    resolution: {integrity: sha512-kl4Pk3Q2lnE6AJ7Qaij47KNEfY2/UXRZBT/zqGA24B8qwkgllr/j7rclKOf1axcslNXvvUdztjo4Xqh39Yq1aA==}
    engines: {node: '>= 12.0.0'}
    cpu: [arm64]
    os: [darwin]
    requiresBuild: true
    optional: true

  /lightningcss-darwin-x64@1.23.0:
    resolution: {integrity: sha512-KeRFCNoYfDdcolcFXvokVw+PXCapd2yHS1Diko1z1BhRz/nQuD5XyZmxjWdhmhN/zj5sH8YvWsp0/lPLVzqKpg==}
    engines: {node: '>= 12.0.0'}
    cpu: [x64]
    os: [darwin]
    requiresBuild: true
    optional: true

  /lightningcss-freebsd-x64@1.23.0:
    resolution: {integrity: sha512-xhnhf0bWPuZxcqknvMDRFFo2TInrmQRWZGB0f6YoAsZX8Y+epfjHeeOIGCfAmgF0DgZxHwYc8mIR5tQU9/+ROA==}
    engines: {node: '>= 12.0.0'}
    cpu: [x64]
    os: [freebsd]
    requiresBuild: true
    optional: true

  /lightningcss-linux-arm-gnueabihf@1.23.0:
    resolution: {integrity: sha512-fBamf/bULvmWft9uuX+bZske236pUZEoUlaHNBjnueaCTJ/xd8eXgb0cEc7S5o0Nn6kxlauMBnqJpF70Bgq3zg==}
    engines: {node: '>= 12.0.0'}
    cpu: [arm]
    os: [linux]
    requiresBuild: true
    optional: true

  /lightningcss-linux-arm64-gnu@1.23.0:
    resolution: {integrity: sha512-RS7sY77yVLOmZD6xW2uEHByYHhQi5JYWmgVumYY85BfNoVI3DupXSlzbw+b45A9NnVKq45+oXkiN6ouMMtTwfg==}
    engines: {node: '>= 12.0.0'}
    cpu: [arm64]
    os: [linux]
    requiresBuild: true
    optional: true

  /lightningcss-linux-arm64-musl@1.23.0:
    resolution: {integrity: sha512-cU00LGb6GUXCwof6ACgSMKo3q7XYbsyTj0WsKHLi1nw7pV0NCq8nFTn6ZRBYLoKiV8t+jWl0Hv8KkgymmK5L5g==}
    engines: {node: '>= 12.0.0'}
    cpu: [arm64]
    os: [linux]
    requiresBuild: true
    optional: true

  /lightningcss-linux-x64-gnu@1.23.0:
    resolution: {integrity: sha512-q4jdx5+5NfB0/qMbXbOmuC6oo7caPnFghJbIAV90cXZqgV8Am3miZhC4p+sQVdacqxfd+3nrle4C8icR3p1AYw==}
    engines: {node: '>= 12.0.0'}
    cpu: [x64]
    os: [linux]
    requiresBuild: true
    optional: true

  /lightningcss-linux-x64-musl@1.23.0:
    resolution: {integrity: sha512-G9Ri3qpmF4qef2CV/80dADHKXRAQeQXpQTLx7AiQrBYQHqBjB75oxqj06FCIe5g4hNCqLPnM9fsO4CyiT1sFSQ==}
    engines: {node: '>= 12.0.0'}
    cpu: [x64]
    os: [linux]
    requiresBuild: true
    optional: true

  /lightningcss-win32-x64-msvc@1.23.0:
    resolution: {integrity: sha512-1rcBDJLU+obPPJM6qR5fgBUiCdZwZLafZM5f9kwjFLkb/UBNIzmae39uCSmh71nzPCTXZqHbvwu23OWnWEz+eg==}
    engines: {node: '>= 12.0.0'}
    cpu: [x64]
    os: [win32]
    requiresBuild: true
    optional: true

  /lightningcss@1.23.0:
    resolution: {integrity: sha512-SEArWKMHhqn/0QzOtclIwH5pXIYQOUEkF8DgICd/105O+GCgd7jxjNod/QPnBCSWvpRHQBGVz5fQ9uScby03zA==}
    engines: {node: '>= 12.0.0'}
    dependencies:
      detect-libc: 1.0.3
    optionalDependencies:
      lightningcss-darwin-arm64: 1.23.0
      lightningcss-darwin-x64: 1.23.0
      lightningcss-freebsd-x64: 1.23.0
      lightningcss-linux-arm-gnueabihf: 1.23.0
      lightningcss-linux-arm64-gnu: 1.23.0
      lightningcss-linux-arm64-musl: 1.23.0
      lightningcss-linux-x64-gnu: 1.23.0
      lightningcss-linux-x64-musl: 1.23.0
      lightningcss-win32-x64-msvc: 1.23.0

  /locate-character@3.0.0:
    resolution: {integrity: sha512-SW13ws7BjaeJ6p7Q6CO2nchbYEc3X3J6WrmTTDto7yMPqVSZTUyY5Tjbid+Ab8gLnATtygYtiDIJGQRRn2ZOiA==}

  /lru-cache@6.0.0:
    resolution: {integrity: sha512-Jo6dJ04CmSjuznwJSS3pUeWmd/H0ffTlkXXgwZi+eq1UCmqQwCh+eLsYOYCwY991i2Fah4h1BEMCx4qThGbsiA==}
    engines: {node: '>=10'}
    dependencies:
      yallist: 4.0.0
    dev: true

  /lz-string@1.5.0:
    resolution: {integrity: sha512-h5bgJWpxJNswbU7qCrV0tIKQCaS3blPDrqKWx+QxzuzL1zGUzij9XCWLrSLsJPu5t+eWA/ycetzYAO5IOMcWAQ==}
    hasBin: true
    dev: true

  /magic-string@0.30.7:
    resolution: {integrity: sha512-8vBuFF/I/+OSLRmdf2wwFCJCz+nSn0m6DPvGH1fS/KiQoSaR+sETbov0eIk9KhEKy8CYqIkIAnbohxT/4H0kuA==}
    engines: {node: '>=12'}
    dependencies:
      '@jridgewell/sourcemap-codec': 1.4.15

  /make-dir@3.1.0:
    resolution: {integrity: sha512-g3FeP20LNwhALb/6Cz6Dd4F2ngze0jz7tbzrD2wAV+o9FeNHe4rL+yK2md0J/fiSf1sa1ADhXqi5+oVwOM/eGw==}
    engines: {node: '>=8'}
    dependencies:
      semver: 6.3.1
    dev: true

  /marked@5.1.2:
    resolution: {integrity: sha512-ahRPGXJpjMjwSOlBoTMZAK7ATXkli5qCPxZ21TG44rx1KEo44bii4ekgTDQPNRQ4Kh7JMb9Ub1PVk1NxRSsorg==}
    engines: {node: '>= 16'}
    hasBin: true
    dev: false

  /marked@8.0.1:
    resolution: {integrity: sha512-eEbeEb/mJwh+sNLEhHOWtxMgjN/NEwZUBs1nkiIH2sTQTq07KmPMQ48ihyvo5+Ya56spVOPhunfGr6406crCVA==}
    engines: {node: '>= 16'}
    hasBin: true
    dev: false

  /mdn-data@2.0.30:
    resolution: {integrity: sha512-GaqWWShW4kv/G9IEucWScBx9G1/vsFZZJUO+tD26M8J8z3Kw5RDQjaoZe03YAClgeS/SWPOcb4nkFBTEi5DUEA==}

  /merge2@1.4.1:
    resolution: {integrity: sha512-8q7VEgMJW4J8tcfVPy8g09NcQwZdbwFEqhe/WZkoIzjn/3TGDwtOCYtXGxA3O8tPzpczCCDgv+P2P5y00ZJOOg==}
    engines: {node: '>= 8'}
    dev: true

  /micromatch@4.0.5:
    resolution: {integrity: sha512-DMy+ERcEW2q8Z2Po+WNXuw3c5YaUSFjAO5GsJqfEl7UjvtIuFKO6ZrKvcItdy98dwFI2N1tg3zNIdKaQT+aNdA==}
    engines: {node: '>=8.6'}
    dependencies:
      braces: 3.0.2
      picomatch: 2.3.1
    dev: true

  /min-indent@1.0.1:
    resolution: {integrity: sha512-I9jwMn07Sy/IwOj3zVkVik2JTvgpaykDZEigL6Rx6N9LbMywwUSMtxET+7lVoDLLd3O3IXwJwvuuns8UB/HeAg==}
    engines: {node: '>=4'}
    dev: true

  /minimatch@3.1.2:
    resolution: {integrity: sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==}
    dependencies:
      brace-expansion: 1.1.11
    dev: true

  /minimist@1.2.8:
    resolution: {integrity: sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA==}
    dev: true

  /minipass@3.3.6:
    resolution: {integrity: sha512-DxiNidxSEK+tHG6zOIklvNOwm3hvCrbUrdtzY74U6HKTJxvIDfOUL5W5P2Ghd3DTkhhKPYGqeNUIh5qcM4YBfw==}
    engines: {node: '>=8'}
    dependencies:
      yallist: 4.0.0
    dev: true

  /minipass@5.0.0:
    resolution: {integrity: sha512-3FnjYuehv9k6ovOEbyOswadCDPX1piCfhV8ncmYtHOjuPwylVWsghTLo7rabjC3Rx5xD4HDx8Wm1xnMF7S5qFQ==}
    engines: {node: '>=8'}
    dev: true

  /minizlib@2.1.2:
    resolution: {integrity: sha512-bAxsR8BVfj60DWXHE3u30oHzfl4G7khkSuPW+qvpd7jFRHm7dLxOjUk1EHACJ/hxLY8phGJ0YhYHZo7jil7Qdg==}
    engines: {node: '>= 8'}
    dependencies:
      minipass: 3.3.6
      yallist: 4.0.0
    dev: true

  /mkdirp@0.5.6:
    resolution: {integrity: sha512-FP+p8RB8OWpF3YZBCrP5gtADmtXApB5AMLn+vdyA+PyxCjrCs00mjyUozssO33cwDeT3wNGdLxJ5M//YqtHAJw==}
    hasBin: true
    dependencies:
      minimist: 1.2.8
    dev: true

  /mkdirp@1.0.4:
    resolution: {integrity: sha512-vVqVZQyf3WLx2Shd0qJ9xuvqgAyKPLAiqITEtqW0oIUjzo3PePDd6fW9iFz30ef7Ysp/oiWqbhszeGWW2T6Gzw==}
    engines: {node: '>=10'}
    hasBin: true
    dev: true

  /mri@1.2.0:
    resolution: {integrity: sha512-tzzskb3bG8LvYGFF/mDTpq3jpI6Q9wc3LEmBaghu+DdCssd1FakN7Bc0hVNmEyGq1bq3RgfkCb3cmQLpNPOroA==}
    engines: {node: '>=4'}

  /mrmime@1.0.1:
    resolution: {integrity: sha512-hzzEagAgDyoU1Q6yg5uI+AorQgdvMCur3FcKf7NhMKWsaYg+RnbTyHRa/9IlLF9rf455MOCtcqqrQQ83pPP7Uw==}
    engines: {node: '>=10'}

  /mrmime@2.0.0:
    resolution: {integrity: sha512-eu38+hdgojoyq63s+yTpN4XMBdt5l8HhMhc4VKLO9KM5caLIBvUm4thi7fFaxyTmCKeNnXZ5pAlBwCUnhA09uw==}
    engines: {node: '>=10'}

  /ms@2.1.2:
    resolution: {integrity: sha512-sGkPx+VjMtmA6MX27oA4FBFELFCZZ4S4XqeGOXCv68tT+jb3vk/RyaKWP0PTKyWtmLSM0b+adUTEvbs1PEaH2w==}

  /nanoid@3.3.7:
    resolution: {integrity: sha512-eSRppjcPIatRIMC1U6UngP8XFcz8MQWGQdt1MTBQ7NaAmvXDfvNxbvWV3x2y6CdEUciCSsDHDQZbhYaB8QEo2g==}
    engines: {node: ^10 || ^12 || ^13.7 || ^14 || >=15.0.1}
    hasBin: true

  /nanostores@0.8.1:
    resolution: {integrity: sha512-1ZCfQtII2XeFDrtqXL2cdQ/diGrLxzRB3YMyQjn8m7GSGQrJfGST2iuqMpWnS/ZlifhtjgR/SX0Jy6Uij6lRLA==}
    engines: {node: ^16.0.0 || >=18.0.0}
    dev: false

  /node-fetch@2.7.0:
    resolution: {integrity: sha512-c4FRfUm/dbcWZ7U+1Wq0AwCyFL+3nt2bEw05wfxSz+DWpWsitgmSgYmy2dQdWyKC1694ELPqMs/YzUSNozLt8A==}
    engines: {node: 4.x || >=6.0.0}
    peerDependencies:
      encoding: ^0.1.0
    peerDependenciesMeta:
      encoding:
        optional: true
    dependencies:
      whatwg-url: 5.0.0
    dev: true

  /node-gyp-build@4.8.0:
    resolution: {integrity: sha512-u6fs2AEUljNho3EYTJNBfImO5QTo/J/1Etd+NVdCj7qWKUSN/bSLkZwhDv7I+w/MSC6qJ4cknepkAYykDdK8og==}
    hasBin: true
    dev: true

  /node-releases@2.0.14:
    resolution: {integrity: sha512-y10wOWt8yZpqXmOgRo77WaHEmhYQYGNA6y421PKsKYWEK8aW+cqAphborZDhqfyKrbZEN92CN1X2KbafY2s7Yw==}
    dev: true

  /nopt@5.0.0:
    resolution: {integrity: sha512-Tbj67rffqceeLpcRXrT7vKAN8CwfPeIBgM7E6iBkmKLV7bEMwpGgYLGv0jACUsECaa/vuxP0IjEont6umdMgtQ==}
    engines: {node: '>=6'}
    hasBin: true
    dependencies:
      abbrev: 1.1.1
    dev: true

  /normalize-path@3.0.0:
    resolution: {integrity: sha512-6eZs5Ls3WtCisHWp9S2GUy8dqkpGi4BVSz3GaqiE6ezub0512ESztXUwUB6C6IKbQkY2Pnb/mD4WYojCRwcwLA==}
    engines: {node: '>=0.10.0'}
    dev: true

  /npmlog@5.0.1:
    resolution: {integrity: sha512-AqZtDUWOMKs1G/8lwylVjrdYgqA4d9nu8hc+0gzRxlDb1I10+FHBGMXs6aiQHFdCUUlqH99MUMuLfzWDNDtfxw==}
    dependencies:
      are-we-there-yet: 2.0.0
      console-control-strings: 1.1.0
      gauge: 3.0.2
      set-blocking: 2.0.0
    dev: true

  /object-assign@4.1.1:
    resolution: {integrity: sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==}
    engines: {node: '>=0.10.0'}
    dev: true

  /once@1.4.0:
    resolution: {integrity: sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w==}
    dependencies:
      wrappy: 1.0.2
    dev: true

  /parent-module@1.0.1:
    resolution: {integrity: sha512-GQ2EWRpQV8/o+Aw8YqtfZZPfNRWZYkbidE9k5rpl/hC3vtHHBfGm2Ifi6qWV+coDGkrUKZAxE3Lot5kcsRlh+g==}
    engines: {node: '>=6'}
    dependencies:
      callsites: 3.1.0
    dev: true

  /path-is-absolute@1.0.1:
    resolution: {integrity: sha512-AVbw3UJ2e9bq64vSaS9Am0fje1Pa8pbGqTTsmXfaIiMpnr5DlDhfJOuLj9Sf95ZPVDAUerDfEk88MPmPe7UCQg==}
    engines: {node: '>=0.10.0'}
    dev: true

  /periscopic@3.1.0:
    resolution: {integrity: sha512-vKiQ8RRtkl9P+r/+oefh25C3fhybptkHKCZSPlcXiJux2tJF55GnEj3BVn4A5gKfq9NWWXXrxkHBwVPUfH0opw==}
    dependencies:
      '@types/estree': 1.0.5
      estree-walker: 3.0.3
      is-reference: 3.0.2

  /picocolors@1.0.0:
    resolution: {integrity: sha512-1fygroTLlHu66zi26VoTDv8yRgm0Fccecssto+MhsZ0D/DGW2sm8E8AjW7NU5VVTRt5GxbeZ5qBuJr+HyLYkjQ==}

  /picomatch@2.3.1:
    resolution: {integrity: sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==}
    engines: {node: '>=8.6'}
    dev: true

  /playwright-core@1.41.2:
    resolution: {integrity: sha512-VaTvwCA4Y8kxEe+kfm2+uUUw5Lubf38RxF7FpBxLPmGe5sdNkSg5e3ChEigaGrX7qdqT3pt2m/98LiyvU2x6CA==}
    engines: {node: '>=16'}
    hasBin: true
    dev: true

  /playwright@1.41.2:
    resolution: {integrity: sha512-v0bOa6H2GJChDL8pAeLa/LZC4feoAMbSQm1/jF/ySsWWoaNItvrMP7GEkvEEFyCTUYKMxjQKaTSg5up7nR6/8A==}
    engines: {node: '>=16'}
    hasBin: true
    dependencies:
      playwright-core: 1.41.2
    optionalDependencies:
      fsevents: 2.3.2
    dev: true

  /port-authority@2.0.1:
    resolution: {integrity: sha512-Hz/WvSNt5+7x+Rq1Cn6DetJOZxKtLDehJ1mLCYge6ju4QvSF/PHvRgy94e1SKJVI96AJTcqEdNwkkaAFad+TXQ==}
    dev: false

  /postcss@8.4.35:
    resolution: {integrity: sha512-u5U8qYpBCpN13BsiEB0CbR1Hhh4Gc0zLFuedrHJKMctHCHAGrMdG0PRM/KErzAL3CU6/eckEtmHNB3x6e3c0vA==}
    engines: {node: ^10 || ^12 || >=14}
    dependencies:
      nanoid: 3.3.7
      picocolors: 1.0.0
      source-map-js: 1.0.2

  /prettier-plugin-svelte@3.1.2(prettier@3.2.5)(svelte@4.2.10):
    resolution: {integrity: sha512-7xfMZtwgAWHMT0iZc8jN4o65zgbAQ3+O32V6W7pXrqNvKnHnkoyQCGCbKeUyXKZLbYE0YhFRnamfxfkEGxm8qA==}
    peerDependencies:
      prettier: ^3.0.0
      svelte: ^3.2.0 || ^4.0.0-next.0 || ^5.0.0-next.0
    dependencies:
      prettier: 3.2.5
      svelte: 4.2.10
    dev: true

  /prettier@3.2.5:
    resolution: {integrity: sha512-3/GWa9aOC0YeD7LUfvOG2NiDyhOWRvt1k+rcKhOuYnMY24iiCphgneUfJDyFXd6rZCAnuLBv6UeAULtrhT/F4A==}
    engines: {node: '>=14'}
    hasBin: true
    dev: true

  /prism-svelte@0.5.0:
    resolution: {integrity: sha512-db91Bf3pRGKDPz1lAqLFSJXeW13mulUJxhycysFpfXV5MIK7RgWWK2E5aPAa71s8TCzQUXxF5JOV42/iOs6QkA==}
    dev: false

  /prismjs@1.29.0:
    resolution: {integrity: sha512-Kx/1w86q/epKcmte75LNrEoT+lX8pBpavuAbvJWRXar7Hz8jrtF+e3vY751p0R8H9HdArwaCTNDDzHg/ScJK1Q==}
    engines: {node: '>=6'}
    dev: false

  /queue-microtask@1.2.3:
    resolution: {integrity: sha512-NuaNSa6flKT5JaSYQzJok04JzTL1CA6aGhv5rfLW3PgqA+M2ChpZQnAC8h8i4ZFkBS8X5RqkDBHA7r4hej3K9A==}
    dev: true

  /readable-stream@3.6.2:
    resolution: {integrity: sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA==}
    engines: {node: '>= 6'}
    dependencies:
      inherits: 2.0.4
      string_decoder: 1.3.0
      util-deprecate: 1.0.2
    dev: true

  /readdirp@3.6.0:
    resolution: {integrity: sha512-hOS089on8RduqdbhvQ5Z37A0ESjsqz6qnRcffsMU3495FuTdqSm+7bhJ29JvIOsBDEEnan5DPu9t3To9VRlMzA==}
    engines: {node: '>=8.10.0'}
    dependencies:
      picomatch: 2.3.1
    dev: true

  /resolve-from@4.0.0:
    resolution: {integrity: sha512-pb/MYmXstAkysRFx8piNI1tGFNQIFA3vkE3Gq4EuA1dF6gHp/+vgZqsCGJapvy8N3Q+4o7FwvquPJcnZ7RYy4g==}
    engines: {node: '>=4'}
    dev: true

  /resolve-from@5.0.0:
    resolution: {integrity: sha512-qYg9KP24dD5qka9J47d0aVky0N+b4fTU89LN9iDnjB5waksiC49rvMB0PrUJQGoTmH50XPiqOvAjDfaijGxYZw==}
    engines: {node: '>=8'}
    dev: true

  /resolve.exports@2.0.2:
    resolution: {integrity: sha512-X2UW6Nw3n/aMgDVy+0rSqgHlv39WZAlZrXCdnbyEiKm17DSqHX4MmQMaST3FbeWR5FTuRcUwYAziZajji0Y7mg==}
    engines: {node: '>=10'}
    dev: false

  /reusify@1.0.4:
    resolution: {integrity: sha512-U9nH88a3fc/ekCF1l0/UP1IosiuIjyTh7hBvXVMHYgVcfGvt897Xguj2UOLDeI5BG2m7/uwyaLVT6fbtCwTyzw==}
    engines: {iojs: '>=1.0.0', node: '>=0.10.0'}
    dev: true

  /rimraf@2.7.1:
    resolution: {integrity: sha512-uWjbaKIK3T1OSVptzX7Nl6PvQ3qAGtKEtVRjRuazjfL3Bx5eI409VZSqgND+4UNnmzLVdPj9FqFJNPqBZFve4w==}
    hasBin: true
    dependencies:
      glob: 7.2.3
    dev: true

  /rimraf@3.0.2:
    resolution: {integrity: sha512-JZkJMZkAGFFPP2YqXZXPbMlMBgsxzE8ILs4lMIX/2o0L9UBw9O/Y3o6wFw/i9YLapcUJWwqbi3kdxIPdC62TIA==}
    hasBin: true
    dependencies:
      glob: 7.2.3
    dev: true

  /rollup@3.29.4:
    resolution: {integrity: sha512-oWzmBZwvYrU0iJHtDmhsm662rC15FRXmcjCk1xD771dFDx5jJ02ufAQQTn0etB2emNk4J9EZg/yWKpsn9BWGRw==}
    engines: {node: '>=14.18.0', npm: '>=8.0.0'}
    hasBin: true
    optionalDependencies:
      fsevents: 2.3.3

  /run-parallel@1.2.0:
    resolution: {integrity: sha512-5l4VyZR86LZ/lDxZTR6jqL8AFE2S0IFLMP26AbjsLVADxHdhB/c0GUsH+y39UfCi3dzz8OlQuPmnaJOMoDHQBA==}
    dependencies:
      queue-microtask: 1.2.3
    dev: true

  /sade@1.8.1:
    resolution: {integrity: sha512-xal3CZX1Xlo/k4ApwCFrHVACi9fBqJ7V+mwhBsuf/1IOKbBy098Fex+Wa/5QMubw09pSZ/u8EY8PWgevJsXp1A==}
    engines: {node: '>=6'}
    dependencies:
      mri: 1.2.0

  /safe-buffer@5.2.1:
    resolution: {integrity: sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==}
    dev: true

  /sander@0.5.1:
    resolution: {integrity: sha512-3lVqBir7WuKDHGrKRDn/1Ye3kwpXaDOMsiRP1wd6wpZW56gJhsbp5RqQpA6JG/P+pkXizygnr1dKR8vzWaVsfA==}
    dependencies:
      es6-promise: 3.3.1
      graceful-fs: 4.2.11
      mkdirp: 0.5.6
      rimraf: 2.7.1
    dev: true

  /semver@6.3.1:
    resolution: {integrity: sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==}
    hasBin: true
    dev: true

  /semver@7.6.0:
    resolution: {integrity: sha512-EnwXhrlwXMk9gKu5/flx5sv/an57AkRplG3hTK68W7FRDN+k+OWBj65M7719OkA82XLBxrcX0KSHj+X5COhOVg==}
    engines: {node: '>=10'}
    hasBin: true
    dependencies:
      lru-cache: 6.0.0
    dev: true

  /set-blocking@2.0.0:
    resolution: {integrity: sha512-KiKBS8AnWGEyLzofFfmvKwpdPzqiy16LvQfK3yv/fVH7Bj13/wl3JSR1J+rfgRE9q7xUJK4qvgS8raSOeLUehw==}
    dev: true

  /set-cookie-parser@2.6.0:
    resolution: {integrity: sha512-RVnVQxTXuerk653XfuliOxBP81Sf0+qfQE73LIYKcyMYHG94AuH0kgrQpRDuTZnSmjpysHmzxJXKNfa6PjFhyQ==}

  /shiki-twoslash@3.1.2(typescript@5.3.3):
    resolution: {integrity: sha512-JBcRIIizi+exIA/OUhYkV6jtyeZco0ykCkIRd5sgwIt1Pm4pz+maoaRZpm6SkhPwvif4fCA7xOtJOykhpIV64Q==}
    peerDependencies:
      typescript: '>3'
    dependencies:
      '@typescript/twoslash': 3.1.0
      '@typescript/vfs': 1.3.4
      fenceparser: 1.1.1
      shiki: 0.10.1
      typescript: 5.3.3
    transitivePeerDependencies:
      - supports-color
    dev: true

  /shiki@0.10.1:
    resolution: {integrity: sha512-VsY7QJVzU51j5o1+DguUd+6vmCmZ5v/6gYu4vyYAhzjuNQU6P/vmSy4uQaOhvje031qQMiW0d2BwgMH52vqMng==}
    dependencies:
      jsonc-parser: 3.2.1
      vscode-oniguruma: 1.7.0
      vscode-textmate: 5.2.0
    dev: true

  /signal-exit@3.0.7:
    resolution: {integrity: sha512-wnD2ZE+l+SPC/uoS0vXeE9L1+0wuaMqKlfz9AMUo38JsyLSBWSFcHR1Rri62LZc12vLr1gb3jl7iwQhgwpAbGQ==}
    dev: true

  /sirv@2.0.4:
    resolution: {integrity: sha512-94Bdh3cC2PKrbgSOUqTiGPWVZeSiXfKOVZNJniWoqrWrRkB1CJzBU3NEbiTsPcYy1lDsANA/THzS+9WBiy5nfQ==}
    engines: {node: '>= 10'}
    dependencies:
      '@polka/url': 1.0.0-next.24
      mrmime: 2.0.0
      totalist: 3.0.1

  /sorcery@0.11.0:
    resolution: {integrity: sha512-J69LQ22xrQB1cIFJhPfgtLuI6BpWRiWu1Y3vSsIwK/eAScqJxd/+CJlUuHQRdX2C9NGFamq+KqNywGgaThwfHw==}
    hasBin: true
    dependencies:
      '@jridgewell/sourcemap-codec': 1.4.15
      buffer-crc32: 0.2.13
      minimist: 1.2.8
      sander: 0.5.1
    dev: true

  /source-map-js@1.0.2:
    resolution: {integrity: sha512-R0XvVJ9WusLiqTCEiGCmICCMplcCkIwwR11mOSD9CR5u+IXYdiseeEuXCVAjS54zqwkLcPNnmU4OeJ6tUrWhDw==}
    engines: {node: '>=0.10.0'}

  /string-width@4.2.3:
    resolution: {integrity: sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==}
    engines: {node: '>=8'}
    dependencies:
      emoji-regex: 8.0.0
      is-fullwidth-code-point: 3.0.0
      strip-ansi: 6.0.1
    dev: true

  /string_decoder@1.3.0:
    resolution: {integrity: sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA==}
    dependencies:
      safe-buffer: 5.2.1
    dev: true

  /strip-ansi@6.0.1:
    resolution: {integrity: sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==}
    engines: {node: '>=8'}
    dependencies:
      ansi-regex: 5.0.1
    dev: true

  /strip-indent@3.0.0:
    resolution: {integrity: sha512-laJTa3Jb+VQpaC6DseHhF7dXVqHTfJPCRDaEbid/drOhgitgYku/letMUqOXFoWV0zIIUbjpdH2t+tYj4bQMRQ==}
    engines: {node: '>=8'}
    dependencies:
      min-indent: 1.0.1
    dev: true

  /style-mod@4.1.0:
    resolution: {integrity: sha512-Ca5ib8HrFn+f+0n4N4ScTIA9iTOQ7MaGS1ylHcoVqW9J7w2w8PzN6g9gKmTYgGEBH8e120+RCmhpje6jC5uGWA==}
    dev: false

  /svelte-check@3.6.4(svelte@4.2.10):
    resolution: {integrity: sha512-mY/dqucqm46p72M8yZmn81WPZx9mN6uuw8UVfR3ZKQeLxQg5HDGO3HHm5AZuWZPYNMLJ+TRMn+TeN53HfQ/vsw==}
    hasBin: true
    peerDependencies:
      svelte: ^3.55.0 || ^4.0.0-next.0 || ^4.0.0 || ^5.0.0-next.0
    dependencies:
      '@jridgewell/trace-mapping': 0.3.22
      chokidar: 3.6.0
      fast-glob: 3.3.2
      import-fresh: 3.3.0
      picocolors: 1.0.0
      sade: 1.8.1
      svelte: 4.2.10
      svelte-preprocess: 5.1.3(svelte@4.2.10)(typescript@5.3.3)
      typescript: 5.3.3
    transitivePeerDependencies:
      - '@babel/core'
      - coffeescript
      - less
      - postcss
      - postcss-load-config
      - pug
      - sass
      - stylus
      - sugarss
    dev: true

  /svelte-hmr@0.15.3(svelte@4.2.10):
    resolution: {integrity: sha512-41snaPswvSf8TJUhlkoJBekRrABDXDMdpNpT2tfHIv4JuhgvHqLMhEPGtaQn0BmbNSTkuz2Ed20DF2eHw0SmBQ==}
    engines: {node: ^12.20 || ^14.13.1 || >= 16}
    peerDependencies:
      svelte: ^3.19.0 || ^4.0.0
    dependencies:
      svelte: 4.2.10

  /svelte-json-tree@2.2.0(svelte@4.2.10):
    resolution: {integrity: sha512-zcfepTrJ6xhpdgRZEujmiFh+ainRw7HO4Bsoh8PMAsm7fkgUPtnrZi3An8tmCFY8jajYhMrauHsd1S1XTeuiCw==}
    peerDependencies:
      svelte: ^4.0.0
    dependencies:
      svelte: 4.2.10
    dev: false

  /svelte-local-storage-store@0.4.0(svelte@4.2.10):
    resolution: {integrity: sha512-ctPykTt4S3BE5bF0mfV0jKiUR1qlmqLvnAkQvYHLeb9wRyO1MdIFDVI23X+TZEFleATHkTaOpYZswIvf3b2tWA==}
    engines: {node: '>=0.14'}
    peerDependencies:
      svelte: ^3.48.0
    dependencies:
      svelte: 4.2.10
    dev: false

  /svelte-local-storage-store@0.6.4(svelte@4.2.10):
    resolution: {integrity: sha512-45WoY2vSGPQM1sIQJ9jTkPPj20hYeqm+af6mUGRFSPP5WglZf36YYoZqwmZZ8Dt/2SU8lem+BTA8/Z/8TkqNLg==}
    engines: {node: '>=0.14'}
    peerDependencies:
      svelte: ^3.48.0 || >4.0.0
    dependencies:
      svelte: 4.2.10
    dev: true

  /svelte-preprocess@5.1.3(svelte@4.2.10)(typescript@5.3.3):
    resolution: {integrity: sha512-xxAkmxGHT+J/GourS5mVJeOXZzne1FR5ljeOUAMXUkfEhkLEllRreXpbl3dIYJlcJRfL1LO1uIAPpBpBfiqGPw==}
    engines: {node: '>= 16.0.0', pnpm: ^8.0.0}
    requiresBuild: true
    peerDependencies:
      '@babel/core': ^7.10.2
      coffeescript: ^2.5.1
      less: ^3.11.3 || ^4.0.0
      postcss: ^7 || ^8
      postcss-load-config: ^2.1.0 || ^3.0.0 || ^4.0.0 || ^5.0.0
      pug: ^3.0.0
      sass: ^1.26.8
      stylus: ^0.55.0
      sugarss: ^2.0.0 || ^3.0.0 || ^4.0.0
      svelte: ^3.23.0 || ^4.0.0-next.0 || ^4.0.0 || ^5.0.0-next.0
      typescript: '>=3.9.5 || ^4.0.0 || ^5.0.0'
    peerDependenciesMeta:
      '@babel/core':
        optional: true
      coffeescript:
        optional: true
      less:
        optional: true
      postcss:
        optional: true
      postcss-load-config:
        optional: true
      pug:
        optional: true
      sass:
        optional: true
      stylus:
        optional: true
      sugarss:
        optional: true
      typescript:
        optional: true
    dependencies:
      '@types/pug': 2.0.10
      detect-indent: 6.1.0
      magic-string: 0.30.7
      sorcery: 0.11.0
      strip-indent: 3.0.0
      svelte: 4.2.10
      typescript: 5.3.3
    dev: true

  /svelte@4.2.10:
    resolution: {integrity: sha512-Ep06yCaCdgG1Mafb/Rx8sJ1QS3RW2I2BxGp2Ui9LBHSZ2/tO/aGLc5WqPjgiAP6KAnLJGaIr/zzwQlOo1b8MxA==}
    engines: {node: '>=16'}
    dependencies:
      '@ampproject/remapping': 2.2.1
      '@jridgewell/sourcemap-codec': 1.4.15
      '@jridgewell/trace-mapping': 0.3.22
      '@types/estree': 1.0.5
      acorn: 8.11.3
      aria-query: 5.3.0
      axobject-query: 4.0.0
      code-red: 1.0.4
      css-tree: 2.3.1
      estree-walker: 3.0.3
      is-reference: 3.0.2
      locate-character: 3.0.0
      magic-string: 0.30.7
      periscopic: 3.1.0

  /tar@6.2.0:
    resolution: {integrity: sha512-/Wo7DcT0u5HUV486xg675HtjNd3BXZ6xDbzsCUZPt5iw8bTQ63bP0Raut3mvro9u+CUyq7YQd8Cx55fsZXxqLQ==}
    engines: {node: '>=10'}
    dependencies:
      chownr: 2.0.0
      fs-minipass: 2.1.0
      minipass: 5.0.0
      minizlib: 2.1.2
      mkdirp: 1.0.4
      yallist: 4.0.0
    dev: true

  /tiny-glob@0.2.9:
    resolution: {integrity: sha512-g/55ssRPUjShh+xkfx9UPDXqhckHEsHr4Vd9zX55oSdGZc/MD0m3sferOkwWtp98bv+kcVfEHtRJgBVJzelrzg==}
    dependencies:
      globalyzer: 0.1.0
      globrex: 0.1.2

  /to-regex-range@5.0.1:
    resolution: {integrity: sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ==}
    engines: {node: '>=8.0'}
    dependencies:
      is-number: 7.0.0
    dev: true

  /totalist@3.0.1:
    resolution: {integrity: sha512-sf4i37nQ2LBx4m3wB74y+ubopq6W/dIzXg0FDGjsYnZHVa1Da8FH853wlL2gtUhg+xJXjfk3kUZS3BRoQeoQBQ==}
    engines: {node: '>=6'}

  /tr46@0.0.3:
    resolution: {integrity: sha512-N3WMsuqV66lT30CrXNbEjx4GEwlow3v6rr4mCcv6prnfwhS01rkgyFdjPNBYd9br7LpXV1+Emh01fHnq2Gdgrw==}
    dev: true

  /typescript@5.3.3:
    resolution: {integrity: sha512-pXWcraxM0uxAS+tN0AG/BF2TyqmHO014Z070UsJ+pFvYuRSq8KH8DmWpnbXe0pEPDHXZV3FcAbJkijJ5oNEnWw==}
    engines: {node: '>=14.17'}
    hasBin: true
    dev: true

  /undici-types@5.26.5:
    resolution: {integrity: sha512-JlCMO+ehdEIKqlFxk6IfVoAUVmgz7cU7zD/h9XZ0qzeosSHmUJVOzSQvvYSYWXkFXC+IfLKSIffhv0sVZup6pA==}
    dev: true

  /undici@5.26.5:
    resolution: {integrity: sha512-cSb4bPFd5qgR7qr2jYAi0hlX9n5YKK2ONKkLFkxl+v/9BvC0sOpZjBHDBSXc5lWAf5ty9oZdRXytBIHzgUcerw==}
    engines: {node: '>=14.0'}
    dependencies:
      '@fastify/busboy': 2.1.0

  /update-browserslist-db@1.0.13(browserslist@4.22.3):
    resolution: {integrity: sha512-xebP81SNcPuNpPP3uzeW1NYXxI3rxyJzF3pD6sH4jE7o/IX+WtSpwnVU+qIsDPyk0d3hmFQ7mjqc6AtV604hbg==}
    hasBin: true
    peerDependencies:
      browserslist: '>= 4.21.0'
    dependencies:
      browserslist: 4.22.3
      escalade: 3.1.2
      picocolors: 1.0.0
    dev: true

  /util-deprecate@1.0.2:
    resolution: {integrity: sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==}
    dev: true

  /vite@4.5.2(lightningcss@1.23.0):
    resolution: {integrity: sha512-tBCZBNSBbHQkaGyhGCDUGqeo2ph8Fstyp6FMSvTtsXeZSPpSMGlviAOav2hxVTqFcx8Hj/twtWKsMJXNY0xI8w==}
    engines: {node: ^14.18.0 || >=16.0.0}
    hasBin: true
    peerDependencies:
      '@types/node': '>= 14'
      less: '*'
      lightningcss: ^1.21.0
      sass: '*'
      stylus: '*'
      sugarss: '*'
      terser: ^5.4.0
    peerDependenciesMeta:
      '@types/node':
        optional: true
      less:
        optional: true
      lightningcss:
        optional: true
      sass:
        optional: true
      stylus:
        optional: true
      sugarss:
        optional: true
      terser:
        optional: true
    dependencies:
      esbuild: 0.18.20
      lightningcss: 1.23.0
      postcss: 8.4.35
      rollup: 3.29.4
    optionalDependencies:
      fsevents: 2.3.3

  /vitefu@0.2.5(vite@4.5.2):
    resolution: {integrity: sha512-SgHtMLoqaeeGnd2evZ849ZbACbnwQCIwRH57t18FxcXoZop0uQu0uzlIhJBlF/eWVzuce0sHeqPcDo+evVcg8Q==}
    peerDependencies:
      vite: ^3.0.0 || ^4.0.0 || ^5.0.0
    peerDependenciesMeta:
      vite:
        optional: true
    dependencies:
      vite: 4.5.2(lightningcss@1.23.0)

  /vscode-oniguruma@1.7.0:
    resolution: {integrity: sha512-L9WMGRfrjOhgHSdOYgCt/yRMsXzLDJSL7BPrOZt73gU0iWO4mpqzqQzOz5srxqTvMBaR0XZTSrVWo4j55Rc6cA==}
    dev: true

  /vscode-textmate@5.2.0:
    resolution: {integrity: sha512-Uw5ooOQxRASHgu6C7GVvUxisKXfSgW4oFlO+aa+PAkgmH89O3CXxEEzNRNtHSqtXFTl0nAC1uYj0GMSH27uwtQ==}
    dev: true

  /w3c-keyname@2.2.8:
    resolution: {integrity: sha512-dpojBhNsCNN7T82Tm7k26A6G9ML3NkhDsnw9n/eoxSRlVBB4CEtIQ/KTCLI2Fwf3ataSXRhYFkQi3SlnFwPvPQ==}
    dev: false

  /webidl-conversions@3.0.1:
    resolution: {integrity: sha512-2JAn3z8AR6rjK8Sm8orRC0h/bcl/DqL7tRPdGZ4I1CjdF+EaMLmYxBHyXuKL849eucPFhvBoxMsflfOb8kxaeQ==}
    dev: true

  /whatwg-url@5.0.0:
    resolution: {integrity: sha512-saE57nupxk6v3HY35+jzBwYa0rKSy0XR8JSxZPwgLr7ys0IBzhGviA1/TUGJLmSVqs8pb9AnvICXEuOHLprYTw==}
    dependencies:
      tr46: 0.0.3
      webidl-conversions: 3.0.1
    dev: true

  /wide-align@1.1.5:
    resolution: {integrity: sha512-eDMORYaPNZ4sQIuuYPDHdQvf4gyCF9rEEV/yPxGfwPkRodwEgiMUUXTx/dex+Me0wxx53S+NgUHaP7y3MGlDmg==}
    dependencies:
      string-width: 4.2.3
    dev: true

  /wrappy@1.0.2:
    resolution: {integrity: sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ==}
    dev: true

  /ws@8.16.0:
    resolution: {integrity: sha512-HS0c//TP7Ina87TfiPUz1rQzMhHrl/SG2guqRcTOIUYD2q8uhUdNHZYJUaQ8aTGPzCh+c6oawMKW35nFl1dxyQ==}
    engines: {node: '>=10.0.0'}
    peerDependencies:
      bufferutil: ^4.0.1
      utf-8-validate: '>=5.0.2'
    peerDependenciesMeta:
      bufferutil:
        optional: true
      utf-8-validate:
        optional: true
    dev: false

  /yallist@4.0.0:
    resolution: {integrity: sha512-3wdGidZyq5PB084XLES5TpOSRA3wjXAlIWMhum2kRcv/41Sn2emQ0dycQW4uZXLejwKvg6EsvbdlVL+FYEct7A==}
    dev: true

  /yootils@0.3.1:
    resolution: {integrity: sha512-A7AMeJfGefk317I/3tBoUYRcDcNavKEkpiPN/nQsBz/viI2GvT7BtrqdPD6rGqBFN8Ax7v4obf+Cl32JF9DDVw==}
    dev: false

```


####### README.md #######


####### scripts/create-common-bundle/index.js #######

```

import fs from 'fs';
import esbuild from 'esbuild';
import AdmZip from 'adm-zip';
import glob from 'tiny-glob/sync.js';
import { fileURLToPath } from 'url';
import { execSync } from 'child_process';

if (!!process.env.VERCEL) {
	execSync('git clean -d -f content/tutorial');
}

const cwd = 'content/tutorial/common';

execSync('npm ci', { cwd });

const zip = new AdmZip();

// we selectively exclude certain files to minimise the bundle size.
// this is a bit ropey, but it works
const ignored_basenames = ['.DS_Store', 'LICENSE'];
const ignored_extensions = ['.d.ts', '.map'];
const ignored_directories = ['.svelte-kit', 'node_modules/.bin', 'node_modules/rollup/dist/shared'];

const ignored_files = new Set(['node_modules/svelte/compiler.cjs']);

for (const file of glob('**', { cwd, filesOnly: true, dot: true }).map((file) =>
	file.replaceAll('\\', '/')
)) {
	if (ignored_extensions.find((ext) => file.endsWith(ext))) continue;
	if (ignored_basenames.find((basename) => file.endsWith('/' + basename))) continue;
	if (ignored_directories.find((dir) => file.startsWith(dir + '/'))) continue;

	if (ignored_files.has(file)) {
		ignored_files.delete(file);
		continue;
	}

	if (file.startsWith('node_modules/esbuild/') || file.startsWith('node_modules/@esbuild/')) {
		continue;
	}

	zip.addFile(
		file.replace('node_modules/esbuild-wasm/', 'node_modules/esbuild/'),
		fs.readFileSync(`${cwd}/${file}`)
	);
}

if (ignored_files.size > 0) {
	throw new Error(`expected to find ${Array.from(ignored_files).join(', ')}`);
}

const out = zip.toBuffer();

fs.writeFileSync(`src/lib/client/adapters/common/common.zip`, out);

// bundle adm-zip so we can use it in the webcontainer
esbuild.buildSync({
	entryPoints: [fileURLToPath(new URL('./unzip.js', import.meta.url))],
	bundle: true,
	platform: 'node',
	minify: true,
	outfile: 'src/lib/client/adapters/common/unzip.cjs',
	format: 'cjs'
});

```


####### scripts/create-common-bundle/unzip.js #######

```

import fs from 'fs';
import AdmZip from 'adm-zip';

const zip = new AdmZip('common.zip');
zip.extractAllTo('.');

if (!fs.existsSync('node_modules/.bin')) {
	fs.mkdirSync('node_modules/.bin');
}

fs.symlinkSync('../@sveltejs/kit/svelte-kit.js', 'node_modules/.bin/svelte-kit');
fs.chmodSync('node_modules/.bin/svelte-kit', 0o777);

fs.symlinkSync('../esbuild/bin/esbuild', 'node_modules/.bin/esbuild');
fs.chmodSync('node_modules/.bin/esbuild', 0o777);

```


####### script.sh #######

```

#!/bin/bash

# Append the output of the tree command to the end of README.md
echo -e "\n" >> README.md
echo -e "\n########## Project Structure ##########\n" >> README.md
echo -e '```\n' >> README.md
tree >> README.md
echo -e '\n```\n' >> README.md

# Append the output of the find command to the end of README.md
echo -e "\n########## File List ##########\n" >> README.md
file_list=$(find . -not -path '*/\.*' -type f ! -name "*.jpg" ! -name "*.jpeg" ! -name "*.png" ! -name "*.gif" ! -name "*.bmp" ! -name "*.tif" ! -name "*.tiff" ! -name "*.ico" ! -name "*.svg" ! -name "*.webp" ! -name "*.raw" ! -name "*.indd" ! -name "*.ai" ! -name "*.eps" ! -name "*.pdf" ! -name "*.mp4" ! -name "*.mkv" ! -name "*.flv" ! -name "*.avi" ! -name "*.mov" ! -name "*.wmv" ! -name "*.rm" ! -name "*.rmvb" ! -name "*.m4v" ! -name "*.mpg" ! -name "*.mpeg" ! -name "*.vob" ! -name "*.3gp" ! -name "*.mp3" ! -name "*.wav" ! -name "*.ogg" ! -name "*.flac" ! -name "*.aac" ! -name "*.wma" ! -name "*.m4a" ! -name "*.amr" ! -name "*.aiff" ! -name "*.caf" ! -name "*.midi" ! -name "*.mid" ! -name "*.ttf" ! -name "*.otf" ! -name "*.woff" ! -name "*.woff2" ! -name "*.eot" ! -name "*.pfa" ! -name "*.pfb" ! -name "*.sfd" ! -name "*.fon" ! -name "*.dfont" ! -name "*.pt3" ! -name "*.cff" ! -name "*.std" ! -name "*.pro" ! -name "*.gai" -print | sed 's|./||' | sort)

# Generate a table with the file list
echo "| Index | File name |" >> README.md
echo "|-------|-----------|" >> README.md
index=1
while IFS= read -r file
do
    echo "| $index | $file |" >> README.md
    ((index++))
done <<< "$file_list"

# Loop through each file and append its content to README.md
while IFS= read -r file
do
    echo "Processing $file"
    echo -e "\n####### $file #######\n" >> README.md
    if [[ $file == *.md || $file == *.txt ]]; then
        cat "$file" >> README.md
    else
        echo -e '```\n' >> README.md
        cat "$file" >> README.md
        echo -e '\n```\n' >> README.md
    fi
done <<< "$file_list"
```


####### src/app.css #######

```

/* TODO move all this to site-kit */

body {
	/* --font-mono: Menlo, Monaco, 'Courier New', monospace; */
	--font-mono: 'Roboto Mono', monospace;
	--h4: 1.6rem;

	--light-blue: #f4f8fb;
}

input,
button {
	border: 2px solid transparent;
}

input:focus-visible,
button:focus-visible {
	outline: none;
	border: 2px solid var(--flash);
}

/* this is duplicated with kit.svelte.dev */
pre.language-diff code {
	color: rgba(0, 0, 0, 0.4);
}
.dark pre.language-diff code {
	color: rgba(255, 255, 255, 0.4);
}

.language-diff .inserted,
.language-diff .deleted {
	position: relative;
}

.language-diff .inserted {
	color: hsl(120, 100%, 25%);
}

.language-diff .deleted {
	color: hsl(2, 80%, 47%);
	user-select: none;
}

.language-diff .inserted::before,
.language-diff .deleted::before {
	position: absolute;
	left: -1rem;
	top: -0.2rem;
	font-size: 1.2rem;
}

.language-diff .inserted::before {
	content: '+';
}

.language-diff .deleted::before {
	content: '-';
}

```


####### src/app.d.ts #######

```

// See https://kit.svelte.dev/docs/types#app
// for information about these interfaces
declare global {
	namespace App {
		// interface Error {}
		// interface Locals {}
		// interface PageData {}
		// interface Platform {}
	}
}

export {};

```


####### src/app.html #######

```

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="color-scheme" content="dark light" />
		<meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff" />
		<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#2e2e2e" />
		<meta
			name="description"
			content="Learn Svelte and SvelteKit with an interactive browser-based tutorial"
		/>
		<link rel="manifest" href="/manifest.json" />
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<script>
			const themeValue = JSON.parse(localStorage.getItem('svelte:theme'))?.current;
			const systemPreferredTheme = window.matchMedia('(prefers-color-scheme: dark)').matches
				? 'dark'
				: 'light';

			document.body.classList.remove('light', 'dark');
			document.body.classList.add(themeValue ?? systemPreferredTheme);
		</script>

		<div>%sveltekit.body%</div>
	</body>
</html>

```


####### src/hooks.server.js #######

```

export async function handle({ event, resolve }) {
	const response = await resolve(event);

	response.headers.set('cross-origin-opener-policy', 'same-origin');
	response.headers.set('cross-origin-embedder-policy', 'require-corp');
	response.headers.set('cross-origin-resource-policy', 'cross-origin');

	return response;
}

```


####### src/lib/client/adapters/common/index.js #######

```

import zipped from './common.zip?url';
import unzip from './unzip.cjs?url';

async function load() {
	const result = await Promise.all([
		fetch(zipped).then((r) => r.arrayBuffer()),
		fetch(unzip).then((r) => r.text())
	]);

	return {
		zipped: result[0],
		unzip: result[1]
	};
}

export const ready = load();

```


####### src/lib/client/adapters/webcontainer/index.js #######

```

import { WebContainer } from '@webcontainer/api';
import base64 from 'base64-js';
import AnsiToHtml from 'ansi-to-html';
import * as yootils from 'yootils';
import { escape_html, get_depth } from '../../../utils.js';
import { ready } from '../common/index.js';

/**
 * @typedef {import("../../../../routes/tutorial/[slug]/state.js").CompilerWarning} CompilerWarning
 */

const converter = new AnsiToHtml({
	fg: 'var(--sk-text-3)'
});

/** @type {import('@webcontainer/api').WebContainer} Web container singleton */
let vm;

/**
 * @param {import('svelte/store').Writable<string | null>} base
 * @param {import('svelte/store').Writable<Error | null>} error
 * @param {import('svelte/store').Writable<{ value: number, text: string }>} progress
 * @param {import('svelte/store').Writable<string[]>} logs
 * @param {import('svelte/store').Writable<Record<string, CompilerWarning[]>>} warnings
 * @returns {Promise<import('$lib/types').Adapter>}
 */
export async function create(base, error, progress, logs, warnings) {
	progress.set({ value: 0, text: 'loading files' });

	const q = yootils.queue(1);
	/** @type {Map<string, Array<import('$lib/types').FileStub>>} */
	const q_per_file = new Map();

	/** Paths and contents of the currently loaded file stubs */
	let current_stubs = stubs_to_map([]);

	progress.set({ value: 1 / 5, text: 'booting webcontainer' });
	vm = await WebContainer.boot();

	progress.set({ value: 2 / 5, text: 'writing virtual files' });
	const common = await ready;
	await vm.mount({
		'common.zip': {
			file: { contents: new Uint8Array(common.zipped) }
		},
		'unzip.cjs': {
			file: { contents: common.unzip }
		}
	});

	/** @type {Record<string, CompilerWarning[]>} */
	let $warnings;
	warnings.subscribe((value) => $warnings = value);

	/** @type {any} */
	let timeout;

	/** @param {number} msec */
	function schedule_to_update_warning(msec) {
		clearTimeout(timeout);
		timeout = setTimeout(() => warnings.set($warnings), msec);
	}

	const log_stream = () =>
		new WritableStream({
			write(chunk) {
				if (chunk === '\x1B[1;1H') {
					// clear screen
					logs.set([]);

				} else if (chunk?.startsWith('svelte:warnings:')) {
					/** @type {CompilerWarning} */
					const warn = JSON.parse(chunk.slice(16));
					const current = $warnings[warn.filename];

					if (!current) {
						$warnings[warn.filename] = [warn];
					// the exact same warning may be given multiple times in a row
					} else if (!current.some((s) => (s.code === warn.code && s.pos === warn.pos))) {
						current.push(warn);
					}

					schedule_to_update_warning(100);

				} else {
					const log = converter.toHtml(escape_html(chunk)).replace(/\n/g, '<br>');
					logs.update(($logs) => [...$logs, log]);
				}
			}
		});

	progress.set({ value: 3 / 5, text: 'unzipping files' });
	const unzip = await vm.spawn('node', ['unzip.cjs']);
	unzip.output.pipeTo(log_stream());
	const code = await unzip.exit;

	if (code !== 0) {
		throw new Error('Failed to initialize WebContainer');
	}

	await vm.spawn('chmod', ['a+x', 'node_modules/vite/bin/vite.js']);

	vm.on('server-ready', (_port, url) => {
		base.set(url);
	});

	vm.on('error', ({ message }) => {
		error.set(new Error(message));
	});

	let launched = false;

	async function launch() {
		if (launched) return;
		launched = true;

		progress.set({ value: 4 / 5, text: 'starting dev server' });

		await new Promise(async (fulfil, reject) => {
			const error_unsub = vm.on('error', (error) => {
				error_unsub();
				reject(new Error(error.message));
			});

			const ready_unsub = vm.on('server-ready', (_port, base) => {
				ready_unsub();
				progress.set({ value: 5 / 5, text: 'ready' });
				fulfil(base); // this will be the last thing that happens if everything goes well
			});

			await run_dev();

			async function run_dev() {
				const process = await vm.spawn('npm', ['run', 'dev']);

				// TODO differentiate between stdout and stderr (sets `vite_error` to `true`)
				// https://github.com/stackblitz/webcontainer-core/issues/971
				process.output.pipeTo(log_stream());

				// keep restarting dev server (can crash in case of illegal +files for example)
				await process.exit;
				run_dev();
			}
		});
	}

	return {
		reset: (stubs) => {
			return q.add(async () => {
				/** @type {import('$lib/types').Stub[]} */
				const to_write = [];

				const force_delete = [];

				for (const stub of stubs) {
					if (stub.name.endsWith('/__delete')) {
						force_delete.push(stub.name.slice(0, -9));
					} else if (stub.type === 'file') {
						if (stub.contents.startsWith('__delete')) {
							force_delete.push(stub.name);
							continue;
						}

						const current = /** @type {import('$lib/types').FileStub} */ (
							current_stubs.get(stub.name)
						);

						if (current?.contents !== stub.contents) {
							to_write.push(stub);
						}
					} else {
						// always add directories, otherwise convert_stubs_to_tree will fail
						to_write.push(stub);
					}

					current_stubs.delete(stub.name);
				}

				// Don't delete the node_modules folder when switching from one exercise to another
				// where, as this crashes the dev server.
				const to_delete = [
					...Array.from(current_stubs.keys()).filter(
						(s) => !s.startsWith('/node_modules')
					),
					...force_delete
				];

				// initialize warnings of written files
				to_write
					.filter((stub) => stub.type === 'file' && $warnings[stub.name])
					.forEach((stub) => $warnings[stub.name] = []);
				// remove warnings of deleted files
				to_delete
					.filter((stubname) => $warnings[stubname])
					.forEach((stubname) => delete $warnings[stubname]);

				warnings.set($warnings);

				current_stubs = stubs_to_map(stubs);

				// For some reason, server-ready is fired again when the vite dev server is restarted.
				// We need to wait for it to finish before we can continue, else we might
				// request files from Vite before it's ready, leading to a timeout.
				const will_restart = launched &&
					(to_write.some(is_config) || to_delete.some(is_config_path));
				const promise = will_restart ? wait_for_restart_vite() : Promise.resolve();

				for (const file of to_delete) {
					await vm.fs.rm(file, { force: true, recursive: true });
				}

				await vm.mount(convert_stubs_to_tree(to_write));
				await promise;
				await new Promise((f) => setTimeout(f, 200)); // wait for chokidar

				// Also trigger a reload of the iframe in case new files were added / old ones deleted,
				// because that can result in a broken UI state
				const should_reload = !launched || will_restart || to_delete.length > 0;

				await launch();

				return should_reload;
			});
		},
		update: (file) => {

			let queue = q_per_file.get(file.name);
			if (queue) {
				queue.push(file);
				return Promise.resolve(false);
			}

			q_per_file.set(file.name, queue = [file]);

			return q.add(async () => {
				/** @type {import('@webcontainer/api').FileSystemTree} */
				const root = {};

				let tree = root;

				const path = file.name.split('/').slice(1);
				const basename = /** @type {string} */ (path.pop());

				for (const part of path) {
					if (!tree[part]) {
						/** @type {import('@webcontainer/api').FileSystemTree} */
						const directory = {};

						tree[part] = {
							directory
						};
					}

					tree = /** @type {import('@webcontainer/api').DirectoryNode} */ (tree[part]).directory;
				}

				const will_restart = is_config(file);

				while (queue && queue.length > 0) {

					// if the file is updated many times rapidly, get the most recently updated one
					const file = /** @type {import('$lib/types').FileStub} */ (queue.pop());
					queue.length = 0

					tree[basename] = to_file(file);

					// initialize warnings of this file
					$warnings[file.name] = [];
					schedule_to_update_warning(100);

					await vm.mount(root);

					if (will_restart) await wait_for_restart_vite();

					current_stubs.set(file.name, file);

					// we need to stagger sequential updates, just enough that the HMR
					// wires don't get crossed. 50ms seems to be enough of a delay
					// to avoid glitches without noticeably affecting update speed
					await new Promise((f) => setTimeout(f, 50));
				}

				q_per_file.delete(file.name)

				return will_restart;
			});
		}
	};
}

/**
 * @param {import('$lib/types').Stub} file
 */
function is_config(file) {
	return file.type === 'file' && is_config_path(file.name);
}

/**
 * @param {string} path
 */
function is_config_path(path) {
	return ['/vite.config.js', '/svelte.config.js', '/.env'].includes(path);
}

function wait_for_restart_vite() {
	return new Promise((fulfil, reject) => {
		const error_unsub = vm.on('error', (error) => {
			error_unsub();
			reject(new Error(error.message));
		});

		const ready_unsub = vm.on('server-ready', (port, base) => {
			ready_unsub();
			console.log(`server ready on port ${port} at ${performance.now()}: ${base}`);
			fulfil(undefined);
		});

		setTimeout(() => {
			reject(new Error('Timed out resetting WebContainer'));
		}, 10000);
	});
}

/**
 * @param {import('$lib/types').Stub[]} stubs
 * @returns {import('@webcontainer/api').FileSystemTree}
 */
function convert_stubs_to_tree(stubs, depth = 1) {
	/** @type {import('@webcontainer/api').FileSystemTree} */
	const tree = {};

	for (const stub of stubs) {
		if (get_depth(stub.name) === depth) {
			if (stub.type === 'directory') {
				const children = stubs.filter((child) => child.name.startsWith(stub.name));

				tree[stub.basename] = {
					directory: convert_stubs_to_tree(children, depth + 1)
				};
			} else {
				tree[stub.basename] = to_file(stub);
			}
		}
	}

	return tree;
}

/** @param {import('$lib/types').FileStub} file */
function to_file(file) {
	// special case
	if (file.name === '/src/app.html' || file.name === '/src/error.html') {
		const contents = file.contents + '<script type="module" src="/src/__client.js"></script>';

		return {
			file: { contents }
		};
	}

	const contents = file.text ? file.contents : base64.toByteArray(file.contents);

	return {
		file: { contents }
	};
}

/**
 * @param {import('$lib/types').Stub[]} files
 * @returns {Map<string, import('$lib/types').Stub>}
 */
function stubs_to_map(files, map = new Map()) {
	for (const file of files) {
		map.set(file.name, file);
	}
	return map;
}

```


####### src/lib/components/Modal.svelte #######

```

<script>
	import { onMount } from 'svelte';

	/** @type {HTMLDialogElement} */
	let modal;

	onMount(() => {
		const selection = window.getSelection();

		const active = /** @type {HTMLElement} */ (document.activeElement);
		const sfnsp = selection?.focusNode?.parentElement;

		if (modal.showModal) modal.showModal();

		return () => {
			setTimeout(() => {
				if (active && active !== document.body) {
					active.focus();
					return;
				}

				// reset sequential focus navigation starting point (ideally this
				// would be automatic with <dialog>, i think)
				if (sfnsp) {
					const tabindex = sfnsp.getAttribute('tabindex');

					sfnsp.setAttribute('tabindex', '-1');
					sfnsp.focus();
					sfnsp.blur();

					if (tabindex) {
						sfnsp.setAttribute('tabindex', tabindex);
					} else {
						sfnsp.removeAttribute('tabindex');
					}
				}
			}, 0);
		};
	});
</script>

<div class="modal-background" />

<dialog class="modal" tabindex="-1" bind:this={modal} on:close>
	<slot />
</dialog>

<style>
	/* when enough people have upgraded Safari, we can use
	   dialog::backdrop instead, but not yet */
	.modal-background {
		position: fixed;
		width: 100%;
		height: 100%;
		left: 0;
		top: 0;
		background: rgba(0, 0, 0, 0.3);
		backdrop-filter: grayscale(0.7) blur(3px);
		z-index: 99998;
	}

	dialog {
		position: fixed;
		left: 50%;
		top: 50%;
		transform: translate(-50%, -50%);
		width: calc(100vw - 2rem);
		max-width: 56rem;
		background: var(--sk-back-2);
		color: var(--sk-text-2);
		padding: 2rem;
		border: none;
		border-radius: 0.5rem;
		filter: drop-shadow(3px 5px 10px rgba(0, 0, 0, 0.1));
		z-index: 99999;
	}
</style>

```


####### src/lib/server/content.js #######

```

import { posixify } from '$lib/utils.js';
import { readFile, readdir, stat } from 'node:fs/promises';
import path from 'node:path';
import glob from 'tiny-glob';
import { transform } from './markdown.js';

const text_files = new Set([
	'.svelte',
	'.txt',
	'.json',
	'.js',
	'.ts',
	'.css',
	'.svg',
	'.html',
	'.md',
	'.env'
]);

const excluded = new Set(['.DS_Store', '.gitkeep', '.svelte-kit', 'package-lock.json']);

/** @param {string} file */
async function json(file) {
	return JSON.parse(await readFile(file, 'utf-8'));
}

/** @param {string} dir */
function is_valid(dir) {
	return /^\d{2}-/.test(dir);
}

/**
 * @param {string} path
 */
async function exists(path) {
	try {
		await stat(path);
		return true;
	} catch {
		return false;
	}
}

/**
 * @param {string} part
 * @param {string} chapter
 * @param {string} dir
 */
async function exists_readme(part, chapter, dir) {
	return exists(`content/tutorial/${part}/${chapter}/${dir}/README.md`);
}

/**
 * @returns {Promise<import('$lib/types').PartStub[]>}
 */
export async function get_index() {
	const parts = (await readdir('content/tutorial')).filter(is_valid).map(posixify);

	/** @type {import('$lib/types').PartStub[]} */
	const final_data = [];

	for (const part of parts) {
		const chapters = (await readdir(`content/tutorial/${part}`)).filter(is_valid).map(posixify);

		const obj = /** @type {import('$lib/types').PartStub} */ ({
			slug: part,
			title: (await json(`content/tutorial/${part}/meta.json`)).title,
			chapters: []
		});

		for (const chapter of chapters) {
			let exercises = await readdir(`content/tutorial/${part}/${chapter}`);
			for (const exercise of exercises) {
				if (!(is_valid(exercise) && (await exists_readme(part, chapter, exercise)))) {
					exercises = exercises.filter((e) => e !== exercise);
				}
			}
			exercises = exercises.map(posixify);

			const chapters_obj = /** @type {import('$lib/types').ChapterStub} */ ({
				slug: chapter,
				title: (await json(`content/tutorial/${part}/${chapter}/meta.json`)).title,
				exercises: []
			});

			for (const exercise of exercises) {
				const dir = `content/tutorial/${part}/${chapter}/${exercise}`;

				const text = await readFile(`${dir}/README.md`, 'utf-8');
				const { frontmatter } = extract_frontmatter(text, dir);
				const { title } = frontmatter;

				chapters_obj.exercises.push({
					slug: exercise.slice(3),
					title
				});
			}

			obj.chapters.push(chapters_obj);
		}

		final_data.push(obj);
	}

	return final_data;
}

/**
 * @param {string} slug
 * @returns {Promise<import('$lib/types').Exercise | undefined>}
 */
export async function get_exercise(slug) {
	const exercises = (
		await glob('[0-9][0-9]-*/[0-9][0-9]-*/[0-9][0-9]-*/README.md', {
			cwd: 'content/tutorial'
		})
	).map(posixify);

	/** @type {string[]} */
	const chain = [];

	for (let i = 0; i < exercises.length; i += 1) {
		const file = exercises[i];
		const [part_dir, chapter_dir, exercise_dir] = file.split('/');
		const exercise_slug = exercise_dir.slice(3);

		const dir = `content/tutorial/${part_dir}/${chapter_dir}/${exercise_dir}`;

		if (await exists(`${dir}/app-a`)) {
			chain.length = 0;
			chain.push(`${dir}/app-a`);
		}

		if (exercise_slug === slug) {
			const a = {
				...(await walk('content/tutorial/common', {
					exclude: ['node_modules', 'static/tutorial', 'static/svelte-logo-mask.svg']
				})),
				...(await walk(`content/tutorial/${part_dir}/common`))
			};

			for (const dir of chain) {
				Object.assign(a, await walk(dir));
			}

			const b = await walk(`${dir}/app-b`);
			const has_solution = Object.keys(b).length > 0;

			// ensure no duplicate content
			for (const key in b) {
				if (!a[key]) continue;
				if (b[key].type !== 'file') continue;

				const a_ = /** @type {import('$lib/types').FileStub} */ (a[key]);
				const b_ = /** @type {import('$lib/types').FileStub} */ (b[key]);

				if (a_.contents === b_.contents) {
					throw new Error(`duplicate file: ${exercise_slug} ${key}`);
				}
			}

			const part_meta = await json(`content/tutorial/${part_dir}/meta.json`);
			const chapter_meta = await json(`content/tutorial/${part_dir}/${chapter_dir}/meta.json`);

			const exercise_meta_file = `content/tutorial/${part_dir}/${chapter_dir}/${exercise_dir}/meta.json`;
			const exercise_meta = (await exists(exercise_meta_file))
				? await json(exercise_meta_file)
				: {};

			const scope = chapter_meta.scope ?? part_meta.scope;

			const text = await readFile(`${dir}/README.md`, 'utf-8');
			const { frontmatter, markdown } = extract_frontmatter(text, dir);
			const { title, path = '/', focus } = frontmatter;

			const prev_slug = exercises[i - 1]?.split('/')[2].slice(3);
			const prev = prev_slug
				? {
						slug: prev_slug
				  }
				: null;

			let next = null;

			const next_exercise = exercises[i + 1];

			if (next_exercise) {
				/** @type {string} */
				let title;

				const dirs = next_exercise.split('/');
				if (dirs[0] !== part_dir) {
					title = (await json(`content/tutorial/${dirs[0]}/meta.json`)).title;
				} else if (dirs[1] !== chapter_dir) {
					title = (await json(`content/tutorial/${dirs[0]}/${dirs[1]}/meta.json`)).title;
				} else {
					title = extract_frontmatter(
						await readFile(`content/tutorial/${next_exercise}`, 'utf-8'),
						next_exercise
					).frontmatter.title;
				}

				next = {
					slug: next_exercise.split('/')[2].slice(3),
					title
				};
			}

			const editing_constraints = {
				create: new Set(exercise_meta.editing_constraints?.create ?? []),
				remove: new Set(exercise_meta.editing_constraints?.remove ?? [])
			};

			const solution = { ...a };

			for (const stub of Object.values(b)) {
				if (stub.type === 'file' && stub.contents.startsWith('__delete')) {
					// remove file
					editing_constraints.remove.add(stub.name);
					delete solution[stub.name];
				} else if (stub.name.endsWith('/__delete')) {
					// remove directory
					const parent = stub.name.slice(0, stub.name.lastIndexOf('/'));
					editing_constraints.remove.add(parent);
					delete solution[parent];
					for (const k in solution) {
						if (k.startsWith(parent + '/')) {
							delete solution[k];
						}
					}
				} else {
					if (!solution[stub.name]) {
						editing_constraints.create.add(stub.name);
					}
					solution[stub.name] = stub;
				}
			}

			// ensure every code block for an exercise with multiple files has a `/// file:` annotation
			const filtered = Object.values(solution).filter((item) => {
				return item.type === 'file' && item.name.startsWith(scope.prefix);
			});

			if (filtered.length > 0) {
				for (const match of markdown.matchAll(/```[a-z]+\n([\s\S]+?)\n```/g)) {
					const content = match[1];
					if (!content.includes('/// file') && !content.includes('/// no-file')) {
						throw new Error(`Code block lacks a \`/// file: ...\` annotation: ${dir}/README.md`);
					}
				}
			}

			const all_files = { ...a, ...solution };
			const filenames = new Set(
				Object.keys(all_files)
					.filter(
						(filename) => filename.startsWith(scope.prefix) && all_files[filename].type === 'file'
					)
					.map((filename) => filename.slice(scope.prefix.length))
			);

			return {
				part: {
					slug: part_dir,
					title: `Part ${part_dir.slice(1, 2)}`,
					label: part_meta.title
				},
				chapter: {
					slug: chapter_dir,
					title: chapter_meta.title
				},
				scope,
				focus: focus ?? chapter_meta.focus ?? part_meta.focus,
				title,
				path,
				slug: exercise_slug,
				prev,
				next,
				dir,
				editing_constraints,
				markdown,
				html: await transform(markdown, {
					codespan: (text) =>
						filenames.size > 1 && filenames.has(text)
							? `<code data-file="${scope.prefix + text}">${text}</code>`
							: `<code>${text}</code>`
				}),
				a,
				b: solution,
				has_solution
			};
		}

		chain.push(`${dir}/app-b`);
	}
}

/**
 * @param {string} markdown
 * @param {string} dir
 */
function extract_frontmatter(markdown, dir) {
	const match = /---\n([^]+?)\n---\n([^]+)/.exec(markdown);
	if (!match) {
		throw new Error(`bad markdown for ${dir}`);
	}

	/** @type {Record<string, string>} */
	const frontmatter = {};

	for (const line of match[1].split('\n')) {
		const index = line.indexOf(':');
		if (index !== -1) {
			frontmatter[line.slice(0, index).trim()] = line.slice(index + 1).trim();
		}
	}

	return { frontmatter, markdown: match[2] };
}

/**
 * Get a list of all files in a directory
 * @param {string} cwd - the directory to walk
 * @param {{
 *   exclude?: string[]
 * }} options
 */
async function walk(cwd, options = {}) {
	/** @type {Record<string, import('$lib/types').FileStub | import('$lib/types').DirectoryStub>} */
	const result = {};

	if (!(await exists(cwd))) return result;

	/**
	 * @param {string} dir
	 * @param {number} depth
	 */
	async function walk_dir(dir, depth) {
		const files = (await readdir(path.join(cwd, dir))).map(posixify);

		for (const basename of files) {
			if (excluded.has(basename)) continue;

			const name = dir + basename;

			if (options.exclude?.some((exclude) => posixify(name).endsWith(exclude))) continue;

			const resolved = path.join(cwd, name);
			const stats = await stat(resolved);

			if (stats.isDirectory()) {
				result[name] = {
					type: 'directory',
					name,
					basename
				};

				await walk_dir(name + '/', depth + 1);
			} else {
				const text = text_files.has(path.extname(name) || path.basename(name));
				const contents = await readFile(resolved, text ? 'utf-8' : 'base64');

				result[name] = {
					type: 'file',
					name,
					basename,
					text,
					contents
				};
			}
		}
	}

	return await walk_dir('/', 1), result;
}

```


####### src/lib/server/markdown.js #######

```

import PrismJS from 'prismjs';
import 'prismjs/components/prism-bash.js';
import 'prismjs/components/prism-diff.js';
import 'prismjs/components/prism-typescript.js';
import 'prism-svelte';
import { Marked } from 'marked';
import { escape_html } from '$lib/utils';

const languages = {
	bash: 'bash',
	env: 'bash',
	html: 'markup',
	svelte: 'svelte',
	js: 'javascript',
	css: 'css',
	diff: 'diff',
	ts: 'typescript',
	'': ''
};

const delimiter_substitutes = {
	'+++': '             ',
	'---': '           ',
	':::': '         '
};

/**
 * @param {string} content
 * @param {string} classname
 */
function highlight_spans(content, classname) {
	return `<span class="${classname}">${content}</span>`;
	// return content.replace(/<span class="([^"]+)"/g, (_, classnames) => {
	// 	return `<span class="${classname} ${classnames}"`;
	// });
}

/** @type {Partial<import('marked').Renderer>} */
const default_renderer = {
	code: (source, language = '') => {
		/** @type {Record<string, string>} */
		const options = {};

		let html = '';

		source = source
			.replace(/\/\/\/ (.+?)(?:: (.+))?\n/gm, (_, key, value) => {
				options[key] = value;
				return '';
			})
			.replace(/^([\-\+])?((?:    )+)/gm, (match, prefix = '', spaces) => {
				if (prefix && language !== 'diff') return match;

				// for no good reason at all, marked replaces tabs with spaces
				let tabs = '';
				for (let i = 0; i < spaces.length; i += 4) {
					tabs += '\t';
				}
				return prefix + tabs;
			})
			.replace(/(\+\+\+|---|:::)/g, (_, /** @type {keyof delimiter_substitutes} */ delimiter) => {
				return delimiter_substitutes[delimiter];
			})
			.replace(/\*\\\//g, '*/');

		if (language === 'diff') {
			const lines = source.split('\n').map((content) => {
				let type = null;
				if (/^[\+\-]/.test(content)) {
					type = content[0] === '+' ? 'inserted' : 'deleted';
					content = content.slice(1);
				}

				return {
					type,
					content: escape_html(content)
				};
			});

			html = `<div class="code-block"><pre class="language-diff"><code>${lines
				.map((line) => {
					if (line.type) return `<span class="${line.type}">${line.content}\n</span>`;
					return line.content + '\n';
				})
				.join('')}</code></pre></div>`;
		} else {
			const lang = /** @type {keyof languages} */ (language);
			const plang = languages[lang];
			const highlighted = plang
				? PrismJS.highlight(source, PrismJS.languages[plang], language)
				: escape_html(source);

			html = `<div class="code-block">${
				options.file ? `<span class="filename">${options.file}</span>` : ''
			}<pre class='language-${plang}'><code>${highlighted}</code></pre></div>`;
		}

		return html
			.replace(/ {13}([^ ][^]+?) {13}/g, (_, content) => {
				return highlight_spans(content, 'highlight add');
			})
			.replace(/ {11}([^ ][^]+?) {11}/g, (_, content) => {
				return highlight_spans(content, 'highlight remove');
			})
			.replace(/ {9}([^ ][^]+?) {9}/g, (_, content) => {
				return highlight_spans(content, 'highlight');
			});
	}
};

/**
 * @param {string} markdown
 * @param {Partial<import('marked').Renderer>} options
 */
export async function transform(markdown, options) {
	const marked = new Marked({
		renderer: {
			...default_renderer,
			...options
		}
	});

	return (await marked.parse(markdown)) ?? '';
}

```


####### src/lib/types/index.d.ts #######

```

import type { Writable } from 'svelte/store';

export interface FileStub {
	type: 'file';
	name: string;
	basename: string;
	contents: string;
	text: boolean;
}

export interface DirectoryStub {
	type: 'directory';
	name: string;
	basename: string;
}

export type Stub = FileStub | DirectoryStub;

export interface Adapter {
	/** Returns `false` if the reset was in such a way that a reload of the iframe isn't needed */
	reset(files: Array<Stub>): Promise<boolean>;
	update(file: FileStub): Promise<boolean>;
}

export interface Scope {
	prefix: string;
	name: string;
}

export interface Exercise {
	part: {
		slug: string;
		title: string;
		label: string;
	};
	chapter: {
		slug: string;
		title: string;
	};
	scope: Scope;
	focus: string;
	title: string;
	/** the initial path to navigate to */
	path: string;
	slug: string;
	prev: { slug: string } | null;
	next: { slug: string; title: string } | null;
	markdown: string;
	html: string;
	dir: string;
	editing_constraints: {
		create: Set<string>;
		remove: Set<string>;
	};
	a: Record<string, Stub>;
	b: Record<string, Stub>;
	has_solution: boolean;
}

export interface ExerciseStub {
	title: string;
	slug: string;
}

export interface ChapterStub {
	slug: string;
	title: string;
	exercises: ExerciseStub[];
}

export interface PartStub {
	slug: string;
	title: string;
	chapters: ChapterStub[];
}

export interface EditingConstraints {
	create: Set<string>;
	remove: Set<string>;
}

```


####### src/lib/utils.js #######

```

/** @param {string} name */
export function get_depth(name) {
	return name.split('/').length - 1;
}

/** @type {Record<string, string>} */
const chars = {
	'&': '&amp;',
	'<': '&lt;',
	'>': '&gt;'
};

/** @param {string} html */
export function escape_html(html) {
	return html.replace(/[&<>]/g, (c) => chars[c]);
}

/** @param {string} path */
export function posixify(path) {
	return path.replace(/\\/g, '/');
}

```


####### src/routes/assets/media/[...path]/+server.js #######

```

export async function GET({ request, params, fetch }) {
	const request_headers = new Headers();

	const range = request.headers.get('range');
	const if_range = request.headers.get('if-range');

	if (range) request_headers.set('range', range);
	if (if_range) request_headers.set('if-range', if_range);

	const response = await fetch(`https://sveltejs.github.io/assets/${params.path}`, {
		headers: request_headers
	});

	const response_headers = new Headers(response.headers);
	response_headers.set('cross-origin-resource-policy', 'cross-origin');

	return new Response(response.body, {
		status: response.status,
		headers: response_headers
	});
}

```


####### src/routes/content.json/+server.js #######

```

import { get_exercise, get_index } from '$lib/server/content.js';
import { json } from '@sveltejs/kit';
import { markedTransform } from '@sveltejs/site-kit/markdown';

export const prerender = true;

export const GET = async () => {
	return json(await content());
};

async function content() {
	/** @type {import('@sveltejs/site-kit/search').Block[]} */
	const blocks = [];

	for (const { chapters } of await get_index()) {
		for (const { exercises } of chapters) {
			for (const { slug, title } of exercises) {
				const exercise_content = await get_exercise(slug);

				if (exercise_content) {
					exercise_content.markdown = exercise_content.markdown.replace(/(\+\+\+|---|:::)/g, '');

					blocks.push({
						href: `/tutorial/${slug}`,
						breadcrumbs: [title],
						content: await plaintext(exercise_content.markdown),
						rank: 0
					});
				}
			}
		}
	}

	return { blocks };
}

/** @param {string} markdown */
async function plaintext(markdown) {
	/** @param {unknown} text */
	const block = (text) => `${text}\n`;

	/** @param {string} text */
	const inline = (text) => text;

	return (
		await markedTransform(markdown, {
			code: (source) => source.split('// ---cut---\n').pop() ?? '',
			blockquote: block,
			html: () => '\n',
			heading: (text) => `${text}\n`,
			hr: () => '',
			list: block,
			listitem: block,
			checkbox: block,
			paragraph: (text) => `${text}\n\n`,
			table: block,
			tablerow: block,
			tablecell: (text, opts) => {
				return text + ' ';
			},
			strong: inline,
			em: inline,
			codespan: inline,
			br: () => '',
			del: inline,
			link: (href, title, text) => text,
			image: (href, title, text) => text,
			text: inline
		})
	)
		.replace(/&lt;/g, '<')
		.replace(/&gt;/g, '>')
		.replace(/&#(\d+);/g, (match, code) => {
			return String.fromCharCode(code);
		})
		.trim();
}

```


####### src/routes/+error.svelte #######

```

<script>
	import { page } from '$app/stores';

	// we don't want to use <svelte:window bind:online> here, because we only care about the online
	// state when the page first loads
	let online = typeof navigator !== 'undefined' ? navigator.onLine : true;
</script>

<svelte:head>
	<title>{$page.status}</title>
</svelte:head>

<div class="container">
	{#if $page.status === 404}
		<h1>Not found!</h1>
	{:else if online}
		<h1>Yikes!</h1>

		{#if $page.error?.message}
			<p class="error">{$page.status}: {$page.error.message}</p>
		{/if}

		<p>Please try reloading the page.</p>

		<p>
			If the error persists, please drop by <a href="https://svelte.dev/chat">Discord chatroom</a>
			and let us know, or raise an issue on
			<a href="https://github.com/sveltejs/svelte">GitHub</a>. Thanks!
		</p>
	{:else}
		<h1>It looks like you're offline</h1>

		<p>Reload the page once you've found the internet.</p>
	{/if}
</div>

<style>
	.container {
		padding: 4rem;
	}

	h1,
	p {
		margin: 0 auto;
	}

	h1 {
		font-size: 2.8em;
		font-weight: 300;
		margin: 0;
		margin-bottom: 0.5em;
	}

	p {
		margin: 1em auto;
	}

	.error {
		background-color: #da106e;
		color: white;
		padding: 12px 16px;
		font: 600 16px/1.7 var(--sk-font);
		border-radius: 2px;
	}
</style>

```


####### src/routes/+layout.server.js #######

```

export const prerender = true;

export const load = async ({ fetch }) => {
	return {
		links: fetch('/nav.json').then((r) => r.json())
	};
};

```


####### src/routes/+layout.svelte #######

```

<script>
	import { browser } from '$app/environment';
	import { page } from '$app/stores';
	import '@fontsource/roboto-mono';
	import { Icon, Shell } from '@sveltejs/site-kit/components';
	import { Nav, Separator } from '@sveltejs/site-kit/nav';
	import { Search, SearchBox } from '@sveltejs/site-kit/search';
	import '@sveltejs/site-kit/styles/index.css';
	import '../app.css';

	export let data;
</script>

<Shell>
	<Nav title="" links={data.links} slot="top-nav">
		<svelte:fragment slot="home-large">
			<strong>learn</strong>.svelte.dev
		</svelte:fragment>

		<svelte:fragment slot="home-small">
			<strong>learn</strong>
		</svelte:fragment>

		<svelte:fragment slot="search">
			{#if $page.url.pathname !== '/search'}
				<Search />
			{/if}
		</svelte:fragment>

		<svelte:fragment slot="external-links">
			<a href="https://svelte.dev">Svelte</a>

			<a href="https://kit.svelte.dev">SvelteKit</a>

			<Separator />

			<a href="https://svelte.dev/chat" title="Discord Chat">
				<span class="small">Discord</span>
				<span class="large"><Icon name="discord" /></span>
			</a>

			<a href="https://github.com/sveltejs/learn.svelte.dev" title="GitHub Repo">
				<span class="small">GitHub</span>
				<span class="large"><Icon name="github" /></span>
			</a>
		</svelte:fragment>
	</Nav>

	<slot />
</Shell>

{#if browser}
	<SearchBox />
{/if}

<style>
	:global(body) {
		margin: 0;
		width: 100%;
		min-height: 100dvh;
	}

	span {
		display: none;
	}

	@media (min-width: 800px) {
		span {
			height: 100%;
			display: flex;
			align-items: center;
			color: var(--sk-text-2);
			font-size: var(--sk-text-s);
			opacity: 1;
			white-space: nowrap;
		}
	}
</style>

```


####### src/routes/nav.json/+server.js #######

```

import { get_index } from '$lib/server/content.js';
import { json } from '@sveltejs/kit';

export const prerender = true;

export const GET = async () => {
	return json(await get_nav_list());
};

/**
 * @returns {Promise<import('@sveltejs/site-kit').NavigationLink[]>}
 */
async function get_nav_list() {
	const index = await get_index();

	return [
		{
			title: 'Tutorial',
			prefix: 'tutorial',
			pathname: '/tutorial',
			sections: index.map(({ chapters, title }) => ({
				title,
				sections: chapters.map(({ title, exercises }) => ({
					title,
					sections: exercises
						.map(({ slug, title }) => ({
							title,
							path: `/tutorial/${slug}`
						}))
						.flat()
				}))
			}))
		}
	];
}

```


####### src/routes/+page.server.js #######

```

import { redirect } from '@sveltejs/kit';

export function load() {
	throw redirect(307, '/tutorial/welcome-to-svelte');
}

```


####### src/routes/tutorial/+page.js #######

```

import { redirect } from '@sveltejs/kit';

export function load() {
	throw redirect(307, '/tutorial/welcome-to-svelte');
}

```


####### src/routes/tutorial/[slug]/adapter.js #######

```

import { writable } from 'svelte/store';
import { browser } from '$app/environment';

export const progress = writable({
	value: 0,
	text: 'initialising'
});

/** @type {import('svelte/store').Writable<string | null>} */
export const base = writable(null);

/** @type {import('svelte/store').Writable<Error | null>} */
export const error = writable(null);

/** @type {import('svelte/store').Writable<string[]>} */
export const logs = writable([]);

/** @type {import('svelte/store').Writable<Record<string, import('./state').CompilerWarning[]>>} */
export const warnings = writable({});

/** @type {Promise<import('$lib/types').Adapter>} */
let ready = new Promise(() => {});

let initial_load = true;

if (browser) {
	load_webcontainer();
	initial_load = false;
}

export function load_webcontainer() {
	ready = new Promise(async (fulfil, reject) => {
		try {
			// TODO: remove this when webcontainers are properly supported on iOS
			// see https://github.com/stackblitz/webcontainer-core/issues/1120
			if (initial_load && /iphone/i.test(navigator.userAgent)) {
				throw new Error('iOS does not support WebContainers');
			}

			const module = await import('$lib/client/adapters/webcontainer/index.js');
			const adapter = await module.create(base, error, progress, logs, warnings);

			fulfil(adapter);
		} catch (error) {
			reject(error);
		}
	});
}

/** @typedef {'reload'} EventName */

/** @type {Map<EventName, Set<() => void>>} */
let subscriptions = new Map([['reload', new Set()]]);

/**
 *
 * @param {EventName} event
 * @param {() => void} callback
 */
export function subscribe(event, callback) {
	subscriptions.get(event)?.add(callback);

	return () => {
		subscriptions.get(event)?.delete(callback);
	};
}

/**
 * @param {EventName} event
 */
function publish(event) {
	subscriptions.get(event)?.forEach((fn) => fn());
}

/**
 * @param {import('$lib/types').Stub[]} files
 */
export async function reset(files) {
	try {
		const adapter = await ready;
		const should_reload = await adapter.reset(files);

		if (should_reload) {
			publish('reload');
		}

		error.set(null);
	} catch (e) {
		error.set(/** @type {Error} */ (e));
	}
}

/**
 * @param {import('$lib/types').FileStub} file
 */
export async function update(file) {
	const adapter = await ready;
	const should_reload = await adapter.update(file);

	if (should_reload) {
		publish('reload');
	}
}

```


####### src/routes/tutorial/[slug]/autocompletionDataProvider.js #######

```

/**
 * this file is based on [dataProvider.ts from sveltejs/language-tools](https://github.com/sveltejs/language-tools/blob/master/packages/language-server/src/plugins/html/dataProvider.ts)
 */

export const globalEvents = [
	{ name: 'on:abort' },
	{ name: 'on:animationcancel' },
	{ name: 'on:animationend' },
	{ name: 'on:animationiteration' },
	{ name: 'on:animationstart' },
	{ name: 'on:auxclick' },
	{ name: 'on:beforeinput' },
	{ name: 'on:blur' },
	{ name: 'on:cancel' },
	{ name: 'on:canplay' },
	{ name: 'on:canplaythrough' },
	{ name: 'on:change' },
	{ name: 'on:click' },
	{ name: 'on:close' },
	{ name: 'on:contextmenu' },
	{ name: 'on:copy' },
	{ name: 'on:cuechange' },
	{ name: 'on:cut' },
	{ name: 'on:dblclick' },
	{ name: 'on:drag' },
	{ name: 'on:dragend' },
	{ name: 'on:dragenter' },
	{ name: 'on:dragleave' },
	{ name: 'on:dragover' },
	{ name: 'on:dragstart' },
	{ name: 'on:drop' },
	{ name: 'on:durationchange' },
	{ name: 'on:emptied' },
	{ name: 'on:ended' },
	{ name: 'on:error' },
	{ name: 'on:focus' },
	{ name: 'on:formdata' },
	{ name: 'on:gotpointercapture' },
	{ name: 'on:input' },
	{ name: 'on:invalid' },
	{ name: 'on:keydown' },
	{ name: 'on:keypress' },
	{ name: 'on:keyup' },
	{ name: 'on:load' },
	{ name: 'on:loadeddata' },
	{ name: 'on:loadedmetadata' },
	{ name: 'on:loadstart' },
	{ name: 'on:lostpointercapture' },
	{ name: 'on:mousedown' },
	{ name: 'on:mouseenter' },
	{ name: 'on:mouseleave' },
	{ name: 'on:mousemove' },
	{ name: 'on:mouseout' },
	{ name: 'on:mouseover' },
	{ name: 'on:mouseup' },
	{ name: 'on:paste' },
	{ name: 'on:pause' },
	{ name: 'on:play' },
	{ name: 'on:playing' },
	{ name: 'on:pointercancel' },
	{ name: 'on:pointerdown' },
	{ name: 'on:pointerenter' },
	{ name: 'on:pointerleave' },
	{ name: 'on:pointermove' },
	{ name: 'on:pointerout' },
	{ name: 'on:pointerover' },
	{ name: 'on:pointerup' },
	{ name: 'on:progress' },
	{ name: 'on:ratechange' },
	{ name: 'on:reset' },
	{ name: 'on:resize' },
	{ name: 'on:scroll' },
	{ name: 'on:securitypolicyviolation' },
	{ name: 'on:seeked' },
	{ name: 'on:seeking' },
	{ name: 'on:select' },
	{ name: 'on:selectionchange' },
	{ name: 'on:selectstart' },
	{ name: 'on:slotchange' },
	{ name: 'on:stalled' },
	{ name: 'on:submit' },
	{ name: 'on:suspend' },
	{ name: 'on:timeupdate' },
	{ name: 'on:toggle' },
	{ name: 'on:touchcancel' },
	{ name: 'on:touchend' },
	{ name: 'on:touchmove' },
	{ name: 'on:touchstart' },
	{ name: 'on:transitioncancel' },
	{ name: 'on:transitionend' },
	{ name: 'on:transitionrun' },
	{ name: 'on:transitionstart' },
	{ name: 'on:volumechange' },
	{ name: 'on:waiting' },
	{ name: 'on:webkitanimationend' },
	{ name: 'on:webkitanimationiteration' },
	{ name: 'on:webkitanimationstart' },
	{ name: 'on:webkittransitionend' },
	{ name: 'on:wheel' }
];

/** @type {{ name: string, description?: string }[]} */
export const svelteEvents = [
	...globalEvents,
	{
		name: 'on:introstart',
		description: 'Available when element has transition'
	},
	{
		name: 'on:introend',
		description: 'Available when element has transition'
	},
	{
		name: 'on:outrostart',
		description: 'Available when element has transition'
	},
	{
		name: 'on:outroend',
		description: 'Available when element has transition'
	}
];

export const svelteAttributes = [
	{
		name: 'bind:innerHTML',
		description: 'Available when contenteditable=true'
	},
	{
		name: 'bind:textContent',
		description: 'Available when contenteditable=true'
	},
	{
		name: 'bind:innerText',
		description: 'Available when contenteditable=true'
	},
	{
		name: 'bind:clientWidth',
		description: 'Available for block level elements. (read-only)'
	},
	{
		name: 'bind:clientHeight',
		description: 'Available for block level elements. (read-only)'
	},
	{
		name: 'bind:offsetWidth',
		description: 'Available for block level elements. (read-only)'
	},
	{
		name: 'bind:offsetHeight',
		description: 'Available for block level elements. (read-only)'
	},
	{
		name: 'bind:this',
		description:
			'To get a reference to a DOM node, use bind:this. If used on a component, gets a reference to that component instance.'
	}
];

export const sveltekitAttributes = [
	{
		name: 'data-sveltekit-keepfocus',
		description:
			'SvelteKit-specific attribute. Currently focused element will retain focus after navigation. Otherwise, focus will be reset to the body.',
		valueSet: 'v',
		values: [{ name: 'off' }]
	},
	{
		name: 'data-sveltekit-noscroll',
		description: 'SvelteKit-specific attribute. Will prevent scrolling after the link is clicked.',
		valueSet: 'v',
		values: [{ name: 'off' }]
	},
	{
		name: 'data-sveltekit-preload-code',
		description:
			"SvelteKit-specific attribute. Will cause SvelteKit to run the page's load function as soon as the user hovers over the link (on a desktop) or touches it (on mobile), rather than waiting for the click event to trigger navigation.",
		valueSet: 'v',
		values: [
			{ name: 'eager' },
			{ name: 'viewport' },
			{ name: 'hover' },
			{ name: 'tap' },
			{ name: 'off' }
		]
	},
	{
		name: 'data-sveltekit-preload-data',
		description:
			"SvelteKit-specific attribute. Will cause SvelteKit to run the page's load function as soon as the user hovers over the link (on a desktop) or touches it (on mobile), rather than waiting for the click event to trigger navigation.",
		valueSet: 'v',
		values: [{ name: 'hover' }, { name: 'tap' }, { name: 'off' }]
	},
	{
		name: 'data-sveltekit-reload',
		description:
			'SvelteKit-specific attribute. Will cause SvelteKit to do a normal browser navigation which results in a full page reload.',
		valueSet: 'v',
		values: [{ name: 'off' }]
	},
	{
		name: 'data-sveltekit-replacestate',
		description:
			'SvelteKit-specific attribute. Will replace the current `history` entry rather than creating a new one with `pushState` when the link is clicked.',
		valueSet: 'v',
		values: [{ name: 'off' }]
	}
];

export const svelteTags = [
	{
		name: 'svelte:self',
		description:
			'Allows a component to include itself, recursively.\n\nIt cannot appear at the top level of your markup; it must be inside an if or each block to prevent an infinite loop.',
		attributes: []
	},
	{
		name: 'svelte:component',
		description:
			'Renders a component dynamically, using the component constructor specified as the this property. When the property changes, the component is destroyed and recreated.\n\nIf this is falsy, no component is rendered.',
		attributes: [
			{
				name: 'this',
				description:
					'Component to render.\n\nWhen this property changes, the component is destroyed and recreated.\nIf this is falsy, no component is rendered.'
			}
		]
	},
	{
		name: 'svelte:element',
		description:
			'Renders a DOM element dynamically, using the string as the this property. When the property changes, the element is destroyed and recreated.\n\nIf this is falsy, no element is rendered.',
		attributes: [
			{
				name: 'this',
				description:
					'DOM element to render.\n\nWhen this property changes, the element is destroyed and recreated.\nIf this is falsy, no element is rendered.'
			}
		]
	},
	{
		name: 'svelte:window',
		description:
			'Allows you to add event listeners to the window object without worrying about removing them when the component is destroyed, or checking for the existence of window when server-side rendering.',
		attributes: [
			{
				name: 'bind:innerWidth',
				description: 'Bind to the inner width of the window. (read-only)'
			},
			{
				name: 'bind:innerHeight',
				description: 'Bind to the inner height of the window. (read-only)'
			},
			{
				name: 'bind:outerWidth',
				description: 'Bind to the outer width of the window. (read-only)'
			},
			{
				name: 'bind:outerHeight',
				description: 'Bind to the outer height of the window. (read-only)'
			},
			{
				name: 'bind:scrollX',
				description: 'Bind to the scroll x position of the window.'
			},
			{
				name: 'bind:scrollY',
				description: 'Bind to the scroll y position of the window.'
			},
			{
				name: 'bind:online',
				description: 'An alias for window.navigator.onLine'
			},
			// window events
			{ name: 'on:afterprint' },
			{ name: 'on:beforeprint' },
			{ name: 'on:beforeunload' },
			{ name: 'on:gamepadconnected' },
			{ name: 'on:gamepaddisconnected' },
			{ name: 'on:hashchange' },
			{ name: 'on:languagechange' },
			{ name: 'on:message' },
			{ name: 'on:messageerror' },
			{ name: 'on:offline' },
			{ name: 'on:online' },
			{ name: 'on:pagehide' },
			{ name: 'on:pageshow' },
			{ name: 'on:popstate' },
			{ name: 'on:rejectionhandled' },
			{ name: 'on:storage' },
			{ name: 'on:unhandledrejection' },
			{ name: 'on:unload' }
		]
	},
	{
		name: 'svelte:document',
		description:
			"As with <svelte:window>, this element allows you to add listeners to events on document, such as visibilitychange, which don't fire on window.",
		attributes: [
			// document events
			{ name: 'on:fullscreenchange' },
			{ name: 'on:fullscreenerror' },
			{ name: 'on:pointerlockchange' },
			{ name: 'on:pointerlockerror' },
			{ name: 'on:readystatechange' },
			{ name: 'on:visibilitychange' }
		]
	},
	{
		name: 'svelte:body',
		description:
			"As with <svelte:window>, this element allows you to add listeners to events on document.body, such as mouseenter and mouseleave which don't fire on window.",
		attributes: []
	},
	{
		name: 'svelte:head',
		description:
			'This element makes it possible to insert elements into document.head. During server-side rendering, head content exposed separately to the main html content.',
		attributes: []
	},
	{
		name: 'svelte:options',
		description: 'Provides a place to specify per-component compiler options',
		attributes: [
			{
				name: 'immutable',
				description:
					'If true, tells the compiler that you promise not to mutate any objects. This allows it to be less conservative about checking whether values have changed.',
				values: [
					{
						name: '{true}',
						description:
							'You never use mutable data, so the compiler can do simple referential equality checks to determine if values have changed'
					},
					{
						name: '{false}',
						description:
							'The default. Svelte will be more conservative about whether or not mutable objects have changed'
					}
				]
			},
			{
				name: 'accessors',
				description:
					"If true, getters and setters will be created for the component's props. If false, they will only be created for readonly exported values (i.e. those declared with const, class and function). If compiling with customElement: true this option defaults to true.",
				values: [
					{
						name: '{true}',
						description: "Adds getters and setters for the component's props"
					},
					{
						name: '{false}',
						description: 'The default.'
					}
				]
			},
			{
				name: 'namespace',
				description: 'The namespace where this component will be used, most commonly "svg"'
			},
			{
				name: 'tag',
				description: 'The name to use when compiling this component as a custom element'
			}
		]
	},
	{
		name: 'svelte:fragment',
		description:
			'This element is useful if you want to assign a component to a named slot without creating a wrapper DOM element.',
		attributes: [
			{
				name: 'slot',
				description: 'The name of the named slot that should be targeted.'
			}
		]
	},
	{
		name: 'slot',
		description:
			'Components can have child content, in the same way that elements can.\n\nThe content is exposed in the child component using the <slot> element, which can contain fallback content that is rendered if no children are provided.',
		attributes: [
			{
				name: 'name',
				description:
					'Named slots allow consumers to target specific areas. They can also have fallback content.'
			}
		]
	}
];

const mediaAttributes = [
	{
		name: 'bind:duration',
		description: 'The total duration of the video, in seconds. (readonly)'
	},
	{
		name: 'bind:buffered',
		description: 'An array of {start, end} objects. (readonly)'
	},
	{
		name: 'bind:seekable',
		description: 'An array of {start, end} objects. (readonly)'
	},
	{
		name: 'bind:played',
		description: 'An array of {start, end} objects. (readonly)'
	},
	{
		name: 'bind:seeking',
		description: 'boolean. (readonly)'
	},
	{
		name: 'bind:ended',
		description: 'boolean. (readonly)'
	},
	{
		name: 'bind:currentTime',
		description: 'The current point in the video, in seconds.'
	},
	{
		name: 'bind:playbackRate',
		description: "how fast or slow to play the video, where 1 is 'normal'"
	},
	{
		name: 'bind:paused'
	},
	{
		name: 'bind:volume',
		description: 'A value between 0 and 1'
	},
	{
		name: 'bind:muted'
	},
	{
		name: 'bind:readyState'
	}
];

const videoAttributes = [
	{
		name: 'bind:videoWidth',
		description: 'readonly'
	},
	{
		name: 'bind:videoHeight',
		description: 'readonly'
	}
];

const indeterminateAttribute = {
	name: 'indeterminate',
	description: 'Available for type="checkbox"'
};

/** @type {Record<string, { name: string, description?: string }[]>} */
export const addAttributes = {
	select: [{ name: 'bind:value' }],
	input: [
		{ name: 'bind:value' },
		{ name: 'bind:group', description: 'Available for type="radio" and type="checkbox"' },
		{ name: 'bind:checked', description: 'Available for type="checkbox"' },
		{ name: 'bind:files', description: 'Available for type="file" (readonly)' },
		indeterminateAttribute,
		{ ...indeterminateAttribute, name: 'bind:indeterminate' }
	],
	img: [{ name: 'bind:naturalWidth' }, { name: 'bind:naturalHeight' }],
	textarea: [{ name: 'bind:value' }],
	video: [...mediaAttributes, ...videoAttributes],
	audio: [...mediaAttributes],
	details: [
		{
			name: 'bind:open'
		}
	]
};

```


####### src/routes/tutorial/[slug]/autocompletion.js #######

```

import { svelteLanguage } from '@replit/codemirror-lang-svelte';
import { javascriptLanguage } from '@codemirror/lang-javascript';
import { syntaxTree } from '@codemirror/language';
import { snippetCompletion } from '@codemirror/autocomplete';
import {
	addAttributes,
	svelteAttributes,
	svelteTags,
	sveltekitAttributes,
	svelteEvents
} from './autocompletionDataProvider.js';

const logic_block_snippets = [
	snippetCompletion('#if ${}}\n\n{/if', { label: '#if', type: 'keyword' }),
	snippetCompletion('#each ${} as }\n\n{/each', {
		label: '#each',
		type: 'keyword'
	}),
	snippetCompletion('#await ${} then }\n\n{/await', {
		label: '#await then',
		type: 'keyword'
	}),
	snippetCompletion('#await ${}}\n\n{:then }\n\n{/await', {
		label: '#await :then',
		type: 'keyword'
	}),
	snippetCompletion('#key ${}}\n\n{/key', { label: '#key', type: 'keyword' })
];

const special_tag_snippets = [
	snippetCompletion('@html ${}', { label: '@html', type: 'keyword' }),
	snippetCompletion('@debug ${}', { label: '@debug', type: 'keyword' }),
	snippetCompletion('@const ${}', { label: '@const', type: 'keyword' })
];

/**
 * @param {import('@codemirror/autocomplete').CompletionContext} context
 * @param {import("@lezer/common").SyntaxNode} node
 */
function completion_for_block(context, node) {
	const prefix = context.state.doc.sliceString(node.from, node.from + 1);

	const from = node.from;
	const to = context.pos;

	const type = 'keyword';

	if (prefix === '/') {
		/** @param {string} label */
		const completion = (label) => ({ from, to, options: [{ label, type }], validFor: /^\/\w*$/ });

		const parent = node.parent;
		const block = node.parent?.parent;

		if (parent?.name === 'EachBlockClose' || block?.name === 'EachBlock') {
			return completion('/each');
		} else if (parent?.name === 'IfBlockClose' || block?.name === 'IfBlock') {
			return completion('/if');
		} else if (parent?.name === 'AwaitBlockClose' || block?.name === 'AwaitBlock') {
			return completion('/await');
		} else if (parent?.name === 'KeyBlockClose' || block?.name === 'KeyBlock') {
			return completion('/key');
		}
	} else if (prefix === ':') {
		/** @param {import('@codemirror/autocomplete').Completion[]} options */
		const completion = (options) => ({ from, to, options, validFor: /^\:\w*$/ });

		const parent = node.parent;
		const block = node.parent?.parent;

		if (parent?.name === 'ElseBlock' || block?.name === 'IfBlock') {
			return completion([
				{ label: ':else', type },
				{ label: ':else if ', type }
			]);
		} else if (parent?.name === 'ThenBlock' || block?.name === 'AwaitBlock') {
			return completion([
				{ label: ':then', type },
				{ label: ':catch', type }
			]);
		}
	} else if (prefix === '#') {
		return { from, to, options: logic_block_snippets, validFor: /^#(\w)*$/ };
	} else if (prefix === '@') {
		return { from, to, options: special_tag_snippets, validFor: /^@(\w)*$/ };
	}

	return null;
}

const options_for_svelte_events = svelteEvents.map((event) =>
	snippetCompletion(event.name + '={${}}', {
		label: event.name,
		info: event.description,
		type: 'keyword'
	})
);

const options_for_sveltekit_attributes = sveltekitAttributes.map((attr) => ({
	label: attr.name,
	info: attr.description,
	type: 'keyword'
}));

const options_for_sveltekit_attr_values = sveltekitAttributes.reduce((prev, cur) => {
	prev[cur.name] = cur.values.map((value) => ({ label: value.name, type: 'keyword' }));
	return prev;
}, /** @type {Record<string, import('@codemirror/autocomplete').Completion[]>} */ ({}));

/**
 * @param {{ name: string, description?: string}[]} attributes
 */
function snippet_for_attribute(attributes) {
	return attributes.map((attr) =>
		snippetCompletion(attr.name + '={${}}', {
			label: attr.name,
			info: attr.description,
			type: 'keyword'
		})
	);
}

const options_for_svelte_attributes = snippet_for_attribute(svelteAttributes);

const options_for_svelte_tags = svelteTags.reduce((tags, tag) => {
	tags[tag.name] = snippet_for_attribute(tag.attributes);
	return tags;
}, /** @type {Record<string, import('@codemirror/autocomplete').Completion[]>} */ ({}));

/**
 * @param {import('@codemirror/autocomplete').CompletionContext} context
 * @param {import("@lezer/common").SyntaxNode} node
 */
function completion_for_attributes(context, node) {
	/** @param {import('@codemirror/autocomplete').Completion[]} options */
	const completion = (options) => {
		return { from: node.from, to: context.pos, options, validFor: /^\w*$/ };
	};

	const global_options = [
		...options_for_svelte_events,
		...options_for_svelte_attributes,
		...options_for_sveltekit_attributes
	];

	if (node.parent?.parent?.firstChild?.nextSibling?.name === 'SvelteElementName') {
		const tag_node = node.parent.parent.firstChild.nextSibling;
		const tag = context.state.doc.sliceString(tag_node.from, tag_node.to);
		return completion([...global_options, ...options_for_svelte_tags[tag]]);
	} else if (node.parent?.parent?.firstChild?.nextSibling?.name === 'TagName') {
		const tag_node = node.parent.parent.firstChild.nextSibling;
		const tag = context.state.doc.sliceString(tag_node.from, tag_node.to);
		if (addAttributes[tag]) {
			const completions_attributes = snippet_for_attribute(addAttributes[tag]);
			return completion([...global_options, ...completions_attributes]);
		}
	}

	return completion(global_options);
}

/**
 * @param {import('@codemirror/autocomplete').CompletionContext} context
 * @param {import("@lezer/common").SyntaxNode} node
 * @param {string} attr
 */
function completion_for_sveltekit_attr_values(context, node, attr) {
	const options = options_for_sveltekit_attr_values[attr];
	if (options) {
		return {
			from: node.name === 'AttributeValueContent' ? node.from : node.from + 1,
			to: context.pos,
			options,
			validFor: /^\w*$/
		};
	}

	return null;
}

/**
 * @param {import('@codemirror/autocomplete').CompletionContext} context
 * @returns {import('@codemirror/autocomplete').CompletionResult | null}
 */
function completion_for_markup(context) {
	const node_before = syntaxTree(context.state).resolveInner(context.pos, -1);

	if (node_before.name === 'BlockPrefix') {
		return completion_for_block(context, node_before);
	} else if (node_before.prevSibling?.name === 'BlockPrefix') {
		return completion_for_block(context, node_before.prevSibling);
	} else if (node_before.name === 'AttributeName') {
		return completion_for_attributes(context, node_before);
	} else if (
		node_before.name === 'DirectiveOn' ||
		node_before.name === 'DirectiveBind' ||
		node_before.name === 'DirectiveTarget'
	) {
		if (node_before.parent) {
			return completion_for_attributes(context, node_before.parent);
		}
	} else if (node_before.parent?.name === 'AttributeValue') {
		if (node_before.parent?.parent?.firstChild) {
			const attr_name_node = node_before.parent.parent.firstChild;
			const attr_name = context.state.doc.sliceString(attr_name_node.from, attr_name_node.to);

			if (attr_name.startsWith('data-sveltekit-')) {
				return completion_for_sveltekit_attr_values(context, node_before, attr_name);
			}
		}
	}

	return null;
}

/**
 * @param {import('@codemirror/autocomplete').CompletionContext} context
 * @returns {import('@codemirror/autocomplete').CompletionResult | null}
 */
function completion_for_javascript(context) {
	// TODO autocompletion for import source

	return null;
}

export function autocomplete_for_svelte() {
	return [
		svelteLanguage.data.of({
			autocomplete: completion_for_markup
		}),
		javascriptLanguage.data.of({
			autocomplete: completion_for_javascript
		})
	];
}

```


####### src/routes/tutorial/[slug]/Chrome.svelte #######

```

<script>
	import { createEventDispatcher } from 'svelte';

	/** @type {string} */
	export let path;

	/** @type {boolean} */
	export let loading;

	/** @type {string | null} */
	export let href;

	const dispatch = createEventDispatcher();
</script>

<div class="chrome" class:loading>
	<button disabled={loading} class="reload icon" on:click={() => dispatch('refresh')} aria-label="reload" />

	<input
		disabled={loading}
		aria-label="URL"
		value={path}
		on:change={(e) => {
			dispatch('change', { value: e.currentTarget.value });
		}}
		on:keydown={(e) => {
			if (e.key !== 'Enter') return;

			dispatch('change', { value: e.currentTarget.value });
			e.currentTarget.blur();
		}}
	/>

	<a {href} class="new-tab icon" target="_blank" aria-label={href ? 'open in new tab' : undefined} tabindex="0" />

	<button
		disabled={loading}
		class="terminal icon"
		on:click={() => dispatch('toggle_terminal')}
		aria-label="toggle terminal"
	/>
</div>

<style>
	.chrome {
		width: 100%;
		height: 4rem;
		display: flex;
		border-top: 1px solid var(--sk-back-4);
	}

	button {
		user-select: none;
	}

	input {
		flex: 1;
		padding: 0.5rem 1rem 0.4rem 1rem;
		background-color: var(--sk-back-3);
		color: var(--sk-text-1);
		font-family: inherit;
		font-size: 1.6rem;
	}

	a:focus-visible,
	button:focus-visible,
	input:focus-visible {
		outline: none;
		border: 2px solid var(--sk-theme-3);
	}

	.icon, .icon::after {
		position: relative;
		height: 100%;
		aspect-ratio: 1;
		background: var(--sk-back-4) no-repeat 50% 50%;
		background-size: 2rem;
	}

	.loading a {
		opacity: 0.5;
	}

	.new-tab {
		background-image: url($lib/icons/external.svg);
	}

	.terminal {
		background-image: url($lib/icons/terminal.svg);
	}

	.reload::after {
		content: '';
		position: absolute;
		left: 0;
		top: 0;
		background-image: url($lib/icons/refresh.svg);
		transition: 0.2s ease-out;
	}

	.reload:active::after {
		transform: rotate(-360deg);
		transition: none;
	}
</style>

```


####### src/routes/tutorial/[slug]/codemirror.css #######

```

.codemirror-wrapper {
	height: 100%;
}

.cm-editor {
	height: 100%;
}

.cm-editor .cm-scroller {
	font-family: var(--font-mono);
	font-size: 1.3rem;
	line-height: 2rem;
}

.cm-editor .cm-gutters {
	background: var(--sk-back-3);
	border-right: none;
	padding: 0;
	width: 5rem;
}

.cm-editor .cm-activeLine {
	background: var(--sk-back-translucent);
}

.cm-editor .cm-activeLineGutter {
	background-color: var(--sk-back-3);
}

.cm-editor .cm-lineNumbers {
	flex: 1;
	color: #237893;
}

.cm-editor .cm-foldGutter {
	width: 1rem;
}

.cm-focused .cm-cursor {
	border-left-color: var(--sk-text-3);
}

.cm-editor .cm-content {
	padding: 1rem 0;
}

.cm-editor .cm-line {
	padding: 0 1rem;
}

.cm-editor .cm-selectionBackground {
	border-radius: 2px;
}

.cm-editor .cm-selectionMatch {
	background: var(--selection-color);
	color: var(--sk-text-2);
}

.cm-editor.cm-focused .cm-selectionBackground,
.cm-editor .cm-selectionBackground,
.cm-editor .cm-content ::selection {
	background: var(--sk-theme-3);
	opacity: .3;
}

.cm-editor .cm-tooltip {
	background: var(--sk-back-2);
	color: var(--sk-text-1);
	border: none;
	border-radius: 2px;
	overflow: hidden;
	margin: 0.4rem 0;
	filter: drop-shadow(1px 2px 5px rgba(0,0,0,0.1));
}

.cm-editor .cm-tooltip-hover {
	border: none;
}

.cm-editor .cm-tooltip-below {}
.cm-editor .cm-tooltip-lint {}
.cm-editor .cm-tooltip-section {}
.cm-editor .cm-diagnostic {
	border: none;
	padding: 0.2rem 0.8rem;
}

.cm-editor .cm-diagnostic-warning {
	background: var(--sk-theme-1-variant);
	color: white;
}

.cm-editor .cm-diagnosticText {}

.cm-editor .cm-tooltip.cm-tooltip-autocomplete > ul {
	font-family: var(--font-mono);
	font-size: 1.3rem;
}

.cm-editor .cm-panels {
	background: var(--sk-back-4);
	color: var(--sk-text-1);
}

.cm-editor .cm-panels.cm-panels-top,
.cm-editor .cm-panels.cm-panels-bottom {
	border-top: 1px solid var(--sk-back-5);
	border-bottom: 1px solid var(--sk-back-5);
}

.cm-editor .cm-button {
	background: var(--sk-back-5);
	border: 2px solid transparent;
}

.cm-editor .cm-button:active {
	background: var(--sk-theme-2-variant);
}

.cm-editor .cm-textfield {
	background: var(--sk-back-1);
	color: var(--sk-text-1);
	border: 2px solid transparent;
}

.cm-editor .cm-search button:focus-visible,
.cm-editor .cm-search input:focus-visible {
	border: 2px solid var(--flash);
}

.cm-editor .cm-search input[type='checkbox']:focus-visible {
	outline: 2px solid var(--flash);
}

```


####### src/routes/tutorial/[slug]/Editor.svelte #######

```

<script>
	import { browser } from '$app/environment';
	import { afterNavigate, beforeNavigate } from '$app/navigation';
	import { acceptCompletion } from '@codemirror/autocomplete';
	import { indentWithTab } from '@codemirror/commands';
	import { html } from '@codemirror/lang-html';
	import { javascript } from '@codemirror/lang-javascript';
	import { indentUnit } from '@codemirror/language';
	import { setDiagnostics } from '@codemirror/lint';
	import { EditorState } from '@codemirror/state';
	import { EditorView, keymap } from '@codemirror/view';
	import { svelte } from '@replit/codemirror-lang-svelte';
	import { svelteTheme } from '@sveltejs/repl/theme';
	import { basicSetup } from 'codemirror';
	import { onMount, tick } from 'svelte';
	import { warnings } from './adapter.js';
	import { autocomplete_for_svelte } from './autocompletion.js';
	import './codemirror.css';
	import { files, selected_file, selected_name, update_file } from './state.js';

	/** @type {HTMLDivElement} */
	let container;

	let preserve_editor_focus = false;
	let skip_reset = true;

	/** @type {any} */
	let remove_focus_timeout;

	/** @type {Map<string, import('@codemirror/state').EditorState>} */
	let editor_states = new Map();

	/** @type {import('@codemirror/view').EditorView} */
	let editor_view;

	const extensions = [
		basicSetup,
		EditorState.tabSize.of(2),
		keymap.of([{ key: 'Tab', run: acceptCompletion }, indentWithTab]),
		indentUnit.of('\t'),
		svelteTheme
	];

	$: reset($files);

	$: select_state($selected_name);

	$: if (editor_view) {
		if ($selected_name) {
			const current_warnings = $warnings[$selected_name];

			if (current_warnings) {
				const diagnostics = current_warnings.map((warning) => {
					/** @type {import('@codemirror/lint').Diagnostic} */
					const diagnostic = {
						from: warning.start.character,
						to: warning.end.character,
						severity: 'warning',
						message: warning.message
					};

					return diagnostic;
				});

				const transaction = setDiagnostics(editor_view.state, diagnostics);

				editor_view.dispatch(transaction);
			}
		}
	}

	let installed_vim = false;

	/** @param {import('$lib/types').Stub[]} $files */
	async function reset($files) {
		if (skip_reset) return;

		let should_install_vim = localStorage.getItem('vim') === 'true';

		const q = new URLSearchParams(location.search);
		if (q.has('vim')) {
			should_install_vim = q.get('vim') === 'true';
			localStorage.setItem('vim', should_install_vim.toString());
		}

		if (!installed_vim && should_install_vim) {
			installed_vim = true;
			const { vim } = await import('@replit/codemirror-vim');
			extensions.push(vim());
		}

		for (const file of $files) {
			if (file.type !== 'file') continue;

			let state = editor_states.get(file.name);

			if (state) {
				const existing = state.doc.toString();

				if (file.contents !== existing) {
					const transaction = state.update({
						changes: {
							from: 0,
							to: existing.length,
							insert: file.contents
						}
					});

					editor_states.set(file.name, transaction.state);
					state = transaction.state;

					if ($selected_name === file.name) {
						editor_view.setState(state);
					}
				}
			} else {
				let lang;

				if (file.name.endsWith('.js') || file.name.endsWith('.json')) {
					lang = [javascript()];
				} else if (file.name.endsWith('.html')) {
					lang = [html()];
				} else if (file.name.endsWith('.svelte')) {
					lang = [svelte(), ...autocomplete_for_svelte()];
				}

				state = EditorState.create({
					doc: file.contents,
					extensions: lang ? [...extensions, ...lang] : extensions
				});

				editor_states.set(file.name, state);
			}
		}
	}

	/** @param {string | null} $selected_name */
	function select_state($selected_name) {
		if (skip_reset) return;

		const state =
			($selected_name && editor_states.get($selected_name)) ||
			EditorState.create({
				doc: '',
				extensions: [EditorState.readOnly.of(true)]
			});

		editor_view.setState(state);
	}

	onMount(() => {
		editor_view = new EditorView({
			parent: container,
			async dispatch(transaction) {
				editor_view.update([transaction]);

				if (transaction.docChanged && $selected_file) {
					skip_reset = true;

					// TODO do we even need to update `$files`? maintaining separate editor states is probably sufficient
					update_file({
						...$selected_file,
						contents: editor_view.state.doc.toString()
					});

					// keep `editor_states` updated so that undo/redo history is preserved for files independently
					editor_states.set($selected_file.name, editor_view.state);

					await tick();
					skip_reset = false;
				}
			}
		});

		return () => {
			editor_view.destroy();
		};
	});

	beforeNavigate(() => {
		skip_reset = true;
	});

	afterNavigate(async () => {
		skip_reset = false;

		editor_states.clear();
		await reset($files);

		if (editor_view) {
			// could be false if onMount returned early
			select_state($selected_name);
		}

		// clear warnings
		warnings.set({});
	});
</script>

<svelte:window
	on:pointerdown={(e) => {
		if (!container.contains(/** @type {HTMLElement} */ (e.target))) {
			preserve_editor_focus = false;
		}
	}}
	on:message={(e) => {
		if (preserve_editor_focus && e.data.type === 'iframe_took_focus') {
			editor_view.focus();
		}
	}}
/>

<div
	class="container"
	bind:this={container}
	on:focusin={() => {
		clearTimeout(remove_focus_timeout);
		preserve_editor_focus = true;
	}}
	on:focusout={() => {
		// Heuristic: user did refocus themmselves if iframe_took_focus
		// doesn't happen in the next few miliseconds. Needed
		// because else navigations inside the iframe refocus the editor.
		remove_focus_timeout = setTimeout(() => {
			preserve_editor_focus = false;
		}, 200);
	}}
>
	{#if !browser && $selected_file}
		<div class="fake">
			<div class="fake-gutter">
				{#each $selected_file.contents.split('\n') as _, i}
					<div class="fake-line">{i + 1}</div>
				{/each}
			</div>
			<div class="fake-content">
				{#each $selected_file.contents.split('\n') as line}
					<pre>{line || ' '}</pre>
				{/each}
			</div>
		</div>
	{/if}
</div>

<style>
	.container {
		width: 100%;
		height: 100%;
	}

	.fake {
		display: grid;
		grid-template-columns: 4rem 1fr;
		grid-gap: 1rem;
		padding: 1rem 0;
		font-size: 1.3rem;
		line-height: 2rem;
	}

	.fake * {
		font-family: var(--font-mono) !important;
		color: #ccc;
	}

	.fake-gutter {
		text-align: right;
		padding-right: 3px;
	}

	.fake-content {
		padding: 0 1rem;
	}

	@media (prefers-color-scheme: dark) {
		.fake * {
			color: #666;
		}
	}
</style>

```


####### src/routes/tutorial/[slug]/filetree/context.js #######

```

import { setContext, getContext } from 'svelte';

/**
 * @typedef {{
 *   collapsed: import('svelte/store').Writable<Record<string, boolean>>;
 *   add: (name: string, type: 'file' | 'directory') => Promise<void>;
 *   rename: (stub: import('$lib/types').Stub, name: string) => Promise<void>;
 *   remove: (stub: import('$lib/types').Stub) => Promise<void>;
 *   select: (name: string) => void;
 * }} FileTreeContext
 */

const key = {};

/** @param {FileTreeContext} context */
export function set(context) {
	setContext(key, context);
}

export function get() {
	return /** @type {FileTreeContext} */ (getContext(key));
}

```


####### src/routes/tutorial/[slug]/filetree/ContextMenu.svelte #######

```

<!-- @component
     A context menu for the tutorial's file tree
-->
<script context="module">
	import { writable } from 'svelte/store';

	/**
	 * @typedef {{ icon: string; label: string; fn: () => void }} MenuItem
	 */

	/**
	 * @type {import("svelte/store").Writable<{x: number; y: number; items: MenuItem[]} | null>}
	 */
	let menu_items = writable(null);

	/**
	 * @param {number} x
	 * @param {number} y
	 * @param {MenuItem[]} items
	 */
	export function open(x, y, items) {
		if (items.length > 0) {
			menu_items.set({ x, y, items });
		}
	}
</script>

{#if $menu_items}
	<nav style="position: fixed; z-index: 5; top:{$menu_items.y}px; left:{$menu_items.x}px">
		<div class="navbar" id="navbar">
			<ul>
				{#each $menu_items.items as item}
					<li>
						<button on:click={item.fn}>{item.label}</button>
					</li>
				{/each}
			</ul>
		</div>
	</nav>
{/if}

<svelte:window on:click={() => menu_items.set(null)} />

<style>
	.navbar {
		display: inline-flex;
		border: 1px solid rgba(0, 0, 0, 0.1);
		background-color: var(--back);
		border-radius: var(--border-r);
		overflow: hidden;
		flex-direction: column;
		filter: drop-shadow(1px 1px 4px rgba(0, 0, 0, 0.1));
	}

	ul {
		margin: 0;
		padding: 0;
		background-color: var(--sk-back-3);
		border: 1px solid hsl(var(--sk-theme-1-hsl));
	}

	li {
		display: block;
		list-style-type: none;
		width: 1fr;
	}
	li:hover {
		background-color: var(--sk-theme-1-variant);
	}

	button {
		color: var(--sk-text-2);
		width: 100%;
		text-align: left;
		border: 0px;
		padding: 0.4rem 1rem 0.2rem 1rem;
		font-size: 1.4rem;
	}

	li:first-child button {
		padding-top: 0.5rem;
	}

	li:last-child button {
		padding-bottom: 0.4rem;
	}

	button:hover {
		background-color: var(--back-api);
	}
</style>

```


####### src/routes/tutorial/[slug]/filetree/File.svelte #######

```

<script>
	import * as context from './context.js';
	import Item from './Item.svelte';
	import file_icon from '$lib/icons/file.svg';
	import { selected_name, solution } from '../state.js';

	/** @type {import('$lib/types').FileStub} */
	export let file;

	/** @type {number} */
	export let depth;

	const { rename, remove, select } = context.get();

	let renaming = false;

	$: can_remove = !$solution[file.name];

	/** @type {import('./ContextMenu.svelte').MenuItems} */
	$: actions = can_remove
		? [
				{
					icon: 'rename',
					label: 'Rename',
					fn: () => {
						renaming = true;
					}
				},
				{
					icon: 'delete',
					label: 'Delete',
					fn: () => {
						remove(file);
					}
				}
		  ]
		: [];
</script>

<Item
	{depth}
	can_rename={can_remove}
	{renaming}
	basename={file.basename}
	icon={file_icon}
	selected={file.name === $selected_name}
	{actions}
	on:click={() => select(file.name)}
	on:edit={() => {
		renaming = true;
	}}
	on:rename={(e) => {
		rename(file, e.detail.basename);
	}}
	on:cancel={() => {
		renaming = false;
	}}
/>

```


####### src/routes/tutorial/[slug]/filetree/Filetree.svelte #######

```

<script>
	import { createEventDispatcher } from 'svelte';
	import { writable } from 'svelte/store';
	import Folder from './Folder.svelte';
	import * as context from './context.js';
	import Modal from '$lib/components/Modal.svelte';
	import { files, solution, reset_files, create_directories, selected_name } from '../state.js';
	import { afterNavigate } from '$app/navigation';

	/** @type {import('$lib/types').Exercise} */
	export let exercise;

	export let mobile = false;

	const dispatch = createEventDispatcher();

	const hidden = new Set(['__client.js', 'node_modules', '__delete']);

	let modal_text = '';

	/** @type {import('svelte/store').Writable<Record<string, boolean>>}*/
	const collapsed = writable({});

	afterNavigate(() => {
		collapsed.set({});
	});

	context.set({
		collapsed,

		add: async (name, type) => {
			const expected = $solution[name];

			if (expected && type !== expected.type) {
				modal_text = `${name.slice(exercise.scope.prefix.length)} should be a ${expected.type}, not a ${type}!`;
				return;
			}

			if (!expected && !exercise.editing_constraints.create.has(name)) {
				modal_text =
					'Only the following files and folders are allowed to be created in this exercise:\n' +
					Array.from(exercise.editing_constraints.create).join('\n');
				return;
			}

			const existing = $files.find((file) => file.name === name);
			if (existing) {
				modal_text = `A ${existing.type} already exists with this name`;
				return;
			}

			const basename = /** @type {string} */ (name.split('/').pop());

			/** @type {import('$lib/types').Stub} */
			const file = type === 'file'
				? { type, name, basename, text: true, contents: '' }
				: { type, name, basename };

			reset_files([...$files, ...create_directories(name, $files), file]);

			if (type === 'file') {
				dispatch('select', { name });
			}
		},

		rename: async (to_rename, new_name) => {
			const new_full_name = to_rename.name.slice(0, -to_rename.basename.length) + new_name;

			if ($files.some((f) => f.name === new_full_name)) {
				modal_text = `A file or folder named ${new_full_name} already exists`;
				return;
			}

			if (!$solution[new_full_name] && !exercise.editing_constraints.create.has(new_full_name)) {
				modal_text =
					'Only the following files and folders are allowed to be created in this exercise:\n' +
					Array.from(exercise.editing_constraints.create).join('\n');
				return;
			}

			if ($solution[to_rename.name] && !exercise.editing_constraints.remove.has(to_rename.name)) {
				modal_text =
					'Only the following files and folders are allowed to be removed in this exercise:\n' +
					Array.from(exercise.editing_constraints.remove).join('\n');
				return;
			}

			if (to_rename.type === 'directory') {
				for (const file of $files) {
					if (file.name.startsWith(to_rename.name + '/')) {
						file.name = new_full_name + file.name.slice(to_rename.name.length);
					}
				}
			}

			const was_selected = $selected_name === to_rename.name;

			to_rename.basename = /** @type {string} */ (new_full_name.split('/').pop());
			to_rename.name = new_full_name;

			reset_files([...$files, ...create_directories(new_full_name, $files)]);

			if (was_selected) {
				dispatch('select', { name: new_full_name });
			}
		},

		remove: async (file) => {
			if ($solution[file.name] && !exercise.editing_constraints.remove.has(file.name)) {
				modal_text =
					'Only the following files and folders are allowed to be deleted in this tutorial chapter:\n' +
					Array.from(exercise.editing_constraints.remove).join('\n');
				return;
			}

			dispatch('select', { name: null });

			reset_files(
				$files.filter((f) => {
					if (f === file) return false;
					if (f.name.startsWith(file.name + '/')) return false;
					return true;
				})
			);
		},

		select: (name) => {
			dispatch('select', { name });
		}
	});

	/** @param {import('$lib/types').Stub} file */
	function is_deleted(file) {
		if (file.type === 'directory') return `${file.name}/__delete` in exercise.a;
		if (file.text) return file.contents.startsWith('__delete');

		return false;
	}
</script>

<ul
	class="filetree"
	class:mobile
	on:keydown={(e) => {
		if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
			e.preventDefault();
			const lis = Array.from(e.currentTarget.querySelectorAll('li'));
			const focused = lis.findIndex((li) => li.contains(e.target));

			const d = e.key === 'ArrowUp' ? -1 : +1;

			lis[focused + d]?.querySelector('button')?.focus();
		}
	}}
>
	<Folder
		prefix={exercise.scope.prefix}
		depth={0}
		directory={{
			type: 'directory',
			name: '',
			basename: exercise.scope.name
		}}
		contents={$files.filter((file) => !hidden.has(file.basename) && !is_deleted(file))}
	/>
</ul>

{#if modal_text}
	<Modal on:close={() => (modal_text = '')}>
		<div class="modal-contents">
			<h2>This action is not allowed</h2>
			<p>{modal_text}</p>
			<button on:click={() => (modal_text = '')}>OK</button>
		</div>
	</Modal>
{/if}

<style>
	.filetree {
		--font-size: 1.4rem;
		flex: 1;
		overflow-y: auto;
		overflow-x: hidden;
		padding: 1rem 0rem;
		margin: 0;
		background: var(--sk-back-1);
		list-style: none;
	}

	.filetree.mobile {
		height: 100%;
	}

	.filetree:not(.mobile)::before {
		content: '';
		position: absolute;
		width: 0;
		height: 100%;
		top: 0;
		right: 0;
		border-right: 1px solid var(--sk-back-4);
	}

	.modal-contents p {
		white-space: pre-line;
	}

	.modal-contents button {
		display: block;
		background: var(--sk-theme-1);
		color: white;
		padding: 1rem;
		width: 10em;
		margin: 1em 0 0 0;
		border-radius: var(--sk-border-radius);
		line-height: 1;
	}
</style>

```


####### src/routes/tutorial/[slug]/filetree/Folder.svelte #######

```

<script>
	import File from './File.svelte';
	import * as context from './context.js';
	import { get_depth } from '$lib/utils';
	import Item from './Item.svelte';
	import folder_closed from '$lib/icons/folder.svg';
	import folder_open from '$lib/icons/folder-open.svg';
	import { files, solution, creating } from '../state.js';

	/** @type {import('$lib/types').DirectoryStub} */
	export let directory;

	/** @type {string} */
	export let prefix;

	/** @type {number} */
	export let depth;

	/** @type {Array<import('$lib/types').Stub>} */
	export let contents;

	let renaming = false;

	const { collapsed, rename, add, remove } = context.get();

	$: segments = get_depth(prefix);

	$: children = contents
		.filter((file) => file.name.startsWith(prefix))
		.sort((a, b) => (a.name < b.name ? -1 : 1));

	$: child_directories = children.filter(
		(child) => get_depth(child.name) === segments && child.type === 'directory'
	);

	$: child_files = /** @type {import('$lib/types').FileStub[]} */ (
		children.filter((child) => get_depth(child.name) === segments && child.type === 'file')
	);

	const can_create = { file: false, directory: false };

	$: {
		can_create.file = false;
		can_create.directory = false;

		const child_prefixes = [];

		for (const file of $files) {
			if (
				file.type === 'directory' &&
				file.name.startsWith(prefix) &&
				get_depth(file.name) === depth + 1
			) {
				child_prefixes.push(file.name + '/');
			}
		}

		for (const file of Object.values($solution)) {
			if (!file.name.startsWith(prefix)) continue;

			// if already exists in $files, bail
			if ($files.find((f) => f.name === file.name)) continue;

			// if intermediate directory exists, bail
			if (child_prefixes.some((prefix) => file.name.startsWith(prefix))) continue;

			can_create[file.type] = true;
		}
	}

	// fake root directory has no name
	$: can_remove = directory.name ? !$solution[directory.name] : false;

	/** @type {import('./ContextMenu.svelte').MenuItem[]} */
	$: actions = [
		can_create.file && {
			icon: 'file-new',
			label: 'New file',
			fn: () => {
				creating.set({
					parent: directory.name,
					type: 'file'
				});
			}
		},
		can_create.directory && {
			icon: 'folder-new',
			label: 'New folder',
			fn: () => {
				creating.set({
					parent: directory.name,
					type: 'directory'
				});
			}
		},
		can_remove && {
			icon: 'rename',
			label: 'Rename',
			fn: () => {
				renaming = true;
			}
		},
		can_remove && {
			icon: 'delete',
			label: 'Delete',
			fn: () => {
				remove(directory);
			}
		}
	].filter(Boolean);
</script>

<Item
	{depth}
	basename={directory.basename}
	icon={$collapsed[directory.name] ? folder_closed : folder_open}
	can_rename={can_remove}
	{renaming}
	{actions}
	on:click={() => {
		$collapsed[directory.name] = !$collapsed[directory.name];
	}}
	on:edit={() => {
		renaming = true;
	}}
	on:rename={(e) => {
		rename(directory, e.detail.basename);
	}}
	on:cancel={() => {
		renaming = false;
	}}
	on:keydown={(e) => {
		if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
			$collapsed[directory.name] = e.key === 'ArrowLeft';
		}
	}}
/>

{#if !$collapsed[directory.name]}
	{#if $creating?.parent === directory.name && $creating.type === 'directory'}
		<Item
			depth={depth + 1}
			renaming
			on:rename={(e) => {
				add(prefix + e.detail.basename, 'directory');
			}}
			on:cancel={() => {
				creating.set(null);
			}}
		/>
	{/if}

	{#each child_directories as directory}
		<svelte:self {directory} prefix={directory.name + '/'} depth={depth + 1} contents={children} />
	{/each}

	{#if $creating?.parent === directory.name && $creating.type === 'file'}
		<Item
			depth={depth + 1}
			renaming
			on:rename={(e) => {
				add(prefix + e.detail.basename, 'file');
			}}
			on:cancel={() => {
				creating.set(null);
			}}
		/>
	{/if}

	{#each child_files as file, i}
		<File {file} depth={depth + 1} />
	{/each}
{/if}

```


####### src/routes/tutorial/[slug]/filetree/Item.svelte #######

```

<script>
	import { createEventDispatcher, tick } from 'svelte';
	import { open } from './ContextMenu.svelte';

	export let basename = '';
	export let icon = '';
	export let depth = 0;

	export let selected = false;

	/** @type {boolean} */
	export let can_rename = false;

	/** @type {boolean} */
	export let renaming;

	/** @type {import('./ContextMenu.svelte').MenuItem[]} */
	export let actions = [];

	const dispatch = createEventDispatcher();

	let cancelling = false;

	/** @param {Event} e */
	function commit(e) {
		const input = /** @type {HTMLInputElement} */ (e.target);
		if (input.value && input.value !== basename) {
			dispatch('rename', { basename: input.value });
		}

		cancel();
	}

	async function cancel() {
		cancelling = true;
		dispatch('cancel');
		await tick();
		cancelling = false;
	}
</script>

<li
	aria-current={selected ? 'true' : undefined}
	style="--depth: {depth}; --icon: url('{icon}');"
	on:keydown
>
	{#if renaming}
		<!-- svelte-ignore a11y-autofocus -->
		<input
			type="text"
			autofocus
			autocomplete="off"
			spellcheck="false"
			value={basename}
			on:blur={(e) => {
				if (!cancelling) {
					commit(e);
				}
			}}
			on:keyup={(e) => {
				if (e.key === 'Enter') {
					commit(e);
				}

				if (e.key === 'Escape') {
					cancel();
				}
			}}
		/>
	{:else}
		<button
			class="basename"
			on:click
			on:dblclick={() => {
				if (can_rename) {
					dispatch('edit');
				}
			}}
			on:contextmenu|preventDefault={(e) => {
				open(e.clientX, e.clientY, actions);
			}}
		>
			{basename}
		</button>

		{#if actions.length > 0}
			<div class="actions">
				{#each actions as action}
					<button aria-label={action.label} class="icon {action.icon}" on:click={action.fn} />
				{/each}
			</div>
		{/if}
	{/if}
</li>

<style>
	li {
		--bg: var(--sk-back-1);
		--inset: calc((var(--depth) * 1.2rem) + 1.5rem);
		display: flex;
		position: relative;
		width: calc(100% - 1px);
		height: 2.4rem;
		z-index: 1;
		background: var(--bg) var(--icon) no-repeat;
		background-position: calc(var(--inset) - 0.5rem) 50%;
		background-size: 1.2rem;
		color: var(--sk-text-2);
	}

	li:hover {
		--bg: var(--sk-back-3);
	}

	button,
	input {
		background-size: 1.2rem 1.2rem;
		background-position: 0 45%;
		background-repeat: no-repeat;
	}

	:focus-visible {
		outline: none;
		border: 2px solid var(--sk-theme-3) !important;
		border-radius: 2px;
	}

	input {
		background: var(--sk-back-1);
		color: var(--sk-text-1) !important;
		margin: 0 0.5rem 0 calc(0.5rem + var(--inset));
		padding: 0 0.5rem;
		font-size: var(--font-size);
		font-family: inherit;
	}

	.basename {
		display: block;
		position: relative;
		margin: 0;
		padding: 0 1rem 0 calc(1rem + var(--inset));
		font-size: var(--font-size);
		font-family: inherit;
		color: inherit;
		flex: 1;
		height: 100%;
		text-align: left;
		border: 2px solid transparent;
		white-space: nowrap;
		overflow: hidden;
		line-height: 1;
	}

	input {
		width: 100%;
		height: 100%;
	}

	.actions {
		display: flex;
		right: 0;
		top: 0;
		height: 100%;
		padding-right: 1rem;
		background-color: var(--bg);
		white-space: pre;
	}

	.icon {
		height: 100%;
		width: 1.5rem;
	}

	.icon.rename {
		background-image: url($lib/icons/rename.svg);
	}

	.icon.delete {
		background-image: url($lib/icons/delete.svg);
	}

	.icon.file-new {
		background-image: url($lib/icons/file-new.svg);
	}

	.icon.folder-new {
		background-image: url($lib/icons/folder-new.svg);
	}

	[aria-current='true'] {
		color: var(--sk-theme-1);
	}

	[aria-current='true']::after {
		content: '';
		position: absolute;
		width: 1rem;
		height: 1rem;
		top: 0.3rem;
		right: calc(-0.6rem - 2px);
		background-color: var(--sk-back-3);
		border: 1px solid var(--sk-back-4);
		transform: translate(0, 0.2rem) rotate(45deg);
		z-index: 2;
	}

	[aria-current='true']:has(:focus-visible)::after,
	:global(.mobile-filetree) [aria-current='true']::after {
		display: none;
	}
</style>
```


####### src/routes/tutorial/[slug]/ImageViewer.svelte #######

```

<script>
	/** @type {import('$lib/types').FileStub | null} */
	export let selected;

	const image_types = new Map([
		// TODO add more
		['.jpg', 'image/jpeg'],
		['.jpeg', 'image/jpeg'],
		['.png', 'image/png'],
		['.gif', 'image/gif'],
		['.webp', 'image/webp']
	]);

	$: ext = selected?.basename.slice(selected.basename.lastIndexOf('.'));
	$: image_type = ext && image_types.get(ext);
	$: image = image_type && selected;
</script>

{#if image}
	<div class="image-viewer">
		<img alt="{image.name} preview" src="data:{image_type};base64,{image.contents}" />
	</div>
{/if}

<style>
	.image-viewer {
		position: absolute;
		width: 100%;
		height: 100%;
		left: 0;
		top: 0;
		display: flex;
		align-items: center;
		justify-content: center;
		background: white
			url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 20 20" height="20px" width="20px"><g><rect fill="hsl(240, 8%, 95%)" width="10" height="10"></rect><rect fill="hsl(240, 8%, 95%)" x="10" y="10" width="10" height="10"></rect></g></svg>');
	}

	img {
		max-width: 100%;
		max-height: 100%;
		object-fit: contain;
	}
</style>

```


####### src/routes/tutorial/[slug]/+layout.server.js #######

```

import { get_index } from '$lib/server/content.js';

export function load() {
	return {
		index: get_index()
	};
}

```


####### src/routes/tutorial/[slug]/Loading.svelte #######

```

<script>
	import { page } from '$app/stores';
	import { Icon } from '@sveltejs/site-kit/components';
	import { load_webcontainer, reset } from './adapter';
	import { files } from './state';

	/** @type {boolean} */
	export let initial;

	/** @type {Error | null} */
	export let error;

	/** @type {number} */
	export let progress;

	/** @type {string} */
	export let status;

	$: is_svelte = /Part (1|2)/.test($page.data.exercise.part.title);
</script>

<div class="loading">
	{#if error}
		<div class="error">
			<div>
				<h2>Yikes!</h2>
				{#if error.message === 'Your browser does not support all necessary features'}
					<p>
						This app requires modern web platform features. Please use a browser other than Safari.
					</p>
				{:else if /firefox/i.test(navigator.userAgent)}
					<p>
						We couldn't start the app. Please ensure
						<a
							target="_blank"
							rel="noreferrer"
							href="https://support.mozilla.org/en-US/kb/third-party-cookies-firefox-tracking-protection"
						>
							third party cookies
						</a> are enabled for this site, and disable Enhanced Tracking Protection.
					</p>
					<p>
						If you have 'Delete cookies and site data when Firefox is closed' enabled in
						<code>about:preferences#privacy</code>, make sure <code>learn.svelte.dev</code> is included
						as an exception.
					</p>
				{:else if /chrome/i.test(navigator.userAgent) && !/edg/i.test(navigator.userAgent)}
					<p>
						We couldn't start the app. Please ensure third party cookies are enabled for this site —
						click the
						<svg
							xmlns="http://www.w3.org/2000/svg"
							viewBox="0 0 24 24"
							style="width: 1em; height: 1em; position: relative; top: 0.1em; margin: 0 0.2em; transform: scale(1.2)"
						>
							<title>eye</title>
							<path
								fill="#666"
								d="M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.08L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.74,7.13 11.35,7 12,7Z"
							/>
						</svg>
						icon in the URL bar or go to
						<code>chrome://settings/cookies</code> and add <code>learn.svelte.dev</code> to 'Sites that
						can always use cookies'.
					</p>
					<!-- TODO: remove this when webcontainers are properly supported on iOS
				see https://github.com/stackblitz/webcontainer-core/issues/1120 -->
				{:else if /iphone/i.test(navigator.userAgent)}
					<p>
						We couldn't start the app. It seems that you're using iOS, which does not support
						WebContainers.
					</p>
					<p>
						If this is not the case, you can try loading it by <button
							type="button"
							on:click={async () => {
								error = null;
								load_webcontainer();
								await reset($files);
							}}>clicking here</button
						>.
					</p>
				{:else}
					<p>
						We couldn't start the app. Please ensure third party cookies are enabled for this site.
					</p>
				{/if}

				{#if is_svelte}
					<a href="https://svelte.dev/tutorial/{$page.data.exercise.slug}">
						Or go to the legacy svelte tutorial instead <Icon name="arrow-right" />
					</a>
				{/if}
			</div>

			<small>{error.message}</small>
		</div>
	{:else}
		<svg width="107" height="128" viewBox="0 0 107 128">
			<path
				d="M94.1566,22.8189c-10.4-14.8851-30.94-19.2971-45.7914-9.8348L22.2825,29.6078A29.9234,29.9234,0,0,0,8.7639,49.6506a31.5136,31.5136,0,0,0,3.1076,20.2318A30.0061,30.0061,0,0,0,7.3953,81.0653a31.8886,31.8886,0,0,0,5.4473,24.1157c10.4022,14.8865,30.9423,19.2966,45.7914,9.8348L84.7167,98.3921A29.9177,29.9177,0,0,0,98.2353,78.3493,31.5263,31.5263,0,0,0,95.13,58.117a30,30,0,0,0,4.4743-11.1824,31.88,31.88,0,0,0-5.4473-24.1157"
				style="fill: var(--faded)"
			/>
			<path
				d="M45.8171,106.5815A20.7182,20.7182,0,0,1,23.58,98.3389a19.1739,19.1739,0,0,1-3.2766-14.5025,18.1886,18.1886,0,0,1,.6233-2.4357l.4912-1.4978,1.3363.9815a33.6443,33.6443,0,0,0,10.203,5.0978l.9694.2941-.0893.9675a5.8474,5.8474,0,0,0,1.052,3.8781,6.2389,6.2389,0,0,0,6.6952,2.485,5.7449,5.7449,0,0,0,1.6021-.7041L69.27,76.281a5.4306,5.4306,0,0,0,2.4506-3.631,5.7948,5.7948,0,0,0-.9875-4.3712,6.2436,6.2436,0,0,0-6.6978-2.4864,5.7427,5.7427,0,0,0-1.6.7036l-9.9532,6.3449a19.0329,19.0329,0,0,1-5.2965,2.3259,20.7181,20.7181,0,0,1-22.2368-8.2427,19.1725,19.1725,0,0,1-3.2766-14.5024,17.9885,17.9885,0,0,1,8.13-12.0513L55.8833,23.7472a19.0038,19.0038,0,0,1,5.3-2.3287A20.7182,20.7182,0,0,1,83.42,29.6611a19.1739,19.1739,0,0,1,3.2766,14.5025,18.4,18.4,0,0,1-.6233,2.4357l-.4912,1.4978-1.3356-.98a33.6175,33.6175,0,0,0-10.2037-5.1l-.9694-.2942.0893-.9675a5.8588,5.8588,0,0,0-1.052-3.878,6.2389,6.2389,0,0,0-6.6952-2.485,5.7449,5.7449,0,0,0-1.6021.7041L37.73,51.719a5.4218,5.4218,0,0,0-2.4487,3.63,5.7862,5.7862,0,0,0,.9856,4.3717,6.2437,6.2437,0,0,0,6.6978,2.4864,5.7652,5.7652,0,0,0,1.602-.7041l9.9519-6.3425a18.978,18.978,0,0,1,5.2959-2.3278,20.7181,20.7181,0,0,1,22.2368,8.2427,19.1725,19.1725,0,0,1,3.2766,14.5024,17.9977,17.9977,0,0,1-8.13,12.0532L51.1167,104.2528a19.0038,19.0038,0,0,1-5.3,2.3287"
				style="fill: var(--cutout)"
			/>
		</svg>

		{#if initial}
			<div class="progress-container">
				<div class="progress" style="width: {progress * 100}%;" />
			</div>
			<span>{status}</span>
		{/if}
	{/if}
</div>

<style>
	.loading {
		--faded: #eee;
		--progress: #ccc;
		--cutout: #fff;
		position: absolute;
		width: 100%;
		height: 100%;
		top: 0;
		left: 0;
		padding: 2rem;
		display: flex;
		gap: 1rem;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		background: var(--sk-back-2);
		user-select: none;
	}

	.progress-container {
		width: 10rem;
		height: 0.5rem;
		background: var(--faded);
		border-radius: 0.25rem;
	}

	.progress {
		height: 100%;
		background: var(--progress);
		border-radius: 0.25rem;
		transition: width 0.2s ease-out;
	}

	.error {
		width: 100%;
		height: 100%;
		display: flex;
		flex-direction: column;
		justify-content: space-between;
	}

	h2 {
		font-size: var(--sk-text-xl);
	}

	p {
		margin: 0 0 1em 0;
	}

	button {
		color: var(--sk-theme-1);
		padding: 0 0 1px;
		position: relative;
	}

	button:hover {
		text-decoration: underline;
	}

	small {
		font-size: var(--sk-text-xs);
		color: var(--sk-text-3);
		text-transform: uppercase;
	}

	span {
		color: var(--sk-text-3);
	}

	svg {
		width: 10rem;
		height: 10rem;
	}

	@media (prefers-color-scheme: dark) {
		.loading {
			--faded: #444;
			--progress: #555;
			--cutout: var(--sk-back-2);
		}
	}
</style>

```


####### src/routes/tutorial/[slug]/Menu.svelte #######

```

<script>
	import { page } from '$app/stores';
	import { click_outside, focus_outside } from '@sveltejs/site-kit/actions';
	import { Icon } from '@sveltejs/site-kit/components';
	import { open_nav } from '@sveltejs/site-kit/nav';
	import { mql, reduced_motion, theme } from '@sveltejs/site-kit/stores';
	import { expoOut } from 'svelte/easing';
	import { slide } from 'svelte/transition';

	/** @type {import('$lib/types').PartStub[]}*/
	export let index;

	/** @type {import('$lib/types').Exercise} */
	export let current;

	const is_mobile = mql('(max-width: 800px)');

	const duration = $reduced_motion ? 0 : 200;

	let is_open = false;

	$: expanded_part = current.part.slug;
	$: expanded_chapter = current.chapter.slug;
</script>

<div
	class="container"
	class:dark={$theme.current === 'dark'}
	use:focus_outside={() => (is_open = false)}
	use:click_outside={() => (is_open = false)}
>
	<header>
		<a
			class="prev-button"
			href={current.prev ? `/tutorial/${current.prev.slug}` : undefined}
			aria-label={current.prev && 'Previous'}
		>
			<Icon name="arrow-left" size={16} />
		</a>

		<button
			class="heading"
			on:click={() => ($is_mobile ? open_nav() : (is_open = !is_open))}
			class:open={is_open}
		>
			<h1>
				<div class="mobile">
					<div class="heading-row">
						<strong>{current.title}</strong>
					</div>
					<div class="heading-row">
						<span class="part-title">{current.part.label}</span>
						<span class="separator">/</span>
						<span class="chapter-title">{current.chapter.title}</span>
					</div>
				</div>

				<div class="desktop">
					<span class="part-title">{current.part.title}</span><span class="separator">/</span>
					<span class="chapter-title">{current.chapter.title}</span><span class="separator">/</span
					><strong>{current.title}</strong>
				</div>

				<span style="flex: 1 1 auto" />
			</h1>

			<span class="expand-icon" class:inverted={is_open}>
				<Icon name="chevron-down" />
			</span>

			{#if is_open}
				<nav
					aria-label="tutorial exercises"
					transition:slide={{ axis: 'y', easing: expoOut, duration: $reduced_motion ? 0 : 400 }}
				>
					<div class="exercises">
						<ul>
							{#each index as part, i (part.slug)}
								<li
									class="part"
									class:expanded={part.slug === expanded_part}
									aria-current={part.slug === current.part.slug ? 'step' : undefined}
									transition:slide={{ duration }}
								>
									<button
										on:click|stopPropagation={() => {
											if (expanded_part !== part.slug) {
												expanded_part = part.slug;
												expanded_chapter = part.chapters[0].slug;
											}
										}}
									>
										Part {i + 1}: {part.title}
									</button>

									{#if part.slug === expanded_part}
										<ul class="chapter" transition:slide={{ duration }}>
											{#each part.chapters as chapter (chapter.slug)}
												<li
													class="chapter"
													class:expanded={chapter.slug === expanded_chapter}
													aria-current={chapter.slug === current.chapter.slug ? 'step' : undefined}
												>
													<button
														on:click|stopPropagation={() => (expanded_chapter = chapter.slug)}
														style="width: 100%; text-align: start;"
													>
														<!-- <img src={arrow} alt="Arrow icon" /> -->
														<Icon name="arrow-right-chevron" size={16} />
														{chapter.title}
													</button>

													{#if chapter.slug === expanded_chapter}
														<ul transition:slide={{ duration }}>
															{#each chapter.exercises as exercise (exercise.slug)}
																<li
																	transition:slide={{ duration }}
																	class="exercise"
																	aria-current={$page.url.pathname === `/tutorial/${exercise.slug}`
																		? 'page'
																		: undefined}
																>
																	<a
																		href="/tutorial/{exercise.slug}"
																		on:click={() => (is_open = false)}
																	>
																		{exercise.title}
																	</a>
																</li>
															{/each}
														</ul>
													{/if}
												</li>
											{/each}
										</ul>
									{/if}
								</li>
							{/each}
						</ul>
					</div>
				</nav>
			{/if}
		</button>

		<a
			class="next-button"
			href={current.next ? `/tutorial/${current.next.slug}` : undefined}
			aria-label="Next"
		>
			<Icon name="arrow-right" size={16} />
		</a>
	</header>
</div>

<style>
	.container {
		--shadow: 0px 0px 14px rgba(0, 0, 0, 0.1);

		position: relative;

		display: flex;
		justify-content: center;

		border-right: 1px solid var(--sk-back-4);

		width: 100%;
		padding: 1rem 0;

		background-color: transparent;

		isolation: isolate;
		z-index: 4;
	}

	.container.dark {
		--shadow: 0 0 0 1px var(--sk-back-4);
	}

	header {
		position: relative;
		/* z-index: 2; */

		display: grid;
		grid-template-columns: 4rem minmax(0, 1fr) 4rem;
		gap: 0.5rem;
		align-items: center;

		padding: 0;
		padding-right: 4px;
		height: var(--menu-width);
		width: 100%;
	}

	.heading.open {
		border-radius: var(--sk-border-radius) var(--sk-border-radius) 0 0;
	}

	header strong,
	h1 {
		font-size: var(--sk-text-xs);
	}

	.heading {
		font-size: var(--sk-text-s);
		border: none;
	}

	header strong {
		color: var(--sk-theme-1);
	}

	.heading {
		flex: 1;

		position: relative;

		display: flex;
		justify-content: center;
		align-items: center;
		gap: 0.4ch;

		top: 0.15rem;
		height: 100%;
		min-width: 0;
		width: 100%;
		max-width: 100%;

		padding: 0 1.5rem;

		transition: 0.4s var(--quint-out);
		transition-property: background, box-shadow;

		background-color: var(--sk-back-2);

		border-radius: var(--sk-border-radius);
		box-shadow: var(--shadow);

		cursor: pointer;
	}

	h1 {
		display: flex;

		width: 100%;
		height: 100%;

		z-index: 3;

		overflow: hidden;

		white-space: nowrap;
		text-overflow: ellipsis;
		text-align: center;
		color: var(--sk-text-2);
		font-weight: 400;
	}

	h1 .desktop {
		display: flex;
		gap: 0.5ch;
		align-items: center;
	}

	h1 .mobile {
		display: none;
	}

	/* .expand-icon {
		padding: 0.5rem;
	} */

	.expand-icon :global(svg) {
		transition: transform 0.4s var(--quint-out);
		transform-origin: center;
	}

	.expand-icon.inverted :global(svg) {
		transform: rotate3d(0, 0, 1, 180deg);
	}

	.separator {
		position: relative;
		font-size: 0.8em;
		opacity: 0.3;
		top: -0.1rem;
		display: inline-block;
	}

	header a:not([href]) {
		opacity: 0.1;
		cursor: default;
	}

	nav {
		--transform-transition: transform 0.2s;
		position: absolute;
		top: var(--menu-width);
		left: 0;
		width: 100%;
		height: auto;
		max-height: 70vh;
		background: var(--sk-back-2);
		z-index: -1;
		box-shadow: var(--shadow);
		border-radius: 0 0 var(--sk-border-radius) var(--sk-border-radius);
		display: flex;
		flex-direction: column;
	}

	nav a {
		justify-content: start !important;
		display: flex;
	}

	.exercises {
		padding: 2rem 0;
		flex: 1;
		overflow: auto;
	}

	ul {
		position: relative;
		list-style: none;
		padding: 0 0 0 1.5rem;
		margin: 0;
	}

	ul.chapter {
		padding: 0 0 0 1rem;
	}

	li {
		position: relative;
	}

	li[aria-current='page'] a,
	li[aria-current='step']:not(.expanded) > button {
		color: var(--sk-theme-1);
	}

	li :global(svg) {
		position: absolute;
		/* left: -2rem; */
		top: 0.1rem;
		width: 2rem;
		height: 2rem;
		transition: transform 0.2s;
		stroke-width: 0 !important;
	}

	li.expanded > button {
		font-weight: bold;
	}

	li.expanded > button > :global(svg) {
		transform: rotate(90deg);
	}

	li a::before,
	li a::after {
		position: absolute;
	}

	.exercise {
		--dot-size: 1.2rem;
		--color: var(--sk-text-2);
	}

	a,
	button {
		color: var(--sk-text-2);
		padding: 0 0 0 0.5rem;
		margin: 0 0.5rem 0 0;
		display: block;
		font-variant-numeric: tabular-nums;
		border: 2px solid transparent;
		box-sizing: border-box;
	}

	li button {
		position: relative;

		display: flex;
		gap: 0.5rem;
	}

	li a {
		padding-left: 2rem;
	}

	header > a {
		height: 100%;
		width: 100%;

		display: flex;
		align-items: center;
		justify-content: center;

		padding: 0;
		padding: 0;
		margin: 0;
		border: 0;
	}

	a:focus-visible,
	.exercises button:focus-visible {
		outline: none;
		border: 2px solid var(--sk-theme-3);
	}

	@media screen and (max-width: 800px) {
		.container {
			border-right: none;
		}

		/* Remove all styles */
		.heading {
			box-shadow: none;
			background-color: transparent;

			padding: 0;

			justify-content: start;
		}

		.expand-icon {
			display: none;
		}

		h1 {
			display: flex;
			flex-direction: column;
			column-gap: 0.5ch;
			align-items: flex-start;
			grid-template-rows: repeat(2, auto);

			width: max-content;
			height: max-content;
		}

		h1 .mobile {
			display: block;
		}

		h1 .desktop {
			display: none;
		}

		.heading-row {
			display: flex;
			gap: 0.5ch;
			align-items: center;
		}

		h1 :where(.part-title, .chapter-title) {
			grid-row: 2 / span 1;
			font-size: var(--sk-text-xs);
			color: var(--sk-text-3);
		}

		h1 strong {
			font-size: var(--sk-text-s) !important;
			line-height: 1;
		}
	}
</style>

```


####### src/routes/tutorial/[slug]/Output.svelte #######

```

<script>
	import { browser, dev } from '$app/environment';
	import { afterNavigate } from '$app/navigation';
	import { theme } from '@sveltejs/site-kit/stores';
	import { onMount } from 'svelte';
	import Chrome from './Chrome.svelte';
	import Loading from './Loading.svelte';
	import { base, error, logs, progress, subscribe } from './adapter';

	/** @type {import('$lib/types').Exercise} */
	export let exercise;

	/** @type {boolean} */
	export let paused;

	/** @type {HTMLIFrameElement} */
	let iframe;
	let loading = true;
	let initial = true;
	let terminal_visible = false;

	// reset `path` to `exercise.path` each time, but allow it to be controlled by the iframe
	let path = exercise.path;

	$: if ($base) set_iframe_src($base + (path = exercise.path));

	onMount(() => {
		const unsubscribe = subscribe('reload', () => {
			set_iframe_src($base + path);
		});

		return () => {
			unsubscribe();
		};
	});

	afterNavigate(() => {
		clearTimeout(timeout);
	});

	/** @param {typeof $theme} $theme */
	function change_theme($theme) {
		if (!iframe) return;

		try {
			const url = new URL(iframe.src);

			url.searchParams.set('theme', $theme.current);

			iframe.src = url.href;
		} catch {}
	}

	$: change_theme($theme);

	/** @type {any} */
	let timeout;

	/** @param {MessageEvent} e */
	async function handle_message(e) {
		if (e.origin !== $base) return;

		if (paused) return;

		if (e.data.type === 'path') {
			path = e.data.path;
		} else if (e.data.type === 'ping') {
			loading = false;

			clearTimeout(timeout);
			timeout = setTimeout(() => {
				if (dev && !iframe) return;

				// we lost contact, refresh the page
				loading = true;
				set_iframe_src($base + path);
				loading = false;
			}, 1000);
		} else if (e.data.type === 'ping-pause') {
			clearTimeout(timeout);
		}
	}

	/** @param {string} src */
	function set_iframe_src(src) {
		if (!iframe) return; // HMR

		// To prevent iframe flickering.
		// Set to `visible` by calling `set_iframe_visible` function
		// from iframe on:load or setTimeout
		iframe.style.visibility = 'hidden';
		setTimeout(set_iframe_visible, 1000);

		// removing the iframe from the document allows us to
		// change the src without adding a history entry, which
		// would make back/forward traversal very annoying
		const parentNode = /** @type {HTMLElement} */ (iframe.parentNode);
		parentNode?.removeChild(iframe);

		const url = new URL(src);
		url.searchParams.set('theme', $theme.current);

		iframe.src = url.href;
		parentNode?.appendChild(iframe);
	}

	function set_iframe_visible() {
		if (iframe.style.visibility === 'hidden') {
			iframe.style.visibility = 'visible';
		}
	}
</script>

<svelte:window on:message={handle_message} />
<Chrome
	{path}
	{loading}
	href={$base && $base + path}
	on:refresh={() => {
		set_iframe_src($base + path);
	}}
	on:toggle_terminal={() => {
		terminal_visible = !terminal_visible;
	}}
	on:change={(e) => {
		if ($base) {
			const url = new URL(e.detail.value, $base);
			path = url.pathname + url.search + url.hash;
			set_iframe_src($base + path);
		}
	}}
/>

<div class="content">
	{#if browser}
		<iframe bind:this={iframe} title="Output" on:load={set_iframe_visible} />
	{/if}

	{#if paused || loading || $error}
		<Loading {initial} error={$error} progress={$progress.value} status={$progress.text} />
	{/if}

	<div class="terminal" class:visible={terminal_visible}>
		{#each $logs as log}
			<div>{@html log}</div>
		{/each}
	</div>
</div>

<style>
	.content {
		display: flex;
		flex-direction: column;
		position: relative;
		min-height: 0;
		height: 100%;
		max-height: 100%;
		background: var(--sk-back-2);
		--menu-width: 5.4rem;
	}

	iframe {
		width: 100%;
		height: 100%;
		flex: 1;
		resize: none;
		box-sizing: border-box;
		border: none;
		background: var(--sk-back-2);
	}

	.terminal {
		position: absolute;
		left: 0;
		bottom: 0;
		width: 100%;
		height: 80%;
		font-family: var(--font-mono);
		font-size: var(--sk-text-xs);
		padding: 1rem;
		background: rgba(255, 255, 255, 0.5);
		transform: translate(0, 100%);
		transition: transform 0.3s;
		backdrop-filter: blur(3px);
		overflow-y: auto;
	}

	.terminal::after {
		--thickness: 6px;
		--shadow: transparent;
		content: '';
		display: block;
		position: absolute;
		width: 100%;
		height: var(--thickness);
		left: 0;
		top: calc(-1 * var(--thickness));
		background-image: linear-gradient(to bottom, transparent, var(--shadow));
		pointer-events: none;
	}

	.terminal.visible {
		transform: none;
	}

	.terminal.visible::after {
		--shadow: rgba(0, 0, 0, 0.05);
	}

	@media (prefers-color-scheme: dark) {
		.terminal {
			background: rgba(0, 0, 0, 0.5);
		}
	}
</style>

```


####### src/routes/tutorial/[slug]/+page.server.js #######

```

import { get_exercise } from '$lib/server/content.js';
import { error, redirect } from '@sveltejs/kit';

export function entries() {
	return [{ slug: 'local-transitions' }];
}

export async function load({ params }) {
	if (params.slug === 'local-transitions') {
		throw redirect(307, '/tutorial/global-transitions');
	}

	const exercise = await get_exercise(params.slug);

	if (!exercise) {
		throw error(404, 'No such tutorial found');
	}

	return {
		exercise
	};
}

```


####### src/routes/tutorial/[slug]/+page.svelte #######

```

<script>
	import { afterNavigate, beforeNavigate } from '$app/navigation';
	import { SplitPane } from '@rich_harris/svelte-split-pane';
	import { Icon } from '@sveltejs/site-kit/components';
	import { reset } from './adapter.js';
	import Editor from './Editor.svelte';
	import ContextMenu from './filetree/ContextMenu.svelte';
	import Filetree from './filetree/Filetree.svelte';
	import ImageViewer from './ImageViewer.svelte';
	import Output from './Output.svelte';
	import ScreenToggle from './ScreenToggle.svelte';
	import Sidebar from './Sidebar.svelte';
	import {
		create_directories,
		creating,
		files,
		reset_files,
		selected_file,
		selected_name,
		solution
	} from './state.js';

	export let data;

	let path = data.exercise.path;
	let show_editor = false;
	let show_filetree = false;
	let paused = false;
	let w = 1000;

	/** @type {import('$lib/types').Stub[]} */
	let previous_files = [];

	$: mobile = w < 800; // for the things we can't do with media queries
	$: files.set(Object.values(data.exercise.a));
	$: solution.set(data.exercise.b);
	$: selected_name.set(data.exercise.focus);
	$: completed = is_completed($files, data.exercise.b);

	beforeNavigate(() => {
		previous_files = $files;
	});

	afterNavigate(async () => {
		w = window.innerWidth;

		const will_delete = previous_files.some((file) => !(file.name in data.exercise.a));

		if (data.exercise.path !== path || will_delete) paused = true;
		await reset($files);

		path = data.exercise.path;
		paused = false;
	});

	/**
	 * @param {import('$lib/types').Stub[]} files
	 * @param {Record<string, import('$lib/types').Stub> | null} solution
	 */
	function is_completed(files, solution) {
		if (!solution) return true;

		for (const file of files) {
			if (file.type === 'file') {
				const expected = solution[file.name];
				if (expected?.type !== 'file') return false;
				if (normalise(file.contents) !== normalise(expected.contents)) return false;
			}
		}

		const names = new Set(files.map((stub) => stub.name));

		for (const name in solution) {
			if (!names.has(name)) return false;
		}

		return true;
	}

	/** @param {string} code */
	function normalise(code) {
		// TODO think about more sophisticated normalisation (e.g. truncate multiple newlines)
		return code.replace(/\s+/g, ' ').trim();
	}

	/** @param {string | null} name */
	function select_file(name) {
		const file = name && $files.find((file) => file.name === name);

		if (!file && name) {
			// trigger file creation input. first, create any intermediate directories
			const new_directories = create_directories(name, $files);

			if (new_directories.length > 0) {
				reset_files([...$files, ...new_directories]);
			}

			// find the parent directory
			const parent = name.split('/').slice(0, -1).join('/');

			creating.set({
				parent,
				type: 'file'
			});

			show_filetree = true;
		} else {
			show_filetree = false;
			selected_name.set(name);
		}

		show_editor = true;
	}

	/** @param {string} name */
	function navigate_to_file(name) {
		if (name === $selected_name) return;

		select_file(name);

		if (mobile) {
			const q = new URLSearchParams({ file: $selected_name || '' });
			history.pushState({}, '', `?${q}`);
		}
	}

	/** @type {HTMLElement} */
	let sidebar;

	/** @type {import('./$types').Snapshot<number>} */
	export const snapshot = {
		capture: () => {
			const scroll = sidebar.scrollTop;
			sidebar.scrollTop = 0;
			return scroll;
		},
		restore: (scroll) => {
			sidebar.scrollTop = scroll;
		}
	};
</script>

<svelte:head>
	<title>{data.exercise.chapter.title} / {data.exercise.title} • Svelte Tutorial</title>

	<meta name="twitter:title" content="{data.exercise.title} • Svelte Tutorial" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@sveltejs" />
	<meta name="twitter:creator" content="@sveltejs" />
	<meta name="twitter:image" content="https://svelte.dev/images/twitter-thumbnail.jpg" />
	<meta property="twitter:domain" content="learn.svelte.dev" />
	<meta property="twitter:url" content="https://learn.svelte.dev" />

	<meta property="og:title" content="{data.exercise.title} • Svelte Tutorial" />
	<meta property="og:url" content="https://learn.svelte.dev" />
	<meta property="og:type" content="website" />
	<meta property="og:image" content="https://svelte.dev/images/twitter-thumbnail.jpg" />
</svelte:head>

<svelte:window
	bind:innerWidth={w}
	on:popstate={(e) => {
		const q = new URLSearchParams(location.search);
		const file = q.get('file');

		if (file) {
			show_editor = true;
			select_file(file || null); // empty string === null
		} else {
			show_editor = false;
		}
	}}
/>

<ContextMenu />

<div class="container" class:mobile>
	<div class="top" class:offset={show_editor}>
		<SplitPane id="main" type="horizontal" min="360px" max="50%" pos="33%">
			<section slot="a" class="content">
				<Sidebar
					bind:sidebar
					index={data.index}
					exercise={data.exercise}
					on:select={(e) => {
						navigate_to_file(e.detail.file);
					}}
				/>
			</section>

			<section slot="b">
				<SplitPane type="vertical" min="100px" max="-4.1rem" pos="50%">
					<section slot="a">
						<SplitPane
							id="editor"
							type={mobile ? 'vertical' : 'horizontal'}
							min="120px"
							max="300px"
							pos="200px"
						>
							<section class="navigator" slot="a">
								{#if mobile}
									<button class="file" on:click={() => (show_filetree = !show_filetree)}>
										{$selected_file?.name.replace(
											data.exercise.scope.prefix,
											data.exercise.scope.name + '/'
										) ?? 'Files'}
									</button>
								{:else}
									<Filetree
										exercise={data.exercise}
										on:select={(e) => {
											select_file(e.detail.name);
										}}
									/>
								{/if}

								<button
									class="solve"
									class:completed
									disabled={!data.exercise.has_solution}
									on:click={() => {
										reset_files(Object.values(completed ? data.exercise.a : data.exercise.b));
									}}
								>
									{#if completed && data.exercise.has_solution}
										reset
									{:else}
										solve <Icon name="arrow-right" />
									{/if}
								</button>
							</section>

							<section class="editor-container" slot="b">
								<Editor />
								<ImageViewer selected={$selected_file} />

								{#if mobile && show_filetree}
									<div class="mobile-filetree">
										<Filetree
											mobile
											exercise={data.exercise}
											on:select={(e) => {
												navigate_to_file(e.detail.name);
											}}
										/>
									</div>
								{/if}
							</section>
						</SplitPane>
					</section>

					<section slot="b" class="preview">
						<Output exercise={data.exercise} {paused} />
					</section>
				</SplitPane>
			</section>
		</SplitPane>
	</div>

	<div class="screen-toggle">
		<ScreenToggle
			on:change={(e) => {
				show_editor = e.detail.pressed;

				const url = new URL(location.origin + location.pathname);

				if (show_editor) {
					url.searchParams.set('file', $selected_name ?? '');
				}

				history.pushState({}, '', url);
			}}
			pressed={show_editor}
		/>
	</div>
</div>

<style>
	.container {
		display: flex;
		flex-direction: column;
		height: calc(100dvh - var(--sk-nav-height));
		/** necessary for innerWidth to be correct, so we can determine `mobile` */
		width: 100vw;
		overflow: hidden;
	}

	.top {
		width: 200vw;
		margin-left: -100vw;
		height: 0;
		flex: 1;
		transition: transform 0.2s;
		/* we transform the default state, rather than the editor state, because otherwise
		   the positioning of tooltips is wrong (doesn't take into account transforms) */
		transform: translate(50%, 0);
	}

	.top.offset {
		transform: none;
	}

	.screen-toggle {
		height: 4.6rem;
	}

	.content {
		display: flex;
		flex-direction: column;
		position: relative;
		min-height: 100%;
		height: 100%;
		background: var(--sk-back-3);
		--menu-width: 5rem;
	}

	.navigator {
		position: relative;
		background: var(--sk-back-2);
		display: flex;
		flex-direction: column;
	}

	.navigator .solve {
		position: relative;
		background: var(--sk-theme-2);
		padding: 0.5rem;
		width: 100%;
		height: 4rem;
		border-right: 1px solid var(--sk-back-4);
		color: white;
		opacity: 1;
	}

	.navigator .solve:disabled {
		opacity: 0.5;
	}

	.navigator .solve:not(:disabled) {
		background: var(--sk-theme-1);
	}

	.navigator .solve.completed {
		background: var(--sk-theme-2);
	}

	.preview {
		display: flex;
		flex-direction: column;
	}

	.editor-container {
		position: relative;
		background-color: var(--sk-back-3);
	}

	.mobile .navigator {
		display: flex;
		flex-direction: row;
		align-items: center;
		padding: 1rem;
		gap: 1rem;
	}

	.mobile .navigator .file {
		flex: 1;
		text-align: left;
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;

		/* put ellipsis at start */
		direction: rtl;
		text-align: left;
	}

	.mobile .navigator .solve {
		width: 9rem;
		height: auto;
		padding: 0.2rem;
		border-radius: 4rem;
		border: none;
	}

	.mobile-filetree {
		position: absolute;
		top: 0;
		width: 100%;
		height: 100%;
		overflow-y: auto;
	}

	/* on mobile, override the <SplitPane> controls */
	@media (max-width: 799px) {
		:global([data-pane='main']) {
			--pos: 50% !important;
		}

		:global([data-pane='editor']) {
			--pos: 5.4rem !important;
		}

		:global([data-pane]) :global(.divider) {
			cursor: default;
		}
	}

	@media (min-width: 800px) {
		.top {
			width: 100vw;
			margin: 0;
			transform: none;
		}

		.screen-toggle {
			display: none;
		}
	}
</style>

```


####### src/routes/tutorial/[slug]/ScreenToggle.svelte #######

```

<script>
	import { createEventDispatcher } from 'svelte';
	import ToggleButton from './ToggleButton.svelte';

	/** @type {boolean} */
	export let pressed = false;

	const dispatch = createEventDispatcher();
</script>

<div class="input-output-toggle">
	<button
		aria-hidden="true"
		on:click={() => {
			if (pressed) {
				pressed = false;
				dispatch('change', { pressed });
			}
		}}>Tutorial</button
	>
	<ToggleButton label="Show editor" {pressed} on:change />
	<button
		aria-hidden="true"
		on:click={() => {
			if (!pressed) {
				pressed = true;
				dispatch('change', { pressed });
			}
		}}>Editor</button
	>
</div>

<style>
	.input-output-toggle {
		position: relative;
		display: flex;
		gap: 0.5em;
		user-select: none;
		align-items: center;
		justify-content: center;
		width: 100%;
		height: 100%;
		z-index: 2;
		margin: 0 auto;
		box-shadow: 0px 0px 6px rgba(0, 0, 0, 0.07);
	}

	@media (min-width: 832px) {
		.input-output-toggle {
			padding-left: 3.2rem;
			width: var(--sidebar-menu-width);
			margin: 0 0 0 auto;
		}
	}
</style>

```


####### src/routes/tutorial/[slug]/Sidebar.svelte #######

```

<script>
	import { createEventDispatcher } from 'svelte';
	import Modal from '$lib/components/Modal.svelte';
	import Menu from './Menu.svelte';

	/** @type {import('$lib/types').PartStub[]} */
	export let index;

	/** @type {import('$lib/types').Exercise} */
	export let exercise;

	/** @type {HTMLElement} */
	export let sidebar;

	const dispatch = createEventDispatcher();

	const namespace = 'learn.svelte.dev';
	const copy_enabled = `${namespace}:copy_enabled`;

	let show_modal = false;
</script>

<Menu {index} current={exercise} />

<section bind:this={sidebar}>
	<div
		class="text"
		on:copy={(e) => {
			if (sessionStorage[copy_enabled]) return;

			/** @type {HTMLElement | null} */
			let node = /** @type {HTMLElement} */ (e.target);

			while (node && node !== e.currentTarget) {
				if (node.nodeName === 'PRE') {
					show_modal = true;

					e.preventDefault();
					return;
				}

				node = /** @type {HTMLElement | null} */ (node.parentNode);
			}
		}}
	>
		<!-- svelte-ignore a11y-click-events-have-key-events -->
		<!-- svelte-ignore a11y-no-static-element-interactions -->
		<div
			on:click={(e) => {
				const node = /** @type {HTMLElement} */ (e.target);

				if (node.nodeName === 'CODE') {
					const { file } = node.dataset;
					if (file) {
						dispatch('select', { file });
					}
				}

				if (node.nodeName === 'SPAN' && node.classList.contains('filename')) {
					const file = exercise.scope.prefix + node.textContent;
					dispatch('select', { file });
				}
			}}
		>
			{@html exercise.html}
		</div>

		{#if exercise.next}
			<p><a href="/tutorial/{exercise.next.slug}">Next: {exercise.next.title}</a></p>
		{/if}
	</div>

	<footer>
		<a
			target="_blank"
			rel="noreferrer"
			class="edit"
			href="https://github.com/sveltejs/learn.svelte.dev/tree/main/{exercise.dir}"
		>
			Edit this page
		</a>
	</footer>
</section>

{#if show_modal}
	<Modal on:close={() => (show_modal = false)}>
		<div class="modal-contents">
			<h2>Copy and paste is currently disabled!</h2>

			<p>
				We recommend typing the code into the editor to complete the exercise, as this results in
				better retention and understanding.
			</p>
			<label>
				<input
					type="checkbox"
					on:change={(e) => {
						sessionStorage[copy_enabled] = e.currentTarget.checked ? 'true' : '';
					}}
				/>
				enable copy-and-paste for the duration of this session
			</label>

			<button on:click={() => (show_modal = false)}>OK</button>
		</div>
	</Modal>
{/if}

<style>
	section {
		display: flex;
		flex-direction: column;
		flex: 1 1 auto;

		overflow-y: auto;
	}

	.text {
		flex: 1 1 auto;
		padding: 2.2rem 3rem;
		border-right: 1px solid var(--sk-back-4);
		background: var(--sk-back-3);
	}

	.text :global(pre) {
		background: var(--sk-back-1);
		box-shadow: inset 1px 1px 3px rgba(0, 0, 0, 0.1);
		border-radius: var(--sk-border-radius);
	}

	.text :global(pre) :global(.highlight) {
		--color: rgba(220, 220, 0, 0.2);
		background: var(--color);
		outline: 2px solid var(--color);
		border-radius: 2px;
	}

	.text :global(pre) :global(.highlight.add) {
		--color: rgba(0, 255, 0, 0.18);
	}

	.text :global(pre) :global(.highlight.remove) {
		--color: rgba(255, 0, 0, 0.1);
	}

	:global(body.dark) .text :global(pre) :global(.highlight.remove) {
		--color: rgba(255, 0, 0, 0.27);
	}

	/** this probably belongs in site-kit */
	.text :global(p) :global(a) :global(code) {
		color: var(--sk-theme-1);
		background: rgba(255, 62, 0, 0.1);
	}

	.text :global([data-file]),
	.text :global(.filename) {
		cursor: pointer;
		background-image: url($lib/icons/file-edit.svg);
		background-repeat: no-repeat;
	}

	.text :global([data-file]) {
		background-position: 0.5rem 50%;
		background-size: 1rem 1rem;
		padding-left: 2rem;
	}

	.text :global(.filename) {
		background-position: 1rem 54%;
		background-size: 1rem 1rem;
		padding-left: 2.5rem;
	}

	@media (prefers-color-scheme: dark) {
		.text :global([data-file]),
		.text :global(.filename) {
			background-image: url($lib/icons/file-edit-inline-dark.svg);
		}
	}

	.text :global(.desktop) {
		display: none;
	}

	footer {
		padding: 1rem 2.9rem;
		display: flex;
		justify-content: space-between;
		background: var(--sk-back-3);
		border-top: 1px solid var(--sk-back-4);
		border-right: 1px solid var(--sk-back-4);
	}

	footer .edit {
		color: var(--sk-text-2);
		font-size: 1.4rem;
		padding: 0 0 0 1.4em;
		background: url($lib/icons/file-edit.svg) no-repeat 0 calc(50% - 0.1em);
		background-size: 1em 1em;
	}

	.modal-contents h2 {
		font-size: 2.4rem;
		margin: 0 0 0.5em 0;
	}

	.modal-contents label {
		user-select: none;
	}

	.modal-contents button {
		display: block;
		background-color: var(--sk-theme-1);
		color: white;
		padding: 1rem;
		width: 10em;
		margin: 1em 0 0 0;
		border-radius: var(--sk-border-radius);
		line-height: 1;
	}

	@media (max-width: 800px) {
		.text {
			border-right: none;
		}
	}

	@media (min-width: 800px) {
		.text :global(.mobile) {
			display: none;
		}

		.text :global(.desktop) {
			display: inline;
		}
	}
</style>

```


####### src/routes/tutorial/[slug]/state.js #######

```

import { derived, writable } from 'svelte/store';
import * as adapter from './adapter.js';

/**
 * @template T
 * @typedef {import('svelte/store').Writable<T>} Writable<T>
 */

// TODO would be nice if svelte exported this type (maybe it does already?)
/**
 * @typedef {{
 *   code: string;
 *   start: { line: number, column: number, character: number };
 *   end: { line: number, column: number, character: number };
 *   pos: number;
 *   filename: string;
 *   frame: string;
 *   message: string;
 * }} CompilerWarning
 */

/** @type {Writable<import('$lib/types').Stub[]>} */
export const files = writable([]);

/** @type {Writable<Record<string, import('$lib/types').Stub>>} */
export const solution = writable({});

/** @type {Writable<{ parent: string, type: 'file' | 'directory' } | null>} */
export const creating = writable(null);

/** @type {Writable<string | null>} */
export const selected_name = writable(null);

export const selected_file = derived([files, selected_name], ([$files, $selected_name]) => {
	return (
		/** @type{import('$lib/types').FileStub | undefined} */ (
			$files.find((stub) => stub.name === $selected_name)
		) ?? null
	);
});

/** @param {import('$lib/types').FileStub} file */
export function update_file(file) {
	files.update(($files) => {
		return $files.map((old) => {
			if (old.name === file.name) {
				return file;
			}
			return old;
		});
	});

	adapter.update(file);
}

/** @param {import('$lib/types').Stub[]} new_files */
export function reset_files(new_files) {
	// if the selected file no longer exists, clear it
	selected_name.update(($selected_name) => {
		const file = new_files.find((file) => file.name === $selected_name);
		return file?.name ?? null;
	});

	files.set(new_files);
	adapter.reset(new_files);
}

/**
 * @param {string} name
 * @param {import('$lib/types').Stub[]} files
 */
export function create_directories(name, files) {
	const existing = new Set();

	for (const file of files) {
		if (file.type === 'directory') {
			existing.add(file.name);
		}
	}

	/** @type {import('$lib/types').DirectoryStub[]} */
	const directories = [];

	const parts = name.split('/');
	while (parts.length) {
		parts.pop();

		const dir = parts.join('/');
		if (existing.has(dir)) {
			break;
		}

		directories.push({
			type: 'directory',
			name: dir,
			basename: /** @type {string} */ (parts.at(-1))
		});
	}

	return directories;
}
```


####### src/routes/tutorial/[slug]/ToggleButton.svelte #######

```

<!-- TODO this is copied from kit.svelte.dev — probably belongs in site-kit -->
<script>
	import { createEventDispatcher } from 'svelte';

	/** @type {string} */
	export let label;

	export let pressed = false;

	const dispatch = createEventDispatcher();
</script>

<button
	aria-pressed={pressed ? 'true' : 'false'}
	on:click={() => {
		pressed = !pressed;
		dispatch('change', { pressed });
	}}
>
	<span class="visually-hidden">{label}</span>
</button>

<style>
	button {
		--size: 1em;
		--bg: var(--sk-theme-2);
		--fg: white;
		--bg-active: var(--bg);
		--fg-active: var(--fg);
		position: relative;
		height: var(--size);
		width: calc(100% - 0.6em);
		max-width: calc(2 * var(--size));
		top: -2px;
		border-radius: 0.5em;
		-webkit-appearance: none;
		appearance: none;
		outline-offset: 2px;
		border: transparent;
	}

	button:focus-visible {
		outline: 2px solid var(--sk-theme-3);
	}

	button::before {
		content: '';
		position: absolute;
		display: block;
		height: 100%;
		width: 100%;
		padding: 2px;
		border-radius: var(--size);
		top: 0;
		left: 0;
		background: var(--bg);
		box-sizing: border-box;
	}

	button[aria-pressed='true']::before {
		background: var(--bg-active);
	}

	button::after {
		content: '';
		position: absolute;
		display: block;
		width: calc(var(--size) - 4px);
		height: calc(var(--size) - 4px);
		aspect-ratio: 1;
		top: 2px;
		left: 2px;
		border-radius: 50%;
		background: var(--fg);
		box-shadow: 0 0px 1px rgba(0, 0, 0, 0.4), 0 4px 2px rgba(0, 0, 0, 0.1);
		transition: background 0.2s ease-out, left 0.2s ease-out;
	}

	button[aria-pressed='true']::after {
		background: var(--fg-active);
		left: calc(100% - var(--size) + 2px);
	}
</style>

```


####### static/manifest.json #######

```

{
	"short_name": "Learn Svelte",
	"name": "learn.svelte.dev",
	"description": "An interactive Svelte/SvelteKit tutorial",
	"icons": [
		{
			"src": "/svelte-logo-square.svg",
			"type": "image/svg+xml",
			"sizes": "512x512"
		},
		{
			"src": "/svelte-logo-square.png",
			"type": "image/png",
			"sizes": "512x512",
			"purpose": "any maskable"
		}
	],
	"start_url": "/",
	"background_color": "#383838",
	"theme_color": "#383838",
	"display": "minimal-ui",
	"scope": "/"
}
```


####### static/robots.txt #######

User-agent: *
Disallow:

####### static/tutorial/dark-theme.css #######

```

body {
	background-color: #333;
	color: whitesmoke;
	transition: all 0.5s;
}

```


####### svelte.config.js #######

```

import * as child_process from 'node:child_process';
import adapter from '@sveltejs/adapter-vercel';

/** @type {import('@sveltejs/kit').Config} */
const config = {
	kit: {
		adapter: adapter({ runtime: 'edge' }),

		prerender: {
			concurrency: 4
		},

		version: {
			name: child_process.execSync('git rev-parse HEAD').toString().trim()
		}
	}
};

export default config;

```


####### tests/env_file.spec.ts #######

```

import { expect, test, type Page } from '@playwright/test';

const iframe_selector = 'iframe[src*="webcontainer.io/"]';

async function disableAnimations(page: Page) {
	await page.addStyleTag({
		content: `
      *, *::before, *::after {
        animation-duration: 0s !important;
        transition-duration: 0s !important;
      }
    `
	});
}

test.describe.configure({ mode: 'parallel' });

test('.env file: no timeout error occurs when switching a tutorials without a .env file to one with it', async ({
	page
}) => {
	await page.bringToFront();

	await page.goto('/tutorial/welcome-to-svelte');

	// disable animations to prevent flakiness
	await disableAnimations(page);

	const iframe_locator = page.frameLocator(iframe_selector);

	// wait for the iframe to load
	await iframe_locator.getByText('Welcome!').waitFor();

	// switch to another tutorial with a .env file
	await page.click('header > button > h1', { delay: 200 });
	await page.getByRole('button', { name: 'Part 4: Advanced SvelteKit' }).click({ delay: 200 });
	await page.getByRole('button', { name: 'Environment variables' }).click({ delay: 200 });
	await page.locator('a', { hasText: '$env/static/private' }).click({ delay: 200 });

	// wait for the iframe to load
	await iframe_locator.getByText('enter the passphrase').waitFor();

	// wait for a bit, because when Vite dev server is restarted, learn.svelte.dev
	// will wait for 10 seconds, after which time a timeout error will occur.
	await page.waitForTimeout(11000);

	// expect no timeout error
	await expect(page.getByText('Yikes!')).toBeHidden();
	await expect(iframe_locator.getByText('enter the passphrase')).toBeVisible();
});

test('.env file: environment variables are available when switching a tutorial without a .env file to one with it', async ({
	page
}) => {
	await page.bringToFront();

	await page.goto('/tutorial/welcome-to-svelte');

	// disable animations to prevent flakiness
	await disableAnimations(page);

	const iframe_locator = page.frameLocator(iframe_selector);

	// wait for the iframe to load
	await iframe_locator.getByText('Welcome!').waitFor();

	// switch to another tutorial with a .env file
	await page.click('header > button > h1', { delay: 200 });
	await page.getByRole('button', { name: 'Part 4: Advanced SvelteKit' }).click({ delay: 200 });
	await page.getByRole('button', { name: 'Environment variables' }).click({ delay: 200 });
	await page.locator('a', { hasText: '$env/dynamic/private' }).click({ delay: 200 });

	// wait for the iframe to load
	await iframe_locator.getByText('enter the passphrase').waitFor();

	await page.waitForTimeout(3000);

	// login
	// 'open sesame' is the environment variables loaded from `.env` file
	await iframe_locator.locator('input[name="passphrase"]').fill('open sesame');
	await page.keyboard.press('Enter', { delay: 1000 });

	// expect to be able to login.
	// Being able to log in means that environment variables are loaded.
	await expect(iframe_locator.getByText('wrong passphrase!')).toBeHidden();
	await expect(iframe_locator.locator('button', { hasText: 'log out' })).toBeEnabled();
});

```


####### tests/focus_management.spec.ts #######

```

import { expect, test } from '@playwright/test';

const editor_selector = '.cm-content';
const iframe_selector = 'iframe[src*="webcontainer.io/"]';

test.describe.configure({ mode: 'parallel' });

test('focus management: the editor keeps focus when iframe is loaded', async ({ page }) => {
	await page.bringToFront();

	await page.goto('/tutorial/your-first-component');

	// first, focus the editor before the iframe is loaded
	await page.waitForTimeout(1000);
	await page.locator(editor_selector).click();

	// at this time, expect focus to be on the editor
	await expect(page.locator(editor_selector)).toBeFocused();

	// wait for the iframe to load
	await page.frameLocator(iframe_selector).getByText('Hello world!').waitFor();

	// wait a little, because there may be a script that manipulates focus
	await page.waitForTimeout(1000);

	// expect focus to be on the editor
	await expect(page.locator(editor_selector)).toBeFocused();
});

test('focus management: input inside the iframe gets focus when clicking it', async ({ page }) => {
	await page.bringToFront();

	await page.goto('/tutorial/named-form-actions');

	const iframe = page.frameLocator(iframe_selector);

	// wait for the iframe to load
	await iframe.getByText('todos').waitFor();

	// first, focus the editor
	await page.waitForTimeout(1000)
	await page.locator(editor_selector).click();
	await expect(page.locator(editor_selector)).toBeFocused();

	// then, click a input in the iframe
	const input = iframe.locator('input[name="description"]');
	await page.waitForTimeout(1000)
	await input.click();

	// wait a little, because there may be a script that manipulates focus
	await page.waitForTimeout(1000);

	// expect focus to be on the input in the iframe, not the editor.
	await expect(input).toBeFocused();
	await expect(page.locator(editor_selector)).not.toBeFocused();
});

test('focus management: The editor keeps focus while typing', async ({ page }) => {
	await page.bringToFront();

	await page.goto('/tutorial/your-first-component');

	// wait for the iframe to load
	await page.frameLocator(iframe_selector).getByText('Hello world!').waitFor();

	// first, write script tag
	const code = '<script>\n\n</script>\n';
	await page.locator(editor_selector).fill(code);

	// move the cursor into the script tag
	await page.waitForTimeout(500);
	await page.keyboard.press('PageUp');
	await page.waitForTimeout(500);
	await page.keyboard.press('ArrowDown');

	// wait a little because the above operation is flaky
	await page.waitForTimeout(500);

	// type the code as a person would do it manually
	await page.keyboard.type(`	export let data;`, { delay: 150 });

	// wait a little, because there may be a script that manipulates focus
	await page.waitForTimeout(1000);

	// get code from DOM, then replace nbsp with normal space
	const received = (await page.locator(editor_selector).innerText()).replace(/\u00a0/g, ' ');

	const expected = '<script>\n\texport let data;\n</script>\n\n';

	expect(received).toBe(expected);
});

```


####### vercel.json #######

```

{
	"$schema": "https://openapi.vercel.sh/vercel.json",
	"headers": [
		{
			"source": "_app/immutable/workers/(.*)",
			"headers": [
				{
					"key": "cross-origin-opener-policy",
					"value": "same-origin"
				},
				{
					"key": "cross-origin-embedder-policy",
					"value": "require-corp"
				},
				{
					"key": "cross-origin-resource-policy",
					"value": "cross-origin"
				}
			]
		}
	]
}

```


####### vite.config.js #######

```

import { sveltekit } from '@sveltejs/kit/vite';
import browserslist from 'browserslist';
import { browserslistToTargets } from 'lightningcss';
import path from 'node:path';

/** @type {import('vite').UserConfig} */
export default {
	logLevel: 'info',

	css: {
		transformer: 'lightningcss',
		lightningcss: {
			targets: browserslistToTargets(browserslist(['>0.2%', 'not dead']))
		}
	},
	build: {
		target: 'esnext',
		cssMinify: 'lightningcss'
	},

	plugins: [
		// apply cross-origin isolation headers when previewing locally
		{
			name: 'cross-origin-isolation-for-preview',
			configurePreviewServer: (server) => {
				server.middlewares.use((_, res, next) => {
					res.setHeader('cross-origin-opener-policy', 'same-origin');
					res.setHeader('cross-origin-embedder-policy', 'require-corp');
					res.setHeader('cross-origin-resource-policy', 'cross-origin');
					next();
				});
			}
		},

		sveltekit()
	],

	server: {
		fs: {
			allow: [path.resolve('.apps')],
			strict: false
		},
		watch: {
			ignored: ['**/.apps/**']
		},
		headers: {
			'cross-origin-opener-policy': 'same-origin',
			'cross-origin-embedder-policy': 'require-corp',
			'cross-origin-resource-policy': 'cross-origin'
		}
	},

	ssr: {
		noExternal: ['@sveltejs/site-kit']
	},

	optimizeDeps: {
		exclude: ['@sveltejs/site-kit']
	}
};

```

